// commondb028.js
(function(){
Type.registerNamespace('Kepler.CommonDB028.Controls');Kepler.CommonDB028.Controls.ESelectionItemState=function(){};Kepler.CommonDB028.Controls.ESelectionItemState.prototype = {eNormal:0,eMoved:1,ePressed:2,ePressedHover:3,eFocus:4,eFocusHover:5,eDisabled:6,eDrag:7,eLostFocus:8,eSelected:9}
Kepler.CommonDB028.Controls.ESelectionItemState.registerEnum('Kepler.CommonDB028.Controls.ESelectionItemState',false);Kepler.CommonDB028.Controls.ItemContainer=function(oSize,index,strSelectionText,strId,strDownArrowBtnId){this.iRelatedShapeIndex=-1;Kepler.CommonDB028.Controls.ItemContainer.initializeBase(this,['div',' animation_item_container',strId]);if(ss.isValue(oSize)){this.set_size(oSize);}this.$3_1=index;this.get_element().index=this.$3_1;var $0;if(Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName()!=='powerpoint'){$0=' animation_item_container'+'_'+Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName();}else{$0=' animation_item_container';}this.get_element().className=$0;this.changeState(0);this.$3_11(strDownArrowBtnId);this.setSelectionText(strSelectionText);this._bIsMenuActive=false;this.set_dblClickEventNeeded(true);}
Kepler.CommonDB028.Controls.ItemContainer.prototype={$3_0:0,$3_1:0,get_index:function(){return this.$3_1;},$3_2:null,$3_3:null,get_markerBottomElement:function(){return this.$3_3;},set_markerBottomElement:function(value){this.$3_3=value;return value;},$3_4:0,$3_5:null,$3_6:null,get_selectionText:function(){return this.$3_6;},set_selectionText:function(value){this.$3_6=value;return value;},$3_7:false,get_isSelected:function(){return this.$3_7;},$3_8:false,_bIsMenuActive:false,get_isMenuActive:function(){return this._bIsMenuActive;},$3_9:null,$3_A:null,get_downArrowBtn:function(){return this.$3_A;},bIsSlicer:false,_strSelectedIndex:null,get_selecetedIndex:function(){return this._strSelectedIndex;},get_ariaSpeech:function(){var $0='';if(this.$3_E){$0='. Use arrow keys to switch between the options';this.$3_E=false;}if(this.$3_7||(this.get_parent()).get_selectionItemsList().indexOf(this)===(this.get_parent())._iHighlightedIdx){var $2=Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'get_ariaSpeech').replaceAll(' not','').replaceAll($0,'')+$0;if(this.bIsSlicer){return $2.replaceAll(this.$3_6,this.$3_6+' slicer');}return $2;}else if(Type.canCast(this.get_parent(),Kepler.CommonDB028.Controls.CustomScrollableContainer)&&(this.get_parent()).get_selIndexList().length>0){for(var $3=0;$3<=(this.get_parent()).get_selIndexList().length;$3++){var $4=((this.get_parent()).get_selectionItemsList()[$3]);if(ss.isValue($4)&&$4.get_isSelected()){var $5=(this.get_parent()).get_selectionItemsList()[$3].get_ariaSpeech().replaceAll(' not','');return $5.replaceAll($0,'')+$0;}}}else if(Type.canCast(this.get_parent(),Kepler.CommonDB028.Controls.CustomScrollableContainer)&&(this.get_parent())._iHighlightedIdx>=0){var $6=(this.get_parent()).get_selectionItemsList()[(this.get_parent())._iHighlightedIdx].get_ariaSpeech().replaceAll(' not','')+$0;return $6.replaceAll($0,'')+$0;}var $1=Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'get_ariaSpeech').replaceAll($0,'')+$0;if(this.bIsSlicer){return $1.replaceAll(this.$3_6,this.$3_6+' slicer');}return $1;},set_ariaSpeech:function(value){Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'set_ariaSpeech',[value]);return value;},$3_B:null,$3_C:0,$3_D:0,$3_E:true,get_firstFocus:function(){return this.$3_E;},set_firstFocus:function(value){this.$3_E=value;return value;},onLoad:function(){Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'onLoad');this.$3_F();this.addEvents(Kepler.Framework.UI.Events.EventArgsNs.EventType.mouseOver|Kepler.Framework.UI.Events.EventArgsNs.EventType.mouseOut|Kepler.Framework.UI.Events.EventArgsNs.EventType.mouseDown|Kepler.Framework.UI.Events.EventArgsNs.EventType.mouseUp|Kepler.Framework.UI.Events.EventArgsNs.EventType.mouseWheel|Kepler.Framework.UI.Events.EventArgsNs.EventType.mouseMove|Kepler.Framework.UI.Events.EventArgsNs.EventType.mouseDoubleClick|Kepler.Framework.UI.Events.EventArgsNs.EventType.keyDown);this.addEvents(Kepler.Framework.UI.Events.EventArgsNs.EventType.touchStart|Kepler.Framework.UI.Events.EventArgsNs.EventType.touchMove|Kepler.Framework.UI.Events.EventArgsNs.EventType.touchEnd);this.$3_10();},$3_F:function(){this.add(this.$3_A);},$3_10:function(){this.attachMessage(Kepler.Engine.UI.Controls.Control.msG_COMMAND,ss.Delegate.create(this,this.$3_16));this.attachMessage(Kepler.Engine.UI.Controls.ButtonBase.msG_BUTTON_CLICKED,ss.Delegate.create(this,this.onMsgButtonClicked));},$3_11:function($p0){this.$3_2=document.createElement('div');this.$3_2.className='animation_text';this.$3_A=new Kepler.CommonDB028.Controls.CustomCssImageButton(null,null,new Kepler.Framework.UI.Size(17,16),'commondb028_hide_btn',$p0,null);this.$3_A.set_focusable(false);this.$3_3=document.createElement('div');Kepler.Engine.UI.Helper.HtmlCssHelper.addCssClass(this.$3_3,'item_marker');this.get_element().appendChild(this.$3_2);this.get_element().appendChild(this.$3_3);},setSelectionText:function(strText){this.$3_6=strText;this.$3_2.innerHTML=this.$3_6;},setSelectedContainer:function(){if(!this.$3_7){this.$3_7=true;(this.get_parent()).get_selIndexList().add(this.get_element().index);(this.get_parent())._iHighlightedIdx=this.get_element().index;}this.changeState(2);},setDeselectedContainer:function(){if(this.$3_7){this.changeState(0);this.$3_7=false;(this.get_parent()).get_selIndexList().remove(this.get_element().index);}},$3_12:function($p0){if(ss.isValue(this.$3_B)){var $0=this.$3_B.getPageAndSeqNoOfCommandId($p0);if(ss.isValue($0)){return this.$3_B.getSeqNoFromControlId($0);}}return -1;},$3_13:function($p0){var $0=Kepler.Engine.UI.Controls.Control.getClientPointFromEventArgs($p0);var $1=$(this.get_element()).offset().top+22;var $2=this.get_element().index;var $3=$2-Math.round(($1-$0.get_y())/this.get_height());return $3;},onMsgButtonClicked:function(wParam,lParam){if(lParam===this.$3_A){return this.sendMessageToParent(Kepler.Engine.UI.Controls.ButtonBase.msG_BUTTON_CLICKED,wParam,lParam);}return null;},$3_14:function($p0,$p1){if($p0){this.setCapture();}var $0=this.get_parent();var $1=Kepler.Engine.UI.Controls.Control.getClientPointFromEventArgs($p1);this.$3_C=$1.get_x();this.$3_D=$1.get_y();this.$3_8=false;if(!$p1.get_shiftKey()){if(!!$0.get_isCtrlPlusAClicked()){$0.set_isCtrlPlusAClicked(false);}if(!$p1.get_ctrlKey()&&!this.$3_7){$0.resetAllItems();this.setSelectedContainer();var $2=$0.get_selIndexList()[$0.get_selIndexList().length-1];$0._pseudoselect.clear();$0._pseudoselect.add(this.$3_1);this.sendMessageToParent('msg_child_selection_change',null,this.$3_1);}}else{if(!$p1.get_ctrlKey()){if(!!$0.get_isCtrlPlusAClicked()){$0.set_isCtrlPlusAClicked(false);$0.get_selIndexList().removeRange(0,$0.get_selIndexList().length);$0.get_selIndexList().add($0.get_selectionItemsList().length-1);}$0.handleItemSelectionWithShiftKey(this.iRelatedShapeIndex);}else{if(!!$0.get_isCtrlPlusAClicked()){$0.set_isCtrlPlusAClicked(false);}if(!this.$3_7){this.setSelectedContainer();}}this.sendMessageToParent('msg_child_selection_change',null,this.$3_1);}this.sendRecordEventMessageToParent(Kepler.Framework.Core.PlayBackEvent.ActionEventType.lefT_CLICK.toString());},fillCtrlPlayBackData:function(oPlayBackEventData){var $0=oPlayBackEventData.get_ctrlPlayBackData();$0.set_element(this.get_element());if(oPlayBackEventData.get_actionEventType()===Kepler.Framework.Core.PlayBackEvent.ActionEventType.keyboarD_COMMAND){var $1=oPlayBackEventData.get_metaData();var $2=$1[Kepler.Framework.Core.PlayBackEvent.PlayBackEventData.metadatA_KEY];$0.set_keyCode(parseInt($2,10));}},changeState:function(eState){if(this.$3_0===eState){return;}this.$3_0=eState;this.drawItem(this.$3_0);},drawItem:function(eState){var $0;var $1='';if(this.get_element().className.indexOf('commondb028_child_shape')>=0){$1='commondb028_child_shape';}var $2;if(Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName()!=='powerpoint'){$2=' animation_item_container'+'_'+Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName();}else{$2=' animation_item_container';}if(!this.get_enable()){$0='_disable';this.get_element().className=$1+' '+$2+$2+$0;return;}switch(eState){case 0:$0='_normal';this.get_element().className=$1+' '+$2+$2+$0;break;case 1:$0='_selected_move';this.get_element().className=$1+' '+$2+$2+$0;break;case 2:$0='_pressed';this.get_element().className=$1+' '+$2+$2+$0;break;case 9:$0='_selected';this.get_element().className=$1+' '+$2+$2+$0;break;}},$3_15:function($p0,$p1){var $0=this.getCapture();this.releaseCapture();if(this.isMouseEventInElementRect($p0)){var $1=new Kepler.Framework.UI.Controls.OnCommandStruct(null,Kepler.Framework.UI.Controls.NotificationCode.buttoN_DBLCLICK);this.sendMessageToParent(Kepler.Engine.UI.Controls.Control.msG_COMMAND,$1,$p1);}if(this.$3_7){this.changeState(9);}},sendMsgToParent:function(wParam){var $0=new Kepler.Framework.UI.Controls.OnCommandStruct(wParam,Kepler.Framework.UI.Controls.NotificationCode.menU_ITEM_CLICKED);var $1=this.sendMessageToParent(Kepler.Engine.UI.Controls.Control.msG_COMMAND,$0,this);if(!$1){return this.sendMessageToParent(Kepler.Engine.Messages.msG_MENUITEM_CLICKED_LAUNCHER,wParam,this);}return $1;},$3_16:function($p0,$p1){return this.sendMessageToParent(Kepler.Engine.UI.Controls.Control.msG_COMMAND,$p0,$p1);},getFocusRect:function(){return null;},onLButtonDown:function(evt){Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'onLButtonDown',[evt]);this.$3_14(true,evt);},onMouseMove:function(evt){Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'onMouseMove',[evt]);var $0=this.getCapture();if($0===this){var $1=this.get_parent();var $2=this.$3_13(evt);if(!this.isMouseEventInElementRect(evt)){this.$3_8=true;if($1.get_selIndexList().length>=2){if(!$1.get_selIndexList().contains(this.$3_1+1)&&!$1.get_selIndexList().contains(this.$3_1-1)){$1.resetAllItems();this.setSelectedContainer();this.sendMessageToParent('msg_child_selection_change',null,this.$3_1);}}}this.sendMessageToParent('msg_place_drop_marker',$2,this);var $3=Kepler.Engine.UI.Controls.Control.getClientPointFromEventArgs(evt);var $4=Math.sqrt(Math.pow(($3.get_x()-this.$3_C),2)+Math.pow(($3.get_y()-this.$3_D),2));if($4>3){if($2===this.get_index()||$2===this.get_index()-1){Kepler.Engine.UI.Helper.HtmlCssHelper.setStyleProperty(this.get_element(),'cursor',"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAHTSURBVDhPdZLNTttAFIXHIXJspxINIMOGlC5is4NlniCwb8kDAAKWWYRKVLRJJdIFFbANKE7cV6Ab8rNEJl4QworfXdSm7kucem5cwM3kSFeeuXPuN3euzP7X3f0dbNsGk1go5t7O4eb2BoFNrNMfp5AiEvQZHe9X3oVieXmJQNlsVgyxv9uIx+MUfB2kQwqKhyFW1YKu63S7qioofimObPUfJJPJPHtyuRy15zgOfTVNw15pbyQkKB6cV6wKFTVbTUp4ngc5JpOhXC6PhBimAUVRwCrVANAcALhc18VscpYgNbsmhBjzBuKvNLBqrYpIJIJ6ox4y8n3KSBH8+OR4CJIyU1A1FcyyLEiShEazMWQ6q58h+SbpnzOUvpZC5xw+eII/Az79VqslbPXcOUdMkaH57RaKn588pv8EVfMBXJtbG0hMJuD98YSQ/u8+z/ugGPa/7WNtfRVROfrs3f20C1mW/VlI+NX/KYQ8PD5g/PU4dTsWHcOUPhX2bX/YJkhiIoFOpyOEFAoFGurC4gJ6vd6wh3fCDea8iYOjAxweHT7FzscdGmY6ncZV90p4AYn/1vl8nkAvY3pmGnzgl53L0cUv5bptXLQdira/7l53BYWM/QV2NxDVxM+q+QAAAABJRU5ErkJggg=='), auto");}else{Kepler.Engine.UI.Helper.HtmlCssHelper.setStyleProperty(this.get_element(),'cursor',"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAVCAYAAAB2Wd+JAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAJGSURBVDhPlZO9b1JhFMb7XzAQVlopta5UJyUlMFBiylIHYKgI1gRCSS1uJOIAYtogG8rEUlC6iJVeNzYIHy0pgxeQmjoQSE2ocPl6vO9L5aZRlD43J4Fzz+99znty7ozBaIBGo8HMdSWVSlGr1aBSqa4Hzy/Mgyiby8JitUwPy+Qy9Ad9DIdDJD4m4HnxfDp4dm4WHa6NwXCAbq+L2PvYdDABiWN/0EOvP4pE4gMslv+0TYZD3Ag45J/fbedyOSyrlifDBCTFxIkcQKLX79IcnbZ6wrQJ2O1xtJjckQRxZFkWR8UjhMNhGI3GP+G5G3O4+HlBW2XLLE5KJ/S3SCSC7r4Oev0qH3ocModX4ZFjF6ffTrGiW4H/lZ+2S8DLkr+LgB2ug/WH64jGonA9cyGfz2N/Pw6TyfTv4SzclKPMt0m06dwEwzD0nmKxeDIol8vpy3QmTV053v2e8i7Ovp+h+rUKpVKJQCCAUCgExW0FrV28tSgc2Gq1sLu7g0gkgo0nGzj4dIBGo4G1B2soV8pwu904Lh5j6c4SCoWCALLsF2w93RonyXDIQpD9tdls48I3b0PYdm0LYKVagcvlQjqdpskd3t1ut9PDmM/MuJDkPR6PAJ7/OMdLvw+xd7FxMplMgtz98i+VWqNGKpUSctlsFuZH5itFk6RQjIZExXEcAq8D8Pl80Gq1KBaLkMlkiMfjcDgcMJvNdHskEgnq9boAlkoleL1eBINBZDIZrPKr1mw24XQ6sRfd4z+1BKyPrWh32jAYDfgFu2PZ+AiqufoAAAAASUVORK5CYII='), auto");}}else{Kepler.Engine.UI.Helper.HtmlCssHelper.setStyleProperty(this.get_element(),'cursor','');}}},onLButtonUp:function(mouseEventArgs){Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'onLButtonUp',[mouseEventArgs]);var $0=this.getCapture();this.releaseCapture();if($0===this){this.get_element().style.cursor='';(this.get_parent()).get_element().className='';if(!!this.$3_8){this.$3_8=false;var $1=new Kepler.Framework.UI.Controls.OnCommandStruct(null,Kepler.Framework.UI.Controls.NotificationCode.buttoN_CLICK);this.sendMessageToParent(Kepler.Engine.UI.Controls.Control.msG_COMMAND,$1,this);}else{var $2=this.get_parent();$2.removeMarkerNode();this.$3_8=false;if(!mouseEventArgs.get_shiftKey()){if(!mouseEventArgs.get_ctrlKey()&&this.$3_7){$2.resetAllItems();this.setSelectedContainer();var $3=$2.get_selIndexList()[$2.get_selIndexList().length-1];this.sendMessageToParent('msg_child_selection_change',null,$3);}else if(mouseEventArgs.get_ctrlKey()){if(this.$3_7){this.setDeselectedContainer();}else{this.setSelectedContainer();}var $4=$2.get_selIndexList()[$2.get_selIndexList().length-1];this.sendMessageToParent('msg_child_selection_change',null,$4);}}}}if(this.$3_7){this.changeState(3);}},onMouseDblClick:function(evt){this.sendRecordEventMessageToParent(Kepler.Framework.Core.PlayBackEvent.ActionEventType.doublE_CLICK.toString());Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'onMouseDblClick',[evt]);this.$3_15(evt,this);},onRButtonUp:function(evt){Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'onRButtonUp',[evt]);if(!this.$3_7){var $0=this.get_parent();$0.resetAllItems();this.setSelectedContainer();var $1=$0.get_selIndexList()[$0.get_selIndexList().length-1];this.sendMessageToParent('msg_child_selection_change',null,this.$3_1);}},onMouseOut:function(evt){Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'onMouseOut',[evt]);var $0=Kepler.Engine.UI.Controls.Control.getClientPointFromEventArgs(evt);var $1=Kepler.Engine.UI.Helper.HtmlCssHelper.getElementClientRect(this.get_element());if(!$1.isPtInRect($0.get_x(),$0.get_y(),false)){if(this.$3_7){this.changeState(9);}else{}}},onKeyDown:function(KeyEventArgs){this.sendMessageToParent('msg_item_key_down',KeyEventArgs,this);},onPretranslateEvent:function(sender,eventArgs){var $0=sender;if(eventArgs.get_categoryType()===Kepler.Framework.UI.Events.EventArgsNs.EventCategoryType.key){var $2=eventArgs;if($2.get_type()===Kepler.Framework.UI.Events.EventArgsNs.EventType.keyDown){var $3=$2.get_key();if(this.$3_7){if($2.get_altKey()&&$3===Kepler.Framework.UI.Events.EventArgsNs.Keys.down){return true;}if($3===Kepler.Framework.UI.Events.EventArgsNs.Keys.returnKey){}}}}var $1=Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'onPretranslateEvent',[sender,eventArgs]);sender=$0;return $1;},onFocus:function(oFocusedPrevControl){var $0=(this.get_parent())._iHighlightedIdx;if($0===-1){(this.get_parent())._pseudoselect.add(0);var $1=(this.get_parent()).get_selectionItemsList()[0];var $2=$1;$2.changeState(1);if($2.get_isSelected()){this.set_ariaSpeech($2.get_element().innerText);}else{this.set_ariaSpeech($2.get_element().innerText+' not selected');}}else{var $3=(this.get_parent()).get_selectionItemsList()[$0];var $4=$3;$4.changeState(1);}Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'onFocus',[oFocusedPrevControl]);},onLostFocus:function(oFocusedNewControl){this.$3_E=true;var $0=(this.get_parent()).get_selectionItemsList().length;for(var $1=0;$1<$0;$1++){var $2=(this.get_parent()).get_selectionItemsList()[$1];var $3=$2;if($3.get_isSelected()){$3.changeState(9);}else{$3.changeState(0);}}Kepler.CommonDB028.Controls.ItemContainer.callBaseMethod(this, 'onLostFocus',[oFocusedNewControl]);},$3_17:function($p0,$p1){var $0=$p1;var $1=$p0;this.$3_14(true,$1);return null;},$3_18:function($p0,$p1){if(!this._bIsMenuActive){return null;}var $0=$p1;var $1=$p0;if((Kepler.Engine.UI.Menu.WindowsMenuItem).isInstanceOfType($p0)){var $2=$p0;this._strSelectedIndex=$0.toString();return this.sendMsgToParent($0);}else{return this.sendMsgToParent($p0);}},$3_19:function($p0,$p1){if(!this.$3_7){var $0=this.get_parent();$0.resetAllItems();this.setSelectedContainer();var $1=$0.get_selIndexList()[$0.get_selIndexList().length-1];this.sendMessageToParent('msg_child_selection_change',null,this.$3_1);}return null;}}
Kepler.CommonDB028.Controls.CustomCssImageButton=function(strImagePath,oPosition,oSize,strCssClassName,strId,element){Kepler.CommonDB028.Controls.CustomCssImageButton.initializeBase(this,[strImagePath,oPosition,oSize,strCssClassName,strId,element]);this.set_dblClickEventNeeded(true);}
Kepler.CommonDB028.Controls.CustomCssImageButton.prototype={onRButtonDown:function(mouseEventArgs){Kepler.CommonDB028.Controls.CustomCssImageButton.callBaseMethod(this, 'onRButtonDown',[mouseEventArgs]);this.setCapture();this.changeState(Kepler.Framework.UI.Controls.EItemState.ePressed);if(this.get_sendClickMsgOnMouseDown()){this.onEventProcessClick(mouseEventArgs);}},onRButtonUp:function(mouseEventArgs){Kepler.CommonDB028.Controls.CustomCssImageButton.callBaseMethod(this, 'onRButtonUp',[mouseEventArgs]);var $0=this.getCapture();this.releaseCapture();if(!this.get_sendClickMsgOnMouseDown()&&$0===this&&this.isMouseEventInElementRect(mouseEventArgs)){this.onEventProcessClick(mouseEventArgs);}this.changeState(Kepler.Framework.UI.Controls.EItemState.eNormal);},getFocusRect:function(){return null;}}
Kepler.CommonDB028.Controls.CustomCssImageTextButton=function(strHtml,oPosition,oSize,strId,strImgCssClassName,strCssClass,element){Kepler.CommonDB028.Controls.CustomCssImageTextButton.initializeBase(this,[strHtml,oPosition,oSize,strId,strImgCssClassName,strCssClass,element]);}
Kepler.CommonDB028.Controls.CustomCssImageTextButton.prototype={getFocusRect:function(){return null;}}
Kepler.CommonDB028.Controls.CustomScrollableContainer=function(strTagName){this.$4_3=-2;Kepler.CommonDB028.Controls.CustomScrollableContainer.initializeBase(this,[strTagName]);this.$4_2=0;this.$4_0=[];this.$4_1=[];this.$4_4=[];this._defaultMarkerContainer=document.createElement('div');Kepler.Engine.UI.Helper.HtmlCssHelper.addCssClass(this._defaultMarkerContainer,'default_drop_marker');this._marker=document.createElement('div');Kepler.Engine.UI.Helper.HtmlCssHelper.addCssClass(this._marker,'animation_item_horizontal_marker');this._pseudoselect=[];this._iHighlightedIdx=-1;this.set_focusChildCtrlsOnTab(true);this._elmScrollableContainer.style.paddingLeft='2px';}
Kepler.CommonDB028.Controls.CustomScrollableContainer.prototype={$4_0:null,get_selIndexList:function(){return this.$4_0;},$4_1:null,get_selIndexListForAction:function(){return this.$4_1;},$4_2:0,get_previousSelectedIndex:function(){return this.$4_2;},set_previousSelectedIndex:function(value){this.$4_2=value;return value;},_defaultMarkerContainer:null,_marker:null,get_marker:function(){return this._marker;},get_dropIndex:function(){return this.$4_3;},set_dropIndex:function(value){this.$4_3=-2;return value;},$4_4:null,get_selectionItemsList:function(){return this.$4_4;},$4_5:false,get_isCtrlPlusAClicked:function(){return this.$4_5;},set_isCtrlPlusAClicked:function(value){this.$4_5=value;return value;},$4_6:null,get_menuActionNodes:function(){return this.$4_6;},set_menuActionNodes:function(value){this.$4_6=value;return value;},$4_7:null,get_dragActionAllowedNodes:function(){return this.$4_7;},set_dragActionAllowedNodes:function(value){this.$4_7=value;return value;},_pseudoselect:null,_iHighlightedIdx:0,onLoad:function(){Kepler.CommonDB028.Controls.CustomScrollableContainer.callBaseMethod(this, 'onLoad');if(this._defaultMarkerContainer!=null){this.get_scrollAreaElement().appendChild(this._defaultMarkerContainer);}this.$4_8();this.$4_9();},$4_8:function(){this.addEvents(Kepler.Framework.UI.Events.EventArgsNs.EventType.keyDown|Kepler.Framework.UI.Events.EventArgsNs.EventType.touchStart);},$4_9:function(){this.attachMessage(Kepler.Engine.UI.Controls.Control.msG_COMMAND,ss.Delegate.create(this,this.$4_D));this.attachMessage('msg_child_selection_change',ss.Delegate.create(this,this.$4_E));this.attachMessage('msg_place_drop_marker',ss.Delegate.create(this,this.$4_F));this.attachMessage('msg_item_key_down',ss.Delegate.create(this,this.$4_A));},$4_A:function($p0,$p1){var $0=$p0;if($0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.down||$0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.up||$0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.space||$0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.returnKey){this.$4_B($0);($p1).sendRecordEventMessageToParent(Kepler.Framework.Core.PlayBackEvent.ActionEventType.keyboarD_COMMAND+Kepler.Framework.Core.Seperators.PIPE+$0.get_key(),$0.get_altKey(),$0.get_shiftKey(),$0.get_ctrlKey());}else{if($0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.tab&&this.get_defaultTabHandling()){if(this.get_controls().length>0&&this.get_focusChildCtrlsOnTab()){this.processTabOnControl($0,this);($p1).sendRecordEventMessageToParent(Kepler.Framework.Core.PlayBackEvent.ActionEventType.keyboarD_COMMAND+Kepler.Framework.Core.Seperators.PIPE+Kepler.Framework.UI.Events.EventArgsNs.Keys.tab,$0.get_altKey(),$0.get_shiftKey(),$0.get_ctrlKey());}else{if(ss.isValue(this.get_parent())){this.get_parent().processTabOnControl($0,this);}($p1).sendRecordEventMessageToParent(Kepler.Framework.Core.PlayBackEvent.ActionEventType.keyboarD_COMMAND+Kepler.Framework.Core.Seperators.PIPE+Kepler.Framework.UI.Events.EventArgsNs.Keys.tab,$0.get_altKey(),$0.get_shiftKey(),$0.get_ctrlKey());}}}return null;},$4_B:function($p0){this.$4_2=this.get_selIndexList()[0];if($p0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.down||$p0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.up){var $0;if($p0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.down&&(this._iHighlightedIdx===-1||this._iHighlightedIdx+1<this.$4_4.length)){if(this._pseudoselect[this._pseudoselect.length-1]+1===this.$4_4.length&&this._pseudoselect.length>0){return null;}if(this._pseudoselect.length>0){$0=this._pseudoselect[this._pseudoselect.length-1]+1;}else{$0=(this._iHighlightedIdx+1);}this._pseudoselect.add($0);this._iHighlightedIdx=$0;}if($p0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.up&&(this._iHighlightedIdx===-1||this._iHighlightedIdx>0)){if(!this._pseudoselect[this._pseudoselect.length-1]&&this._pseudoselect.length>0){return null;}if(this._pseudoselect.length>0){$0=this._pseudoselect[this._pseudoselect.length-1]-1;}else{$0=(this._iHighlightedIdx-1);}this._pseudoselect.add($0);this._iHighlightedIdx=$0;}if(this._pseudoselect.length>0){var $1=this.$4_4[this._pseudoselect[this._pseudoselect.length-1]];$1.set_selectionText($1.get_element().innerText);this.setAriaAttributes();if($1!=null){$1.changeState(1);}$1=this.$4_4[this._pseudoselect[this._pseudoselect.length-2]];if($1!=null){if(this.get_selIndexList().indexOf(this._pseudoselect[this._pseudoselect.length-2])<0){$1.changeState(0);}else{$1.changeState(9);}}}return null;}if($p0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.space||$p0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.returnKey){var $2=this.$4_4[this.$4_2];if(!$p0.get_shiftKey()){this.resetAllItems();this.get_selIndexList().removeRange(0,this.get_selIndexList().length);if(ss.isValue($2)){$2.changeState(0);}$2=this.$4_4[this._pseudoselect[this._pseudoselect.length-1]];this.get_selIndexList().add(this._pseudoselect[this._pseudoselect.length-1]);this.sendMessageToParent('msg_child_selection_change',this._pseudoselect[this._pseudoselect.length-1],this);if(ss.isValue($2)){$2.changeState(9);}}else if(this._pseudoselect.length>0){$2=this.$4_4[this._pseudoselect[this._pseudoselect.length-1]];this.get_selIndexList().add(this._pseudoselect[this._pseudoselect.length-1]);this.sendMessageToParent('msg_child_selection_change',this._pseudoselect[this._pseudoselect.length-1],this);$2.changeState(9);}Kepler.Framework.Accessibility.AccessibilitySupport.get_instance().set_dontSkipText(Kepler.Engine.Core.EngineApp.get_engine().getCurrentAppFrame().get_ribbonManager().get_documentTitle()+', ');Kepler.Engine.Core.EngineApp.get_engine().getCurrentAppView().setFocus();return null;}return null;},setFocus:function(){if(Type.canCast(this.get_parentWnd(),Kepler.CommonDB028.SelectionDialog)&&!this.get_parentWnd().get_visible()){return Kepler.Engine.UI.Controls.Control.get_focusedControl();}return Kepler.CommonDB028.Controls.CustomScrollableContainer.callBaseMethod(this, 'setFocus');},getAriaSpeech:function(){if(!ss.isNullOrUndefined(this.$4_4[this._iHighlightedIdx])){var $0=(this.$4_4[this._iHighlightedIdx]);if($0.get_isSelected()){if($0.bIsSlicer){return $0.get_selectionText()+' slicer.';}return $0.get_selectionText();}else{if($0.bIsSlicer){return $0.get_selectionText()+' slicer not selected';}return $0.get_selectionText()+' not selected';}}else{return Kepler.CommonDB028.Controls.CustomScrollableContainer.callBaseMethod(this, 'getAriaSpeech');}},addControls:function(lstControls){for(var $0=0;$0<lstControls.length;$0++){this.add(lstControls[$0]);this.$4_4.add(lstControls[$0]);}},resetAllItems:function(){var $enum1=ss.IEnumerator.getEnumerator(this.get_selectionItemsList());while($enum1.moveNext()){var $0=$enum1.current;$0.setDeselectedContainer();}this.get_selIndexList().clear();},handleMarkerOnItem:function(index){this.removeMarkerNode();this.showHideMarker(true);this.get_element().className='';if(index!==-2){if(index===-1){this._defaultMarkerContainer.appendChild(this.get_marker());}else{(this.get_controls()[index]).get_markerBottomElement().appendChild(this.get_marker());}Kepler.Engine.UI.Helper.HtmlCssHelper.addCssClass(this.get_element(),'drag_cursor');}else{Kepler.Engine.UI.Helper.HtmlCssHelper.addCssClass(this.get_element(),'drag_invalid_cursor');}},removeMarkerNode:function(){if(!ss.isNullOrUndefined(this.get_marker().parentNode)){this.get_marker().parentNode.removeChild(this.get_marker());}},showHideMarker:function(bShow){if(bShow){this.get_marker().style.visibility='visible';}else{this.get_marker().style.visibility='hidden';}},$4_C:function($p0,$p1){if($p0<-1){$p0=-1;}else if($p0>=this.$4_4.length){$p0=this.$4_4.length-1;}if(this.$4_0.length>=2){var $0=this.$4_0;$0.sort();if($p0>=$0[0]-1&&$p0<=$0[$0.length-1]){$p0=-2;}}this.$4_3=$p0;return $p0;},updateScrollbar:function(){if(!this.get_loaded()){return;}var $0=$(this._elmScrollableContainer).outerHeight();var $1=$(this.get_element()).outerHeight();if($0<=$1){this.get_verticalScrollbar().set_enable(false);this._bIsScrollable=false;}else{var $2=new Kepler.Engine.UI.Controls.ScrollBarParams();$2.setBounds(0,$0-$1);$2.setSteps(this.get_scrollBarSingleStep(),$1);this.get_verticalScrollbar().updateScrollbarParams($2);this.get_verticalScrollbar().set_enable(true);this._bIsScrollable=true;}if(this.get_scrollbarMode()===Kepler.Engine.UI.Controls.EScrollbarMode.NONE){this.get_verticalScrollbar().show(false);this.get_verticalScrollbar().get_elementStyle().display='none';this._elmScrollableContainer.style.width=this.get_width()+'px';}else if(this.get_scrollbarMode()===Kepler.Engine.UI.Controls.EScrollbarMode.AUTO){this.get_verticalScrollbar().show(this._bIsScrollable);if($0>$1){this.get_verticalScrollbar().set_enable(this._bIsScrollable);}if(this._bIsScrollable){this.get_verticalScrollbar().get_elementStyle().display='inline-block';this._elmScrollableContainer.style.width=new ss.StringBuilder().append(this.get_width()-this.get_scrollBarWidth()).append('px').toString();}else{this.get_verticalScrollbar().get_elementStyle().display='none';this._elmScrollableContainer.style.width=this.get_width()+'px';}}else if(this.get_scrollbarMode()===Kepler.Engine.UI.Controls.EScrollbarMode.shoW_ALWAYS){this.get_verticalScrollbar().show(true);this.get_verticalScrollbar().set_enable(this._bIsScrollable);this.get_verticalScrollbar().get_elementStyle().display='inline-block';}},onSize:function(){var $0=$(this.get_element()).outerHeight();this.set_height($0);Kepler.CommonDB028.Controls.CustomScrollableContainer.callBaseMethod(this, 'onSize');if(this.get_scrollbarMode()!==Kepler.Engine.UI.Controls.EScrollbarMode.NONE){this.get_verticalScrollbar().set_left(this.get_width()-(this.get_scrollBarWidth()+2));this.get_verticalScrollbar().set_height($0);this.updateScrollbar();}},getFocusRect:function(){return null;},handleItemSelectionWithShiftKey:function(_index){var $0=this.get_selIndexList()[0];var $1=_index-1;if(ss.isNullOrUndefined($0)){$0=_index-1;}this.get_selIndexList().removeRange(1,this.get_selIndexList().length-1);var $enum1=ss.IEnumerator.getEnumerator(this.get_selectionItemsList());while($enum1.moveNext()){var $2=$enum1.current;var $3=this.get_selIndexList()[0];if($3!==$2.get_index()){$2.setDeselectedContainer();}}if($0>$1){for(var $4=$0;$4>=$1;$4--){var $5=this.$4_4[$4];if(ss.isValue($5)){var $6=$5.get_index();if($6!==this.get_selIndexList()[0]){$5.setSelectedContainer();}}}}else{for(var $7=$0;$7<=$1;$7++){var $8=this.$4_4[$7];if(ss.isValue($8)){var $9=$8.get_index();if($9!==this.get_selIndexList()[0]){$8.setSelectedContainer();}}}}},$4_D:function($p0,$p1){var $0=$p1;var $1=$p0;var $2=$1.get_notificationMsg();if(this._ctrlBackToTop!=null&&$0===this._ctrlBackToTop){Kepler.Engine.UI.Helper.HtmlCssHelper.setElementTransformOrigin(this._elmScrollableContainer,'0px 0px');Kepler.Engine.UI.Helper.HtmlCssHelper.setElementTransform(this._elmScrollableContainer,'translate(0px, 0px) scale(1) translateZ(0px)');this.get_verticalScrollbar().performScrollTo(0);}if((Kepler.CommonDB028.Controls.ItemContainer).isInstanceOfType($0)&&$2===Kepler.Framework.UI.Controls.NotificationCode.buttoN_CLICK){if(this.$4_3===-2){return true;}}return this.sendMessageToParent(Kepler.Engine.UI.Controls.Control.msG_COMMAND,$p0,$p1);},onKeyReceived:function(oKey){var $0=null;if(oKey===Kepler.Framework.UI.Events.EventArgsNs.Keys.f6){if(this._iHighlightedIdx!==Kepler.Framework.Core.Globals.invaliD_VALUE){$0=(this.$4_4[this._iHighlightedIdx]);}else if(this.$4_4[0]!=null){$0=(this.$4_4[0]);this._iHighlightedIdx=-1;}if($0!=null){$0.setFocus();$0.changeState(1);}this.get_selIndexList().add(this._iHighlightedIdx);if(oKey!==Kepler.Framework.UI.Events.EventArgsNs.Keys.f6){this._pseudoselect.add(this._iHighlightedIdx);}}},$4_E:function($p0,$p1){var $0=$p1;this.sendMessageToParent('msg_child_selection_change',$0,this);return null;},$4_F:function($p0,$p1){var $0=($p1).get_element().index;var $1=this.$4_C($p0,$0);this.handleMarkerOnItem($1);return null;},onLButtonDown:function(evt){Kepler.CommonDB028.Controls.CustomScrollableContainer.callBaseMethod(this, 'onLButtonDown',[evt]);this._iHighlightedIdx=-1;},onKeyDown:function(KeyEventArgs){this.$4_B(KeyEventArgs);}}
Kepler.CommonDB028.Controls.CustomSplitButton=function(strHtml,oPosition,oSize,strClassName,strImgPath,ptImgPosition,sizeImgSize,iMenuNum,strSelectionIndex,eMode,strId,element,bImgBeforeText){Kepler.CommonDB028.Controls.CustomSplitButton.initializeBase(this,[strHtml,oPosition,oSize,strClassName,strImgPath,ptImgPosition,sizeImgSize,iMenuNum,strSelectionIndex,eMode,strId,element,bImgBeforeText]);}
Kepler.CommonDB028.Controls.CustomSplitButton.prototype={setFocus:function(){if(this._eMode===Kepler.Engine.UI.Controls.SplitButtonType.withSplit){this.iFocusedindex=0;if(!ss.isNull(this._elmText)){}if(!ss.isNull(this._elmImage)){}}return null;}}
Kepler.CommonDB028.Controls.CustomButton=function(strHtml,oPosition,oSize,strId,strClassName,element){Kepler.CommonDB028.Controls.CustomButton.initializeBase(this,[strHtml,oPosition,oSize,strId,strClassName,element]);}
Kepler.CommonDB028.Controls.CustomButton.prototype={getFocusRect:function(){return null;},onFocus:function(oFocusedPrevControl){Kepler.CommonDB028.Controls.CustomButton.callBaseMethod(this, 'onFocus',[oFocusedPrevControl]);if(Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName()!=='powerpoint'){this.addCssClass('commondb028_Custom_btn_'+Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName()+'_focus');}else{this.addCssClass('commondb028_Custom_btn_focus');}},onLostFocus:function(oFocusedNewControl){Kepler.CommonDB028.Controls.CustomButton.callBaseMethod(this, 'onLostFocus',[oFocusedNewControl]);if(Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName()!=='powerpoint'){this.removeCssClass('commondb028_Custom_btn_'+Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName()+'_focus');}else{this.removeCssClass('commondb028_Custom_btn_focus');}}}
Type.registerNamespace('Kepler.CommonDB028');Kepler.CommonDB028.SelectionClient=function(){Kepler.CommonDB028.SelectionClient.initializeBase(this);var $0=Kepler.CommonDB028.CommonDB028App.get_commonDB028().get_appName();this.$4_0=new Kepler.Engine.UI.Controls.Button('Cancel',null,null,1002+$0);this.$4_8=[];this.$4_9=[];this._zindexOnView=[];var $1='commondb028_play_all_btn';var $2='commondb028_play_from_btn';var $3='commondb028_move_earlier_btn';var $4='commondb028_move_later_btn';if(Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName()!=='powerpoint'){$1=$1+'_'+Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName();$2=$2+'_'+Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName();$3=$3+'_'+Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName();$4=$4+'_'+Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName();}this.$4_2=new Kepler.CommonDB028.Controls.CustomButton('Show All',null,new Kepler.Framework.UI.Size(54,23),1011+$0,$1);this.$4_2.set_donotHandleFocusOnLButtonDown(true);this.$4_2.get_elementStyle().textAlign='center';this.$4_3=new Kepler.CommonDB028.Controls.CustomButton('Hide All',null,new Kepler.Framework.UI.Size(54,23),1012+$0,$2);this.$4_3.set_donotHandleFocusOnLButtonDown(true);this.$4_3.get_elementStyle().textAlign='center';this.$4_4=new Kepler.CommonDB028.Controls.CustomCssImageButton('',null,new Kepler.Framework.UI.Size(21,21),$3,1013+$0,null);this.$4_4.set_donotHandleFocusOnLButtonDown(true);this.$4_4.setTooltipParams('Bring Forward',Kepler.Engine.UI.Controls.Tooltip.ETooltipTypes.simplE_DESCR);this.$4_5=new Kepler.CommonDB028.Controls.CustomCssImageButton('',null,new Kepler.Framework.UI.Size(21,21),$4,1014+$0,null);this.$4_5.set_donotHandleFocusOnLButtonDown(true);this.$4_5.setTooltipParams('Send Backward',Kepler.Engine.UI.Controls.Tooltip.ETooltipTypes.simplE_DESCR);this.$4_A=0;}
Kepler.CommonDB028.SelectionClient.prototype={$4_0:null,$4_1:null,$4_2:null,$4_3:null,$4_4:null,$4_5:null,$4_6:null,$4_7:null,$4_8:null,get_customContainersList:function(){return this.$4_8;},_zindexOnView:null,_selectedIndex:null,$4_9:null,get_triggerLabelList:function(){return this.$4_9;},$4_A:0,$4_B:function(){this._zindexOnView.clear();},get_slideSelectedIndex:function(){return this.$4_A;},$4_C:null,$4_D:null,$4_E:null,$4_F:false,$4_10:function($p0){var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $2=$enum1.current;this._selectedIndex=[$p0];}var $0=parseInt($p0[$p0.length-1])-1;var $1=this.$4_8[this.$4_A];if(ss.isNullOrUndefined($1)){return;}$1.resetAllItems();if(!!$p0.length&&!isNaN(parseInt($p0[0]))){var $enum2=ss.IEnumerator.getEnumerator($p0);while($enum2.moveNext()){var $3=$enum2.current;var $4=parseInt($3)-1;var $enum3=ss.IEnumerator.getEnumerator($1.get_selectionItemsList());while($enum3.moveNext()){var $5=$enum3.current;if($5.iRelatedShapeIndex===parseInt($3)){$5.setSelectedContainer();}}}}else if(ss.isValue($1)){$1._iHighlightedIdx=-1;}},getDataFromView:function(){},$4_11:function($p0){this.$4_A=$p0;var $enum1=ss.IEnumerator.getEnumerator(this.$4_8);while($enum1.moveNext()){var $0=$enum1.current;$0.show(false);}if(this.$4_8.length>this.$4_A){this.$4_8[this.$4_A].show(true);this.changeStateOfObjectPosition();}},changeStateOfObjectPosition:function(){if((this.$4_8[this.$4_A]).get_controls().length<2){this.$4_4.set_enable(false);this.$4_5.set_enable(false);}else{this.$4_4.set_enable(true);this.$4_5.set_enable(true);}},onLoad:function(){Kepler.CommonDB028.SelectionClient.callBaseMethod(this, 'onLoad');this.$4_7=(this.get_parent());this.addControls();this.$4_14();this.$4_12();this.addControlsToRepository();},$4_12:function(){this.addEvents(Kepler.Framework.UI.Events.EventArgsNs.EventType.keyDown);this.attachMessage('msg_child_selection_change',ss.Delegate.create(this,this.$4_13));},$4_13:function($p0,$p1){var $0=$p1;var $1=$p0;var $2=($0.get_selectionItemsList()[$1]).bIsSlicer;this.changeButtonStateBasedOnSelctionChange($0,true,$2);var $3=(this.get_parentWnd()).getPageAndSeqNoOfCommandId($0.get_selectionItemsList()[$1].get_id());var $4=(this.get_parentWnd()).isCorrectSelectionAction($3);if($4){this.$4_F=true;(this.get_parentWnd()).handleUserEvent($0.get_selectionItemsList()[$1].get_id(),Kepler.Framework.UI.Controls.NotificationCode.buttoN_CLICK);}return null;},addControls:function(){this.add(this.$4_0);this.$4_0.show(false);this.add(this.$4_2);this.add(this.$4_3);this.add(this.$4_4);this.add(this.$4_5);},$4_14:function(){this.attachMessage(Kepler.Engine.UI.Controls.Control.msG_COMMAND,ss.Delegate.create(this,this.$4_20));this.attachMessage('msg_child_selection_change',ss.Delegate.create(this,this.$4_13));this.attachMessage('current_page_in_view_changed',ss.Delegate.create(this,this.$4_17));},addControlsToRepository:function(slicerCount,slicerData){var $0=[];var $1=0;var $2;var $3=0;$0.add(new Kepler.Engine.Core.REPOSITORY_INFO(0,new Kepler.Engine.Core.CONTROL_ID(0,20),this.$4_0.get_id(),Kepler.Engine.Core.EControlTypes.BUTTON,true,-1,-1,'','Close',-1,-1));$0.add(new Kepler.Engine.Core.REPOSITORY_INFO($1++,new Kepler.Engine.Core.CONTROL_ID(0,30),this.$4_2.get_id(),Kepler.Engine.Core.EControlTypes.BUTTON,true,0,0,'','Show All',-1,-1));$0.add(new Kepler.Engine.Core.REPOSITORY_INFO($1++,new Kepler.Engine.Core.CONTROL_ID(0,40),this.$4_3.get_id(),Kepler.Engine.Core.EControlTypes.BUTTON,true,0,0,'','Hide All',-1,-1));$0.add(new Kepler.Engine.Core.REPOSITORY_INFO($1++,new Kepler.Engine.Core.CONTROL_ID(0,50),this.$4_4.get_id(),Kepler.Engine.Core.EControlTypes.BUTTON,true,0,0,'','Bring Forward',-1,-1));$0.add(new Kepler.Engine.Core.REPOSITORY_INFO($1++,new Kepler.Engine.Core.CONTROL_ID(0,60),this.$4_5.get_id(),Kepler.Engine.Core.EControlTypes.BUTTON,true,0,0,'','Send backward',-1,-1));var $4=0;var $enum1=ss.IEnumerator.getEnumerator(this.$4_8);while($enum1.moveNext()){var $5=$enum1.current;$2=0;$3+=1;var $6=0;if(ss.isValue(slicerData)){$6=parseInt(slicerData.split(Kepler.Framework.Core.Seperators.miD_DOT)[$3-1]);}var $enum2=ss.IEnumerator.getEnumerator($5.get_selectionItemsList());while($enum2.moveNext()){var $7=$enum2.current;var $8=($6>0)?$3*10:$3;($7).bIsSlicer=$6>0;if(!$6){$2=0;}$2+=10;$0.add(new Kepler.Engine.Core.REPOSITORY_INFO($1++,new Kepler.Engine.Core.CONTROL_ID($8,$2),$7.get_id(),Kepler.Engine.Core.EControlTypes.BUTTON,true,0,-1,'','',-1,-1));$2+=10;$0.add(new Kepler.Engine.Core.REPOSITORY_INFO($1++,new Kepler.Engine.Core.CONTROL_ID($8,$2),$7.get_downArrowBtn().get_id(),Kepler.Engine.Core.EControlTypes.BUTTON,true,0,-1,'','',-1,-1));$6--;}var $enum3=ss.IEnumerator.getEnumerator(this.$4_7.get_dynamicElementList());while($enum3.moveNext()){var $9=$enum3.current;if($9.get_slideNo()===$3&&!$9.get_isAddedInRepository()){$2+=10;$0.add(new Kepler.Engine.Core.REPOSITORY_INFO($1++,new Kepler.Engine.Core.CONTROL_ID($3,$2),this.$4_9[$4].get_id(),Kepler.Engine.Core.EControlTypes.statiC_TEXT,true,0,0,'','',-1,-1));$4++;$9.set_isAddedInRepository(true);}}}this.$4_7.initializeRepository($0);},$4_15:function(){for(var $0=0;$0<this.$4_8.length;$0++){var $1=this.$4_8[$0];this.remove($1);}this.$4_8.clear();},$4_16:function($p0){var $0=parseInt($p0[$p0.length-1])-1;var $1=this.$4_8[this.$4_A];$1.resetAllItems();if(!!$p0.length&&!isNaN(parseInt($p0[0]))){var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $2=$enum1.current;var $3=parseInt($2)-1;if($3<$1.get_selectionItemsList().length){if(this._zindexOnView.length>0){for(var $4=0;$4<this._zindexOnView.length;$4++){if(this._zindexOnView[$4]===$3){($1.get_selectionItemsList()[$4]).setSelectedContainer();break;}}}else{($1.get_selectionItemsList()[$3]).setSelectedContainer();}}}}},$4_17:function($p0,$p1){if(ss.isValue($p0)){this.$4_11($p0);this.changeStateOfObjectPosition();}return null;},changeButtonStateBasedOnSelctionChange:function(oContainer,bIsSendMsgToView,bIsSlicer){if(bIsSendMsgToView){var $0=Kepler.Framework.Accessibility.AccessibilitySupport.get_instance().get_isAccessibilityOn();Kepler.Framework.Accessibility.AccessibilitySupport.get_instance().set_isAccessibilityOn(false);var $1={};$1['db_selected_shapes_index']=this.$4_1A();if((bIsSlicer&&oContainer.get_selIndexList().length<2)||!bIsSlicer){Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().getAppView().sendMessage(Kepler.Engine.Messages.msG_SELECTION_PANE_SELECTION_INDEX_CHANGE,bIsSlicer,$1);}Kepler.Framework.Accessibility.AccessibilitySupport.get_instance().set_isAccessibilityOn($0);}},$4_18:function(){var $0=this.$4_8[this.$4_A];if(!ss.isNullOrUndefined($0)){$0.resetAllItems();$0.get_selIndexList().clear();$0._iHighlightedIdx=-1;}},$4_19:function($p0){this._zindexOnView.add($p0);},$4_1A:function(){var $0='';var $1=(this.$4_8[this.$4_A]).get_selIndexList();var $2=0;var $enum1=ss.IEnumerator.getEnumerator($1);while($enum1.moveNext()){var $3=$enum1.current;if(Type.canCast((this.$4_8[this.$4_A]).get_controls()[$3],Kepler.CommonDB028.Controls.ItemContainer)){$0+=((this.$4_8[this.$4_A]).get_controls()[$3]).iRelatedShapeIndex;if($2!==$1.length-1){$0+=Kepler.Framework.Core.Seperators.miD_DOT;}}$2++;}return $0;},createScrollableContainers:function(iSlidesCount,lstItemperSlides){this.get_scrollableDiv().get_elementStyle().paddingTop='2px';var $enum1=ss.IEnumerator.getEnumerator(this.get_scrollableDiv().get_controls());while($enum1.moveNext()){var $5=$enum1.current;if(Type.canCast($5,Kepler.CommonDB028.Controls.CustomScrollableContainer)){this.get_scrollableDiv().remove($5);}}var $0;var $1=Kepler.CommonDB028.CommonDB028App.get_commonDB028().get_appName();var $2=10000;var $3;var $4;for(var $6=0;$6<iSlidesCount;$6++){var $7=[];$3=(++$2).toString()+$1;this.$4_6=new Kepler.CommonDB028.Controls.CustomScrollableContainer('div');this.$4_6.set_position(new Kepler.Framework.UI.Point(0,30));this.$4_6.set_size(new Kepler.Framework.UI.Size(236,484));this.$4_6.set_id($2);this.$4_6.get_element().id=$3;this.$4_6.get_elementStyle().position='absolute';this.$4_6.set_scrollBarWidth(15);this.$4_6.set_scrollBarSingleStep(12);this.$4_6.get_elementStyle().marginLeft='20px';this.$4_6.set_scrollbarMode(Kepler.Engine.UI.Controls.EScrollbarMode.AUTO);this.$4_6.updateScrollbar();var $8=lstItemperSlides[$6].split(Kepler.Framework.Core.Seperators.spikeD_CIRCLE);var $9=null;if(!ss.isNullOrUndefined($8[1])){$9=$8[1].split(Kepler.Framework.Core.Seperators.v_CROSS);}for(var $A=0;$A<parseInt($8[0]);$A++){$4=$2.toString()+($A+1).toString();$0=new Kepler.CommonDB028.Controls.ItemContainer(new Kepler.Framework.UI.Size(215,22),$A,'Shape',$4+(1).toString()+$1,$4+(2).toString()+$1);if(!ss.isNullOrUndefined($9)&&$9.contains($A.toString())){$0.addCssClass('commondb028_child_shape');}$7.add($0);}this.$4_6.addControls($7);this.$4_8.add(this.$4_6);this.add(this.$4_6);this.$4_6.show(false);}this.$4_8[this.$4_A].show(true);this.$4_1B();},$4_1B:function(){var $enum1=ss.IEnumerator.getEnumerator(this.$4_7.get_dynamicElementList());while($enum1.moveNext()){var $0=$enum1.current;this.$4_1C($0);}},$4_1C:function($p0){var $0=(this.$4_8[$p0.get_slideNo()-1]);var $1=new Kepler.Engine.UI.Controls.Label('',null,'commondb028_preview_mode_trgger_label',null,'10001'+$p0.get_slideNo().toString()+$p0.get_startIndex().toString());$0.insert($p0.get_startIndex(),$1,$0.get_scrollAreaElement());this.$4_9.add($1);},onPretranslateEvent:function(sender,eventArgs){if(eventArgs.get_type()===Kepler.Framework.UI.Events.EventArgsNs.EventType.keyDown){var $0=eventArgs;if(this.$4_7.get_simMode()===ESIM_MODE.modE_ASSESSMENT){if($0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.returnKey){}else if($0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.escape){return false;}if($0.get_altKey()&&$0.get_key()!==Kepler.Framework.UI.Events.EventArgsNs.Keys.menu){var $1=this.$4_7.sendMessage(Kepler.Engine.Core.DialogApp.msG_HANDLE_ALT_KEY_NAVIGATION,$0,this);if($1){$0.set_defaultPrevented(true);}return $1;}}}return Kepler.CommonDB028.SelectionClient.callBaseMethod(this, 'onPretranslateEvent',[sender,eventArgs]);},getCancelButtonCtrlId:function(){var $0=this.$4_7.get_overrideRepository();for(var $1=0;$1<$0.length;$1++){var $2=$0[$1];if($2._iCommandId===this.$4_0.get_id()){return $2._scControlId;}}return null;},isExitButtonClicked:function(iCommandId){Kepler.CommonDB028.SelectionClient.callBaseMethod(this, 'isExitButtonClicked',[iCommandId]);if(iCommandId===this.$4_4.get_id()||iCommandId===this.$4_5.get_id()){this._zindexOnView.clear();}if(iCommandId===this.$4_0.get_id()||iCommandId===this.$4_4.get_id()||iCommandId===this.$4_5.get_id()||iCommandId===this.$4_3.get_id()||iCommandId===this.$4_2.get_id()){return true;}else if(this.$4_F){this.$4_F=false;return true;}else{var $enum1=ss.IEnumerator.getEnumerator(this.$4_8);while($enum1.moveNext()){var $0=$enum1.current;var $enum2=ss.IEnumerator.getEnumerator($0.get_selectionItemsList());while($enum2.moveNext()){var $1=$enum2.current;if(iCommandId===$1.get_id()||iCommandId===$1.get_downArrowBtn().get_id()){return true;}}}}return false;},$4_1D:function($p0){if(this.$4_8[this.$4_A]!=null){(this.$4_8[this.$4_A]).onKeyReceived($p0);}},$4_1E:function($p0,$p1){var $0=false;try{this.$4_7.set_WIP(true);var $1=$p0.get_notificationMsg();var $2=$p0.get_data();switch($1){case Kepler.Framework.UI.Controls.NotificationCode.buttoN_CLICK:var $3=$p1;if(Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().get_appName()==='word'){if($p1===this.$4_4){if(Kepler.Engine.Core.EngineApp.get_engine().getCurrentAppFrame().get_ribbonManager().fireLButtonUpActionForRibbonId(520503)){return true;}}else if($p1===this.$4_5){if(Kepler.Engine.Core.EngineApp.get_engine().getCurrentAppFrame().get_ribbonManager().fireLButtonUpActionForRibbonId(520504)){return true;}}}if(this.isExitButtonClicked($p1.get_id())){this.$4_7.handleUserEvent($p1.get_id(),Kepler.Framework.UI.Controls.NotificationCode.buttoN_CLICK);}break;case Kepler.Framework.UI.Controls.NotificationCode.buttoN_DBLCLICK:this.$4_7.handleUserEvent($p1.get_id(),Kepler.Framework.UI.Controls.NotificationCode.buttoN_DBLCLICK);break;case Kepler.Framework.UI.Controls.NotificationCode.dialoG_CLOSE:if(this.$4_7.get_simMode()===ESIM_MODE.modE_ASSESSMENT){Kepler.CommonDB028.CommonDB028App.get_commonDB028().set_isTaskPane(false);this.$4_7.handleUserEvent(1002,Kepler.Framework.UI.Controls.NotificationCode.buttoN_CLICK);$0=true;}break;case Kepler.Framework.UI.Controls.NotificationCode.selectioN_CHANGED:$0=true;break;}}finally{this.$4_7.set_WIP(false);}return $0;},$4_1F:function(){var $0=document.getElementsByTagName('head')[0];this.$4_C=document.createElement('style');if(ss.isValue($0)){$0.appendChild(this.$4_C);}},dispose:function(){Kepler.CommonDB028.SelectionClient.callBaseMethod(this, 'dispose');this.$4_7=null;},add:function(control,oParentElement){if(ss.isValue(oParentElement)&&oParentElement===this.get_element()){return Kepler.CommonDB028.SelectionClient.callBaseMethod(this, 'add',[control,oParentElement]);}else if(ss.isValue(oParentElement)&&oParentElement!==this.get_element()){return this.get_scrollableDiv().add(control,oParentElement);}else{return Kepler.CommonDB028.SelectionClient.callBaseMethod(this, 'add',[control]);}},setTabFocusToContainerControl:function(oCtrl,keyEvent){if(Type.canCast(oCtrl,Kepler.CommonDB028.Controls.CustomScrollableContainer)&&keyEvent.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.tab){this.$4_6._iHighlightedIdx=-1;}Kepler.CommonDB028.SelectionClient.callBaseMethod(this, 'setTabFocusToContainerControl',[oCtrl,keyEvent]);},$4_20:function($p0,$p1){if(this.$4_7.get_WIP()||this.$4_7.get_parseWIP()){return true;}var $0=$p1;var $1=$p0;if(ss.isValue(this.$4_7)&&this.$4_7.get_simMode()===ESIM_MODE.modE_TUTORIAL){this.$4_7.handleUserEvent($0.get_id(),$1.get_notificationMsg());return true;}if(ss.isNullOrUndefined($1)){return false;}var $2=false;$2=this.$4_1E($1,$0);return $2;}}
Kepler.CommonDB028.Constants=function(){}
Kepler.CommonDB028.DynamicElementData=function(){}
Kepler.CommonDB028.DynamicElementData.prototype={$0:0,get_slideNo:function(){return this.$0;},set_slideNo:function(value){this.$0=value;return value;},$1:0,get_startIndex:function(){return this.$1;},set_startIndex:function(value){this.$1=value;return value;},$2:false,get_isAddedInRepository:function(){return this.$2;},set_isAddedInRepository:function(value){this.$2=value;return value;}}
Kepler.CommonDB028.CommonDB028App=function(){Kepler.CommonDB028.CommonDB028App.initializeBase(this,['CommonDB028',false]);this.precacheImages();}
Kepler.CommonDB028.CommonDB028App.get_commonDB028=function(){return Kepler.CommonDB028.CommonDB028App.$4_0;}
Kepler.CommonDB028.CommonDB028App.prototype={createDialog:function(){var $0=new Kepler.CommonDB028.SelectionDialog('CommonDB028','Selection',Kepler.CommonDB028.SelectionClient,Kepler.Engine.UI.DialogFrameType.paneDialog);$0.set_size(new Kepler.Framework.UI.Size(260,578));var $1=new Kepler.Framework.UI.Alignment(Kepler.Framework.UI.HorzAlignment.right,Kepler.Framework.UI.VertAlignment.top);($0).setPositionRespectToMainView($1,25,25);return $0;},dispose:function(){Kepler.CommonDB028.CommonDB028App.$4_0=null;Kepler.CommonDB028.CommonDB028App.callBaseMethod(this, 'dispose');},getDefaultCSS:function(){var $0=[];$0.add(this.get_cssPath()+this.get_appName().toLowerCase()+'.min.css');return $0;}}
Kepler.CommonDB028.SelectionDialog=function(strId,strDialogName,oTypeDialogClient,oDialodFrameType){Kepler.CommonDB028.SelectionDialog.initializeBase(this,[strId,strDialogName,oTypeDialogClient,true,oDialodFrameType]);this.$7_4=[];this.$7_0=this.get_client();this.$7_2=[];this.set_systemMenuNum(10151);}
Kepler.CommonDB028.SelectionDialog.prototype={$7_0:null,$7_1:0,$7_2:null,$7_3:false,$7_4:null,get_dynamicElementList:function(){return this.$7_4;},$7_5:true,bIsSlicer:false,$7_6:function($p0,$p1){var $0=true;this.$7_3=true;var $1=($p0.get_parent());var $2;if($1.get_selIndexList().length!==$1.get_dragActionAllowedNodes().length){$0=false;}else{var $enum1=ss.IEnumerator.getEnumerator($1.get_selIndexList());while($enum1.moveNext()){var $3=$enum1.current;$2=$1.get_selectionItemsList()[$3];if(!$1.get_dragActionAllowedNodes().contains($2.get_index())){$0=false;break;}}}if($0){$0=($1.get_dropIndex()===$p1);}return $0;},isCorrectSelectionAction:function(oClickedButtonID){var $0=false;if(oClickedButtonID.iPageNo!==Kepler.Framework.Core.Globals.invaliD_VALUE){for(var $1=0;$1<this._scUserActions.iPivotCount;$1++){var $2=0;if(this._scUserActions.scPivotInfo[$1].equals(oClickedButtonID)){var $3=true;for(var $4=0;$4<this._scUserActions.iConditionCount[$1];$4++){var $5=this._scUserActions.getConditionInfo($1,$4);var $6=this.checkCorrectActionForControl($5);var $7=this.getCommandIdFromPageAndSeqNo($5.scControlId.iPageNo,$5.scControlId.iSequenceNo);var $8=this.getControlFromCommandId($7);if($6){$2++;}$3=($3&$6)===1;}$0=$3;}}}return $0;},checkCorrectActionForControl:function(oConditionInfo){var $0=this.getCommandIdFromPageAndSeqNo(oConditionInfo.scControlId.iPageNo,oConditionInfo.scControlId.iSequenceNo);var $1=this.getControlFromCommandId($0);if((Kepler.CommonDB028.Controls.ItemContainer).isInstanceOfType($1)){var $2=($1).get_isSelected();if((!!$2&&!oConditionInfo.iIndexVal)){if(($1.get_parent()).get_dropIndex()!==-2&&!this.$7_3){var $3=oConditionInfo.sContents.split(Kepler.Framework.Core.Seperators.doublE_CROSS);var $4=(parseInt($3[0])===1)?true:false;return ($4&&this.$7_6($1,parseInt($3[1])));}else{return true;}}else{return false;}}else{return Kepler.CommonDB028.SelectionDialog.callBaseMethod(this, 'checkCorrectActionForControl',[oConditionInfo]);}},initControls:function(){var $enum1=ss.IEnumerator.getEnumerator(this.$7_0.get_customContainersList());while($enum1.moveNext()){var $0=$enum1.current;$0.removeMarkerNode();$0.set_dragActionAllowedNodes([]);$0.set_dropIndex(-1);$0.set_menuActionNodes([]);}this.$7_3=false;this.$7_4.clear();this.$7_0.$4_B();this.$7_B();Kepler.CommonDB028.SelectionDialog.callBaseMethod(this, 'initControls');this.$7_B();},onLoad:function(){this.attachMessage(Kepler.Engine.Messages.msG_NOTIFY_DLG_SELECTION_CHANGE,ss.Delegate.create(this,this.$7_9));this.attachMessage('ribbon_item_update',ss.Delegate.create(this,this.$7_8));this.attachMessage('update_shape_data_for_framejump',ss.Delegate.create(this,this.$7_7));Kepler.CommonDB028.SelectionDialog.callBaseMethod(this, 'onLoad');},$7_7:function($p0,$p1){this.$7_C($p1);this.parseOverrideData($p1);this.initControls();return null;},$7_8:function($p0,$p1){var $0=$p0;var $1=$p1;if($0===520505&&!$1){this.handleUserEvent(1002,Kepler.Framework.UI.Controls.NotificationCode.dialoG_CLOSE);}return null;},$7_9:function($p0,$p1){this.$7_B();return null;},confirmOverrideStateForControl:function(iSerialIndex){var $0=this.g_OverrideStateRepository[iSerialIndex];var $1=$0._iControlType;var $2=this.getControlFromCommandId($0._iCommandId);if((Kepler.CommonDB028.Controls.ItemContainer).isInstanceOfType($2)){var $3=($2).get_isSelected();if((!!$3&&!this.g_OverrideStateRepository[iSerialIndex]._iSelIndex)||(!$3&&this.g_OverrideStateRepository[iSerialIndex]._iSelIndex===-1)){return true;}else{return false;}}else{return Kepler.CommonDB028.SelectionDialog.callBaseMethod(this, 'confirmOverrideStateForControl',[iSerialIndex]);}},getControlFromCommandId:function(iCommandId){return this.$7_A(iCommandId,this.get_controls());},$7_A:function($p0,$p1){var $0=null;for(var $1=0;$1<$p1.length;$1++){if($p1[$1].get_id()===$p0){$0=$p1[$1];break;}else if(Type.canCast($p1[$1],Kepler.Engine.UI.Controls.ContainerControl)){$0=this.$7_A($p0,($p1[$1]).get_controls());if(ss.isValue($0)){break;}}}return $0;},show:function(bShow){Kepler.CommonDB028.SelectionDialog.callBaseMethod(this, 'show',[bShow]);if(bShow){this.$7_5=true;Kepler.CommonDB028.CommonDB028App.get_commonDB028().set_isTaskPane(true);Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().getAppFrame().sendMessage(Kepler.Engine.Messages.msG_SUBSCRIBE_DLG_DYNAMIC_UPDATES,'commondb028',this);var $enum1=ss.IEnumerator.getEnumerator((this.get_client()).get_customContainersList());while($enum1.moveNext()){var $0=$enum1.current;$0.updateScrollbar();}}else{Kepler.CommonDB028.CommonDB028App.get_commonDB028().set_isTaskPane(false);Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().getAppFrame().sendMessage(Kepler.Engine.Messages.msG_UNSUBSCRIBE_DLG_DYNAMIC_UPDATES,'commondb028',this);if(this.get_dummyFrame()){Kepler.Engine.Core.EngineApp.get_engine().getCurrentAppView().setFocus();}}Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().getAppView().sendMessage(Kepler.Engine.Messages.msG_SET_ANIMATION_PANE_VISIBILITY,null,bShow);},$7_B:function(){var $0={};Kepler.Engine.Core.EngineApp.get_engine().get_currentApp().getAppFrame().sendMessage(Kepler.Engine.Messages.msG_QUERY_VIEW_DYNAMIC_UPDATES,'commondb028',$0);if(Object.getKeyCount($0)>0&&!!this.$7_0.get_customContainersList().length){if(Object.keyExists($0,'active_view_index')){var $1=parseInt($0['active_view_index'],10);if(!isNaN($1)&&$1>0){this.$7_0.$4_11($1-1);}}if(Object.keyExists($0,'view_selected_shapes_index')&&!!$0['view_selected_shapes_index']){var $2=$0['view_selected_shapes_index'].split(Kepler.Framework.Core.Seperators.miD_DOT);this.$7_0.$4_10($2);}else if(Object.keyExists($0,'view_selected_slicer_index')&&!!$0['view_selected_slicer_index']){var $3=$0['view_selected_slicer_index'].split(Kepler.Framework.Core.Seperators.miD_DOT);this.$7_0.$4_10($3);}else{var $4=''.split(Kepler.Framework.Core.Seperators.miD_DOT);this.$7_0.$4_10($4);}}},parseFrameTags:function(){if(ss.isNullOrUndefined(this.$7_0)){return;}this.get_frame().setTitle(this.get_frame().get_titleElement().innerText);this.$7_C(this._mapFrameData);Kepler.CommonDB028.SelectionDialog.callBaseMethod(this, 'parseFrameTags');},$7_C:function($p0){if(!!this.$7_0.get_customContainersList().length){this.$7_0.$4_15();this.$7_2.clear();}if(!ss.isValue($p0['db_slidesdata'])||this.get_dummyFrame()){Kepler.Engine.Core.EngineApp.get_engine().getCurrentAppView().sendMessage(Kepler.Engine.Messages.msG_FILL_SHAPE_DATA_FOR_SELECTION_PANE,$p0,null);}this.$7_E($p0);if(ss.isValue($p0['db_slidesdata'])&&!this.$7_0.get_customContainersList().length){var $0=$p0['db_slidesdata'].split(Kepler.Framework.Core.Seperators.PIPE);this.$7_1=parseInt($0[0]);if(this.$7_1>0){var $1=$0[1].split(Kepler.Framework.Core.Seperators.miD_DOT);var $enum1=ss.IEnumerator.getEnumerator($1);while($enum1.moveNext()){var $2=$enum1.current;this.$7_2.add($2);}this.$7_0.createScrollableContainers(this.$7_1,this.$7_2);}}if(ss.isValue($p0['hide_selection_pane'])&&$p0['hide_selection_pane']==='1'){this.show(false);}if(ss.isValue(this._mapFrameData['db_slicerdata'])){var $3=parseInt(this._mapFrameData['db_slicerdata'].split(Kepler.Framework.Core.Seperators.PIPE)[0]);var $4=this._mapFrameData['db_slicerdata'].split(Kepler.Framework.Core.Seperators.PIPE)[1];this.$7_0.addControlsToRepository($3,$4);}else{this.$7_0.addControlsToRepository();}},setControlToState:function(oStateInfo){var $0=this.getControlFromCommandId(oStateInfo._iCommandId);if(ss.isNullOrUndefined($0)){return;}var $1;$1=$0.get_enable();if($1!==oStateInfo._bIsEnabled){$0.set_enable(oStateInfo._bIsEnabled);}switch(oStateInfo._iControlType){case Kepler.Engine.Core.EControlTypes.BUTTON:var $2=oStateInfo._sContents;if((Kepler.CommonDB028.Controls.ItemContainer).isInstanceOfType($0)&&!!$2){var $3=$2.split(Kepler.Framework.Core.Seperators.doublE_CROSS);var $4=oStateInfo._iSelIndex;var $5=$0.get_parent();this.$7_D($0,$3);if(!$4){($0).setSelectedContainer();}else if($4===-1){($0).setDeselectedContainer();}this.$7_0.changeButtonStateBasedOnSelctionChange($5,false);}else{Kepler.CommonDB028.SelectionDialog.callBaseMethod(this, 'setControlToState',[oStateInfo]);}break;default:Kepler.CommonDB028.SelectionDialog.callBaseMethod(this, 'setControlToState',[oStateInfo]);break;}},$7_D:function($p0,$p1){var $0=(parseInt($p1[2])===1)?true:false;$p0.setSelectionText($p1[0]);this.$7_0.$4_19(parseInt($p1[1]));$p0.iRelatedShapeIndex=parseInt($p1[1]);if($0){($p0.get_parent()).get_dragActionAllowedNodes().add($p0.get_index());}},$7_E:function($p0){var $0=[];var $1=0;if(($1=Kepler.Engine.UI.KeplerDialog.getCount('db_dynamicelementdata',$p0,$0))>0){var $2=$0[0];var $3=$2.length;for(var $4=0;$4<$3;$4++){var $5=new Kepler.CommonDB028.DynamicElementData();var $6=$2[$4];var $7=$6.split(Kepler.Framework.Core.Seperators.miD_DOT);$5.set_slideNo(parseInt($7[0]));this.$7_4.add($5);}}},onMsgPhaseChanging:function(wParam,lParam){(this.get_client()).$4_18();Kepler.CommonDB028.CommonDB028App.get_commonDB028().set_isTaskPane(false);return Kepler.CommonDB028.SelectionDialog.callBaseMethod(this, 'onMsgPhaseChanging',[wParam,lParam]);},onMsgSetFocus:function(wParam,lParam){if(this.get_isActive()&&!String.isNullOrEmpty(this.get_name())&&this.$7_5){var $0=this.get_name()+'  pane. ';$0+='Use Ctrl + Space to open Task pane Options menu which can be used to close the pane. Use Tab key to move focus on the desired shape. Press Spacebar to select it.';Kepler.Framework.Accessibility.AccessibilitySupport.get_instance().set_dontSkipText($0);this.$7_5=false;}this.set_focusWIP(true);this.setCorrectFocus();this.set_focusWIP(false);if(this.get_dummyFrame()){this._scFocusInfo.scControlId.iPageNo=-1;this._scFocusInfo.scControlId.iSequenceNo=0;this._scFocusInfo.iStartIdx=0;this._scFocusInfo.iEndIdx=0;}return null;},onMsgSetFocusOnF6Navigation:function(lParam,wParam){var $0=Kepler.Framework.Accessibility.AccessibilitySupport.get_instance().get_isAccessibilityOn();Kepler.Framework.Accessibility.AccessibilitySupport.get_instance().set_isAccessibilityOn(false);if(this.get_isActive()&&!String.isNullOrEmpty(this.get_name())&&this.$7_5){var $2=this.get_name()+'  pane. ';$2+='Use Ctrl + Space to open Task pane Options menu which can be used to close the pane. Use Tab key to move focus on the desired shape. Press Spacebar to select it.';Kepler.Framework.Accessibility.AccessibilitySupport.get_instance().set_dontSkipText($2);this.$7_5=false;}this.set_focusWIP(true);var $1=(this.get_client());$1.get_customContainersList()[$1.get_slideSelectedIndex()].setFocus();this.set_focusWIP(false);Kepler.Framework.Accessibility.AccessibilitySupport.get_instance().set_isAccessibilityOn($0);return true;},onPretranslateEvent:function(sender,eventArgs){if(this._iSimMode!==ESIM_MODE.modE_TUTORIAL&&Type.canCast(eventArgs,Kepler.Framework.UI.Events.EventArgsNs.KeyEventArgs)){(this.get_client()).$4_1D((eventArgs).get_key());}return Kepler.CommonDB028.SelectionDialog.callBaseMethod(this, 'onPretranslateEvent',[sender,eventArgs]);},setPosToCenterOfMainView:function(){Kepler.CommonDB028.SelectionDialog.callBaseMethod(this, 'setPosToCenterOfMainView');this.setPositionRespectToMainView(new Kepler.Framework.UI.Alignment(Kepler.Framework.UI.HorzAlignment.right,Kepler.Framework.UI.VertAlignment.middle),20,0);},setPosToCenterOfDesktopExcludePlayer:function(){Kepler.CommonDB028.SelectionDialog.callBaseMethod(this, 'setPosToCenterOfDesktopExcludePlayer');this.setPositionRespectToDesktopExcludingPlayer(new Kepler.Framework.UI.Alignment(Kepler.Framework.UI.HorzAlignment.right,Kepler.Framework.UI.VertAlignment.middle),20,0);},addDlgDontSkipText:function(){if((this.get_isActive()||this.get_dialogFrameType()===Kepler.Engine.UI.DialogFrameType.paneDialog)&&!String.isNullOrEmpty(this.get_name())){var $0=this.get_name()+'  pane. ';$0+='Use Ctrl + Space to open Task pane Options menu which can be used to close the pane. Use Tab key to move focus on the desired shape. Press Spacebar to select it.';Kepler.Framework.Accessibility.AccessibilitySupport.get_instance().set_dontSkipText($0);}},getInCorrectPlaybackCtrlId:function(oExitButtonId,bAnyActionMatched){return oExitButtonId;}}
Kepler.CommonDB028.Controls.ItemContainer.registerClass('Kepler.CommonDB028.Controls.ItemContainer',Kepler.Engine.UI.Controls.ContainerControl);Kepler.CommonDB028.Controls.CustomCssImageButton.registerClass('Kepler.CommonDB028.Controls.CustomCssImageButton',Kepler.Engine.UI.Controls.CssImageButton);Kepler.CommonDB028.Controls.CustomCssImageTextButton.registerClass('Kepler.CommonDB028.Controls.CustomCssImageTextButton',Kepler.Engine.UI.Controls.CssImageTextButton);Kepler.CommonDB028.Controls.CustomScrollableContainer.registerClass('Kepler.CommonDB028.Controls.CustomScrollableContainer',Kepler.Engine.UI.Controls.ScrollableContainer);Kepler.CommonDB028.Controls.CustomSplitButton.registerClass('Kepler.CommonDB028.Controls.CustomSplitButton',Kepler.Engine.UI.Controls.SplitButton);Kepler.CommonDB028.Controls.CustomButton.registerClass('Kepler.CommonDB028.Controls.CustomButton',Kepler.Engine.UI.Controls.Button);Kepler.CommonDB028.SelectionClient.registerClass('Kepler.CommonDB028.SelectionClient',Kepler.Engine.UI.DialogClient);Kepler.CommonDB028.Constants.registerClass('Kepler.CommonDB028.Constants');Kepler.CommonDB028.DynamicElementData.registerClass('Kepler.CommonDB028.DynamicElementData');Kepler.CommonDB028.CommonDB028App.registerClass('Kepler.CommonDB028.CommonDB028App',Kepler.Engine.Core.DialogApp);Kepler.CommonDB028.SelectionDialog.registerClass('Kepler.CommonDB028.SelectionDialog',Kepler.Engine.UI.KeplerDialog);Kepler.CommonDB028.Controls.ItemContainer.iD_MNU_DOWN_ARROW_BTN=614;Kepler.CommonDB028.Controls.ItemContainer.csS_CLASS=' animation_item_container';Kepler.CommonDB028.Controls.ItemContainer.oN_MSG_HOVER='on_msg_hover';Kepler.CommonDB028.Controls.ItemContainer.msG_PLACE_DROP_MARKER='msg_place_drop_marker';Kepler.CommonDB028.Controls.ItemContainer.msG_ANIMATION_ITEM_KEY_DOWN='msg_item_key_down';Kepler.CommonDB028.Controls.CustomScrollableContainer.msG_CUSTOM_SCROLLABLE_SET_FOCUS='msg_custom_scrollble_set_focus';Kepler.CommonDB028.Controls.CustomScrollableContainer.msG_CHILD_SELECTION_CHANGE='msg_child_selection_change';Kepler.CommonDB028.Constants.idC_BUTTON_CANCEL=1002;Kepler.CommonDB028.Constants.idC_BUTTON_SHOW_All=1011;Kepler.CommonDB028.Constants.idC_BUTTON_HIDE_ALL=1012;Kepler.CommonDB028.Constants.idC_BUTTON_MOVE_EARLIER=1013;Kepler.CommonDB028.Constants.idC_BUTTON_MOVE_LATER=1014;Kepler.CommonDB028.Constants.idC_CONTAINER_SCROLLABLE=1020;Kepler.CommonDB028.Constants.idC_HIDE_BUTTON_ELEMENT=1021;Kepler.CommonDB028.CommonDB028App.$4_0=null;(function(){window.setTimeout(function(){
Kepler.CommonDB028.CommonDB028App.$4_0=new Kepler.CommonDB028.CommonDB028App();Kepler.CommonDB028.CommonDB028App.$4_0.init();},1);})();
Kepler.CommonDB028.SelectionDialog.h_MARGIN=20;})();// This script was generated using Script# v0.7.4.0
