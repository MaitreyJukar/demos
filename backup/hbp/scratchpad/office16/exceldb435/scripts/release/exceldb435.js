// exceldb435.js
(function(){
Type.registerNamespace('Kepler.ExcelDB435');Kepler.ExcelDB435.Constants=function(){}
Kepler.ExcelDB435.PasteNameClient=function(){this._arrNameRanges=[];Kepler.ExcelDB435.PasteNameClient.initializeBase(this);var $0='';this.$4_1=new Kepler.Engine.UI.Controls.Button('OK',new Kepler.Framework.UI.Point(91,143),new Kepler.Framework.UI.Size(74,22),'1001'+$0);this.$4_2=new Kepler.Engine.UI.Controls.Button('Cancel',new Kepler.Framework.UI.Point(175,143),new Kepler.Framework.UI.Size(74,22),'1002'+$0);this.$4_4=new Kepler.Engine.UI.Controls.Label('Paste <u>n</u>ame',new Kepler.Framework.UI.Point(7,9),'',null,'1003'+$0);this.$4_4.get_element().style.position='absolute';this.$4_5=new Kepler.Engine.UI.Controls.ListCtrl(new Kepler.Framework.UI.Point(7,22),new Kepler.Framework.UI.Size(242,107),-1,null,null,null,null,'1004'+$0);this.$4_3=new Kepler.Engine.UI.Controls.Button('Paste <u>L</u>ist',new Kepler.Framework.UI.Point(7,143),new Kepler.Framework.UI.Size(74,22),'1005'+$0);}
Kepler.ExcelDB435.PasteNameClient.prototype={$4_0:null,$4_1:null,$4_2:null,$4_3:null,$4_4:null,$4_5:null,setDialogMode:function(iDBMode){if(iDBMode===2){this.$4_3.show(false);}else{this.$4_3.show(true);}},setDefaultFocus:function(){Kepler.ExcelDB435.PasteNameClient.callBaseMethod(this, 'setDefaultFocus');this.$4_5.setFocus();},onLoad:function(){Kepler.ExcelDB435.PasteNameClient.callBaseMethod(this, 'onLoad');this.$4_0=(this.get_parent());this.$4_6();this.$4_7();this.$4_9();},$4_6:function(){this.add(this.$4_1);this.add(this.$4_2);this.add(this.$4_4);this.add(this.$4_5);this.add(this.$4_3);},$4_7:function(){this.attachMessage(Kepler.Engine.UI.Controls.Control.msG_COMMAND,ss.Delegate.create(this,this.$4_A));this.attachMessage(Kepler.Engine.UI.DialogBase.msG_DIALOG_CLOSE,ss.Delegate.create(this,this.$4_8));},$4_8:function($p0,$p1){return null;},$4_9:function(){var $0=[];$0.add(new Kepler.Engine.Core.REPOSITORY_INFO(0,new Kepler.Engine.Core.CONTROL_ID(0,10),this.$4_1.get_id(),Kepler.Engine.Core.EControlTypes.BUTTON,false,0,0,'','OK',-1,-1));$0.add(new Kepler.Engine.Core.REPOSITORY_INFO(1,new Kepler.Engine.Core.CONTROL_ID(0,20),this.$4_2.get_id(),Kepler.Engine.Core.EControlTypes.BUTTON,true,0,0,'','Cancel',-1,-1));$0.add(new Kepler.Engine.Core.REPOSITORY_INFO(2,new Kepler.Engine.Core.CONTROL_ID(0,30),this.$4_4.get_id(),Kepler.Engine.Core.EControlTypes.statiC_TEXT,true,0,0,'','',-1,-1));$0.add(new Kepler.Engine.Core.REPOSITORY_INFO(3,new Kepler.Engine.Core.CONTROL_ID(0,40),this.$4_5.get_id(),Kepler.Engine.Core.EControlTypes.lisT_BOX,true,0,0,'','Paste name List','N',-1));$0.add(new Kepler.Engine.Core.REPOSITORY_INFO(4,new Kepler.Engine.Core.CONTROL_ID(0,50),this.$4_3.get_id(),Kepler.Engine.Core.EControlTypes.BUTTON,true,0,0,'','Paste List','L',-1));this.$4_0.initializeRepository($0);},getCancelButtonCtrlId:function(){var $0=this.$4_0.get_overrideRepository();for(var $1=0;$1<$0.length;$1++){if($0[$1]._iCommandId===this.$4_2.get_id()){return $0[$1]._scControlId;}}return null;},onPretranslateEvent:function(sender,eventArgs){if(eventArgs.get_type()===Kepler.Framework.UI.Events.EventArgsNs.EventType.keyDown){var $0=eventArgs;if(eventArgs.get_type()===Kepler.Framework.UI.Events.EventArgsNs.EventType.keyDown){var $1=eventArgs;if($0.get_key()===Kepler.Framework.UI.Events.EventArgsNs.Keys.tab){$0.set_defaultPrevented(true);}if((this.$4_0.get_simMode()===ESIM_MODE.modE_ASSESSMENT)){if($1.get_altKey()&&$1.get_key()!==Kepler.Framework.UI.Events.EventArgsNs.Keys.menu){var $2=this.$4_0.sendMessage(Kepler.Engine.Core.DialogApp.msG_HANDLE_ALT_KEY_NAVIGATION,$1,this);if($2){$1.set_defaultPrevented(true);}return $2;}}}}return Kepler.ExcelDB435.PasteNameClient.callBaseMethod(this, 'onPretranslateEvent',[sender,eventArgs]);},isExitButtonClicked:function(iCommandId){Kepler.ExcelDB435.PasteNameClient.callBaseMethod(this, 'isExitButtonClicked',[iCommandId]);if(iCommandId===this.$4_1.get_id()||iCommandId===this.$4_2.get_id()||iCommandId===this.$4_3.get_id()){return true;}else{return false;}},dispose:function(){Kepler.ExcelDB435.PasteNameClient.callBaseMethod(this, 'dispose');this.$4_0=null;},$4_A:function($p0,$p1){if(this.$4_0.get_WIP()||this.$4_0.get_parseWIP()){return true;}var $0=$p0;var $1=$p1;if($1===this.$4_5&&$0.get_notificationMsg()===Kepler.Framework.UI.Controls.NotificationCode.selectioN_CHANGED){this.$4_1.set_enable(true);}if(ss.isValue(this.$4_0)&&this.$4_0.get_simMode()===ESIM_MODE.modE_TUTORIAL){this.$4_0.handleUserEvent($1.get_id(),$0.get_notificationMsg());return true;}if(ss.isNullOrUndefined($0)){return false;}var $2=false;$2=this.$4_B($0,$1);return $2;},$4_B:function($p0,$p1){var $0=false;var $1=$p0.get_notificationMsg();var $2=$p0.get_data();switch($1){case Kepler.Framework.UI.Controls.NotificationCode.buttoN_CLICK:if($p1.get_id()===1001){this.$4_C();}this.$4_0.handleUserEvent($p1.get_id(),Kepler.Framework.UI.Controls.NotificationCode.buttoN_CLICK);$0=true;break;case Kepler.Framework.UI.Controls.NotificationCode.buttoN_DBLCLICK:if($p1===this.$4_5){this.$4_C();$0=true;this.$4_0.handleUserEvent(this.$4_1.get_id(),Kepler.Framework.UI.Controls.NotificationCode.buttoN_CLICK);}break;case Kepler.Framework.UI.Controls.NotificationCode.selectioN_CHANGED:$0=true;break;case Kepler.Framework.UI.Controls.NotificationCode.dialoG_CLOSE:if(!this.$4_0.get_parseWIP()){this.$4_0.handleUserEvent(this.$4_2.get_id(),Kepler.Framework.UI.Controls.NotificationCode.buttoN_CLICK);}$0=true;break;}return $0;},$4_C:function(){var $0=Kepler.Engine.UI.DesktopWnd.get_instance().get_dialogManager().get_visibleDialogs();var $1=false;var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $2=$enum1.current;if(($2).get_dialogAppName().toLowerCase().trim()==='exceldb014'){var $3=this._arrNameRanges[this.$4_5.getSelectedIndex()];($2).postMessage('update_range_name_text',null,$3);}}},getDataFromView:function(){var $0=[];$0.add(new Excel.PASTE_DB_PARAMS());Kepler.Excel.Core.ExcelApp.get_excel().getAppView().sendMessage(Excel.ExcelMessages.msG_DB_FILL_PARAMS,Excel.DIALOG_COMM.pastE_DB_PARAMS,$0);this._arrNameRanges=[];var $enum1=ss.IEnumerator.getEnumerator($0[0]._lstRangeNames);while($enum1.moveNext()){var $1=$enum1.current;this._arrNameRanges.add($1.strRangeName);}Kepler.ExcelDB435.PasteNameClient.callBaseMethod(this, 'getDataFromView');}}
Kepler.ExcelDB435.ExcelDB435App=function(){Kepler.ExcelDB435.ExcelDB435App.initializeBase(this,['ExcelDB435',false]);this.precacheImages();}
Kepler.ExcelDB435.ExcelDB435App.get_excelDB435=function(){return Kepler.ExcelDB435.ExcelDB435App.$4_0;}
Kepler.ExcelDB435.ExcelDB435App.prototype={createDialog:function(){var $0=new Kepler.ExcelDB435.PasteNameDialog('ExcelDB435','Paste Name',Kepler.ExcelDB435.PasteNameClient,Kepler.Engine.UI.DialogFrameType.normalDialog);$0.set_size(new Kepler.Framework.UI.Size(257,202));return $0;},dispose:function(){Kepler.ExcelDB435.ExcelDB435App.$4_0=null;Kepler.ExcelDB435.ExcelDB435App.callBaseMethod(this, 'dispose');}}
Kepler.ExcelDB435.PasteNameDialog=function(strId,strDialogName,oTypeDialogClient,oDialodFrameType){Kepler.ExcelDB435.PasteNameDialog.initializeBase(this,[strId,strDialogName,oTypeDialogClient,false,oDialodFrameType]);}
Kepler.ExcelDB435.PasteNameDialog.prototype={setControlToState:function(oStateInfo){if(oStateInfo._iCommandId===1004){var $0=this.getControlFromCommandId(oStateInfo._iCommandId);$0.resetList();$0.addItemsFromArray((this.get_client())._arrNameRanges);}oStateInfo._iSelIndex=-1;Kepler.ExcelDB435.PasteNameDialog.callBaseMethod(this, 'setControlToState',[oStateInfo]);},parseFrameTags:function(){Kepler.ExcelDB435.PasteNameDialog.callBaseMethod(this, 'parseFrameTags');var $0=parseInt((parseInt(this._mapFrameData['db_mode'])/10).toString());this._iSimMode=parseInt((parseInt(this._mapFrameData['db_mode'])%10).toString());(this.get_client()).setDialogMode($0);}}
Kepler.ExcelDB435.Constants.registerClass('Kepler.ExcelDB435.Constants');Kepler.ExcelDB435.PasteNameClient.registerClass('Kepler.ExcelDB435.PasteNameClient',Kepler.Engine.UI.DialogClient);Kepler.ExcelDB435.ExcelDB435App.registerClass('Kepler.ExcelDB435.ExcelDB435App',Kepler.Engine.Core.DialogApp);Kepler.ExcelDB435.PasteNameDialog.registerClass('Kepler.ExcelDB435.PasteNameDialog',Kepler.Engine.UI.KeplerDialog);Kepler.ExcelDB435.Constants.idC_BUTTON_OK=1001;Kepler.ExcelDB435.Constants.idC_BUTTON_CANCEL=1002;Kepler.ExcelDB435.Constants.idC_LABEL_PASTE_NAME=1003;Kepler.ExcelDB435.Constants.idC_LISTCTRL_PASTE_NAME=1004;Kepler.ExcelDB435.Constants.idC_BUTTON_PASTE_LIST=1005;Kepler.ExcelDB435.ExcelDB435App.$4_0=null;(function(){window.setTimeout(function(){
Kepler.ExcelDB435.ExcelDB435App.$4_0=new Kepler.ExcelDB435.ExcelDB435App();Kepler.ExcelDB435.ExcelDB435App.$4_0.init();},1);})();
})();// This script was generated using Script# v0.7.4.0
