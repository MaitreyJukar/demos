/*
 jCanvas v14.03.14
 Copyright 2014 Caleb Evans
 Released under the MIT license
*/
(function(f,ta,ua,Ta,da,fa,na,v,x,h,p){function J(d){var c;if(P.future.inheritance)for(c in d)d.hasOwnProperty(c)&&(this[c]=d[c]);else $(this,d)}function P(d){var c;if(d)$(aa,d);else for(c in aa)aa.hasOwnProperty(c)&&delete aa[c];na&&na.warn&&!va.jCanvas&&(va.jCanvas=v,na.warn("The jCanvas() method has been deprecated and will be removed in a future release."));return this}function wa(){}function ka(d){return"string"===ba(d)}function L(d){return d&&d.getContext?d.getContext("2d"):h}function la(d){d=
$({},d);d.masks=d.masks.slice(0);return d}function ga(d,c){var a;d.save();a=la(c.transforms);c.savedTransforms.push(a)}function xa(d,c,a,b){a[b]&&(ea(a[b])?c[b]=a[b].call(d,a):c[b]=a[b])}function U(d,c,a){xa(d,c,a,"fillStyle");xa(d,c,a,"strokeStyle");c.lineWidth=a.strokeWidth;a.rounded?c.lineCap=c.lineJoin="round":(c.lineCap=a.strokeCap,c.lineJoin=a.strokeJoin,c.miterLimit=a.miterLimit);c.shadowOffsetX=a.shadowX;c.shadowOffsetY=a.shadowY;c.shadowBlur=a.shadowBlur;c.shadowColor=a.shadowColor;c.globalAlpha=
a.opacity;c.globalCompositeOperation=a.compositing;a.imageSmoothing&&(c.webkitImageSmoothingEnabled=c.mozImageSmoothingEnabled=a.imageSmoothing)}function ya(d,c,a){a.mask&&(a.autosave&&ga(d,c),d.clip(),c.transforms.masks.push(a._args))}function Y(d,c,a){a.closed&&c.closePath();a.shadowStroke&&0!==a.strokeWidth?(c.stroke(),c.fill(),c.shadowColor="transparent",c.shadowBlur=0,c.stroke()):(c.fill(),"transparent"!==a.fillStyle&&(c.shadowColor="transparent"),0!==a.strokeWidth&&c.stroke());a.closed||c.closePath();
a._transformed&&c.restore();a.mask&&(d=E(d),ya(c,d,a))}function za(d,c,a){c._toRad=c.inDegrees?G/180:1;d.translate(c.x,c.y);d.rotate(c.rotate*c._toRad);d.translate(-c.x,-c.y);a&&(a.rotate+=c.rotate*c._toRad)}function Aa(d,c,a){1!==c.scale&&(c.scaleX=c.scaleY=c.scale);d.translate(c.x,c.y);d.scale(c.scaleX,c.scaleY);d.translate(-c.x,-c.y);a&&(a.scaleX*=c.scaleX,a.scaleY*=c.scaleY)}function Ba(d,c,a){c.translate&&(c.translateX=c.translateY=c.translate);d.translate(c.translateX,c.translateY);a&&(a.translateX+=
c.translateX,a.translateY+=c.translateY)}function T(d,c,a,b,g){a._toRad=a.inDegrees?G/180:1;a._transformed=v;c.save();a.fromCenter||a._centered||b===p||(g===p&&(g=b),a.x+=b/2,a.y+=g/2,a._centered=v);a.rotate&&za(c,a,h);1===a.scale&&1===a.scaleX&&1===a.scaleY||Aa(c,a,h);(a.translate||a.translateX||a.translateY)&&Ba(c,a,h)}function E(d){var c=ca.dataCache,a;c._canvas===d&&c._data?a=c._data:(a=f.data(d,"jCanvas"),a||(a={canvas:d,layers:[],layer:{names:{},groups:{}},eventHooks:{},intersecting:[],lastIntersected:h,
cursor:f(d).css("cursor"),drag:{layer:h,dragging:x},event:{type:h,x:h,y:h},events:{},transforms:la(oa),savedTransforms:[],animating:x,animated:h,pixelRatio:1,scaled:x},f.data(d,"jCanvas",a)),c._canvas=d,c._data=a);return a}function Ca(d,c,a){for(var b in P.events)P.events.hasOwnProperty(b)&&(a[b]||a.cursors&&a.cursors[b])&&Da(d,c,a,b)}function Da(d,c,a,b){window.ontouchstart!==p&&Z.touchEvents[b]&&(b=Z.touchEvents[b]);P.events[b](d,c);a._event=v}function Ea(d,c,a){var b,g,e;if(a.draggable||a.cursors){b=
["mousedown","mousemove","mouseup"];for(e=0;e<b.length;e+=1)g=b[e],Da(d,c,a,g);c.events.mouseoutdrag||(d.bind("mouseout.jCanvas",function(){var a=c.drag.layer;a&&(c.drag={},R(d,c,a,"dragcancel"),d.drawLayers())}),c.events.mouseoutdrag=v);a._event=v}}function pa(d,c,a,b){d=c.layer.names;b?b.name!==p&&ka(a.name)&&a.name!==b.name&&delete d[a.name]:b=a;ka(b.name)&&(d[b.name]=a)}function qa(d,c,a,b){d=c.layer.groups;var g,e,k,f;if(!b)b=a;else if(b.groups!==p&&a.groups!==h)for(e=0;e<a.groups.length;e+=
1)if(g=a.groups[e],c=d[g]){for(f=0;f<c.length;f+=1)if(c[f]===a){k=f;c.splice(f,1);break}0===c.length&&delete d[g]}if(b.groups!==p&&b.groups!==h)for(e=0;e<b.groups.length;e+=1)g=b.groups[e],c=d[g],c||(c=d[g]=[],c.name=g),k===p&&(k=c.length),c.splice(k,0,a)}function ra(d,c,a,b,g){b[a]&&c._running&&!c._running[a]&&(c._running[a]=v,b[a].call(d[0],c,g),c._running[a]=x)}function R(d,c,a,b,g){if(!a.disableEvents){if("mouseout"!==b){var e;a.cursors&&(e=a.cursors[b]);-1!==f.inArray(e,X.cursors)&&(e=X.prefix+
e);e&&d.css({cursor:e})}ra(d,a,b,a,g);ra(d,a,b,c.eventHooks,g);ra(d,a,b,P.eventHooks,g)}}function Q(d,c,a,b){var g,e=c._layer?a:c;c._args=a;if(c.draggable||c.dragGroups)c.layer=v,c.draggable=v;c._method=b?b:c.method?f.fn[c.method]:c.type?f.fn[Z.drawings[c.type]]:function(){};c.layer&&!c._layer&&(a=f(d),b=E(d),g=b.layers,e.name===h||ka(e.name)&&b.layer.names[e.name]===p)&&(e=new J(c),e.canvas=d,e.$canvas=f(d),e.layer=v,e._layer=v,e._running={},e.data=e.data!==h?$({},e.data):{},e.groups=e.groups!==
h?e.groups.slice(0):[],pa(a,b,e),qa(a,b,e),Ca(a,b,e),Ea(a,b,e),c._event=e._event,e._method===f.fn.drawText&&a.measureText(e),e.index===h&&(e.index=g.length),g.splice(e.index,0,e),c._args=e,R(a,b,e,"add"));return e}function Fa(d,c){var a,b;for(b=0;b<X.props.length;b+=1)a=X.props[b],d[a]!==p&&(d["_"+a]=d[a],X.propsObj[a]=v,c&&delete d[a])}function Ua(d,c,a){var b,g,e,k;for(b in a)if(a.hasOwnProperty(b)&&(g=a[b],ea(g)&&(a[b]=g.call(d,c,b)),"object"===ba(g))){for(e in g)g.hasOwnProperty(e)&&(k=g[e],c[b]!==
p&&(c[b+"."+e]=c[b][e],a[b+"."+e]=k));delete a[b]}return a}function Ga(d){var c,a,b=[],g=1;d.match(/^([a-z]+|#[0-9a-f]+)$/gi)&&("transparent"===d&&(d="rgba(0,0,0,0)"),a=ta.head,c=a.style.color,a.style.color=d,d=f.css(a,"color"),a.style.color=c);d.match(/^rgb/gi)&&(b=d.match(/(\d+(\.\d+)?)/gi),d.match(/%/gi)&&(g=2.55),b[0]*=g,b[1]*=g,b[2]*=g,b[3]=b[3]!==p?fa(b[3]):1);return b}function Va(d){var c=3,a;"array"!==ba(d.start)&&(d.start=Ga(d.start),d.end=Ga(d.end));d.now=[];if(1!==d.start[3]||1!==d.end[3])c=
4;for(a=0;a<c;a+=1)d.now[a]=d.start[a]+(d.end[a]-d.start[a])*d.pos,3>a&&(d.now[a]=Wa(d.now[a]));1!==d.start[3]||1!==d.end[3]?d.now="rgba("+d.now.join(",")+")":(d.now.slice(0,3),d.now="rgb("+d.now.join(",")+")");d.elem.nodeName?d.elem.style[d.prop]=d.now:d.elem[d.prop]=d.now}function Xa(d){P.events[d]=function(c,a){var b,g;g=a.event;b="mouseover"===d||"mouseout"===d?"mousemove":d;a.events[b]||(c.bind(b+".jCanvas",function(a){g.x=a.offsetX;g.y=a.offsetY;g.type=b;g.event=a;c.drawLayers({resetFire:v});
a.preventDefault()}),a.events[b]=v)}}function V(d,c,a){var b,g,e,k;if(a=a._args)d=E(d),b=d.event,b.x!==h&&b.y!==h&&(e=b.x*d.pixelRatio,k=b.y*d.pixelRatio,g=c.isPointInPath(e,k)||c.isPointInStroke&&c.isPointInStroke(e,k)),c=d.transforms,a.eventX=a.mouseX=b.x,a.eventY=a.mouseY=b.y,a.event=b.event,b=d.transforms.rotate,e=a.eventX,k=a.eventY,0!==b?(a._eventX=e*N(-b)-k*S(-b),a._eventY=k*N(-b)+e*S(-b)):(a._eventX=e,a._eventY=k),a._eventX/=c.scaleX,a._eventY/=c.scaleY,g&&d.intersecting.push(a),a.intersects=
g}function Ha(d){for(;0>d;)d+=2*G;return d}function Ia(d,c,a,b){var g,e,k,f,C,t,h;a===b?h=t=0:(t=a.x,h=a.y);b.inDegrees||360!==b.end||(b.end=2*G);b.start*=a._toRad;b.end*=a._toRad;b.start-=G/2;b.end-=G/2;C=G/180*1;b.ccw&&(C*=-1);g=b.x+b.radius*N(b.start+C);e=b.y+b.radius*S(b.start+C);k=b.x+b.radius*N(b.start);f=b.y+b.radius*S(b.start);ha(d,c,a,b,g,e,k,f);c.arc(b.x+t,b.y+h,b.radius,b.start,b.end,b.ccw);g=b.x+b.radius*N(b.end+C);C=b.y+b.radius*S(b.end+C);e=b.x+b.radius*N(b.end);k=b.y+b.radius*S(b.end);
ia(d,c,a,b,e,k,g,C)}function Ja(d,c,a,b,g,e,k,f){var C,t;b.arrowRadius&&!a.closed&&(t=Ya(f-e,k-g),t-=G,d=a.strokeWidth*N(t),C=a.strokeWidth*S(t),a=k+b.arrowRadius*N(t+b.arrowAngle/2),g=f+b.arrowRadius*S(t+b.arrowAngle/2),e=k+b.arrowRadius*N(t-b.arrowAngle/2),b=f+b.arrowRadius*S(t-b.arrowAngle/2),c.moveTo(a-d,g-C),c.lineTo(k-d,f-C),c.lineTo(e-d,b-C),c.moveTo(k-d,f-C),c.lineTo(k+d,f+C),c.moveTo(k,f))}function ha(d,c,a,b,g,e,k,f){b._arrowAngleConverted||(b.arrowAngle*=a._toRad,b._arrowAngleConverted=
v);b.startArrow&&Ja(d,c,a,b,g,e,k,f)}function ia(d,c,a,b,g,e,k,f){b._arrowAngleConverted||(b.arrowAngle*=a._toRad,b._arrowAngleConverted=v);b.endArrow&&Ja(d,c,a,b,g,e,k,f)}function Ka(d,c,a,b){var g,e,k;g=2;ha(d,c,a,b,b.x2+a.x,b.y2+a.y,b.x1+a.x,b.y1+a.y);for(b.x1!==p&&b.y1!==p&&c.moveTo(b.x1+a.x,b.y1+a.y);v;)if(e=b["x"+g],k=b["y"+g],e!==p&&k!==p)c.lineTo(e+a.x,k+a.y),g+=1;else break;g-=1;ia(d,c,a,b,b["x"+(g-1)]+a.x,b["y"+(g-1)]+a.y,b["x"+g]+a.x,b["y"+g]+a.y)}function La(d,c,a,b){var g,e,k,f,C;g=2;
ha(d,c,a,b,b.cx1+a.x,b.cy1+a.y,b.x1+a.x,b.y1+a.y);for(b.x1!==p&&b.y1!==p&&c.moveTo(b.x1+a.x,b.y1+a.y);v;)if(e=b["x"+g],k=b["y"+g],f=b["cx"+(g-1)],C=b["cy"+(g-1)],e!==p&&k!==p&&f!==p&&C!==p)c.quadraticCurveTo(f+a.x,C+a.y,e+a.x,k+a.y),g+=1;else break;g-=1;ia(d,c,a,b,b["cx"+(g-1)]+a.x,b["cy"+(g-1)]+a.y,b["x"+g]+a.x,b["y"+g]+a.y)}function Ma(d,c,a,b){var g,e,k,f,C,t,h,F;g=2;e=1;ha(d,c,a,b,b.cx1+a.x,b.cy1+a.y,b.x1+a.x,b.y1+a.y);for(b.x1!==p&&b.y1!==p&&c.moveTo(b.x1+a.x,b.y1+a.y);v;)if(k=b["x"+g],f=b["y"+
g],C=b["cx"+e],t=b["cy"+e],h=b["cx"+(e+1)],F=b["cy"+(e+1)],k!==p&&f!==p&&C!==p&&t!==p&&h!==p&&F!==p)c.bezierCurveTo(C+a.x,t+a.y,h+a.x,F+a.y,k+a.x,f+a.y),g+=1,e+=2;else break;g-=1;e-=2;ia(d,c,a,b,b["cx"+(e+1)]+a.x,b["cy"+(e+1)]+a.y,b["x"+g]+a.x,b["y"+g]+a.y)}function Na(d,c,a){c*=d._toRad;c-=G/2;return a*N(c)}function Oa(d,c,a){c*=d._toRad;c-=G/2;return a*S(c)}function Pa(d,c,a,b){var g,e,k,f,h,t,D;a===b?h=f=0:(f=a.x,h=a.y);g=1;e=f=t=b.x+f;k=h=D=b.y+h;ha(d,c,a,b,e+Na(a,b.a1,b.l1),k+Oa(a,b.a1,b.l1),
e,k);for(b.x!==p&&b.y!==p&&c.moveTo(e,k);v;)if(e=b["a"+g],k=b["l"+g],e!==p&&k!==p)f=t,h=D,t+=Na(a,e,k),D+=Oa(a,e,k),c.lineTo(t,D),g+=1;else break;ia(d,c,a,b,f,h,t,D)}function Qa(d,c){isNaN(Number(c.fontSize))||(c.fontSize+="px");d.font=c.fontStyle+" "+c.fontSize+" "+c.fontFamily}function Ra(d,c,a,b){var g,e;g=ca.propCache;if(g.text===a.text&&g.fontStyle===a.fontStyle&&g.fontSize===a.fontSize&&g.fontFamily===a.fontFamily&&g.maxWidth===a.maxWidth&&g.lineHeight===a.lineHeight)a.width=g.width,a.height=
g.height;else{a.width=c.measureText(b[0]).width;for(e=1;e<b.length;e+=1)g=c.measureText(b[e]).width,g>a.width&&(a.width=g);c=d.style.fontSize;d.style.fontSize=a.fontSize;a.height=fa(f.css(d,"fontSize"))*b.length*a.lineHeight;d.style.fontSize=c}}function Sa(d,c){var a=c.maxWidth,b=c.text.split("\n"),g=[],e,k,f,h,t;for(f=0;f<b.length;f+=1){h=b[f];t=h.split(" ");e=[];k="";if(1===t.length||d.measureText(h).width<a)e=[h];else{for(h=0;h<t.length;h+=1)d.measureText(k+t[h]).width>a&&(""!==k&&e.push(k),k=
""),k+=t[h],h!==t.length-1&&(k+=" ");e.push(k)}g=g.concat(e.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n"))}return g}var ma,aa,$=f.extend,ja=f.inArray,ba=f.type,ea=f.isFunction,G=da.PI,Wa=da.round,Za=da.abs,S=da.sin,N=da.cos,Ya=da.atan2,sa=Ta.prototype.slice,$a=f.event.fix,Z={},ca={dataCache:{},propCache:{},imageCache:{}},oa={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},va={jCanvas:x},X={};f.fn.jCanvas=P;P.events={};P.eventHooks={};P.future={inheritance:!1};ma=new function(){$(this,
{align:"center",arrowAngle:90,arrowRadius:0,autosave:v,baseline:"middle",bringToFront:x,ccw:x,closed:x,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:v,crossOrigin:"",cursors:h,disableEvents:x,draggable:x,dragGroups:h,groups:h,data:h,dx:h,dy:h,end:360,eventX:h,eventY:h,fillStyle:"transparent",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:v,height:h,imageSmoothing:v,inDegrees:v,index:h,lineHeight:1,layer:x,mask:x,maxWidth:h,miterLimit:10,name:h,
opacity:1,r1:h,r2:h,radius:0,repeat:"repeat",respectAlign:x,rotate:0,rounded:x,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowStroke:x,shadowX:0,shadowY:0,sHeight:h,sides:0,source:"",letterSpacing:h,spread:0,start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:h,sx:h,sy:h,text:"",translate:0,translateX:0,translateY:0,type:h,visible:v,width:h,x:0,y:0})};wa.prototype=ma;aa=new wa;J.prototype=aa;P.extend=function(d){d.name&&(d.props&&$(ma,
d.props),f.fn[d.name]=function a(b){var g,e,k,f;for(e=0;e<this.length;e+=1)if(g=this[e],k=L(g))f=new J(b),Q(g,f,b,a),U(g,k,f),d.fn.call(g,k,f);return this},d.type&&(Z.drawings[d.type]=d.name));return f.fn[d.name]};f.fn.getEventHooks=function(){var d;d={};0!==this.length&&(d=this[0],d=E(d),d=d.eventHooks);return d};f.fn.setEventHooks=function(d){var c,a;for(c=0;c<this.length;c+=1)f(this[c]),a=E(this[c]),$(a.eventHooks,d);return this};f.fn.getLayers=function(d){var c,a,b,g,e=[];if(0!==this.length)if(c=
this[0],a=E(c),a=a.layers,ea(d))for(g=0;g<a.length;g+=1)b=a[g],d.call(c,b)&&e.push(b);else e=a;return e};f.fn.getLayer=function(d){var c,a,b,g;if(0!==this.length)if(c=this[0],a=E(c),c=a.layers,g=ba(d),d&&d.layer)b=d;else if("number"===g)0>d&&(d=c.length+d),b=c[d];else if("regexp"===g)for(a=0;a<c.length;a+=1){if(ka(c[a].name)&&c[a].name.match(d)){b=c[a];break}}else b=a.layer.names[d];return b};f.fn.getLayerGroup=function(d){var c,a,b,g=ba(d);if(0!==this.length)if(c=this[0],"array"===g)b=d;else if("regexp"===
g)for(a in c=E(c),c=c.layer.groups,c){if(a.match(d)){b=c[a];break}}else c=E(c),b=c.layer.groups[d];return b};f.fn.getLayerIndex=function(d){var c=this.getLayers();d=this.getLayer(d);return ja(d,c)};f.fn.setLayer=function(d,c){var a,b,g,e,k,h,C;for(b=0;b<this.length;b+=1)if(a=f(this[b]),g=E(this[b]),e=f(this[b]).getLayer(d)){pa(a,g,e,c);qa(a,g,e,c);for(k in c)c.hasOwnProperty(k)&&(h=c[k],C=ba(h),"object"===C?e[k]=$({},h):"array"===C?e[k]=h.slice(0):"string"===C?0===h.indexOf("+=")?e[k]+=fa(h.substr(2)):
0===h.indexOf("-=")?e[k]-=fa(h.substr(2)):e[k]=h:e[k]=h);Ca(a,g,e);Ea(a,g,e);f.isEmptyObject(c)===x&&R(a,g,e,"change",c)}return this};f.fn.setLayers=function(d,c){var a,b,g,e;for(b=0;b<this.length;b+=1)for(a=f(this[b]),g=a.getLayers(c),e=0;e<g.length;e+=1)a.setLayer(g[e],d);return this};f.fn.setLayerGroup=function(d,c){var a,b,g,e;for(b=0;b<this.length;b+=1)if(a=f(this[b]),g=a.getLayerGroup(d))for(e=0;e<g.length;e+=1)a.setLayer(g[e],c);return this};f.fn.moveLayer=function(d,c){var a,b,g,e,k;for(b=
0;b<this.length;b+=1)if(a=f(this[b]),g=E(this[b]),e=g.layers,k=a.getLayer(d))k.index=ja(k,e),e.splice(k.index,1),e.splice(c,0,k),0>c&&(c=e.length+c),k.index=c,R(a,g,k,"move");return this};f.fn.removeLayer=function(d){var c,a,b,g,e;for(a=0;a<this.length;a+=1)if(c=f(this[a]),b=E(this[a]),g=c.getLayers(),e=c.getLayer(d))e.index=ja(e,g),g.splice(e.index,1),pa(c,b,e,{name:h}),qa(c,b,e,{groups:h}),R(c,b,e,"remove");return this};f.fn.removeLayers=function(d){var c,a,b,g,e,k;for(a=0;a<this.length;a+=1){c=
f(this[a]);b=E(this[a]);g=c.getLayers(d);for(k=0;k<g.length;k+=1)e=g[k],c.removeLayer(e),k-=1;b.layer.names={};b.layer.groups={}}return this};f.fn.removeLayerGroup=function(d){var c,a,b,g;if(d!==p)for(a=0;a<this.length;a+=1)if(c=f(this[a]),E(this[a]),c.getLayers(),b=c.getLayerGroup(d))for(b=b.slice(0),g=0;g<b.length;g+=1)c.removeLayer(b[g]);return this};f.fn.addLayerToGroup=function(d,c){var a,b,g,e=[c];for(b=0;b<this.length;b+=1)a=f(this[b]),g=a.getLayer(d),g.groups&&(e=g.groups.slice(0),-1===ja(c,
g.groups)&&e.push(c)),a.setLayer(g,{groups:e});return this};f.fn.removeLayerFromGroup=function(d,c){var a,b,g,e=[],k;for(b=0;b<this.length;b+=1)a=f(this[b]),g=a.getLayer(d),g.groups&&(k=ja(c,g.groups),-1!==k&&(e=g.groups.slice(0),e.splice(k,1),a.setLayer(g,{groups:e})));return this};X.cursors=["grab","grabbing","zoom-in","zoom-out"];X.prefix=function(){var d=getComputedStyle(ta.documentElement,"");return"-"+(sa.call(d).join("").match(/-(moz|webkit|ms)-/)||""===d.OLink&&["","o"])[1]+"-"}();f.fn.triggerLayerEvent=
function(d,c){var a,b,g;for(b=0;b<this.length;b+=1)a=f(this[b]),g=E(this[b]),(d=a.getLayer(d))&&R(a,g,d,c);return this};f.fn.drawLayer=function(d){var c,a,b;for(c=0;c<this.length;c+=1)a=f(this[c]),L(this[c]),(b=a.getLayer(d))&&b.visible&&b._method&&(b._next=h,b._method.call(a,b));return this};f.fn.drawLayers=function(d){var c,a,b=$({},d),g,e,k,M,C,t;b.index||(b.index=0);for(c=0;c<this.length;c+=1)if(d=f(this[c]),a=L(this[c])){M=E(this[c]);b.clear!==x&&d.clearCanvas();a=M.layers;for(k=b.index;k<a.length&&
(g=a[k],g.index=k,b.resetFire&&(g._fired=x),C=d,t=g,e=k+1,t&&t.visible&&t._method&&(t._next=e?e:h,t._method.call(C,t)),g._masks=M.transforms.masks.slice(0),g._method!==f.fn.drawImage||!g.visible);k+=1);g=M;var D=e=t=C=void 0;C=h;for(t=g.intersecting.length-1;0<=t;t-=1)if(C=g.intersecting[t],C._masks){for(D=C._masks.length-1;0<=D;D-=1)if(e=C._masks[D],!e.intersects){C.intersects=x;break}if(C.intersects)break}g=C;C=M.event;t=C.type;if(M.drag.layer){e=d;var D=M,F=t,y=void 0,u=void 0,q=void 0,A=q=void 0,
n=void 0,q=y=y=q=void 0,q=D.drag,A=(u=q.layer)&&u.dragGroups||[],y=D.layers;if("mousemove"===F||"touchmove"===F){if(q.dragging||(q.dragging=v,u.dragging=v,u.bringToFront&&(y.splice(u.index,1),u.index=y.push(u)),u._startX=u.x,u._startY=u.y,u._endX=u._eventX,u._endY=u._eventY,R(e,D,u,"dragstart")),q.dragging)for(y=u._eventX-(u._endX-u._startX),q=u._eventY-(u._endY-u._startY),u.dx=y-u.x,u.dy=q-u.y,u.x=y,u.y=q,R(e,D,u,"drag"),y=0;y<A.length;y+=1)if(q=A[y],n=D.layer.groups[q],u.groups&&n)for(q=0;q<n.length;q+=
1)n[q]!==u&&(n[q].x+=u.dx,n[q].y+=u.dy)}else if("mouseup"===F||"touchend"===F)q.dragging&&(u.dragging=x,q.dragging=x,R(e,D,u,"dragstop")),D.drag={}}e=M.lastIntersected;e===h||g===e||!e._hovered||e._fired||M.drag.dragging||(M.lastIntersected=h,e._fired=v,e._hovered=x,R(d,M,e,"mouseout"),d.css({cursor:M.cursor}));g&&(g[t]||Z.mouseEvents[t]&&(t=Z.mouseEvents[t]),g._event&&g.intersects&&(M.lastIntersected=g,!(g.mouseover||g.mouseout||g.cursors)||M.drag.dragging||g._hovered||g._fired||(g._fired=v,g._hovered=
v,R(d,M,g,"mouseover")),g._fired||(g._fired=v,C.type=h,R(d,M,g,t)),!g.draggable||g.disableEvents||"mousedown"!==t&&"touchstart"!==t||(M.drag.layer=g)));g!==h||M.drag.dragging||d.css({cursor:M.cursor});k===a.length&&(M.intersecting.length=0,M.transforms=la(oa),M.savedTransforms.length=0)}return this};f.fn.addLayer=function(d){var c,a;for(c=0;c<this.length;c+=1)if(a=L(this[c]))a=new J(d),a.layer=v,Q(this[c],a,d);return this};X.props=["width","height","opacity","lineHeight"];X.propsObj={};f.fn.animateLayer=
function(){function d(a,b,c){return function(){var d,g;for(g=0;g<X.props.length;g+=1)d=X.props[g],c[d]=c["_"+d];for(var k in c)c.hasOwnProperty(k)&&-1!==k.indexOf(".")&&delete c[k];b.animating&&b.animated!==c||a.drawLayers();c._animating=x;b.animating=x;b.animated=h;e[4]&&e[4].call(a[0],c);R(a,b,c,"animateend")}}function c(a,b,c){return function(d,g){var k,f,h=!1;"_"===g.prop[0]&&(h=!0,g.prop=g.prop.replace("_",""),c[g.prop]=c["_"+g.prop]);-1!==g.prop.indexOf(".")&&(k=g.prop.split("."),f=k[0],k=k[1],
c[f]&&(c[f][k]=g.now));c._pos!==g.pos&&(c._pos=g.pos,c._animating||b.animating||(c._animating=v,b.animating=v,b.animated=c),b.animating&&b.animated!==c||a.drawLayers());e[5]&&e[5].call(a[0],d,g,c);R(a,b,c,"animate",g);h&&(g.prop="_"+g.prop)}}var a,b,g,e=sa.call(arguments,0),k,M;"object"===ba(e[2])?(e.splice(2,0,e[2].duration||h),e.splice(3,0,e[3].easing||h),e.splice(4,0,e[4].complete||h),e.splice(5,0,e[5].step||h)):(e[2]===p?(e.splice(2,0,h),e.splice(3,0,h),e.splice(4,0,h)):ea(e[2])&&(e.splice(2,
0,h),e.splice(3,0,h)),e[3]===p?(e[3]=h,e.splice(4,0,h)):ea(e[3])&&e.splice(3,0,h));for(b=0;b<this.length;b+=1)if(a=f(this[b]),g=L(this[b]))g=E(this[b]),(k=a.getLayer(e[0]))&&k._method!==f.fn.draw&&(M=$({},e[1]),M=Ua(this[b],k,M),Fa(M,v),Fa(k),k.style=X.propsObj,f(k).animate(M,{duration:e[2],easing:f.easing[e[3]]?e[3]:h,complete:d(a,g,k),step:c(a,g,k)}),R(a,g,k,"animatestart"));return this};f.fn.animateLayerGroup=function(d){var c,a,b=sa.call(arguments,0),g,e;for(a=0;a<this.length;a+=1)if(c=f(this[a]),
g=c.getLayerGroup(d))for(e=0;e<g.length;e+=1)b[0]=g[e],c.animateLayer.apply(c,b);return this};f.fn.delayLayer=function(d,c){var a,b,g,e;c=c||0;for(b=0;b<this.length;b+=1)if(a=f(this[b]),g=E(this[b]),e=a.getLayer(d))f(e).delay(c),R(a,g,e,"delay");return this};f.fn.delayLayerGroup=function(d,c){var a,b,g,e,k;c=c||0;for(b=0;b<this.length;b+=1)if(a=f(this[b]),g=a.getLayerGroup(d))for(k=0;k<g.length;k+=1)e=g[k],a.delayLayer(e,c);return this};f.fn.stopLayer=function(d,c){var a,b,g,e;for(b=0;b<this.length;b+=
1)if(a=f(this[b]),g=E(this[b]),e=a.getLayer(d))f(e).stop(c),R(a,g,e,"stop");return this};f.fn.stopLayerGroup=function(d,c){var a,b,g,e,k;for(b=0;b<this.length;b+=1)if(a=f(this[b]),g=a.getLayerGroup(d))for(k=0;k<g.length;k+=1)e=g[k],a.stopLayer(e,c);return this};(function(d){var c;for(c=0;c<d.length;c+=1)f.fx.step[d[c]]=Va})("color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "));Z.touchEvents=
{mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"};Z.mouseEvents={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"};(function(d){var c;for(c=0;c<d.length;c+=1)Xa(d[c])})("click dblclick mousedown mouseup mousemove mouseover mouseout touchstart touchmove touchend".split(" "));f.event.fix=function(d){var c,a;d=$a.call(f.event,d);if(c=d.originalEvent)if(a=c.changedTouches,d.pageX!==p&&d.offsetX===p){if(c=f(d.currentTarget).offset())d.offsetX=d.pageX-c.left,d.offsetY=d.pageY-
c.top}else a&&(c=f(d.currentTarget).offset())&&(d.offsetX=a[0].pageX-c.left,d.offsetY=a[0].pageY-c.top);return d};Z.drawings={arc:"drawArc",bezier:"drawBezier",ellipse:"drawEllipse","function":"draw",image:"drawImage",line:"drawLine",path:"drawPath",polygon:"drawPolygon",slice:"drawSlice",quadratic:"drawQuadratic",rectangle:"drawRect",text:"drawText",vector:"drawVector",save:"saveCanvas",restore:"restoreCanvas",rotate:"rotateCanvas",scale:"scaleCanvas",translate:"translateCanvas"};f.fn.draw=function c(a){var b,
g,e=new J(a);if(Z.drawings[e.type])this[Z.drawings[e.type]](a);else for(b=0;b<this.length;b+=1)if(f(this[b]),g=L(this[b]))e=new J(a),Q(this[b],e,a,c),e.visible&&e.fn&&e.fn.call(this[b],g,e);return this};f.fn.clearCanvas=function a(b){var g,e,k=new J(b);for(g=0;g<this.length;g+=1)if(e=L(this[g]))k.width===h||k.height===h?(e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,this[g].width,this[g].height),e.restore()):(Q(this[g],k,b,a),T(this[g],e,k,k.width,k.height),e.clearRect(k.x-k.width/2,k.y-k.height/
2,k.width,k.height),k._transformed&&e.restore());return this};f.fn.saveCanvas=function b(g){var e,k,f,h,t;for(e=0;e<this.length;e+=1)if(k=L(this[e]))for(h=E(this[e]),f=new J(g),Q(this[e],f,g,b),t=0;t<f.count;t+=1)ga(k,h);return this};f.fn.restoreCanvas=function g(e){var k,f,h,t,D;for(k=0;k<this.length;k+=1)if(f=L(this[k]))for(t=E(this[k]),h=new J(e),Q(this[k],h,e,g),D=0;D<h.count;D+=1){var F=f,y=t;0===y.savedTransforms.length?y.transforms=la(oa):(F.restore(),y.transforms=y.savedTransforms.pop())}return this};
f.fn.rotateCanvas=function e(k){var f,h,t,D;for(f=0;f<this.length;f+=1)if(h=L(this[f]))D=E(this[f]),t=new J(k),Q(this[f],t,k,e),t.autosave&&ga(h,D),za(h,t,D.transforms);return this};f.fn.scaleCanvas=function k(f){var h,t,D,F;for(h=0;h<this.length;h+=1)if(t=L(this[h]))F=E(this[h]),D=new J(f),Q(this[h],D,f,k),D.autosave&&ga(t,F),Aa(t,D,F.transforms);return this};f.fn.translateCanvas=function M(f){var h,D,F,y;for(h=0;h<this.length;h+=1)if(D=L(this[h]))y=E(this[h]),F=new J(f),Q(this[h],F,f,M),F.autosave&&
ga(D,y),Ba(D,F,y.transforms);return this};f.fn.drawRect=function C(f){var h,F,y,u,q,A,n,z,K;for(h=0;h<this.length;h+=1)if(F=L(this[h]))y=new J(f),Q(this[h],y,f,C),y.visible&&(U(this[h],F,y),T(this[h],F,y,y.width,y.height),F.beginPath(),u=y.x-y.width/2,q=y.y-y.height/2,z=Za(y.cornerRadius),y.width&&y.height&&(z?(A=y.x+y.width/2,n=y.y+y.height/2,0>y.width&&(K=u,u=A,A=K),0>y.height&&(K=q,q=n,n=K),0>A-u-2*z&&(z=(A-u)/2),0>n-q-2*z&&(z=(n-q)/2),F.moveTo(u+z,q),F.lineTo(A-z,q),F.arc(A-z,q+z,z,3*G/2,2*G,
x),F.lineTo(A,n-z),F.arc(A-z,n-z,z,0,G/2,x),F.lineTo(u+z,n),F.arc(u+z,n-z,z,G/2,G,x),F.lineTo(u,q+z),F.arc(u+z,q+z,z,G,3*G/2,x),y.closed=v):F.rect(u,q,y.width,y.height)),V(this[h],F,y),Y(this[h],F,y));return this};f.fn.drawArc=function t(f){var h,y,u;for(h=0;h<this.length;h+=1)if(y=L(this[h]))u=new J(f),Q(this[h],u,f,t),u.visible&&(U(this[h],y,u),T(this[h],y,u,2*u.radius),y.beginPath(),Ia(this[h],y,u,u),V(this[h],y,u),Y(this[h],y,u));return this};f.fn.drawEllipse=function D(f){var h,u,q,A,n;for(h=
0;h<this.length;h+=1)if(u=L(this[h]))q=new J(f),Q(this[h],q,f,D),q.visible&&(U(this[h],u,q),T(this[h],u,q,q.width,q.height),A=4/3*q.width,n=q.height,u.beginPath(),u.moveTo(q.x,q.y-n/2),u.bezierCurveTo(q.x-A/2,q.y-n/2,q.x-A/2,q.y+n/2,q.x,q.y+n/2),u.bezierCurveTo(q.x+A/2,q.y+n/2,q.x+A/2,q.y-n/2,q.x,q.y-n/2),V(this[h],u,q),q.closed=v,Y(this[h],u,q));return this};f.fn.drawPolygon=function F(f){var h,q,A,n,z,K,H,w,m,l;for(h=0;h<this.length;h+=1)if(q=L(this[h]))if(A=new J(f),Q(this[h],A,f,F),A.visible){U(this[h],
q,A);T(this[h],q,A,2*A.radius);z=2*G/A.sides;K=z/2;n=K+G/2;H=A.radius*N(K);q.beginPath();for(l=0;l<A.sides;l+=1)w=A.x+A.radius*N(n),m=A.y+A.radius*S(n),q.lineTo(w,m),A.concavity&&(w=A.x+(H+-H*A.concavity)*N(n+K),m=A.y+(H+-H*A.concavity)*S(n+K),q.lineTo(w,m)),n+=z;V(this[h],q,A);A.closed=v;Y(this[h],q,A)}return this};f.fn.drawSlice=function y(h){var q,A,n,z,K;for(q=0;q<this.length;q+=1)if(f(this[q]),A=L(this[q]))n=new J(h),Q(this[q],n,h,y),n.visible&&(U(this[q],A,n),T(this[q],A,n,2*n.radius),n.start*=
n._toRad,n.end*=n._toRad,n.start-=G/2,n.end-=G/2,n.start=Ha(n.start),n.end=Ha(n.end),n.end<n.start&&(n.end+=2*G),z=(n.start+n.end)/2,K=n.radius*n.spread*N(z),z=n.radius*n.spread*S(z),n.x+=K,n.y+=z,A.beginPath(),A.arc(n.x,n.y,n.radius,n.start,n.end,n.ccw),A.lineTo(n.x,n.y),V(this[q],A,n),n.closed=v,Y(this[q],A,n));return this};f.fn.drawLine=function u(h){var f,n,z;for(f=0;f<this.length;f+=1)if(n=L(this[f]))z=new J(h),Q(this[f],z,h,u),z.visible&&(U(this[f],n,z),T(this[f],n,z),n.beginPath(),Ka(this[f],
n,z,z),V(this[f],n,z),Y(this[f],n,z));return this};f.fn.drawQuadratic=function q(f){var h,z,K;for(h=0;h<this.length;h+=1)if(z=L(this[h]))K=new J(f),Q(this[h],K,f,q),K.visible&&(U(this[h],z,K),T(this[h],z,K),z.beginPath(),La(this[h],z,K,K),V(this[h],z,K),Y(this[h],z,K));return this};f.fn.drawBezier=function A(h){var f,K,H;for(f=0;f<this.length;f+=1)if(K=L(this[f]))H=new J(h),Q(this[f],H,h,A),H.visible&&(U(this[f],K,H),T(this[f],K,H),K.beginPath(),Ma(this[f],K,H,H),V(this[f],K,H),Y(this[f],K,H));return this};
f.fn.drawVector=function n(f){var h,H,w;for(h=0;h<this.length;h+=1)if(H=L(this[h]))w=new J(f),Q(this[h],w,f,n),w.visible&&(U(this[h],H,w),T(this[h],H,w),H.beginPath(),Pa(this[h],H,w,w),V(this[h],H,w),Y(this[h],H,w));return this};f.fn.drawPath=function z(h){var f,w,m,l,B;for(f=0;f<this.length;f+=1)if(w=L(this[f]))if(m=new J(h),Q(this[f],m,h,z),m.visible){U(this[f],w,m);T(this[f],w,m);w.beginPath();for(l=1;v;)if(B=m["p"+l],B!==p)B=new J(B),"line"===B.type?Ka(this[f],w,m,B):"quadratic"===B.type?La(this[f],
w,m,B):"bezier"===B.type?Ma(this[f],w,m,B):"vector"===B.type?Pa(this[f],w,m,B):"arc"===B.type&&Ia(this[f],w,m,B),l+=1;else break;V(this[f],w,m);Y(this[f],w,m)}return this};f.fn.drawText=function K(H){var w,m,l,B,W,s,O,p,v,x;for(w=0;w<this.length;w+=1)if(f(this[w]),m=L(this[w]))if(l=new J(H),B=Q(this[w],l,H,K),l.visible){U(this[w],m,l);m.textBaseline=l.baseline;m.textAlign=l.align;Qa(m,l);W=l.maxWidth!==h?Sa(m,l):l.text.toString().split("\n");Ra(this[w],m,l,W);B&&(B.width=l.width,B.height=l.height);
T(this[w],m,l,l.width,l.height);O=l.x;"left"===l.align?l.respectAlign?l.x+=l.width/2:O-=l.width/2:"right"===l.align&&(l.respectAlign?l.x-=l.width/2:O+=l.width/2);if(l.radius)for(O=fa(l.fontSize),l.letterSpacing===h&&(l.letterSpacing=O/500),s=0;s<W.length;s+=1){m.save();m.translate(l.x,l.y);B=W[s];p=B.length;m.rotate(-(G*l.letterSpacing*(p-1))/2);for(x=0;x<p;x+=1)v=B[x],0!==x&&m.rotate(G*l.letterSpacing),m.save(),m.translate(0,-l.radius),m.fillText(v,0,0),m.restore();l.radius-=O;l.letterSpacing+=O/
(1E3*G);m.restore()}else for(s=0;s<W.length;s+=1)B=W[s],p=l.y+s*l.height/W.length-(W.length-1)*l.height/W.length/2,m.shadowColor=l.shadowColor,m.fillText(B,O,p),"transparent"!==l.fillStyle&&(m.shadowColor="transparent"),m.strokeText(B,O,p);p=0;"top"===l.baseline?p+=l.height/2:"bottom"===l.baseline&&(p-=l.height/2);l._event&&(m.beginPath(),m.rect(l.x-l.width/2,l.y-l.height/2+p,l.width,l.height),V(this[w],m,l),m.closePath());l._transformed&&m.restore()}ca.propCache=l;return this};f.fn.measureText=function(f){var h,
w;h=this.getLayer(f);if(!h||h&&!h._layer)h=new J(f);if(f=L(this[0]))Qa(f,h),w=Sa(f,h),Ra(this[0],f,h,w);return h};f.fn.drawImage=function H(w){function m(l,m,s,r,w){return function(){var B=f(l);U(l,m,r);r.width===h&&r.sWidth===h&&(r.width=r.sWidth=I.width);r.height===h&&r.sHeight===h&&(r.height=r.sHeight=I.height);w&&(w.width=r.width,w.height=r.height);r.sWidth!==h&&r.sHeight!==h&&r.sx!==h&&r.sy!==h?(r.width===h&&(r.width=r.sWidth),r.height===h&&(r.height=r.sHeight),r.cropFromCenter||(r.sx+=r.sWidth/
2,r.sy+=r.sHeight/2),0>r.sy-r.sHeight/2&&(r.sy=r.sHeight/2),r.sy+r.sHeight/2>I.height&&(r.sy=I.height-r.sHeight/2),0>r.sx-r.sWidth/2&&(r.sx=r.sWidth/2),r.sx+r.sWidth/2>I.width&&(r.sx=I.width-r.sWidth/2),T(l,m,r,r.width,r.height),m.drawImage(I,r.sx-r.sWidth/2,r.sy-r.sHeight/2,r.sWidth,r.sHeight,r.x-r.width/2,r.y-r.height/2,r.width,r.height)):(T(l,m,r,r.width,r.height),m.drawImage(I,r.x-r.width/2,r.y-r.height/2,r.width,r.height));m.beginPath();m.rect(r.x-r.width/2,r.y-r.height/2,r.width,r.height);V(l,
m,r);m.closePath();r._transformed&&m.restore();ya(m,s,r);r.layer?R(B,s,w,"load"):r.load&&r.load.call(B[0],w);r.layer&&(w._masks=s.transforms.masks.slice(0),r._next&&B.drawLayers({clear:x,resetFire:v,index:r._next}))}}var l,B,W,s,O,G,I,P,N,S=ca.imageCache;for(B=0;B<this.length;B+=1)if(l=this[B],W=L(this[B]))s=E(this[B]),O=new J(w),G=Q(this[B],O,w,H),O.visible&&(N=O.source,P=N.getContext,N.src||P?I=N:N&&(S[N]!==p?I=S[N]:(I=new ua,I.crossOrigin=O.crossOrigin,I.src=N,S[N]=I)),I&&(I.complete||P?m(l,W,
s,O,G)():(I.onload=m(l,W,s,O,G),I.src=I.src)));return this};f.fn.createPattern=function(H){function w(){s=l.createPattern(p,B.repeat);B.load&&B.load.call(m[0],s)}var m=this,l,B,p,s,v;(l=L(m[0]))?(B=new J(H),v=B.source,ea(v)?(p=f("<canvas />")[0],p.width=B.width,p.height=B.height,H=L(p),v.call(p,H),w()):(H=v.getContext,v.src||H?p=v:(p=new ua,p.crossOrigin=B.crossOrigin,p.src=v),p.complete||H?w():(p.onload=w(),p.src=p.src))):s=h;return s};f.fn.createGradient=function(f){var w,m=[],l,B,v,s,O,x,I;f=new J(f);
if(w=L(this[0])){f.x1=f.x1||0;f.y1=f.y1||0;f.x2=f.x2||0;f.y2=f.y2||0;w=f.r1!==h&&f.r2!==h?w.createRadialGradient(f.x1,f.y1,f.r1,f.x2,f.y2,f.r2):w.createLinearGradient(f.x1,f.y1,f.x2,f.y2);for(s=1;f["c"+s]!==p;s+=1)f["s"+s]!==p?m.push(f["s"+s]):m.push(h);l=m.length;m[0]===h&&(m[0]=0);m[l-1]===h&&(m[l-1]=1);for(s=0;s<l;s+=1){if(m[s]!==h){x=1;I=0;B=m[s];for(O=s+1;O<l;O+=1)if(m[O]!==h){v=m[O];break}else x+=1;B>v&&(m[O]=m[s])}else m[s]===h&&(I+=1,m[s]=B+(v-B)/x*I);w.addColorStop(m[s],f["c"+(s+1)])}}else w=
h;return w};f.fn.setPixels=function w(f){var l,p,v,s,x,G,I,E,N;for(p=0;p<this.length;p+=1)if(l=this[p],v=L(l)){s=new J(f);Q(l,s,f,w);T(this[p],v,s,s.width,s.height);if(s.width===h||s.height===h)s.width=l.width,s.height=l.height,s.x=s.width/2,s.y=s.height/2;if(0!==s.width&&0!==s.height){G=v.getImageData(s.x-s.width/2,s.y-s.height/2,s.width,s.height);I=G.data;N=I.length;if(s.each)for(E=0;E<N;E+=4)x={r:I[E],g:I[E+1],b:I[E+2],a:I[E+3]},s.each.call(l,x,s),I[E]=x.r,I[E+1]=x.g,I[E+2]=x.b,I[E+3]=x.a;v.putImageData(G,
s.x-s.width/2,s.y-s.height/2);v.restore()}}return this};f.fn.getCanvasImage=function(f,m){var l,v=h;0!==this.length&&(l=this[0],l.toDataURL&&(m===p&&(m=1),v=l.toDataURL("image/"+f,m)));return v};f.fn.detectPixelRatio=function(h){var m,l,p,x,s,G,J;for(l=0;l<this.length;l+=1)m=this[l],f(this[l]),p=L(m),J=E(this[l]),J.scaled||(x=window.devicePixelRatio||1,s=p.webkitBackingStorePixelRatio||p.mozBackingStorePixelRatio||p.msBackingStorePixelRatio||p.oBackingStorePixelRatio||p.backingStorePixelRatio||1,
x/=s,1!==x&&(s=m.width,G=m.height,m.width=s*x,m.height=G*x,m.style.width=s+"px",m.style.height=G+"px",p.scale(x,x)),J.pixelRatio=x,J.scaled=v,h&&h.call(m,x));return this};P.clearCache=function(){for(var f in ca)ca.hasOwnProperty(f)&&(ca[f]={})};f.support.canvas=f("<canvas />")[0].getContext!==p;P.defaults=ma;P.prefs=aa;P.setGlobalProps=U;P.transformShape=T;P.detectEvents=V;P.closePath=Y;f.jCanvas=P})(jQuery,document,Image,Array,Math,parseFloat,console,!0,!1,null);
