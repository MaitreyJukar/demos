!function(){"use strict";MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.Tile=Backbone.Model.extend({base:0,exponent:0,parenthesisState:0,pareExponent:1,operator:"*",getJSON:function(a,b,c,d){var e,f="";return(this.parenthesisState&!0||2==(2&this.parenthesisState))&&(f+="{",f+=MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.Tile.getTileJSON("null",this.pareExponent,a,"PARENTHESIS",2==this.parenthesisState||6==this.parenthesisState?"-1":"1",b?"null":'"*"'),f+=',"tileArray":['),e=c?null:b?null:'"*"',f+="{"+MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.Tile.getTileJSON(this.base,this.exponent,a,"BASE_EXPONENT","null",e)+"}",this.parenthesisState>2&&(f+="]}"),d||(f+=","),f}},{getTileJSON:function(a,b,c,d,e,f){var g="";return g+='"base": '+a,g+=',"exponent": '+b,g+=',"type": "'+d+'"',g+=',"coefficient":'+e,g+=',"operator":'+f,g+=',"strDroppables":"*"',g+=',"bDenominator":'+(c?"true":"false")}}),MathInteractives.Common.Interactivities.ExponentAccordion.Models.RandomExpression=Backbone.Model.extend({numTiles:[],denoTiles:[],accordionLevel:null,getExpression:function(a,b,c,d,e,f,g,h,i){var j=!1;MathInteractives.Common.Utilities.Models.Utils;return this.accordionLevel=i,this.numTiles=[],this.denoTiles=[],g&&1==MathInteractives.Common.Utilities.Models.Utils.getRandomIntegerNumber(0,1)&&(j=!0),this.generateUniqueBasesAndBaseTiles(b,c,d,!a),this.numTiles=this.generateExpAndAssignToTiles(this.numTiles,e),a&&(this.denoTiles=this.generateExpAndAssignToTiles(this.denoTiles,e)),5===i&&this.makeSameBase(!a),f&&(this.numTiles=this.assignParenthesis(this.numTiles,j,e),a&&(this.denoTiles=this.assignParenthesis(this.denoTiles,g&!j,e))),this.writeJSON(h)},generateUniqueBasesAndBaseTiles:function(a,b,c,d){var e=[],f=0,g=MathInteractives.Common.Utilities.Models.Utils;for(b&&(a-=1),f=0;a>f;f++)e.push(g.getRandomIntegerNumber(2,9));if(c)if(1==e.length)e.push(-1*e[0]);else for(f=0;f<e.length;f++)1==g.getRandomIntegerNumber(0,3)&&(e[f]=-1*e[f]);this.compInNum=g.getRandomIntegerNumber(0,1),this.numTiles=this.generateBaseTiles(this.numTiles,e,d,!1),d||(this.denoTiles=this.generateBaseTiles(this.denoTiles,e,d,!0))},makeSameBase:function(a){var b=MathInteractives.Common.Utilities.Models.Utils,c=b.getRandomIntegerNumber(0,3);1===b.getRandomIntegerNumber(0,2)&&(a?(this.numTiles[0].base=this.numTiles[1].base,this.numTiles[0].exponent=-1*this.numTiles[1].exponent):0===c?(this.denoTiles[0].base=this.numTiles[0].base,this.denoTiles[0].exponent=this.numTiles[0].exponent):1===c?(this.numTiles[0].base=this.numTiles[1].base,this.numTiles[0].exponent=-1*this.numTiles[1].exponent):(this.denoTiles[0].base=this.denoTiles[1].base,this.denoTiles[0].exponent=-1*this.denoTiles[1].exponent)),this.numTiles=b.shuffleArray(this.numTiles),this.denoTiles=b.shuffleArray(this.denoTiles)},generateBaseTiles:function(a,b,c,d){var e=0,f=0,g=MathInteractives.Common.Utilities.Models.Utils,h=g.getRandomIntegerNumber(0,b.length)%b.length,i=this.accordionLevel,j=this.compInNum,k=0,l=0,m=0;for(i>3&&(b.splice(4,0,-6),b.splice(10,0,-8)),f=this.getNumberOfTilesNeeded(c,d),e=0;f>e;e++){if(h%2===0&&(b=g.shuffleArray(b)),i>3)if(c&&2>l)for(;;){if(this.isCompositeNumber(b[h])){l++,m=0;break}if(h=(h+1)%b.length,8===m){b[h]=-6,m=0;break}}else if(d===!1)if(1===j){if(2>l)for(;;){if(this.isCompositeNumber(b[h])){l++,m=0;break}if(h=(h+1)%b.length,8===m){b[h]=-6,m=0;break}}}else if(1>l)for(;;){if(this.isCompositeNumber(b[h])){l++,m=0;break}if(h=(h+1)%b.length,8===m){b[h]=-6,m=0;break}}else 1>k&&(this.factor=g.getRandomIntegerNumber(2,3),b[h]=this.factor);else if(d===!0)if(0===j){if(2>l)for(;;){if(this.isCompositeNumber(b[h])){l++,m=0;break}if(h=(h+1)%b.length,8===m){b[h]=-6,m=0;break}}}else if(1>l)for(;;){if(this.isCompositeNumber(b[h])){l++,m=0;break}if(h=(h+1)%b.length,8===m){b[h]=-6,m=0;break}}else 1>k&&(this.factor=g.getRandomIntegerNumber(2,3),b[h]=this.factor);a[e]=new MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.Tile,a[e].base=b[h],h=(h+1)%b.length}return a},isCompositeNumber:function(a){return a%2!==0&&a%3!==0||Math.abs(a)/2===1||Math.abs(a)/3===1?!1:!0},getNumberOfTilesNeeded:function(a,b){if(b&&2==this.numTiles.length)return 3;var c=MathInteractives.Common.Utilities.Models.Utils;return 1===this.accordionLevel?c.getRandomIntegerNumber(2,3):a?3:c.getRandomIntegerNumber(2,3)},generateExpAndAssignToTiles:function(a,b){var c=0;for(c=0;c<a.length;c++)a[c].exponent=MathInteractives.Common.Utilities.Models.Utils.getRandomIntegerNumber(b?-9:1,9),0==a[c].exponent&&(a[c].exponent=-1);return a},assignParenthesis:function(a,b,c){var d=2,e=0,f=0,g=0;for(e=0;e<a.length;e++)if(1==MathInteractives.Common.Utilities.Models.Utils.getRandomIntegerNumber(0,1)){if(2==g)break;for(g++,a[e].parenthesisState=b&&1==g?2:1,a[e].operator=null,5===this.accordionLevel?(a[e].pareExponent=c?MathInteractives.Common.Utilities.Models.Utils.getRandomIntegerNumber(-3,3):MathInteractives.Common.Utilities.Models.Utils.getRandomIntegerNumber(1,3),0==a[e].pareExponent&&(a[e].pareExponent=MathInteractives.Common.Utilities.Models.Utils.getRandomIntegerNumber(-3,-1))):a[e].pareExponent=1,a.length-e==1&&(a[e].parenthesisState+=4,d=0),f=e;d>f;f++)if(1==MathInteractives.Common.Utilities.Models.Utils.getRandomIntegerNumber(0,1)){a[f].parenthesisState+=4,e=f;break}a[e].parenthesisState<=2&&(a[e].parenthesisState+=4)}return a},writeJSON:function(a){var b,c=0,d='{"tileArray":[',e=d,f=this.denoTiles.length>0;for(a&&(e+=d),f&&(e+=d),c=0;c<this.numTiles.length;c++)e+=this.numTiles[c].getJSON(!1,0==c,null==this.numTiles[c].operator,c==this.numTiles.length-1&&!f);for(c=0;c<this.denoTiles.length;c++)e+=this.denoTiles[c].getJSON(!0,0==c,null==this.denoTiles[c].operator,c==this.denoTiles.length-1);return f&&(e+="],"+MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.Tile.getTileJSON("null","null",!1,"FRACTION","null","null")+"}"),a&&(b=MathInteractives.Common.Utilities.Models.Utils.getRandomIntegerNumber(-3,3),b=0===b?2:b,e+="],"+MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.Tile.getTileJSON("null",b,!1,"BIG_PARENTHESIS","null","null")+"}"),e+="],"+MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.Tile.getTileJSON("null","null",!1,"EQUATION_COMPONENT","null","null")+"}"}})}(),function(){"use strict";var a=MathInteractives.Common.Interactivities.ExponentAccordion.Views,b=MathInteractives.Common.Components.Views.EquationManager,c=MathInteractives.Common.Components.Models.EquationManager;a.FormExpressionEquationManager=b.FormExpressionEquationManager.extend({currentLevel:null,initialize:function(){a.FormExpressionEquationManager.__super__.initialize.apply(this,arguments)},setCurrentLevel:function(a){this.currentLevel=a},toggleBigParenthesis:function(a){var b=c.CommandFactory,d=new b.TileLocation("0",!1,1),e=this,f={};f.source=d,f.type=c.TileItem.BinTileType.BIG_PARENTHESIS,this.$el.addClass("hide-overflow"),a?this.fireCommand(b.COMMANDS.ADD_TILE,f):this.fireCommand(b.COMMANDS.DELETE_TILE,f),window.setTimeout(function(){e.$el.removeClass("hide-overflow")},0)},setData:function(b,c){a.FormExpressionEquationManager.__super__.setData.apply(this,arguments),this._bindEventsOnBuildMode()},_bindEventsOnBuildMode:function(){this.listenTo(this.equationView.model,c.CommandFactory.EVENTS.BIG_PARENTHESIS_ADDED,this._onAddBigParenthesis),this.listenTo(this.equationView.model,c.CommandFactory.EVENTS.BIG_PARENTHESIS_REMOVED,this._onRemoveBigParenthesis)},_onAddBigParenthesis:function(){this.trigger(a.FormExpressionEquationManager.EVENTS.BIG_PARENTHESIS_ADDED)},_onRemoveBigParenthesis:function(){this.trigger(a.FormExpressionEquationManager.EVENTS.BIG_PARENTHESIS_REMOVED)},onRepositionTile:function(a){var b,d=c.CommandFactory,e=a.sourceTile,f=a.destTile,g={};return this._isValidDropElementForTutorial(a)?(g.source=new d.TileLocation(e.parent.getIndex(e),e.model.get("bDenominator"),a.numOfTiles),g.dest=new d.TileLocation(f.parent.getIndex(f),f.model.get("bDenominator"),1),g.isLeft=a.isLeft,g.operator="*",this._validateBuildModeReposition(g.source,g.dest)===!1?!1:(b=this.fireCommand(d.COMMANDS.BUILD_REPOSITION,g),b&&this.removeMarquee(),b)):!1},onRepositionIndividualTile:function(a){var b,d=c.CommandFactory,e=a.sourceTile,f=a.destTile,g=a.tiletype,h={};return this._isValidDropElementForTutorial(a)?(h.source=new d.TileLocation(e.parent.getIndex(e),e.model.get("bDenominator"),a.numOfTiles),h.dest=new d.TileLocation(f.parent.getIndex(f),f.model.get("bDenominator"),1),h.type=g,h.isLeft=a.isLeft,h.operator="*",this._validateBuildModeIndividualReposition(h.source,h.dest,g)===!1?!1:(b=this.fireCommand(d.COMMANDS.BUILD_REPOSITION_INDIVIDUAL_TILE,h),b&&this.removeMarquee(),b)):!1},onAddTile:function(a,d){var e=b.EquationManager.Operations.ADD_TILE_TO_CANVAS&&this.model.get("allowManagerLevelOperations");if(e){if(!this._isValidDropElementForTutorial(a))return!1;var f,g,h,i,j=c.CommandFactory,k=new j.TileLocation(a.index,a.isDestDeno,a.numOfTiles),l=a.sourceTile,m=c.TileItem.BinTileType,n={};if(d?(f=l.tileType,g=+l.tilevalue):(f=l.attr("data-tiletype"),g=+l.attr("data-tilevalue")),n.source=k,n.type=f,n.isLeft=a.isLeft,n.operator="*",f===m.BASE){if(this.validateTileAddition(n.source)===!1)return!1;if(n.base=g,!this.isBasePresent(n.base,!1))return!1}else if(f===m.EXPONENT){if(this.validateTileAddition(n.source)===!1)return!1;n.exponent=g}else if(f===m.PARENTHESIS){if(i=a.index.split("."),i.pop(),this.equationView.model.getItemFromIndex(i.join(".")).get("type")===f)return this.trigger(b.FormExpressionEquationManager.EVENTS.NESTED_PARENTHESIS_CASE),!1;if(this.validateMarqueeAndParenthesisAddition(n.source)===!1)return this.removeMarquee(),!1;if(this.validateMarqueeAndParenthesisAddition(n.source)===!1)return this.removeMarquee(),!1;if(n.coefficient=g,this.isParenthesisDroppable(this.equationView.model.getItemFromIndex(a.index).get("bDenominator"),1)===!1)return!1}h=this.fireCommand(j.COMMANDS.ADD_TILE,n),h&&this.removeMarquee()}return h},onBaseClick:function(a,b){return!1},onExponentClick:function(a){return!1},wrapFractionTileItem:function(a){var b=c.TileItem.BinTileType,d={tileArray:[],type:b.FRACTION};return d.tileArray=a.tileArray,a.tileArray=[],a.tileArray[0]=d,a},undo:function(){var a=this;this.$el.addClass("hide-overflow"),this.commandFactory.undo(),window.setTimeout(function(){a.$el.removeClass("hide-overflow")},0),this.getEquationStatusModifyBin()},addTileForNegativeParCoeff:function(){this._updateModelToAddCoefficientTile(this.equationView.model.get("tileArray"))},_updateModelToAddCoefficientTile:function(a){if(null!==a&&0!==a.length){var b,d,e,f={},g=c.TileItem.BinTileType,h=c.CommandFactory;for(b=0;b<a.length;b++)d=a.at(b),d.get("type")===g.PARENTHESIS&&-1===d.get("coefficient")&&(d.set("coefficient",1),e=this.equationView.model.getIndexFromItem(d),f.source=new h.TileLocation(e,d.get("bDenominator"),1),f.type=g.BASE_ONLY,f.base=-1,f.isLeft=!0,f.operator="*",this.fireCommand(h.COMMANDS.ADD_TILE,f)),this._updateModelToAddCoefficientTile(d.get("tileArray"))}},isParenthesisExponentDraggable:function(){return this.trigger(a.FormExpressionEquationManager.EVENTS.GET_CURRENT_LEVEL),5===this.currentLevel?!0:!1}},{EVENTS:{BIG_PARENTHESIS_ADDED:"big-parenthesis-added",BIG_PARENTHESIS_REMOVED:"big-parenthesis-removed",GET_CURRENT_LEVEL:"get-current-level"}})}(),function(){"use strict";var a=MathInteractives.Common.Interactivities.ExponentAccordion.Views,b=MathInteractives.Common.Components.Views.EquationManager,c=MathInteractives.Common.Components.Models.EquationManager;a.EquationManager=b.EquationManager.extend({currentLevel:null,$changeSignButton:null,initialize:function(){a.FormExpressionEquationManager.__super__.initialize.apply(this,arguments)},setCurrentLevel:function(a){this.currentLevel=a},_getExponentTooltipHtml:function(b){var c=$("<div></div>").attr({id:this.idPrefix+"exponent-tooltip-buttons-container-"+b,"class":"exponent-tooltip-buttons-container"}),d=($("<div></div>").attr({id:this.idPrefix+"apply-exponent-button-"+b,"class":"apply-exponent-button"}).appendTo(c),$("<div></div>").attr({id:this.idPrefix+"change-sign-button-"+b,"class":"change-sign-button"}).appendTo(c));return this.$changeSignButton=d,this.trigger(a.EquationManager.GET_CURRENT_LEVEL),c},_generateButtonsInsideTooltip:function(b,c){this.trigger(a.EquationManager.GET_CURRENT_LEVEL);var d,e=this,f=MathInteractives.global.Theme2.Button;this.applyExponentBtnViews.length,this.changeSignBtnViews.length;d={idPrefix:this.idPrefix,player:this.player,manager:this.manager,path:this.filePath,data:{id:this.idPrefix+"apply-exponent-button-"+b,text:this.getMessage("exponent-parenthesis-tooltip","apply-exponent"),type:MathInteractives.global.Theme2.Button.TYPE.TEXT,baseClass:"white-button",textColor:"#007ebf"}},this.applyExponentBtnViews[b]=new f.generateButton(d),this._createAccDivsOfButtons(d.data.id,d.data.text,511),this.applyExponentBtnViews[b].$el.off("click").on("click",null,{view:c},function(a){e.applyExponentClick(a),e.solveModeSetFocusOnTooltip()}),this.applyExponentBtnViews[b].$el.off("keydown").on("keydown",function(a){var b=a.keyCode?a.keyCode:a.charCode;if(9===b&&a.shiftKey){a.preventDefault();var c=e.getCurrentAccView();c.startAcc(),e.hideAllTooltips()}else if(27===b){a.preventDefault();var c=e.getCurrentAccView();c.startAcc(),e.hideAllTooltips()}else 9===b&&(e.currentLevel<=4||e._tutorialMode)&&(a.preventDefault(),e.hideAllTooltips(),e.setFocus("solve-mode-replay-btn"))}),5===this.currentLevel&&(d.data.id=this.idPrefix+"change-sign-button-"+b,d.data.text=this.getMessage("exponent-parenthesis-tooltip","change-sign"),d.data.width=173,this.changeSignBtnViews[b]=new f.generateButton(d),this._createAccDivsOfButtons(d.data.id,d.data.text,512),this.changeSignBtnViews[b].$el.off("click").on("click",null,{view:c},function(a){e.changeSignClick(a);e.solveModeSetFocusOnTooltip(),e.hideAllTooltips()}),this.changeSignBtnViews[b].$el.off("keydown").on("keydown",function(a){var b=a.keyCode?a.keyCode:a.charCode;if(9===b&&a.shiftKey){if(e._tutorialMode){a.preventDefault();var c=e.getCurrentAccView();c.removeAccDiv(),c.startAcc(),e.hideAllTooltips()}}else if(27===b){a.preventDefault();var c=e.getCurrentAccView();c.removeAccDiv(),c.startAcc(),e.hideAllTooltips()}else if(9===b)if(e._tutorialMode)a.preventDefault(),e.hideAllTooltips(),e.setFocus("solve-mode-replay-btn");else{a.preventDefault();var c=e.getCurrentAccView();c.continueAcc(),e.hideAllTooltips()}}))},getLeftOffsetEV:function(){return this.trigger(a.EquationManager.GET_CURRENT_LEVEL),this.currentLevel<3?{left:10,width:0}:{left:5,width:8}},updateCtxMenuRows:function(){var d=this.model,e=d.get("isParenthesesAllowed"),f=this.getCurrentAccView(),g=f.model.get("bDenominator"),h=b.EquationManager.CTX_ITEM_ID,i=c.TileItem.BinTileType,j=c.EquationManager.MODES,k=c.EquationComponent.Operations,l=this.commandFactory.get("allowedOperation"),m=this.model.get("mode"),n=this,o=null,p=[];f&&(o=f.model.get("type"),this.ignoreAllCtxRows(),this.trigger(a.EquationManager.GET_CURRENT_LEVEL),m===j.BuildMode?(e&&o!==i.BIG_PARENTHESIS&&(this.isPosParensEnabled&&p.push(h.ADD_POS_PARENS),this.isNegParensEnabled&&p.push(h.ADD_NEG_PARENS),f.isInsideParentheses()&&p.push(h.REMOVE_PARENS)),this.toShowDeleteRow()&&p.push(h.DELETE_TILE)):((o===i.BASE_EXPONENT||o===i.BASE_ONLY&&!f.model.isOne())&&(!this.isNumeratorEmpty()&&(!g&&this.tilesAvailableForCombine()||g)&&p.push(h.COMBINE_NUM),!this.isDenominatorEmpty()&&(g&&this.tilesAvailableForCombine()||!g)&&p.push(h.COMBINE_DEN),0===(k.BREAK_BASE_EXP_1&l)&&0===(k.BREAK_BASE_EXP_ANY&l)||1===Math.abs(f.model.get("base"))||p.push(h.BREAK_BASE)),o===i.BASE_EXPONENT&&(1===Math.abs(f.model.get("base"))||0===Math.abs(f.model.get("exponent"))?p.push(h.APPLY_EXP):p.push(h.BREAK_EXP)),this.currentLevel>2&&(o!==i.BASE_ONLY&&o!==i.BIG_PARENTHESIS||o===i.BASE_ONLY&&!f.model.isOne())&&p.push(h.REPOS_ACROSS_VINCULUM)),p=_.map(p,function(a,b){return n.idPrefix+a}),this.tileCtxMenu.editContextMenu(p,!1))},tilesAvailableForCombine:function(a){var b=this.getCurrentAccView(),c=b.model.get("bDenominator");return a?0!==_.difference(_.uniq(this.getAllBaseViews()),[b]).length:0!==_.difference(_.uniq(this.getAllBaseViews(c)),[b]).length},isZeroGlowAllowed:function(){return this.trigger(a.EquationManager.GET_CURRENT_LEVEL),5===this.currentLevel?!0:!1}},{GET_CURRENT_LEVEL:"get-current-level"})}(),function(){"use strict";var a=MathInteractives.Common.Interactivities.ExponentAccordion.Views,b=MathInteractives.Common.Interactivities.ExponentAccordion.Models,c=MathInteractives.Common.Components.Models.EquationManager,d=MathInteractives.Common.Components.Views.EquationManager;a.FormExpression=MathInteractives.Common.Player.Views.Base.extend({baseExponentTileViews:[],randomExpressionBtnView:null,doneButtonView:null,directionBoxView:null,toggleButtonView:null,_equationManager:null,_formEquationManager:null,tileStatus:[],accordionLevel:4,dropSlotModelArray:null,dragModelArray:null,combineLikeBasesTooltip:null,maxBasesAllowedTooltip:null,parenthesisExponentTooltip:null,baseTilesViews:null,exponentTilesViews:null,parenthesisTilesViews:null,internalToggle:!0,resetClicked:!1,_$elmDroppableRegionParent:null,_$elmStartDropRegionMultiplicationContainer:null,_$elmStartDropRegionDivisionContainer:null,_$elmStartDropRegionMultiplication:null,_$elmStartDropRegionDivision:null,_$elmFormExpDropRegion:null,$elmFormExpressionContainer:null,$elmWorkspaceContainer:null,tutorialView:null,_$elmTutorialContainer:null,buildModeUndoButtonView:null,solveModeUndoButtonView:null,solveModeResetButtonView:null,buildModeResetButtonView:null,_tutorialMode:!1,_isLoadComplete:!1,_isTouch:null,stopEvent:!1,_marqueeRemoveExceptions:[".parenthesis-tile-dispenser",".droppable-region-holder",".workspace-scrollable"],_isIE:!1,_isIE9:!1,isPopupExist:!1,initialize:function(){this.accordionLevel=this.model.get("accordionLevel");var a=MathInteractives.Common.Utilities.Models.BrowserCheck;MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion;this._isIE9=a.isIE===!0&&"9.0"===a.browserVersion,this._isIE=a.isIE===!0||a.isIE11===!0,this.initializeDefaultProperties(),this.loadScreen("direction-text-screen"),this.loadScreen("form-expression-screen"),this._cacheDomElements(),this._renderDirectionText(),this.createFormEquationManager(),this.model.on("change:clearAllData",this.fireTryAnother,this),this.model.on("change:dataTabTryAnotherClick",this.fireTryAnother,this),this.model.on("change:tryAnotherBtnStatus",this.tryAnotherBtnStatus,this),this.model.on("change:raisedToPower",this.raisedToPowerChange,this),this.model.on("change:tileDropped",this.tileDroppedChangeAccessibilityText,this),this.listenTo(this.model,"change:exploreView",this.updateAccessibilityTextForActivityArea,this),this.listenTo(this.model,"change:buildModeDoneButtonStatus",this.updateDoneButtonState,this),this.tryAnotherBtnStatus(this.model,this.model.get("tryAnotherBtnStatus")),this.render(),this.loadScreen("tooltip-screen"),this._bindEventsOnButtons(),this.loadScreen("swipe-region-screen"),this._handleTouchScroll(),this._createContextMenu()},_cacheDomElements:function(){this.$elmFormExpressionContainer=this.$(".form-expression-container"),this.$elmWorkspaceContainer=this.$("#"+this.idPrefix+"workspace-container"),this._$elmStartDropRegionMultiplicationContainer=this.$("#"+this.idPrefix+"droppable-region-start-multiplication"),this._$elmStartDropRegionDivisionContainer=this.$("#"+this.idPrefix+"droppable-region-start-division"),this._$elmStartDropRegionMultiplication=this.$("#"+this.idPrefix+"multiplication-img"),this._$elmStartDropRegionDivision=this.$("#"+this.idPrefix+"division-img"),this._$elmStartHorizontalSaperator=this.$(".horizontal-saperator"),this._$elmFormExpDropRegion=this.$("#"+this.idPrefix+"droppable-region"),this._$elmTutorialContainer=this.$("#"+this.idPrefix+"tutorial-container"),this._$elmParanthesesDispenserContainer=this.$(".parenthesis-tile-dispenser-container"),this._$elmToggleBtnContainer=this.$(".raised-to-power-toggle-button-container"),this._$animationDiv=this.$(".animation-progress-div").hide(),this._$angleDoubleLeft=this.$(".double-angle-left"),this._$angleDoubleRight=this.$(".double-angle-right"),this._$droppableTitleText=this.$(".droppable-region-title-text")},render:function(){var a=b.ExponentAccordion.CURRENT_VIEW,c=b.ExponentAccordion.EXPLORE_VIEW,d=this.model.get("equationData");this._renderBackground(),this._createAllDraggableTiles(),this._createFormExpressionDroppable(),this._renderButtons(),this._$elmFormExpDropRegion.hide(),this._$droppableTitleText.hide(),this.$elmFormExpressionContainer.show(),this.$elmWorkspaceContainer.hide(),this._createTooltips(),null===d&&this.model.set("exploreView",c.FORMATION),this.player.bindTabChange(function(b){this.model.set("currentTab",2),this.model.set("currentView",a.EXPLORE),this._isLoadComplete||null===d||this._loadFromSaveState(),this._isLoadComplete=!0,this._updatesFocusRects(),this.unloadScreen("bin-tiles-screen"),this.loadScreen("bin-tiles-screen"),this.tileDroppedChangeAccessibilityText(this.model,this.model.get("tileDropped")),this.updateAccessibilityTextForActivityArea(this.model,this.model.get("exploreView")),this._bindAccEvents(),this.updateFocusRect("direction-text-container-direction-text-text"),this.model.get("expolreBtnClick")||this.model.get("backButtonClick")||this.model.get("dataTabTryAnotherClick")?this.setFocus("header-subtitle",20):this.setFocus("direction-text-container-direction-text-text"),this.model.set("backButtonClick",!1),this.model.set("expolreBtnClick",!1)},this,2)},_updatesFocusRects:function(){this.updateFocusRect("base-tile-dispenser-container"),this.updateFocusRect("exponents-tile-dispenser-container"),this.updateFocusRect("parenthesis-tile-dispenser-container"),this.setTabIndex("main-activity-area-container",504),this.enableTab("base-tile-dispenser-container",!0),this.enableTab("exponents-tile-dispenser-container",!0),this.enableTab("parenthesis-tile-dispenser-container",!0)},_createContextMenu:function(){var a,b=this.$(".base-draggable-tiles"),c=this.$(".exponent-draggable-tiles"),d=this.$(".parenthesis-draggable-tiles"),e=this.$(".base-draggable-tiles, .exponent-draggable-tiles, .parenthesis-draggable-tiles"),f=this,g=MathInteractives.global.ContextMenu,h=g.CONTEXTMENU_HIDE,i=g.CONTEXTMENU_SELECT,j=(this.model.get("accordionLevel"),{el:this.player.$el,prefix:this.idPrefix,elements:[],screenId:"bin-base-tiles-context-menu",contextMenuCount:4,manager:this.manager,thisView:this});for(a=0;a<b.length;a++)j.elements.push($(b[a]));for(this.binBaseTilesContextMenuView=g.initContextMenu(j),j.screenId="bin-exponent-tiles-context-menu",j.elements=[],a=0;a<c.length;a++)j.elements.push($(c[a]));for(j.contextMenuCount=5,this.binExponentTilesContextMenuView=g.initContextMenu(j),j.screenId="bin-parenthesis-tiles-context-menu",j.elements=[],a=0;a<d.length;a++)j.elements.push($(d[a]));j.contextMenuCount=4,this.binParenthesisTilesContextMenuView=g.initContextMenu(j),this._updateContextMenu(!0),this._contextMenuSelectEvent(e,i),e.off(h).on(h,function(a,b){f.setFocus(a.target.id.replace(f.idPrefix,""))})},_contextMenuSelectEvent:function(a,b){var c=this;a.off(b).on(b,function(a,b){var d=b.currentTarget.id,e=$(a.currentTarget),f=parseInt(d.substring(d.lastIndexOf("-")+1),10);switch(f){case 0:var g=a.currentTarget,h=$(g);c._tileClickEvent(c,h),c.setFocus(g.id.replace(c.idPrefix,""),600);break;case 1:if("none"!==c._formEquationManager.$el.css("display"))c._formEquationManager.selectedTile=e,c._dropBinTileUsingContextMenu(!1);else{var i=c._$elmStartDropRegionMultiplication;c._onTileDropForAcc(a,b,i,!1,"0",e)}break;case 2:if("none"===c._formEquationManager.$el.css("display")){var i=c._$elmStartDropRegionDivision;c._onTileDropForAcc(a,b,i,!0,"0.0",e)}else c._formEquationManager.selectedTile=e,c._dropBinTileUsingContextMenu(!1);break;case 3:if("none"===c._formEquationManager.$el.css("display")){var i=c._$elmStartDropRegionDivision;c._onTileDropForAcc(a,b,i,!0,"0.1",e)}else c._formEquationManager.selectedTile=e,c._dropBinTileUsingContextMenu(!0);break;case 4:c._formEquationManager.selectedTile=e,c._dropBinTileUsingContextMenu(!1,!0)}})},updateAccessibilityTextForActivityArea:function(a,c,d){c===b.ExponentAccordion.EXPLORE_VIEW.WORKSPACE&&this.changeAccMessage("main-activity-area-container",1)},tileDroppedChangeAccessibilityText:function(a,c,d){if(c!==b.ExponentAccordion.EXPLORE_VIEW.WORKSPACE){var e=a.get("buildModeDivisionMode")?this.getAccMessage("extra-messages",1):this.getAccMessage("extra-messages",0),f=a.get("buildModeDivisionMode")?this.getAccMessage("extra-messages",3):this.getAccMessage("extra-messages",2);c===!0?(this.setAccMessage("main-activity-area-container",this.getAccMessage("main-activity-area-container",0)+this.getAccMessage("main-activity-area-container",2,[e])+this.getAccMessage("main-activity-area-container",4)),this.changeAccMessage("parenthesis-tile-dispenser-container",1,[f]),a.get("accordionLevel")>2?(this.setAccMessage("exponents-tile-dispenser-container",this.getAccMessage("exponents-tile-dispenser-container",1,[f])+this.getAccMessage("exponents-tile-dispenser-container",2)),this.setAccMessage("base-tile-dispenser-container",this.getAccMessage("base-tile-dispenser-container",1,[f])+this.getAccMessage("base-tile-dispenser-container",2))):(this.setAccMessage("exponents-tile-dispenser-container",this.getAccMessage("exponents-tile-dispenser-container",0,[f])+this.getAccMessage("exponents-tile-dispenser-container",2)),this.setAccMessage("base-tile-dispenser-container",this.getAccMessage("base-tile-dispenser-container",0,[f])+this.getAccMessage("base-tile-dispenser-container",2)))):(this.setAccMessage("main-activity-area-container",this.getAccMessage("main-activity-area-container",0)+this.getAccMessage("main-activity-area-container",3)+this.getAccMessage("main-activity-area-container",4)),this.changeAccMessage("parenthesis-tile-dispenser-container",0),this.setAccMessage("exponents-tile-dispenser-container",this.getAccMessage("exponents-tile-dispenser-container",0)+this.getAccMessage("exponents-tile-dispenser-container",2)),this.setAccMessage("base-tile-dispenser-container",this.getAccMessage("base-tile-dispenser-container",0)+this.getAccMessage("base-tile-dispenser-container",2)))}},raisedToPowerChange:function(a,b,c){b?(this._updateContextMenu(),this.setAccMessage("raised-to-power-toggle-button-toggle-button-containment",this.getAccMessage("toggle-button-text",1)),this._formEquationManager.equationView&&(this._formEquationManager.equationView.tileDroppedString=this.getMessage("base-exp-pair",21))):(this._updateContextMenu(),this.setAccMessage("raised-to-power-toggle-button-toggle-button-containment",this.getAccMessage("toggle-button-text",2)),this._formEquationManager.equationView&&(this._formEquationManager.equationView.tileDroppedString=this.getMessage("base-exp-pair",22))),this._enableDisableTabsOfBinTiles("parenthesis",!1)},_loadFromSaveState:function(){var a=b.ExponentAccordion.EXPLORE_VIEW,c=(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED,this.model.get("stepCount"));this.model.get("exploreView")===a.FORMATION||this.model.get("previousView")===a.FORMATION?(this._setNewEquation(this._formEquationManager,this.$("#"+this.idPrefix+"form-expression-area"),JSON.parse(JSON.stringify(this.model.get("equationData"))),!0,!0),this.model.get("buildModeDivisionMode")===!1?this._$elmFormExpDropRegion.removeClass("division").addClass("multiplication"):this._$elmFormExpDropRegion.removeClass("multiplication").addClass("division"),this._showHideFormEquationView(!0),this._formEquationManager.getEquationStatusModifyBin(),this._setUndoResetButtonStatus(),this._formEquationManager.removeMarquee()):(this.model.get("exploreView")===a.WORKSPACE||this.model.get("previousView")===a.WORKSPACE)&&(this._showHideEquationManager(!0),this._createEquationManager(),this._setNewEquation(this._equationManager,this.$("#"+this.idPrefix+"workspace-expression-area"),this.model.get("equationDataSolveMode"),!0,!0),this._renderOriginalExpression(),this._equationManager.showMarquee(),0===c&&this._disableEnableButtons(this.solveModeResetButtonView,!1),this._disableEnableButtons(this.solveModeUndoButtonView,!1))},_createTooltips:function(){this._maxBasesAllowedTooltip(),this._combineLikeBasesTooltip()},_getBinElementFromIndex:function(b){var c,d=parseInt(b.substring(0,1)),e={};if(e.element=this._getBinElementViewFromIndex(b),b.length>1)switch(b=b.substring(2,b.length),d){case 0:e.groupTitle=a.FormExpression.BASE_TYPE,e.isTile=!0;break;case 1:e.groupTitle=a.FormExpression.EXPONENT_TYPE,e.isTile=!0;break;case 2:e.groupTitle=a.FormExpression.PARENTHESIS_TYPE,e.isTile=!0;break;case 3:c=b.indexOf("."),c>0&&(d=b.substring(c+1),e.toggleOn="0"!==d,b=b.substring(0,c)),"0"===b&&(e.groupTitle=a.FormExpression.RAISE_FRACTION,e.isToggle=!0)}return e},_getBinElementViewFromIndex:function(a){var b=a.indexOf("."),c=a.length,d=parseInt(a.substring(0,b)),e=null;if(c>1)switch(a=a.substring(b+1,c),d){case 0:e=this.baseTilesViews.dragButtonViews[a];break;case 1:e=this.exponentTilesViews.dragButtonViews[a];break;case 2:e=this.parenthesisTilesViews.dragButtonViews[a];break;case 3:b=a.indexOf("."),b>0&&(c=a.length,a=parseInt(a.substring(0,b))),e=this._getButtonFromIndex(a)}return e},_getButtonFromIndex:function(a){var b=Number(a),c=null;switch(b){case 4:c=this.doneButtonView;break;case 3:c=this.randomExpressionBtnView;break;case 2:c=this.buildModeResetButtonView;break;case 1:c=this.buildModeUndoButtonView;break;case 0:c=this.toggleButtonView;break;case 7:c=this.solveModeViewDataButtonView;break;case 6:c=this.solveModeResetButtonView;break;case 5:c=this.solveModeUndoButtonView}return c},_getBinElementOffsetFromView:function(a,b){return this._getElementOffsetFromElement(a.el,b)},_getElementOffsetFromElement:function(a,b){b=Number(b);var c=a.getBoundingClientRect(),d=(c.top,c.left,c.height),e=c.width,f=0,g=0;switch(b){case 8:f+=e/4,g+=d/2;break;case 9:f+=e/4*3,g+=d/2;break;default:f+=e/2,g+=d/2}return{x:f,y:g}},_getListOfElements:function(b){var c,d,e=0,f={};if(f.bin=[],f.equationManager=[],b){e=b.length;for(var g=0;e>g;g++)c=b[g].split(a.FormExpression.SEPERATOR_ELEMENT_INDEX),c[1]&&(d=c[1],"0"===c[0]?f.bin.push(d):f.equationManager.push(d))}return f},_validTargetElement:function(a){return a?!0:!1},_disableAllButtons:function(){var a=MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED;this.randomExpressionBtnView.setButtonState(a),this.doneButtonView.setButtonState(a),this.buildModeUndoButtonView.setButtonState(a),this.buildModeResetButtonView.setButtonState(a),this.solveModeUndoButtonView.setButtonState(a),this.solveModeResetButtonView.setButtonState(a),this.solveModeViewDataButtonView.setButtonState(a)},createFormEquationManager:function(){var b,d;b="*",d={player:this.player,allowedOperation:this.model.get("allowedOperation"),maxPrimeLimit:this.model.get("maxPrimeLimit"),fractionMode:this.model.get("fractionMode"),isParenthesesAllowed:this.model.get("isParenthesesAllowed"),adjustContainment:!0,mode:c.EquationManager.MODES.BuildMode,buildModeParenthesisSize:a.FormExpression.BUILD_MODE_PARENTHESIS_SIZE},this._formEquationManager=new a.FormExpressionEquationManager({element:this.$("#"+this.idPrefix+"droppable-region"),draggableContainment:this.$("#"+this.idPrefix+"form-expression-draggable-containment"),strDroppables:b,marqueeDiv:"#"+this.idPrefix+"droppable-region-holder",model:new c.EquationManager(d),tutorialMode:!1,player:this.player,filePath:this.filePath,manager:this.manager}),this._attchBinEvents()},_createFormExpressionDroppable:function(){var a=this,b=c.TileItem.BinTileType;this._$elmStartDropRegionMultiplication.droppable({accept:function(a){var c=a.data("tile-type");return c===b.PARENTHESIS?!1:!0},drop:function(b,c){a._onTileDrop(b,c,this,!1)},hoverClass:"drop-over"}),this._$elmStartDropRegionDivision.droppable({
accept:function(a){var c=a.data("tile-type");return c===b.PARENTHESIS?!1:!0},drop:function(b,c){a._onTileDrop(b,c,this,!0)},hoverClass:"drop-over"})},_renderButtons:function(){var a,b;a=MathInteractives.global.Theme2.Button,b={idPrefix:this.idPrefix,player:this.player,manager:this.manager,path:this.filePath,data:{id:this.idPrefix+"random-expression-button",text:this.getMessage("random-expression-button-text",0),type:MathInteractives.global.Theme2.Button.TYPE.TEXT,baseClass:"btn-yellow",textColor:"#222222"}},this.randomExpressionBtnView=new a.generateButton(b),b.data.id=this.idPrefix+"done-button",b.data.text=this.getMessage("done-button-text",0),this.doneButtonView=new a.generateButton(b),this._createBuildModeUndoButton(),this._createBuildModeResetButton(),this._createSolveModeUndoButton(),this._createSolveModeResetButton(),this._createSolveModeViewDataButton(),this.loadScreen("build-mode-buttons-screen"),this._disableEnableButtons(this.doneButtonView,this.model.get("buildModeDoneButtonStatus")),this._disableEnableButtons(this.buildModeUndoButtonView,!1),this._disableEnableButtons(this.buildModeResetButtonView,!1)},_createSolveModeUndoButton:function(){var a=this;return this.solveModeUndoButtonView=new MathInteractives.global.Theme2.Button.generateButton({player:this.player,manager:this.manager,path:this.filePath,idPrefix:this.idPrefix,data:{id:this.idPrefix+"solve-mode-undo-button",type:MathInteractives.global.Theme2.Button.TYPE.FA_ICON,baseClass:"btn-yellow",height:38,tooltipText:this.getMessage("button-tooltip-text","undo"),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE,icon:{faClass:a.filePath.getFontAwesomeClass("reply"),fontColor:"#222222",fontSize:22,fontWeight:"bold",width:35,height:30}}}),this},_createSolveModeResetButton:function(){var a=this;return this.solveModeResetButtonView=new MathInteractives.global.Theme2.Button.generateButton({player:this.player,manager:this.manager,path:this.filePath,idPrefix:this.idPrefix,data:{id:this.idPrefix+"solve-mode-reset-button",type:MathInteractives.global.Theme2.Button.TYPE.FA_ICON,baseClass:"btn-yellow",height:38,tooltipText:this.getMessage("button-tooltip-text","reset"),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE,icon:{faClass:a.filePath.getFontAwesomeClass("reset"),fontColor:"#222222",fontSize:22,fontWeight:"bold",width:35,height:30}}}),this},_createSolveModeViewDataButton:function(){var a,b;a=MathInteractives.global.Theme2.Button,b={idPrefix:this.idPrefix,player:this.player,manager:this.manager,path:this.filePath,data:{id:this.idPrefix+"view-data-button",text:this.getMessage("view-data-button-text",0),type:MathInteractives.global.Theme2.Button.TYPE.TEXT,baseClass:"btn-yellow",textColor:"#222222"}},this.solveModeViewDataButtonView=new a.generateButton(b)},_createBuildModeUndoButton:function(){var a=this;return this.buildModeUndoButtonView=new MathInteractives.global.Theme2.Button.generateButton({player:this.player,manager:this.manager,path:this.filePath,idPrefix:this.idPrefix,data:{id:this.idPrefix+"build-mode-undo-button",type:MathInteractives.global.Theme2.Button.TYPE.FA_ICON,baseClass:"btn-yellow",height:38,tooltipText:this.getMessage("button-tooltip-text","undo"),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE,icon:{faClass:a.filePath.getFontAwesomeClass("reply"),fontColor:"#222222",fontSize:22,fontWeight:"bold",height:30,width:35}}}),this},_createBuildModeResetButton:function(){var a=this;return this.buildModeResetButtonView=new MathInteractives.global.Theme2.Button.generateButton({player:this.player,manager:this.manager,path:this.filePath,idPrefix:this.idPrefix,data:{id:this.idPrefix+"build-mode-reset-button",type:MathInteractives.global.Theme2.Button.TYPE.FA_ICON,baseClass:"btn-yellow",height:38,tooltipText:this.getMessage("button-tooltip-text","reset"),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE,icon:{faClass:a.filePath.getFontAwesomeClass("reset"),fontColor:"#222222",fontSize:22,fontWeight:"bold",width:35,height:30}}}),this},_createEquationManager:function(){var b={allowedOperation:this.model.get("allowedOperation"),maxPrimeLimit:this.model.get("maxPrimeLimit"),allowManagerLevelOperations:4095,player:this.player,filePath:this.filePath,fractionMode:this.model.get("fractionMode"),isParenthesesAllowed:this.model.get("isParenthesesAllowed"),adjustContainment:!0,numOfTilesInNumDen:this.model.get("numOfTilesInNumDen"),mode:c.EquationManager.MODES.SolveMode};this._equationManager=new a.EquationManager({model:new c.EquationManager(b),element:this.$("#"+this.idPrefix+"workspace-scrollable"),draggableContainment:this.$("#"+this.idPrefix+"workspace-draggable-containment"),tutorialMode:!1,player:this.player,filePath:this.filePath,manager:this.manager}),this._isIE&&this._equationManager.$el.addClass("ie"),this._attachDataEvents()},_setNewEquation:function(a,b,c,d,e){var f={};f={cmdFactoryData:{allowedOperation:this.model.get("allowedOperation"),maxPrimeLimit:this.model.get("maxPrimeLimit"),undoStack:[]},equationData:c,equationViewContainer:b},f.player=this.player,f.filePath=this.filePath,f.manager=this.manager,f.idPrefix=this.idPrefix,a.setData(f,e),d&&a.render(),this._enableDisableEquationViewDroppable(a)},_enableDisableEquationViewDroppable:function(a){var b=c.EquationManager.MODES;a.model.get("mode")===b.BuildMode?this.model.get("buildModeDivisionMode")?a.enableDroppableEquationView(!1):a.enableDroppableEquationView(!0):this.model.get("solveModeDivisionMode")?a.enableDroppableEquationView(!1):a.enableDroppableEquationView(!0)},_createAllDraggableTiles:function(){var a=this.model,b=a.get("allowedCases"),c=(a.get("accordionLevel"),MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion);this._$elmStartDropRegionDivisionContainer.hide(),this._$elmStartHorizontalSaperator.hide(),this._generateBaseTiles(),this._generateExponentTiles(),b&c.IS_PARENTHESIS_ALLOWED?(this._generateParanthesesTile(),this.disabledParIndexes=[0,1],this._disableParenthesis(this.disabledParIndexes)):this._$elmParanthesesDispenserContainer.hide(),b&c.IS_DIVISION_ALLOWED&&(this._$elmStartDropRegionDivisionContainer.show(),this._$elmStartHorizontalSaperator.show()),b&c.IS_RAISED_TO_POWER_ALLOWED?this._generateRaisedToPowerToggle():this._$elmToggleBtnContainer.hide()},_generateBaseTiles:function(){var d,e,f,g,h,i,j,k,l=this.idPrefix,m=(this.model,this.model.get("allowedCases")),n=c.TileItem.BinTileType.BASE,o=b.ExponentAccordion;d=a.FormExpression.BASE_TILE_MIN_VALUE,e=a.FormExpression.BASE_TILE_MAX_VALUE,f=this._getArrayInRange(d,e),k=this._getNegationsFromModel(f,this.model.get("isBinBaseNegated")),f=k.newArray,j=k.textForTiles,g=MathInteractives.global.Theme2.Button.COLORTYPE.DRAGGABLE_BLUE,h=i=a.FormExpression.BIN_BASE_TILE_WIDTH_HEIGHT,this._insertTileDivInDOM(a.FormExpression.BASE_TYPE,"#"+l+"base-tile-dispenser",f,g,h,i,n,j),m&o.IS_NEGATIVE_BASES_ALLOWED&&this._attachBaseEvents()},_getNegationsFromModel:function(a,b){var c,d,e=[],f=[];for(c=0;c<a.length;c++)d=a[c]*b[c],e[c]=d,0>d?f[c]='<span class="tile-number"> &minus; '+Math.abs(d)+"</span>":f[c]='<span class="tile-number">'+d+"</span>";return{newArray:e,textForTiles:f}},_generateExponentTiles:function(){var d,e,f,g,h,i,j,k,l=this.idPrefix,m=(this.model,this.model.get("allowedCases")),n=c.TileItem.BinTileType.EXPONENT,o=b.ExponentAccordion;d=a.FormExpression.POSITIVE_EXPONENT_TILE_MIN_VALUE,e=a.FormExpression.POSITIVE_EXPONENT_TILE_MAX_VALUE,f=this._getArrayInRange(d,e),j=this._getNegationsFromModel(f,this.model.get("isBinExpNegated")),f=j.newArray,k=j.textForTiles,g=MathInteractives.global.Theme2.Button.COLORTYPE.DRAGGABLE_GREEN,h=i=a.FormExpression.BIN_EXPONENT_TILE_WIDTH_HEIGHT,this._insertTileDivInDOM(a.FormExpression.EXPONENT_TYPE,"#"+l+"exponents-tile-dispenser",f,g,h,i,n,k),m&o.IS_NEGATIVE_EXPONENTS_ALLOWED&&this._attachExponentEvents()},_generateParanthesesTile:function(){var d,e,f,g,h=this.idPrefix,i=(this.model,c.TileItem.BinTileType.PARENTHESIS);this.model.get("allowedCases"),b.ExponentAccordion;d=[1,-1],f=g=a.FormExpression.BIN_BASE_TILE_WIDTH_HEIGHT,e=MathInteractives.global.Theme2.Button.COLORTYPE.DRAGGABLE_BLACK,this._insertTileDivInDOM(a.FormExpression.PARENTHESIS_TYPE,"#"+h+"parenthesis-tile-dispenser",d,e,f,g,i)},_insertTileDivInDOM:function(a,b,c,d,e,f,g,h){$(MathInteractives.Common.Interactivities.ExponentAccordion.templates.tiles({tiles:c,idPrefix:this.idPrefix,type:a,tileType:g}).trim()).appendTo(self.$(b)),this._convertToDraggables(a,c,d,e,f,h)},_generateRaisedToPowerToggle:function(){var a=MathInteractives.Common.Components.Theme2.Views.ToggleButton,b={path:this.filePath,idPrefix:this.idPrefix,manager:this.manager,player:this.player,id:this.idPrefix+"raised-to-power-toggle-button",baseClass:"toggle-button-class",text:[this.getMessage("toggle-button-state",0),this.getMessage("toggle-button-state",1)],type:a.TYPE.GENERAL,isDraggable:!0,tabIndex:720};this.toggleButtonView=a.generateToggleButton(b),this.loadScreen("toggle-button-screen"),this._attachToggleBtnHandleEvents(),this.model.get("raisedToPower")?(this.toggleButtonView.changeStateOfToggleButton(a.TOGGLEBUTTON_STATE_ON),this.setAccMessage("raised-to-power-toggle-button-toggle-button-containment",this.getAccMessage("toggle-button-text",1))):(this.toggleButtonView.changeStateOfToggleButton(a.TOGGLEBUTTON_STATE_OFF),this.setAccMessage("raised-to-power-toggle-button-toggle-button-containment",this.getAccMessage("toggle-button-text",2)),this._enableDisableToggleButtonState(!1)),this.listenTo(this.toggleButtonView,"changeState",this._changeToggleState)},_attachToggleBtnHandleEvents:function(){var a,b,c=this;a="mouseenter",b="mouseleave",this.toggleButtonView.$el.find(".handle").off(a).on(a,function(){c.toggleButtonView.$el.hasClass("disabled")||$(this).addClass("hover")}),this.toggleButtonView.$el.find(".handle").off(b).on(b,function(){$(this).removeClass("hover")}),MathInteractives.Common.Utilities.Models.Utils.EnableTouch(this.toggleButtonView.$el.find(".handle"))},_convertToDraggables:function(b,c,d,e,f,g){var h,i,j,k,l=this,m=[],n=MathInteractives.Common.Components.Models.DragDrop,o=MathInteractives.global.Theme2.Button.TYPE.DRAGGABLE_TILE,p={player:this.player,manager:this.manager,filePath:this.filePath,idPrefix:this.idPrefix};"exponent"===b?o.fontSize=14:o.fontSize=20,n.SETUP_SCOPE(this.idPrefix,this.manager,this.player),$.each(c,function(a,k){"base"===b||"exponent"===b?(h=l.idPrefix+b+"-tile-value"+k,j=g[a]):"parenthesis"===b&&(h=l.idPrefix+b+"-tile-value"+c[a],j=1===c[a]?"( )":"&minus;( )"),i={id:h,type:o,colorType:d,text:j,height:e,width:f,helper:"clone",containment:l.$(".bin-tile-containment"),options:{revert:function(a){return this.data("isDropped")?!1:(l.stopEvent=!1,l.animationStart(),!0)}}},m.push(i)}),p.tileData=m,k=[],k.push({containerId:this.idPrefix+"dummy-droppable",width:0,height:0,color:"none",boxShadowColor:"none",borderColor:"none",preventDefaultFunctionality:!0,options:{}}),p.dropSlotData=k,"base"===b?(this.baseTilesViews=MathInteractives.global.Theme2.DragDropTile.generateDragDropTile(p),this.baseTilesViews.addOptionsForDraggable({cursorAt:{left:a.FormExpression.BIN_BASE_TILE_WIDTH_HEIGHT/2,top:a.FormExpression.BIN_BASE_TILE_WIDTH_HEIGHT/2},distance:10}),this._attachBinBaseTileListeners()):"exponent"===b?(this.exponentTilesViews=MathInteractives.global.Theme2.DragDropTile.generateDragDropTile(p),this.exponentTilesViews.addOptionsForDraggable({cursorAt:{left:a.FormExpression.BIN_EXPONENT_TILE_WIDTH_HEIGHT/2,top:a.FormExpression.BIN_EXPONENT_TILE_WIDTH_HEIGHT/2},distance:10}),this._attachBinExponentTileListeners()):(this.parenthesisTilesViews=MathInteractives.global.Theme2.DragDropTile.generateDragDropTile(p),this.parenthesisTilesViews.addOptionsForDraggable({cursorAt:{left:a.FormExpression.BIN_BASE_TILE_WIDTH_HEIGHT/2,top:a.FormExpression.BIN_BASE_TILE_WIDTH_HEIGHT/2},distance:10}),this._attachBinParenthesisTileListeners())},_maxBasesAllowedTooltip:function(){var a=this;if(null===this.maxBasesAllowedTooltip){var b={elementEl:this.idPrefix+"droppable-region",idPrefix:this.idPrefix,manager:this.manager,_player:this.player,type:MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.FORM_VALIDATION,arrowType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.BOTTOM_MIDDLE,path:this.filePath,filePath:this.filePath,isTts:!1,isArrow:!1,closeOnDocumentClick:!0,baseClass:"build-mode-inline-feedback"},a=this;b.text='<div id="'+this.idPrefix+'build-text-in-tooltip" class="text-in-tooltip"></div><div id="'+this.idPrefix+'build-close-btn-in-tooltip" class="close-btn-in-tooltip"></div>',this.maxBasesAllowedTooltip=MathInteractives.global.Theme2.Tooltip.generateTooltip(b),this._attachTooltipEvents(),this.closeBtnView=new MathInteractives.global.Theme2.Button.generateButton({player:this.player,manager:this.manager,path:this.filePath,idPrefix:this.idPrefix,data:{id:this.idPrefix+"build-close-btn-in-tooltip",type:MathInteractives.global.Theme2.Button.TYPE.FA_ICON,height:17,baseClass:"close-btn-base-class",tooltipText:this.getMessage("button-tooltip-text","close"),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE,icon:{faClass:a.filePath.getFontAwesomeClass("close"),fontColor:"#744b11"}}}),this.closeBtnView.$el.off("click").on("click",function(){a.maxBasesAllowedTooltip.hideTooltip()}),this.closeBtnView.$el.off("keydown").on("keydown",function(b){var c=b.keyCode?b.keyCode:b.charCode;32===c&&setTimeout(function(){a.setFocus("droppable-region")},5)}),this._attachCloseButtonEvents(this.closeBtnView.$el)}},_attachCloseButtonEvents:function(a){var b,c,d=a.find(".fa-times");b="mouseenter",c="mouseleave",a.on(b,function(){d.css({color:"#a46409"})}),a.on(c,function(){d.css({color:"#744b11"})}),a.on("mousedown",function(){d.css({color:"#5b3601"})}),a.on("mouseup",function(){d.css({color:"#744b11"})}),MathInteractives.Common.Utilities.Models.Utils.EnableTouch(a)},_setMaxBasesTooltipText:function(){var a=this.model.get("accordionLevel");switch(a){case 1:case 2:return{loc:this.getMessage("max-bases-allowed-tooltip-text",1),acc:this.getAccMessage("max-bases-allowed-tooltip-text",1)};case 3:case 4:case 5:return this.model.get("buildModeDivisionMode")?{loc:this.getMessage("max-bases-allowed-tooltip-text",2),acc:this.getAccMessage("max-bases-allowed-tooltip-text",2)}:{loc:this.getMessage("max-bases-allowed-tooltip-text",1),acc:this.getAccMessage("max-bases-allowed-tooltip-text",1)}}},_setUniqueBaseLimitReachedText:function(){return{loc:this.getMessage("max-bases-allowed-tooltip-text",4),acc:this.getAccMessage("max-bases-allowed-tooltip-text",4)}},_nestedParenthesisNotAllowedText:function(){return{loc:this.getMessage("max-bases-allowed-tooltip-text",5),acc:this.getAccMessage("max-bases-allowed-tooltip-text",5)}},_maxNoOfParenthesisAllowedText:function(){return{loc:this.getMessage("max-bases-allowed-tooltip-text",7),acc:this.getAccMessage("max-bases-allowed-tooltip-text",7)}},_exponentOutOfRangeText:function(){return this.getMessage("error-tooltip-text",1)},_maxLimitCrossedTooltipText:function(){return this.getMessage("combine-like-bases-tooltip-text",0)},_invalidCombineWithinSameParentText:function(){var a=this.model.get("accordionLevel");return a>3?this.getMessage("combine-like-bases-tooltip-text",3):this.getMessage("combine-like-bases-tooltip-text",2)},_invalidCombineWithinDiffParentText:function(){return this.getMessage("combine-like-bases-tooltip-text",1)},_invalidCombineForTileValueExceedingText:function(){return this.getMessage("combine-like-bases-tooltip-text",4)},_invalidCombineForBaseValueExceedingText:function(){return this.getMessage("combine-like-bases-tooltip-text",5)},_invalidCombineForMarquee:function(){return this.getMessage("combine-like-bases-tooltip-text",6)},_maxNoOfTermsInsideParenthesisText:function(){return{loc:this.getMessage("max-bases-allowed-tooltip-text",6),acc:this.getAccMessage("max-bases-allowed-tooltip-text",6)}},_getExponentTooltipHtml:function(){var a=$("<div></div>").attr({id:this.idPrefix+"exponent-tooltip-buttons-container","class":"exponent-tooltip-buttons-container"});$("<div></div>").attr({id:this.idPrefix+"apply-exponent-button","class":"apply-exponent-button"}).appendTo(a),$("<div></div>").attr({id:this.idPrefix+"change-sign-button","class":"change-sign-button"}).appendTo(a);return a},_generateButtonsInsideTooltip:function(){var a,b;a=MathInteractives.global.Theme2.Button,b={idPrefix:this.idPrefix,player:this.player,manager:this.manager,path:this.filePath,data:{id:this.idPrefix+"apply-exponent-button",text:"Apply Exponent",type:MathInteractives.global.Theme2.Button.TYPE.TEXT,baseClass:"white-button",textColor:"#007ebf"}},this.applyExponentBtnView=new a.generateButton(b),b.data.id=this.idPrefix+"change-sign-button",b.data.text="Change Sign",b.data.width=173,this.changeSignBtnView=new a.generateButton(b)},_renderOriginalExpression:function(){var a=this._getOriginalExpression(),b=(this.model.get("raisedToPower"),this.$(".original-expression-holder").html(a)),c=this.filePath,d=c.getFontAwesomeClass("dot");b.find(".operator-data-tab div").addClass(d),b.find(".denominator").hasClass("denominator-empty")&&b.find(".vincullum").hide()},_getOriginalExpression:function(){var a=$.extend(!0,{},this.model.get("equationData"));return this._getExpression(a.tileArray,a.type,"")},_getExpression:function(a,b){var c=0,d="";if("EQUATION_COMPONENT"===b){for(d+="<div class='header-expression-container'><div class='header-expression'>";c<a.length;c++)d+=this._getExpression(a[c],a[c].type);return d+="</div></div>"}if("FRACTION"===b){var e,f,g,h=!0,i=!0;for(e="<div class='fraction-data-tab'><div class='numerator'>",d+=e;c<a.tileArray.length;c++)a.tileArray[c].bDenominator||(d+=this._getExpression(a.tileArray[c],a.tileArray[c].type),i=!1);for(i===!0&&(d=d.replace(e,"<div class='fraction-data-tab'><div class='numerator numerator-empty'>1")),d+="</div><div class='vincullum'></div>",f="<div class='denominator'>",d+=f,c=0;c<a.tileArray.length;c++)a.tileArray[c].bDenominator&&(d+=this._getExpression(a.tileArray[c],a.tileArray[c].type),h=!1);return h===!0&&(d=d.replace(f,"<div class='denominator denominator-empty'>")),d+="</div></div>"}if("PARENTHESIS"===b){for(a.operator&&(d+="<div class='operator-data-tab'><div></div></div>"),a.exponent<0&&(a.exponent='<span class="minus-sign-exponent">&minus;</span>'+Math.abs(a.exponent)),d+="<span><span>(</span>";c<a.tileArray.length;c++)d+=this._getExpression(a.tileArray[c],a.tileArray[c].type);return d+="<span>)</span>",d+="<div class='parenthesis-exponent-data-tab exponent-data-tab'>"+a.exponent+"</div></span>"}if("BIG_PARENTHESIS"===b){for(d+="<span class='big-parenthesis-container'><span class='open-parenthesis-data-tab'></span>",a.exponent<0&&(a.exponent='<span class="minus-sign-exponent minus-sign-exponent-big-parenthesis">&minus;</span>'+Math.abs(a.exponent));c<a.tileArray.length;c++)d+=this._getExpression(a.tileArray[c],a.tileArray[c].type);return d+="<span class='big-parenthesis-close-container'><span class='close-parenthesis-data-tab'></span>",d+="<div class='big-parenthesis-exponent-data-tab'>"+a.exponent+"</div></span></span>",d=d.replace("<div class='fraction-data-tab'><div class='numerator'>","<div class='fraction-data-tab adjust-bottom'><div class='numerator'>")}if("BASE_EXPONENT"===b)return a.base<0&&(g='<span class="minus-sign-base">&minus;</span>'+Math.abs(a.base)),a.exponent<0&&(a.exponent='<span class="minus-sign-exponent">&minus;</span>'+Math.abs(a.exponent)),a.operator&&(d+="<div class='operator-data-tab'><div></div></div>"),d+=a.base<0?"<span class='base-exp-data-tab'>("+g+")<div class='exponent-data-tab'>"+a.exponent+"</div></span>":"<span class='base-exp-data-tab'>"+a.base+"<div class='exponent-data-tab'>"+a.exponent+"</div></span>";if("BASE_ONLY"===b){var j=a.base;return 0>j&&(a.base='<span class="minus-sign-base">&minus;</span>'+Math.abs(j)),a.operator&&(d+="<div class='operator-data-tab'><div></div></div>"),d+=0>j?"<span class='base-exp-data-tab'>("+a.base+")</span>":"<span class='base-exp-data-tab'>"+a.base+"</span>"}},_combineLikeBasesTooltip:function(){if(null===this.combineLikeBasesTooltip){var a={elementEl:this.idPrefix+"inline-feedback-container",idPrefix:this.idPrefix,manager:this.manager,_player:this.player,type:MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.FORM_VALIDATION,arrowType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.BOTTOM_MIDDLE,path:this.filePath,filePath:this.filePath,isTts:!1,isArrow:!1,closeOnDocumentClick:!0},b=this;a.text='<div id="'+this.idPrefix+'solve-text-in-tooltip" class="text-in-tooltip"></div><div id="'+this.idPrefix+'solve-close-btn-in-like-bases-tooltip" class="close-btn-in-tooltip"></div>',this.combineLikeBasesTooltip=MathInteractives.global.Theme2.Tooltip.generateTooltip(a),this.closeBtnViewCombineBasesTooltip=new MathInteractives.global.Theme2.Button.generateButton({player:this.player,manager:this.manager,path:this.filePath,idPrefix:this.idPrefix,data:{id:this.idPrefix+"solve-close-btn-in-like-bases-tooltip",type:MathInteractives.global.Theme2.Button.TYPE.FA_ICON,baseClass:"close-btn-base-class",height:17,tooltipText:this.getMessage("button-tooltip-text","close"),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE,icon:{faClass:b.filePath.getFontAwesomeClass("close"),fontColor:"#744b11"}}}),this.closeBtnViewCombineBasesTooltip.$el.on("click",function(a){b._hideCombineLikeBasesTooltip()}),this.closeBtnViewCombineBasesTooltip.$el.off("keydown").on("keydown",function(a){var c=a.keyCode?a.keyCode:a.charCode;32===c&&setTimeout(function(){b.setFocus("workspace-scrollable")},5)}),this._attachCloseButtonEvents(this.closeBtnViewCombineBasesTooltip.$el)}},_bindAccEvents:function(){var a=this,b=this.model.get("accordionLevel");if(this._enableDisableTabsOfBinTiles("base",!1),this._enableDisableTabsOfBinTiles("exponent",!1),this._enableDisableTabsOfBinTiles("parenthesis",!1),this.$(".base-tile-dispenser-container").off("keydown").on("keydown",function(b){var c=b.keyCode?b.keyCode:b.charCode,d=a._formEquationManager.getBaseArray();27===c&&a.setFocus("base-tile-dispenser-container"),$(b.target).parent().hasClass("base-tile-dispenser-container")!==!1&&32===c&&(b.preventDefault(),a.$el.trigger("mousedown").trigger("mouseup").trigger("click"),a._enableDisableTabsOfBinTiles("base",!0,d),a.spaceRegistered=!0)}),this.$(".exponents-tile-dispenser-container").off("keydown").on("keydown",function(b){var c=b.keyCode?b.keyCode:b.charCode;27===c&&a.setFocus("exponents-tile-dispenser-container"),$(b.target).parent().hasClass("exponents-tile-dispenser-container")!==!1&&32===c&&(b.preventDefault(),a.$el.trigger("mousedown").trigger("mouseup").trigger("click"),a._enableDisableTabsOfBinTiles("exponent",!0),a.setFocus("exponent-tile-value1"),a.spaceRegistered=!0)}),this.$(".parenthesis-tile-dispenser-container").off("keydown").on("keydown",function(b){var c=b.keyCode?b.keyCode:b.charCode;27===c&&a.setFocus("parenthesis-tile-dispenser-container"),$(b.target).parent().hasClass("parenthesis-tile-dispenser-container")!==!1&&32===c&&(b.preventDefault(),a.$el.trigger("mousedown").trigger("mouseup").trigger("click"),a._enableDisableTabsOfBinTiles("parenthesis",!0,a.disabledParIndexes),a.spaceRegistered=!0)}),this.$(".multiplication-img, .division-numerator, .division-denominator").off("keydown").on("keydown",function(b){var c,d=$(b.currentTarget),e=b.keyCode?b.keyCode:b.charCode,f=a.selectedTile;a.model.get("accordionLevel");32===e?(b.preventDefault(),d.hasClass("multiplication-img")?(c=a._$elmStartDropRegionMultiplication,a._onTileDropForAcc(b,null,c,!1,"0",f)):d.hasClass("division-numerator")?(c=a._$elmStartDropRegionMultiplication,a._onTileDropForAcc(b,null,c,!0,"0.0",f)):d.hasClass("division-denominator")&&(c=a._$elmStartDropRegionMultiplication,a._onTileDropForAcc(b,null,c,!0,"0.1",f)),a.selectedTile=null,a._formEquationManager.selectedTile=null):27===e&&(a.setFocus(a.selectedTile.attr("id").replace(a.idPrefix,"")),a.selectedTile=null,a._formEquationManager.selectedTile=null)}),this.focusOut("base-tile-dispenser-container",function(){return a.spaceRegistered?void(a.spaceRegistered=!1):void a._enableDisableTabsOfBinTiles("base",!1)}),this.focusOut("exponents-tile-dispenser-container",function(){return a.spaceRegistered?void(a.spaceRegistered=!1):void a._enableDisableTabsOfBinTiles("exponent",!1)}),this.focusOut("parenthesis-tile-dispenser-container",function(){return a.spaceRegistered?void(a.spaceRegistered=!1):void a._enableDisableTabsOfBinTiles("parenthesis",!1)}),this.focusIn("base-tile-dispenser-container",function(){a._enableDisableTabsOfBinTiles("base",!1),a._disableDroppables()}),this.focusIn("exponents-tile-dispenser-container",function(){a._enableDisableTabsOfBinTiles("base",!1),a._enableDisableTabsOfBinTiles("exponent",!1),a._disableDroppables()}),this.focusIn("parenthesis-tile-dispenser-container",function(){a._enableDisableTabsOfBinTiles("exponent",!1),a._enableDisableTabsOfBinTiles("parenthesis",!1),a._disableDroppables()}),this.focusIn("random-expression-button",function(){a._enableDisableTabsOfBinTiles("parenthesis",!1)}),this.focusIn("raised-to-power-toggle-button-toggle-button-containment",function(){a._enableDisableTabsOfBinTiles("parenthesis",!1)}),this.focusIn("save-btn",function(){a._enableDisableTabsOfBinTiles("exponent",!1),a._enableDisableTabsOfBinTiles("parenthesis",!1)}),this.$(".base-draggable-tiles, .exponent-draggable-tiles, .parenthesis-draggable-tiles").off("focusin").on("focusin",function(){a._disableDroppables()}),this.focusIn("droppable-region",function(b){a._formEquationManager.equationView.buildStartAcc()}),this.focusIn("workspace-scrollable",function(b){a._equationManager.equationView.startAcc()}),4>=b){var c;c=1===b?".base-draggable-tiles, .exponent-draggable-tiles":".exponent-draggable-tiles",this.$(c).off("keydown").on("keydown",function(b){var c=$(b.currentTarget),d=b.keyCode?b.keyCode:b.charCode;32===d&&(b.preventDefault(),a.selectedTile=c,a._formEquationManager.selectedTile=c,"none"!==a._formEquationManager.$el.css("display")?a._setFocusToNumerator():a._enableDroppables(c))})}this.$(".parenthesis-draggable-tiles").off("keydown").on("keydown",function(b){var c=$(b.currentTarget),d=b.keyCode?b.keyCode:b.charCode;32===d&&(b.preventDefault(),a.selectedTile=c,a._formEquationManager.selectedTile=c,a._setFocusToNumerator())}),this.$(".solve-mode-undo-button").off("keydown").on("keydown",function(b){a._setFocusToWorkspaceScrollable(b)}),this.$(".raised-to-power-toggle-button").off("keydown").on("keydown",function(b){window.setTimeout(function(){a._setFocusToDroppableRegion(b)},500)}),this.$(".random-expression-button").off("keydown").on("keydown",function(b){a._setFocusToDroppableRegion(b)})},_setFocusToWorkspaceScrollable:function(a){var b=a.keyCode?a.keyCode:a.charCode,c=this;32===b&&setTimeout(function(){c.setFocus("workspace-scrollable")},5)},_setFocusToDroppableRegion:function(a){var b=a.keyCode?a.keyCode:a.charCode,c=this;32===b&&setTimeout(function(){c.setFocus("droppable-region")},5)},_enableDisableTabsOfBinTiles:function(a,b,c){var d=0;if("base"===a){var e=this.baseTilesViews.dragButtonViews;if(void 0===c||0===c.length){for(;d<e.length;d++)this.enableTab(e[d].$el.attr("id").replace(this.idPrefix,""),b);b&&this.setFocus(e[0].$el.attr("id").replace(this.idPrefix,""))}else{for(;d<c.length;d++)e[Math.abs(c[d])-2].$el.attr("data-tilevalue")!==c[d]&&this.enableTab(e[Math.abs(c[d])-2].$el.attr("id").replace(this.idPrefix,""),b);b&&this.setFocus(e[Math.abs(c[0])-2].$el.attr("id").replace(this.idPrefix,""))}}else if("exponent"===a)for(var f=this.exponentTilesViews.dragButtonViews;d<f.length;d++)this.enableTab(f[d].$el.attr("id").replace(this.idPrefix,""),b);else if("parenthesis"===a&&null!==this.parenthesisTilesViews){var g,h=this.parenthesisTilesViews.dragButtonViews;if(void 0===c||0===c.length){for(;d<h.length;d++)this.enableTab(h[d].$el.attr("id").replace(this.idPrefix,""),b);b&&this.setFocus(h[0].$el.attr("id").replace(this.idPrefix,""))}else{for(;d<c.length;d++)this.enableTab(h[c[d]].$el.attr("id").replace(this.idPrefix,""),!b);b&&1===c.length&&(g=c[0],g=1===g?0:1,this.setFocus(h[g].$el.attr("id").replace(this.idPrefix,"")))}}},_updateContextMenu:function(){var b=this.model.get("accordionLevel"),c=this.model.get("buildModeDivisionMode"),d=this.model.get("tileDropped"),e=this.model.get("raisedToPower"),f=a.FormExpression.BASE_CTX_ITEM_ID,g=a.FormExpression.EXP_CTX_ITEM_ID,h=a.FormExpression.PARENS_CTX_ITEM_ID,i=[],j=[],k=[],l=this;this.ignoreAllCtxRows(),b>=1&&(!c&&d?(i.push(f.ADD_MUL),j.push(g.ADD_MUL),k.push(h.ADD_EXPR)):c&&d?(k.push(h.ADD_NUM),k.push(h.ADD_DEN)):(i.push(f.ADD_MUL),j.push(g.ADD_MUL),k.push(h.ADD_EXPR),k.push(h.ADD_NUM),k.push(h.ADD_DEN))),b>=2&&i.push(f.CHANGE_SIGN),b>=3&&c&&(i.push(f.ADD_NUM_DIV),j.push(g.ADD_NUM_DIV),i.push(f.ADD_DEN_DIV),j.push(g.ADD_DEN_DIV)),b>=5&&(j.push(g.CHANGE_SIGN),e&&j.push(g.RAISE_TO_FRACTION)),i=_.map(i,function(a,b){return l.idPrefix+a}),this.binBaseTilesContextMenuView.editContextMenu(i,!1),j=_.map(j,function(a,b){return l.idPrefix+a}),this.binExponentTilesContextMenuView.editContextMenu(j,!1),k=_.map(k,function(a,b){return l.idPrefix+a}),this.binParenthesisTilesContextMenuView.editContextMenu(k,!1)},ignoreAllCtxRows:function(){var b=a.FormExpression.BASE_CTX_ITEM_ID,c=a.FormExpression.EXP_CTX_ITEM_ID,d=a.FormExpression.PARENS_CTX_ITEM_ID,e=[],f=this;e=_.map(b,function(a,b,c){return f.idPrefix+a}),this.binBaseTilesContextMenuView.editContextMenu(e,!0),e=[],e=_.map(c,function(a,b,c){return f.idPrefix+a}),this.binExponentTilesContextMenuView.editContextMenu(e,!0),e=[],e=_.map(d,function(a,b,c){return f.idPrefix+a}),this.binParenthesisTilesContextMenuView.editContextMenu(e,!0)},_bindEventsOnButtons:function(){var a=this;this.randomExpressionBtnView.$el.off("click").on("click",function(b){$(this).hasClass("clickEnabled")&&a._randomExpressionButtonClick(b)}),this.doneButtonView.$el.off("click").on("click",function(b){$(this).hasClass("clickEnabled")&&a._doneButtonClick(b)}),this.solveModeUndoButtonView.$el.off("click").on("click",function(b){$(this).hasClass("clickEnabled")&&a._solveModeUndoBtnClick(b)}),this.buildModeUndoButtonView.$el.off("click").on("click",function(b){$(this).hasClass("clickEnabled")&&a._buildModeUndoClickHandler(b)}),this.solveModeViewDataButtonView.$el.off("click").on("click",function(b){$(this).hasClass("clickEnabled")&&a._onClickViewData(b)}),this.buildModeResetButtonView.$el.off("click").on("click",function(b){$(this).hasClass("clickEnabled")&&a._onClickBuildModeResetButton(b)}),this.solveModeResetButtonView.$el.off("click").on("click",function(b){$(this).hasClass("clickEnabled")&&a._solveModeResetButtonClick(b)}),this.$el.off("mousedown").on("mousedown",function(b){a.onMouseDown(b)}),this.$(".animation-progress-div").off("mousedown").on("mousedown",function(b){a._stopPropagationOnAnimation(b)})},_attachBaseEvents:function(){this._attachNegateTileEvents(".base-draggable-tiles.clickEnabled")},_attachExponentEvents:function(){this._attachNegateTileEvents(".exponent-draggable-tiles")},_negateParenthesis:function(){this._attachNegateTileEvents(".parenthesis-draggable-tiles")},_attachNegateTileEvents:function(a){var b=this,c=this.model.get("accordionLevel");this.$(a).off("click.bintiles").on("click.bintiles",function(a,d){if(!b.isAnimationRunning){var e=$(this);!MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile&&a.which||d&&d.isTutorialUndoTrigger?b._tileClickEvent(b,e):MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile?b._tileClickEvent(b,e):(b.selectedTile=e,b._formEquationManager.selectedTile=e,"none"!==b._formEquationManager.$el.css("display")?b.model.get("raisedToPower")&&5===c&&"EXPONENT"===e.attr("data-tiletype")?b._setFocusToExponentBigParenthesis(e):b._setFocusToNumerator():b._enableDroppables(e))}
})},_setFocusToExponentBigParenthesis:function(a){var b=!1;(a===!0||"EXPONENT"===a.attr("data-tiletype"))&&(b=!0),this._formEquationManager.setFocusToExponentBigParenthesis("0",b)},_setFocusToNumerator:function(){var a,b=this.model.get("buildModeDivisionMode"),c=this.model.get("raisedToPower"),d=!1;b&&c?a="0.0":b?a="0":(a="0",d=!0),this._formEquationManager.setFocusToNumerator(a,d)},_dropBinTileUsingContextMenu:function(a,b){var c,d=this.model.get("buildModeDivisionMode"),e=this.model.get("raisedToPower"),f=!1;b?c="0":d&&e?c="0.0":d?c="0":(c="0",f=!0),this._formEquationManager.dropBinTileUsingContextMenu(c,f,a,b)},_enableDroppables:function(a){var b=a.attr("id").replace(this.idPrefix,""),c=this.getTabIndex(b);this.setTabIndex("multiplication-img",c+2),this.setTabIndex("division-numerator",c+4),this.setTabIndex("division-denominator",c+6),this.setFocus("multiplication-img")},_disableDroppables:function(){this.enableTab("multiplication-img",!1),this.enableTab("division-numerator",!1),this.enableTab("division-denominator",!1)},_activateClickEventsOnTiles:function(){var a=this.model.get("allowedCases"),b=MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion;a&b.IS_NEGATIVE_BASES_ALLOWED&&this._attachNegateTileEvents(".base-draggable-tiles"),a&b.IS_NEGATIVE_EXPONENTS_ALLOWED&&this._attachNegateTileEvents(".exponent-draggable-tiles")},_attachTooltipEvents:function(){var a=MathInteractives.Common.Components.Theme2.Views.Tooltip.EVENTS,b=d.Marquee.EVENTS;this.listenTo(this.maxBasesAllowedTooltip,a.TOOLTIP_HIDE_ON_CLOSEBTN_CLICK,this._removeMarqueeOnTooltipClick),this.listenTo(this._formEquationManager.marqueeView,b.MARQUEE_MOUSEDOWN,this._hideTooltip),this.maxBasesAllowedTooltip.$el.on("mousedown",$.proxy(this._removeMarqueeOnTooltipClick,this))},_detachNegateTileEvents:function(a){this.$(a).off("click")},_tileClickEvent:function(a,b){var c,d=b,e=-1*parseInt(d.attr("data-tilevalue"),10),f=d.find(".custom-btn-text"),g=this;return d.hasClass("disabled")||this.stopEvent===!0?void(this.stopEvent=!1):(this.model.set("tryAnotherBtnStatus",!0),c=e>0?'<span class="tile-number">'+e+"</span>":'<span class="tile-number">&minus;'+Math.abs(e)+"</span>",f.html(c),d.attr("data-tilevalue",e),d.addClass("animated fadeIn"),this.animationStart(),this.isAnimationRunning=!0,d.off("webkitAnimationEnd oanimationend msAnimationEnd animationend MSAnimationEnd"),this._updateTileValueInModel(d,e),void(this._isIE9?(d.removeClass("animated fadeIn"),g.animationEnd(),g.isAnimationRunning=!1):d.one("webkitAnimationEnd oanimationend msAnimationEnd animationend MSAnimationEnd",function(){d.removeClass("animated fadeIn"),g.animationEnd(),g.isAnimationRunning=!1})))},_updateTileValueInModel:function(a,b){var d,e=a.data("tiletype"),f=c.TileItem.BinTileType,b=parseInt(a.attr("data-tilevalue"),10);e===f.BASE?(d=this.model.get("isBinBaseNegated"),d[Math.abs(b)-2]*=-1,this.model.set("isBinBaseNegated",d),b>0?this.setAccMessage("base-tile-value"+b,this.getAccMessage("base-tile-value"+b,0)):this.setAccMessage("base-tile-value"+Math.abs(b),this.getAccMessage("extra-messages",4)+" "+this.getAccMessage("base-tile-value"+Math.abs(b),0))):e===f.EXPONENT&&(d=this.model.get("isBinExpNegated"),d[Math.abs(b)-1]*=-1,this.model.set("isBinExpNegated",d),b>0?this.setAccMessage("exponent-tile-value"+b,this.getAccMessage("exponent-tile-value"+b,0)):this.setAccMessage("exponent-tile-value"+Math.abs(b),this.getAccMessage("extra-messages",4)+" "+this.getAccMessage("exponent-tile-value"+Math.abs(b),0)))},_attachBinBaseTileListeners:function(){var a,b=MathInteractives.Common.Components.Models.DragDrop.EVENTS.DRAG,c=this.baseTilesViews.getDragModelArr();for(a=0;a<c.length;a++)this.listenTo(c[a],b.START,$.proxy(this._onBinTileDragStart,this)),this.listenTo(c[a],b.DRAG,$.proxy(this._onBinTileDragging,this)),this.listenTo(c[a],b.STOP,$.proxy(this._onBinTileDragStop,this)),this.applyHandCursor(this.baseTilesViews.dragButtonViews[a].$el)},_attachBinExponentTileListeners:function(){var a,b=MathInteractives.Common.Components.Models.DragDrop.EVENTS.DRAG,c=this.exponentTilesViews.getDragModelArr();for(a=0;a<c.length;a++)this.listenTo(c[a],b.START,$.proxy(this._onBinTileDragStart,this)),this.listenTo(c[a],b.DRAG,$.proxy(this._onBinTileDragging,this)),this.listenTo(c[a],b.STOP,$.proxy(this._onBinTileDragStop,this)),this.applyHandCursor(this.exponentTilesViews.dragButtonViews[a].$el)},_attachBinParenthesisTileListeners:function(){var a,b=MathInteractives.Common.Components.Models.DragDrop.EVENTS.DRAG,c=this.parenthesisTilesViews.getDragModelArr();for(a=0;a<c.length;a++)this.listenTo(c[a],b.START,$.proxy(this._onBinTileDragStart,this)),this.listenTo(c[a],b.DRAG,$.proxy(this._onBinTileDragging,this)),this.listenTo(c[a],b.STOP,$.proxy(this._onBinTileDragStop,this)),this.applyHandCursor(this.parenthesisTilesViews.dragButtonViews[a].$el)},_onBinTileDragStart:function(a){this.deActivateClickEventsOnTiles(),this.stopReading();var b=a.$element,d=b.data("tiletype"),e=c.TileItem.BinTileType,f=$(a.ui.helper);d!==e.PARENTHESIS&&(this._formEquationManager.removeMarquee(),this._isTouch&&(this.stopEvent=!0)),b.removeData("isDropped"),f.addClass("bin-tiles-dragging-ui")},_onBinTileDragging:function(a){var b=a.$element,c=b.data("cur-droppable");c&&c.onMouseOver(a.originalEvent,a.ui)},_onBinTileDragStop:function(a){this._activateClickEventsOnTiles();var d=a.ui,e=a.$element,f=e.data("tiletype"),g=c.TileItem.BinTileType,h=this.model.get("allowedCases"),i=b.ExponentAccordion;this._formEquationManager&&(this._formEquationManager.setIsDropped(!1),this._formEquationManager.refresh()),f!==g.BASE||h&i.IS_NEGATIVE_BASES_ALLOWED?f!==g.EXPONENT||h&i.IS_NEGATIVE_EXPONENTS_ALLOWED||(this.stopEvent=!1):this.stopEvent=!1,d.helper.removeData("cur-droppable"),e.removeData("isDropped"),this.animationEnd()},_onClickViewData:function(){this.stopReading(),this.model.set("viewDataBtnClick",!0),this.player.switchToTab(3)},_onClickBuildModeResetButton:function(){this.stopReading(),this._showResetPopup()},_showResetPopup:function(){var a=this;this.isPopupExist||(this.resetPopupView=MathInteractives.global.Theme2.PopUpBox.createPopup({text:this.getMessage("reset-popup","text"),accText:this.getAccMessage("reset-popup","text"),title:this.getMessage("reset-popup","title"),manager:this.manager,player:this.player,path:this.filePath,idPrefix:this.idPrefix,type:MathInteractives.global.Theme2.PopUpBox.CONFIRM,buttons:[{id:"yes-btn",text:this.getMessage("reset-popup","yes"),response:{isPositive:!0,buttonClicked:this.idPrefix+"yes-btn"},clickCallBack:{fnc:this._resetScreen,scope:this}},{id:"cancel-btn",text:this.getMessage("reset-popup","cancel"),response:{isPositive:!1,buttonClicked:this.idPrefix+"cancel-btn"},clickCallBack:{fnc:this._onClickCancelOfResetInBuildMode,scope:this}}]}),this.resetPopupView.$("#"+this.idPrefix+"yes-btn").off("keydown").on("keydown",function(b){var c=b.keyCode?b.keyCode:b.charCode;if(32===c){var d=a.model.get("exploreView"),e=MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion;d===e.EXPLORE_VIEW.FORMATION?setTimeout(function(){a.setFocus("droppable-region")},5):d===e.EXPLORE_VIEW.WORKSPACE&&setTimeout(function(){a.setFocus("workspace-scrollable")},5)}}),this.isPopupExist=!0)},_resetScreen:function(){this.isPopupExist=!1;var a=this.model.get("exploreView"),b=MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion;a===b.EXPLORE_VIEW.FORMATION?this._resetBuildModeScreen():a===b.EXPLORE_VIEW.WORKSPACE&&this._resetSolveModeScreen()},_resetBuildModeScreen:function(){var a=this._getResetJson(),b=(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED,MathInteractives.Common.Components.Theme2.Views.ToggleButton),c=this.model.get("raisedToPower");this.resetClicked=!0,this._setNewEquation(this._formEquationManager,this.$("#"+this.idPrefix+"form-expression-area"),JSON.parse(JSON.stringify(a)),!0,!1),this._enableDisableAllBinTiles(!0),this._disableEnableButtons(this.buildModeUndoButtonView,!1),this._disableEnableButtons(this.buildModeResetButtonView,!1),this._resetAllBinTiles(),c===!0?(this.toggleButtonView.changeStateOfToggleButton(b.TOGGLEBUTTON_STATE_ON),this.model.set("raisedToPower",!0)):null!==this.toggleButtonView&&(this.toggleButtonView.changeStateOfToggleButton(b.TOGGLEBUTTON_STATE_OFF),this.model.set("raisedToPower",!1),this.model.get("buildModeDivisionMode")===!1&&this._enableDisableToggleButtonState(!1)),this._formEquationManager.resetTileCounters(),this._formEquationManager.getEquationStatusModifyBin(),this.resetClicked=!1,this.model.set("tileDropped",!1),this.model.set("randomExprButtonClick",!1),this._formEquationManager.equationView.tileDroppedString=this.getMessage("base-exp-pair",23)},_resetSolveModeScreen:function(){null===this._equationManager&&this._createEquationManager(),this._setNewEquation(this._equationManager,this.$("#"+this.idPrefix+"workspace-expression-area"),this.model.get("equationData"),!0,!0),this._resetAccordionData(),this.animationEnd()},_getResetJson:function(){var a,b=c.TileItem.BinTileType;return a=this.model.get("raisedToPower")===!0?{tileArray:[{bDenominator:!1,base:null,exponent:null,operator:null,tileArray:[{tileArray:[{type:"BASE_EXPONENT",base:null,bDenominator:!1,exponent:null},{type:"BASE_EXPONENT",base:null,exponent:null,bDenominator:!0}],type:"FRACTION",bDenominator:!1}],type:"BIG_PARENTHESIS"}],type:"EQUATION_COMPONENT",bDenominator:!1}:this.model.get("buildModeDivisionMode")?{tileArray:[{tileArray:[{base:null,exponent:null,type:b.BASE_EXPONENT},{base:null,exponent:null,bDenominator:!0,type:b.BASE_EXPONENT}],type:b.FRACTION}],type:"EQUATION_COMPONENT",bDenominator:!1}:{tileArray:[{base:null,exponent:null,type:b.BASE_EXPONENT},{base:null,exponent:null,operator:"*",type:b.BASE_EXPONENT}],type:"EQUATION_COMPONENT",bDenominator:!1}},_onClickCancelOfResetInBuildMode:function(){this.isPopupExist=!1;var a=this.model.get("exploreView"),b=MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion;a===b.EXPLORE_VIEW.FORMATION?this.setFocus("build-mode-reset-button"):a===b.EXPLORE_VIEW.WORKSPACE&&this.setFocus("solve-mode-reset-button")},_solveModeResetButtonClick:function(){this.stopReading(),this._showResetPopup()},onMouseDown:function(a){this._removeMarquee(a),this._hideTooltip(),this._hideCombineLikeBasesTooltip()},removeHighlightTiles:function(){this._equationManager&&this._equationManager.removeHighlightTilesImmediate()},_removeMarquee:function(a){var b=$(a.target),c=this._marqueeRemoveExceptions,d=0;for(d=0;d<c.length;d++)if(_.intersection(b,$(c[d])).length>0||_.intersection(b.parents(c[d]),$(c[d])).length>0)return;return this._formEquationManager&&this._formEquationManager.removeMarquee(),this._equationManager&&this._equationManager.removeMarquee(),!0},_removeMarqueeOnTooltipClick:function(){this._formEquationManager.removeMarquee()},_hideTooltip:function(){this.maxBasesAllowedTooltip.hideTooltip()},_hideCombineLikeBasesTooltip:function(){this.combineLikeBasesTooltip.hideTooltip(),this.combineLikeBasesTooltip.$el.css({left:"0px"})},_randomExpressionButtonClick:function(){this.stopReading(),this.model.set("tryAnotherBtnStatus",!0),this.model.set("randomExprButtonClick",!0);var a,c=this.model.get("allowedCases"),d=b.ExponentAccordion,e=new MathInteractives.Common.Interactivities.ExponentAccordion.Models.RandomExpression,f=(c&d.IS_DIVISION_ALLOWED)===d.IS_DIVISION_ALLOWED,g=(c&d.IS_RAISED_TO_POWER_ALLOWED)===d.IS_RAISED_TO_POWER_ALLOWED,h=MathInteractives.Common.Components.Theme2.Views.ToggleButton;this.toggleButtonView&&(this.resetClicked=!0,this.toggleButtonView.changeStateOfToggleButton(h.TOGGLEBUTTON_STATE_OFF),this._enableDisableToggleButtonState(!1),this.model.set("raisedToPower",!1),this.resetClicked=!1),this.model.get("manualTileDrop")===!0?this.model.get("userSelectedMode")?1==MathInteractives.Common.Utilities.Models.Utils.getRandomIntegerNumber(0,1)&&(g=!1):(f=!1,g=!1):(f&&1==MathInteractives.Common.Utilities.Models.Utils.getRandomIntegerNumber(0,1)&&(f=!1,g=!1),f!==!1&&g&&1==MathInteractives.Common.Utilities.Models.Utils.getRandomIntegerNumber(0,1)&&(g=!1)),a=e.getExpression(f,this.model.get("noOfBasesAllowed"),this.model.get("isAbsolute"),(c&d.IS_NEGATIVE_BASES_ALLOWED)===d.IS_NEGATIVE_BASES_ALLOWED,(c&d.IS_NEGATIVE_EXPONENTS_ALLOWED)===d.IS_NEGATIVE_EXPONENTS_ALLOWED,(c&d.IS_PARENTHESIS_ALLOWED)===d.IS_PARENTHESIS_ALLOWED,(c&d.IS_NEGATIVE_PARENTHESIS_ALLOWED)===d.IS_NEGATIVE_PARENTHESIS_ALLOWED,g,this.model.get("accordionLevel")),this.toggleButtonView&&this.toggleButtonView.getButtonState()===h.TOGGLEBUTTON_STATE_DISABLED&&f&&(this.resetClicked=!0,this._enableDisableToggleButtonState(!0),this.resetClicked=!1),this.toggleButtonView&&this.toggleButtonView.getButtonState()!==h.TOGGLEBUTTON_STATE_DISABLED&&this.toggleBigParenthesisButton(g),f?(this._$elmFormExpDropRegion.removeClass("multiplication").addClass("division"),this.model.set("buildModeDivisionMode",!0)):(this._$elmFormExpDropRegion.removeClass("division").addClass("multiplication"),this.model.set("buildModeDivisionMode",!1)),this.model.set("tileDropped",!0),this.model.set("buildModeDoneButtonStatus",!0),this._setNewEquation(this._formEquationManager,this.$("#"+this.idPrefix+"form-expression-area"),JSON.parse(a),!0,!1),this._showHideFormEquationView(!0),this._formEquationManager.getEquationStatusModifyBin(),this._formEquationManager.commandFactory.resetUndoStack(),this._disableEnableButtons(this.buildModeResetButtonView,!0),this._updateContextMenu(!1),this.updateFocusRect("droppable-region")},_doneButtonClick:function(){var a;MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED;this.stopReading(),this._validateExpression()?(this._equationManager&&this._equationManager.resetData(),this._formEquationManager.addTileForNegativeParCoeff(),a=JSON.parse(JSON.stringify(this._formEquationManager.equationView.model.toJSON())),this.model.set("equationData",a),this.model.set("equationDataSolveMode",$.extend(!0,{},a)),this.model.set("solveModeDivisionMode",this.model.get("buildModeDivisionMode")),!this.model.get("buildModeDivisionMode")&&this.model.get("accordionLevel")>2&&(a=this._formEquationManager.wrapFractionTileItem(a),this.model.set("solveModeDivisionMode",!0)),this._formEquationManager.resetData(),this._showHideEquationManager(!0),this._createEquationManager(),this._setNewEquation(this._equationManager,this.$("#"+this.idPrefix+"workspace-expression-area"),a,!0,!1),this._renderOriginalExpression(),this.model.set("exploreView",b.ExponentAccordion.EXPLORE_VIEW.WORKSPACE),this._equationManager.showMarquee(),this._equationManager.removeMarquee(),this._disableEnableButtons(this.solveModeUndoButtonView,!1),this._disableEnableButtons(this.solveModeResetButtonView,!1),this._setDirectionTextOfExplore(b.ExponentAccordion.EXPLORE_VIEW.WORKSPACE),this.setFocus("direction-text-container-direction-text-text")):(this.model.get("buildModeDivisionMode")?this.tileStatus[0]>=1&&this.tileStatus[1]>=1?this._renderExpressionIncomplete():this._renderExpressionNotFilledFractionMode():this.tileStatus[0]>=2?this._renderExpressionIncomplete():this._renderExpressionNotFilled(),this._setFocusToMaxBasesAllowedTooltip()),this.updateFocusRect("workspace-scrollable")},_setDirectionTextOfExplore:function(a){a===b.ExponentAccordion.EXPLORE_VIEW.WORKSPACE?this.directionBoxView.changeDirectionText(this.getMessage("direction-text",3),!1):a===b.ExponentAccordion.EXPLORE_VIEW.FORMATION&&this.directionBoxView.changeDirectionText(this.getMessage("direction-text",0),!1)},_showHideEquationManager:function(a){a?(this.$elmFormExpressionContainer.hide(),this.$elmWorkspaceContainer.show(),this._$elmFormExpDropRegion.hide(),this._$droppableTitleText.hide()):(this.$elmFormExpressionContainer.show(),this.$elmWorkspaceContainer.hide(),this._$elmFormExpDropRegion.show(),this._$droppableTitleText.show())},_solveModeUndoBtnClick:function(a){var b=this;this.stopReading(),this._equationManager.undo(),window.setTimeout(function(){void 0==a.which&&b.setFocus("workspace-scrollable")},0)},_showHideInitialScreen:function(a){a?(this.$elmFormExpressionContainer.hide(),this.$elmWorkspaceContainer.show()):(this.$elmFormExpressionContainer.show(),this.$elmWorkspaceContainer.hide())},_changeToggleState:function(){this.stopReading();var a=this.toggleButtonView.getButtonState(),b=MathInteractives.Common.Components.Theme2.Views.ToggleButton;this.resetClicked!==!0&&(a===b.TOGGLEBUTTON_STATE_ON?this._changeToggleStateOnOrOff(!0):a===b.TOGGLEBUTTON_STATE_OFF&&this._changeToggleStateOnOrOff(!1))},_changeToggleStateOnOrOff:function(a){this.internalToggle===!0&&this._formEquationManager.toggleBigParenthesis(a),this.model.set("raisedToPower",a)},toggleBigParenthesisButton:function(a){this.internalToggle=!1;var b=MathInteractives.Common.Components.Theme2.Views.ToggleButton;a?this.toggleButtonView.changeStateOfToggleButton(b.TOGGLEBUTTON_STATE_ON):this.toggleButtonView.changeStateOfToggleButton(b.TOGGLEBUTTON_STATE_OFF),this.internalToggle=!0},_enableDisableToggleButtonState:function(a){var b="raised-to-power-toggle-button-container",c=MathInteractives.Common.Components.Theme2.Views.ToggleButton;this.toggleButtonView&&(a?(this.toggleButtonView.changeStateOfToggleButton(c.TOGGLEBUTTON_STATE_ENABLED),this.player.enableHelpElement(b,0,!0)):(this.toggleButtonView.changeStateOfToggleButton(c.TOGGLEBUTTON_STATE_DISABLED),this.player.enableHelpElement(b,0,!1)))},_disableEnableButtons:function(a,b){var c=a.$el.attr("id").split(this.idPrefix)[1],d=MathInteractives.global.Theme2.Button;b?(a.setButtonState(d.BUTTON_STATE_ACTIVE),this.player.enableHelpElement(c,0,!0)):(a.setButtonState(d.BUTTON_STATE_DISABLED),this.player.enableHelpElement(c,0,!1))},_onTileDrop:function(a,b,d,e){var f,g=a.originalEvent?a.originalEvent:a,h=MathInteractives.Common.Utilities.Models.Rect,i=new MathInteractives.Common.Utilities.Models.Point({left:g.clientX,top:g.clientY}),j={},k={},l=c.TileItem.SolveTileType.BASE_EXPONENT,m={type:l,bDenominator:!1,base:null,exponent:null},n={type:l,bDenominator:!1,base:null,exponent:null,operator:"*"},o={type:l,bDenominator:!0,base:null,exponent:null},p=b.helper.data(),q=(p.tilevalue,p.tiletype,e),r=null,s={sourceTile:b.helper};this.model.get("accordionLevel");if(this.model.set("buildModeDivisionMode",q),this.model.set("manualTileDrop",!0),this.model.set("userSelectedMode",q),j={tileArray:[{tileArray:[],arrOperators:[]}],arrOperators:[]},j.type=c.TileItem.SolveTileType.EQUATION_COMPONENT,q){var t=new h(d.getBoundingClientRect()),u=t.getMiddle();j.tileArray[0].tileArray[0]=m,j.tileArray[0].tileArray[1]=o,f=c.TileItem.SolveTileType.FRACTION,j.tileArray[0].type=f,r=i.getTop()<=u.getTop()?"0.0":"0.1",this._$elmFormExpDropRegion.removeClass("multiplication").addClass("division"),this.model.set("buildModeDivisionMode",!0),null!==this.toggleButtonView&&(this.resetClicked=!0,this._enableDisableToggleButtonState(!0),this.resetClicked=!1,this.toggleBigParenthesisButton(!1))}else j.tileArray[0]=m,j.tileArray[1]=n,r="0",this._$elmFormExpDropRegion.removeClass("division").addClass("multiplication"),this.model.set("buildModeDivisionMode",!1);this._showHideFormEquationView(!0),k={cmdFactoryData:{allowedOperation:this.model.get("allowedOperation"),maxPrimeLimit:this.model.get("maxPrimeLimit"),undoStack:[]},equationData:j,equationViewContainer:this.$("#"+this.idPrefix+"form-expression-area"),player:this.player,filePath:this.filePath,manager:this.manager,idPrefix:this.idPrefix},null==this._formEquationManager&&this.createFormEquationManager(),this._formEquationManager.setData(k),this._formEquationManager.render(),s.destTile=this._formEquationManager.getViewFromIndex(r),this._formEquationManager.onReplaceTile(s),q===!0?this._formEquationManager.enableDroppableEquationView(!1):this._formEquationManager.enableDroppableEquationView(!0),b.draggable.data("isDropped",!0),b.helper.isDropped=!0,this.model.set("tileDropped",!0),this.model.set("buildModeDoneButtonStatus",!0),this._formEquationManager.getEquationStatusModifyBin(),this._disableEnableButtons(this.buildModeResetButtonView,!0),this.model.set("tryAnotherBtnStatus",!0),this._updateContextMenu(!1),this.updateFocusRect("droppable-region")},_onTileDropForAcc:function(a,b,d,e,f,g){var h,f,i={},j={},k=c.TileItem.SolveTileType.BASE_EXPONENT,l={type:k,bDenominator:!1,base:null,exponent:null},m={type:k,bDenominator:!1,base:null,exponent:null,operator:"*"},n={type:k,bDenominator:!0,base:null,exponent:null},o=g||$(a.currentTarget),p=o.data(),q=p.tilevalue,r=(p.tiletype,e),s={sourceTile:o};this.model.set("buildModeDivisionMode",r),this.model.set("manualTileDrop",!0),this.model.set("userSelectedMode",r),i={tileArray:[{tileArray:[],arrOperators:[]}],arrOperators:[]},i.type=c.TileItem.SolveTileType.EQUATION_COMPONENT,r?(i.tileArray[0].tileArray[0]=l,i.tileArray[0].tileArray[1]=n,h=c.TileItem.SolveTileType.FRACTION,i.tileArray[0].type=h,this._$elmFormExpDropRegion.removeClass("multiplication").addClass("division"),this.model.set("buildModeDivisionMode",!0),null!==this.toggleButtonView&&(this.resetClicked=!0,this._enableDisableToggleButtonState(!0),this.resetClicked=!1,this.toggleBigParenthesisButton(!1))):(i.tileArray[0]=l,i.tileArray[1]=m,f="0",this._$elmFormExpDropRegion.removeClass("division").addClass("multiplication"),this.model.set("buildModeDivisionMode",!1)),this._showHideFormEquationView(!0),j={cmdFactoryData:{allowedOperation:this.model.get("allowedOperation"),maxPrimeLimit:this.model.get("maxPrimeLimit"),undoStack:[]},equationData:i,equationViewContainer:this.$("#"+this.idPrefix+"form-expression-area"),player:this.player,filePath:this.filePath,manager:this.manager,idPrefix:this.idPrefix},null==this._formEquationManager&&this.createFormEquationManager(),this._formEquationManager.setData(j),this._formEquationManager.render(),s.destTile=this._formEquationManager.getViewFromIndex(f),this._formEquationManager.onReplaceTile(s),r===!0?this._formEquationManager.enableDroppableEquationView(!1):this._formEquationManager.enableDroppableEquationView(!0),o.data("isDropped",!0),this.model.set("tileDropped",!0),this.model.set("buildModeDoneButtonStatus",!0),this._formEquationManager.getEquationStatusModifyBin(),this._disableEnableButtons(this.buildModeResetButtonView,!0),this.model.set("tryAnotherBtnStatus",!0),this._updateContextMenu(!1),this.updateFocusRect("droppable-region"),this._formEquationManager.equationView.tileDroppedString=this.getAccMessage("base-exp-pair",5,[q]),this.setFocus("droppable-region")},_buildModeUndoClickHandler:function(a){return this.stopReading(),this._formEquationManager.undo(),void 0==a.which&&this.setFocus("droppable-region"),this},_renderBackground:function(){this.$el.css({"background-image":'url("'+this.filePath.getImagePath("sprites")+'")'}).addClass("bg"),this._$elmStartDropRegionMultiplicationContainer.find(".multiplication-img").css({"background-image":'url("'+this.filePath.getImagePath("sprites")+'")'}),this._$elmStartDropRegionDivisionContainer.find(".division-img").css({"background-image":'url("'+this.filePath.getImagePath("sprites")+'")'})},_renderDirectionText:function(){if(null===this.directionBoxView){var a={idPrefix:this.idPrefix,containerId:this.idPrefix+"direction-text-container",manager:this.manager,player:this.player,path:this.filePath,text:"",accText:"",btnBaseClass:"btn-yellow",ttsBaseClass:"tts-yellow",showButton:!0,btnColorType:MathInteractives.global.Theme2.Button.COLORTYPE.HEADER_BLUE,btnTextColor:"#222222",buttonText:this.getMessage("try-another-text",0),clickCallback:{fnc:this._clickedTryAnother,scope:this},textColor:"#FFFFFF",containmentBGcolor:"#282828",buttonTabIndex:760,tabIndex:501};this.model.get("exploreView")===b.ExponentAccordion.EXPLORE_VIEW.FORMATION?(a.text=this.getAccMessage("direction-text",0),a.accText=this.getAccMessage("direction-text",0)):this.model.get("exploreView")===b.ExponentAccordion.EXPLORE_VIEW.WORKSPACE&&(a.text=this.getAccMessage("direction-text",3),a.accText=this.getAccMessage("direction-text",3)),this.directionBoxView=new MathInteractives.global.Theme2.DirectionText.generateDirectionText(a)}},_showHideFormEquationView:function(a){var b=this._formEquationManager.marqueeView,c=this.model.get("accordionLevel"),d=!1;null!==this.toggleButtonView&&(d=this.toggleButtonView.getButtonState()===MathInteractives.Common.Components.Theme2.Views.ToggleButton.TOGGLEBUTTON_STATE_ON?!0:!1),a?(this._$elmStartDropRegionMultiplicationContainer&&this._$elmStartDropRegionMultiplicationContainer.hide(),this._$elmStartDropRegionDivisionContainer&&(this._$elmStartDropRegionDivisionContainer.hide(),this._$elmStartHorizontalSaperator.hide()),this._$elmStartDropRegionDivisionContainer&&(this._$elmStartDropRegionDivisionContainer.hide(),this._$elmStartHorizontalSaperator.hide()),this._$elmFormExpDropRegion&&this._$elmFormExpDropRegion.show(),this._$droppableTitleText&&this._$droppableTitleText.show(),b&&b.enableMarquee(),this._showHideEquationManager(!1)):a===!1&&(b&&b.disableMarquee(),this._$elmStartDropRegionMultiplicationContainer&&this._$elmStartDropRegionMultiplicationContainer.show(),c>2&&this._$elmStartDropRegionDivisionContainer&&(this._$elmStartDropRegionDivisionContainer.show(),this._$elmStartHorizontalSaperator.show()),d&&(this.resetClicked=!0,this._enableDisableToggleButtonState(!1),this.model.set("raisedToPower",!1),this.resetClicked=!1),this._$elmFormExpDropRegion&&this._$elmFormExpDropRegion.hide(),this._$droppableTitleText&&this._$droppableTitleText.hide())},_clickedTryAnother:function(){this.stopReading(),this._showTryAnotherPopup()},_showTryAnotherPopup:function(){var a,b=this.model.get("exploreView"),c=MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion;b===c.EXPLORE_VIEW.FORMATION?a=this.getMessage("try-another-popup","text-formation"):b===c.EXPLORE_VIEW.WORKSPACE&&(a=this.getMessage("try-another-popup","text-workspace")),this.tryAnotherPopupView=MathInteractives.global.Theme2.PopUpBox.createPopup({text:a,title:this.getMessage("try-another-popup","title"),manager:this.manager,player:this.player,path:this.filePath,idPrefix:this.idPrefix,type:MathInteractives.global.Theme2.PopUpBox.CONFIRM,buttons:[{id:this.idPrefix+"yes-btn",text:this.getMessage("try-another-popup","yes"),response:{isPositive:!0,buttonClicked:this.idPrefix+"yes-btn"},clickCallBack:{fnc:this._goToIntialScreen,scope:this}},{id:this.idPrefix+"cancel-btn",text:this.getMessage("try-another-popup","cancel"),response:{isPositive:!1,buttonClicked:this.idPrefix+"cancel-btn"},clickCallBack:{fnc:this._onClickCancelOfTryAnotherBuildMode,scope:this}}]})},fireTryAnother:function(){this.model.get("clearAllData")&&(this._goToIntialScreen(),this.model.set("clearAllData",!1)),this.model.get("dataTabTryAnotherClick")&&(this._goToIntialScreen(),this.model.set("dataTabTryAnotherClick",!1))},tryAnotherBtnStatus:function(a,b,c){var d="direction-text-container-direction-text-buttonholder";b===!0?(this.directionBoxView.changeButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE),this.player.enableHelpElement(d,0,!0)):(this.directionBoxView.changeButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED),this.player.enableHelpElement(d,0,!1))},_goToIntialScreen:function(){var a=(this.model.get("accordionLevel"),MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED,this.model.get("allowedCases")),c=MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion,d=MathInteractives.Common.Components.Theme2.Views.ToggleButton;this._enableDisableAllBinTiles(!0),this._disableEnableButtons(this.buildModeUndoButtonView,!1),this._disableEnableButtons(this.buildModeResetButtonView,!1),this._resetAllBinTiles(),a&c.IS_PARENTHESIS_ALLOWED&&(this.disabledParIndexes=[0,1],this._disableParenthesis(this.disabledParIndexes)),null!==this.toggleButtonView&&(this.internalToggle=!1,this.toggleButtonView.changeStateOfToggleButton(d.TOGGLEBUTTON_STATE_OFF),this._enableDisableToggleButtonState(!1),this.internalToggle=!0),this._showHideFormEquationView(!1),this._formEquationManager&&(this._formEquationManager.resetData(),this._formEquationManager.resetTileCounters()),this._equationManager&&this._equationManager.resetData(),this.model.set("tileDropped",!1),this.model.set("buildModeDivisionMode",!0),this.model.set("manualTileDrop",!1),this.model.set("userSelectedMode",null),this.model.set("equationData",null),this.model.set("exploreView",b.ExponentAccordion.EXPLORE_VIEW.FORMATION),this._showHideInitialScreen(!1),this.model.set("pureAndSimpleShown",!1),this.model.set("tryAnotherBtnStatus",!1),this.model.set("randomExprButtonClick",!1),this.model.set("buildModeDoneButtonStatus",!1),this._setDirectionTextOfExplore(b.ExponentAccordion.EXPLORE_VIEW.FORMATION),this._updateContextMenu(!0),this.updateFocusRect("base-tile-dispenser-container"),this.updateFocusRect("exponents-tile-dispenser-container"),this.updateFocusRect("parenthesis-tile-dispenser-container"),this.model.get("dataTabTryAnotherClick")?this.setFocus("header-subtitle",20):this.setFocus("direction-text-container-direction-text-text")},_resetAllBinTiles:function(){var b,c,d=this.baseTilesViews.dragButtonViews,e=this.exponentTilesViews.dragButtonViews,f=a.FormExpression;for(b=0;b<d.length;b++)c=d[b].$el.find(".custom-btn-text"),c.find(".tile-number").text(f.BASE_TILES_RESET_ARRAY[b]),d[b].$el.attr({"data-tilevalue":f.BASE_TILES_RESET_ARRAY[b]});for(b=0;b<e.length;b++)c=e[b].$el.find(".custom-btn-text"),c.find(".tile-number").text(f.EXPONENT_TILES_RESET_ARRAY[b]),e[b].$el.attr({"data-tilevalue":f.EXPONENT_TILES_RESET_ARRAY[b]});this.model.set("isBinBaseNegated",[1,1,1,1,1,1,1,1]),this.model.set("isBinExpNegated",[1,1,1,1,1,1,1,1,1])},_onClickCancelOfTryAnotherBuildMode:function(){this.setFocus("direction-text-container-direction-text-buttonholder")},_enableDisableSpecificBinElements:function(a,b,c){b=b!==!1;var d,e,f=MathInteractives.global.Theme2.Button,g=b?f.BUTTON_STATE_ACTIVE:f.BUTTON_STATE_DISABLED;for(d=0;d<a.length;d++)e=this._getBinElementFromIndex(a[d]),e.isTile?(e.element.setButtonState(g),(b&&c||!b)&&e.element.$el.draggable(b?"enable":"disable"),b&&e.element.$el.removeClass("inactive")):e.isToggle?(this.resetClicked=!0,b?(this._enableDisableToggleButtonState(!0),this.toggleButtonView.$el.removeClass("inactive on-inactive off-inactive")):(this._enableDisableToggleButtonState(!1),this._enableBinGroupTitleText(e.groupTitle,b)),this.resetClicked=!1):e.element.setButtonState(g),b&&this._enableBinGroupTitleText(e.groupTitle)},_inactivateSpecificBinElement:function(a){var b,c,d,e=[],f=MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED;for(b=0;b<a.length;b++)d=this._getBinElementFromIndex(a[b]),c=d.element,d.isTile?(c.setButtonState(f),c.$el.draggable("disable").addClass("inactive")):d.isToggle?(c.changeStateOfToggleButton(MathInteractives.Common.Components.Theme2.Views.ToggleButton.TOGGLEBUTTON_STATE_DISABLED),d.toggleOn?c.$el.addClass("inactive on-inactive"):c.$el.addClass("inactive off-inactive")):c.setButtonState(f),-1===e.indexOf(d.groupTitle)&&e.push(d.groupTitle);for(b=0;b<e.length;b++)this._enableBinGroupTitleText(d.groupTitle,!1)},_getArrayInRange:function(a,b){return _.range(a,b+1)},_attchBinEvents:function(){var c=this._formEquationManager;this.listenTo(c,d.FormExpressionEquationManager.EVENTS.DISABLE_ENABLE_BIN_BASES,this._binBaseTileStatus),this.listenTo(c,d.FormExpressionEquationManager.EVENTS.DISABLE_ENABLE_BIN_PARENTHESIS,this._binParenthesisStatus),this.listenTo(c,d.FormExpressionEquationManager.EVENTS.STACK_STATUS,this._undoStackStatus),this.listenTo(c,d.FormExpressionEquationManager.EVENTS.MAX_UNIQUE_BASES_LIMIT_REACHED,this._maxUniqueBasesLimitReached),this.listenTo(c,d.FormExpressionEquationManager.EVENTS.MAX_BASE_REACHED_IN_NUM_DEN,this._maxBasesInNumAndDenLimitReached),this.listenTo(c,d.FormExpressionEquationManager.EVENTS.DONE_BUTTON_STATUS,this._checkDoneButtonStaus),this.listenTo(c,d.FormExpressionEquationManager.EVENTS.NESTED_PARENTHESIS_CASE,this._nestedParenthesisCase),this.listenTo(c,d.EquationManager.EVENTS.MARQUEE_DRAWN,this._addMarqueeScope),
this.listenTo(c,d.EquationManager.EVENTS.MARQUEE_REMOVED,this._removeMarqueeScope),this.listenTo(c,d.FormExpressionEquationManager.EVENTS.MAX_TERMS_ALLOWED_IN_PARENTHESIS,this._maxNoOfTermsInsideParenthesisCase),this.listenTo(c,d.EquationManager.EVENTS.COMMAND_FIRED,this._checkErrors),this.listenTo(c,d.FormExpressionEquationManager.EVENTS.MAX_PARENTHESIS_REACHED,this._noOfParenthesisAllowedLimitReached),this.listenTo(c,d.EquationManager.EVENTS.TILE_DRAGGING_START,this._tileDraggingStart),this.listenTo(c,d.EquationManager.EVENTS.MARQUEE_START,this.onMarqueeStart),this.listenTo(c,d.EquationManager.EVENTS.MARQUEE_DRAG_START,this.onMarqueeDragStart),this.listenTo(c,d.EquationManager.EVENTS.REVERT_START,this._onTileRevertingStart),this.listenTo(c,d.EquationManager.EVENTS.REVERT_END,this._onTileRevertingEnd),this.listenTo(c,d.EquationManager.EVENTS.TILE_MOUSE_DOWN,this.onTileMouseDown),this.listenTo(c,a.FormExpressionEquationManager.EVENTS.BIG_PARENTHESIS_ADDED,this._onAddBigParenthesis),this.listenTo(c,a.FormExpressionEquationManager.EVENTS.BIG_PARENTHESIS_REMOVED,this._onRemoveBigParenthesis),this.listenTo(c,d.EquationManager.EVENTS.BUILD_TAB,this._buildTabPressed),this.listenTo(c,d.EquationManager.EVENTS.BUILD_SHIFT_TAB,this._buildShiftTabPressed),this.listenTo(c,d.EquationManager.EVENTS.BUILD_SET_FOCUS_ON_TOOLTIP,this._setFocusToMaxBasesAllowedTooltip),this.listenTo(c,a.FormExpressionEquationManager.EVENTS.GET_CURRENT_LEVEL,this.setCurrentLevelOfFormEquationManager),this.listenTo(this.model,b.ExponentAccordion.EVENTS.UPDATE_EQUATION_DATA,this._updateEquationData)},setCurrentLevelOfFormEquationManager:function(){this._formEquationManager.setCurrentLevel(this.model.get("accordionLevel"))},_buildTabPressed:function(){"none"!==this.maxBasesAllowedTooltip.$el.css("display")?this.setFocus("build-text-in-tooltip"):this.buildModeUndoButtonView.getButtonState()===MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE?this.setFocus("build-mode-undo-button"):this.buildModeResetButtonView.getButtonState()===MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE?this.setFocus("build-mode-reset-button"):this.setFocus("done-button")},_buildShiftTabPressed:function(){var a=this.model.get("accordionLevel");4>=a?1===a?this.setFocus("exponents-tile-dispenser-container"):this.setFocus("parenthesis-tile-dispenser-container"):this.toggleButtonView.getButtonState()!==MathInteractives.Common.Components.Theme2.Views.ToggleButton.TOGGLEBUTTON_STATE_DISABLED?this.setFocus("raised-to-power-toggle-button-toggle-button-containment"):this.setFocus("parenthesis-tile-dispenser-container")},onTileMouseDown:function(){this.stopReading(),this.maxBasesAllowedTooltip.hideTooltip()},_onTileRevertingStart:function(){this.animationStart()},_onTileRevertingEnd:function(){this.animationEnd()},onMarqueeDragStart:function(){this.stopReading(),this.maxBasesAllowedTooltip.hideTooltip()},onMarqueeStart:function(){this.stopReading()},_updateEquationData:function(){var a=this.model,c=b.ExponentAccordion.EXPLORE_VIEW;a.get("exploreView")===c.FORMATION||a.get("previousView")===c.FORMATION?this._formEquationManager&&a.set("equationData",this._formEquationManager.getCurrentEquationJSON()):(a.get("exploreView")===c.WORKSPACE||a.get("previousView")===c.WORKSPACE)&&this._equationManager&&a.set("equationDataSolveMode",this._equationManager.getCurrentEquationJSON()),a.getAccordionDataFromSaveState(!1)},_onAddBigParenthesis:function(){this.toggleButtonView.getButtonState()!==MathInteractives.Common.Components.Theme2.Views.ToggleButton.TOGGLEBUTTON_STATE_ON&&(this.internalToggle=!1,this.toggleButtonView.changeStateOfToggleButton(MathInteractives.Common.Components.Theme2.Views.ToggleButton.TOGGLEBUTTON_STATE_ON),this.model.set("raisedToPower",!0),this.internalToggle=!0)},_onRemoveBigParenthesis:function(){this.toggleButtonView.getButtonState()===MathInteractives.Common.Components.Theme2.Views.ToggleButton.TOGGLEBUTTON_STATE_ON&&(this.internalToggle=!1,this.toggleButtonView.changeStateOfToggleButton(MathInteractives.Common.Components.Theme2.Views.ToggleButton.TOGGLEBUTTON_STATE_OFF),this.model.set("raisedToPower",!1),this.internalToggle=!0)},_tileDraggingStart:function(){this.maxBasesAllowedTooltip.hideTooltip(),this.stopReading()},_addMarqueeScope:function(){this.parenthesisTilesViews&&this.parenthesisTilesViews.addOptionsForDraggable({scope:"marquee-scope"})},_removeMarqueeScope:function(){this.parenthesisTilesViews&&this.parenthesisTilesViews.addOptionsForDraggable({scope:"default"})},_checkErrors:function(a){var b="",d=c.CommandFactory.EXIT_CODE;switch(a){case d.OUT_OF_RANGE_EXPONENT:b=this._exponentOutOfRangeText()}b.length>0&&(this._changeMaxBasesAllowedTooltipText(b),this._changeMaxBasesAllowedTooltipWidth(b),this.maxBasesAllowedTooltip.showTooltip())},_setIsTouch:function(){var a=MathInteractives.Common.Utilities.Models.BrowserCheck;this._isTouch=a.isAndroid||a.isIOS},_handleTouchScroll:function(){var a,b;null===this._isTouch&&this._setIsTouch(),this._isTouch&&this.$el.addClass("is-touch"),a=this.filePath.getFontAwesomeClass("angle-double-left"),b=this.filePath.getFontAwesomeClass("angle-double-right"),this._$angleDoubleLeft.addClass(a),this._$angleDoubleRight.addClass(b)},_changeMaxBasesAllowedTooltipText:function(a,b){var c=this.orphanFix(a);this.setMessage("build-text-in-tooltip",c),b?this.setAccMessage("build-text-in-tooltip",b):this.setAccMessage("build-text-in-tooltip",a)},orphanFix:function(a){var b=a.split(" ");return b.length>1&&(b[b.length-2]+="&nbsp;"+b[b.length-1],b.pop()),b.join(" ")},_changeCombineLikeBasesTooltipText:function(a){this.setMessage("solve-text-in-tooltip",a),this.setAccMessage("solve-text-in-tooltip",a),this.updateFocusRect("solve-text-in-tooltip")},_noOfParenthesisAllowedLimitReached:function(){var a=this._maxNoOfParenthesisAllowedText();this._changeMaxBasesAllowedTooltipText(a.loc,a.acc),this._changeMaxBasesAllowedTooltipWidth(!0),this.maxBasesAllowedTooltip.showTooltip()},_nestedParenthesisCase:function(){var a=this._nestedParenthesisNotAllowedText();this._changeMaxBasesAllowedTooltipText(a.loc,a.acc),this._changeMaxBasesAllowedTooltipWidth(a.loc),this.maxBasesAllowedTooltip.showTooltip()},_maxNoOfTermsInsideParenthesisCase:function(){var a=this._maxNoOfTermsInsideParenthesisText();this._changeMaxBasesAllowedTooltipText(a.loc,a.acc),this._changeMaxBasesAllowedTooltipWidth(!0),this.maxBasesAllowedTooltip.showTooltip()},_validateExpression:function(){var a=this.tileStatus,b=this._formEquationManager.baseLocations,c=a[0]+a[1];return c===b.length&&b.length>=2?this._formEquationManager.checkParenthesisExponent()?!0:void 0:!1},_renderExpressionNotFilled:function(){var a=this.getMessage("expression-incomplete-tooltip-text",0),b=this.getAccMessage("expression-incomplete-tooltip-text",0);this._changeMaxBasesAllowedTooltipText(a,b),this._changeMaxBasesAllowedTooltipWidth(!0),this.maxBasesAllowedTooltip.showTooltip()},_renderExpressionNotFilledFractionMode:function(){var a=this.getMessage("expression-incomplete-tooltip-text",3),b=this.getAccMessage("expression-incomplete-tooltip-text",3);this._changeMaxBasesAllowedTooltipText(a,b),this._changeMaxBasesAllowedTooltipWidth(!0),this.maxBasesAllowedTooltip.showTooltip()},_renderExpressionIncomplete:function(){var a=this.getMessage("expression-incomplete-tooltip-text",1),b=this.getAccMessage("expression-incomplete-tooltip-text",1);this._changeMaxBasesAllowedTooltipText(a,b),this._changeMaxBasesAllowedTooltipWidth(a),this.maxBasesAllowedTooltip.showTooltip()},_setFocusToMaxBasesAllowedTooltip:function(){this._formEquationManager.getCurrentAccView()&&this._formEquationManager.getCurrentAccView().removeAccDiv(),"none"!==this.maxBasesAllowedTooltip.$el.css("display")?(this.updateFocusRect("build-text-in-tooltip"),this.setFocus("build-text-in-tooltip")):this.setFocus("droppable-region")},_setFocusToCombineLikeBasesTooltip:function(){this._equationManager.getCurrentAccView()&&this._equationManager.getCurrentAccView().removeAccDiv(),"none"!==this.combineLikeBasesTooltip.$el.css("display")?(this.updateFocusRect("solve-text-in-tooltip"),this.setFocus("solve-text-in-tooltip")):this.setFocus("workspace-scrollable")},_checkDoneButtonStaus:function(){var a=this._formEquationManager.getTileStatus();this.tileStatus=a},updateDoneButtonState:function(a,b,c){this._disableEnableButtons(this.doneButtonView,b)},_maxBasesInNumAndDenLimitReached:function(){var a=this._setMaxBasesTooltipText();this._changeMaxBasesAllowedTooltipText(a.loc,a.acc),this.model.get("buildModeDivisionMode")?this._changeMaxBasesAllowedTooltipWidth(!0):this._changeMaxBasesAllowedTooltipWidth(a.loc),this.maxBasesAllowedTooltip.showTooltip()},_maxUniqueBasesLimitReached:function(){var a=this._setUniqueBaseLimitReachedText();this._changeMaxBasesAllowedTooltipText(a.loc,a.acc),this._changeMaxBasesAllowedTooltipWidth(a.loc),this.maxBasesAllowedTooltip.showTooltip()},_undoStackStatus:function(a){MathInteractives.global.Theme2.Button;0===a.length?(this._disableEnableButtons(this.buildModeUndoButtonView,!1),this.model.get("randomExprButtonClick")===!1&&this._disableEnableButtons(this.buildModeResetButtonView,!1)):(this._disableEnableButtons(this.buildModeUndoButtonView,!0),this._disableEnableButtons(this.buildModeResetButtonView,!0))},_setUndoResetButtonStatus:function(){this.model.get("tileDropped")&&this._disableEnableButtons(this.buildModeResetButtonView,!0)},_binParenthesisStatus:function(a){var c,d=b.ExponentAccordion.NUMBER_OF_PARENTHESIS,e=d.NUMERATOR,f=d.DENOMINATOR,g=d.NEGATIVE,h=f+e,i=this._formEquationManager;this.disabledParIndexes=[],null!==this.parenthesisTilesViews&&(c=this.parenthesisTilesViews.dragButtonViews,this._enableDraggables(c,"parentheses")),i.isPosParensEnabled=!0,i.isNegParensEnabled=!0,this._checkNegativeParNumber(a,g),this.model.get("buildModeDivisionMode")?a.length===h&&(this.disabledParIndexes=[0,1],i.isPosParensEnabled=!1,i.isNegParensEnabled=!1,this._disableParenthesis(this.disabledParIndexes)):a.length===e&&(this.disabledParIndexes=[0,1],i.isPosParensEnabled=!1,i.isNegParensEnabled=!1,this._disableParenthesis(this.disabledParIndexes)),this._formEquationManager.setParArray(a)},_checkNegativeParNumber:function(a,b){if(null!==this.parenthesisTilesViews){var c,d=0,e=this.parenthesisTilesViews.dragButtonViews,f=a.length,g=this._formEquationManager;for(this._enableDraggables(e,"parentheses"),this.player.enableHelpElement("parenthesis-tile-container-value-1",0,!0),c=0;f>c;c++)a[c]/Math.abs(a[c])===-1&&(d+=1);d===b&&(this.disabledParIndexes=[1],g.isNegParensEnabled=!1,this._disableParenthesis([1]))}},_disableParenthesis:function(a){var b,c,d,e=this.parenthesisTilesViews.dragButtonViews;for(b=0;b<a.length;b++)c=a[b],d=e[a[b]].$el,e[a[b]].setButtonState("disabled"),d.draggable("disable");if(2===b){this.player.enableHelpElement("parenthesis-tile-container-value-1",0,!1);var f=this.model.get("buildModeDivisionMode")?this.getAccMessage("extra-messages",3):this.getAccMessage("extra-messages",2);this.changeAccMessage("parenthesis-tile-dispenser-container",2,[f])}},_binBaseTileStatus:function(a){var b=this._findUniqueTiles(a),c=this.model.get("noOfBasesAllowed"),d=this.model.get("isAbsolute"),e=this.baseTilesViews.dragButtonViews;this._enableDraggables(e,"base"),b.length===c?this._disableBaseDraggables(e,b):d&&b.length+1===c&&(b=b.concat([-1*b[0]]),this._disableBaseDraggables(e,b))},_disableBaseDraggables:function(a,b){var c;for(c=0;c<a.length;c++)this._findAbsoluteTermInArray(c+2,b)===!1&&(a[c].setButtonState("disabled"),a[c].$el.draggable("disable"));this._formEquationManager.setBaseArray(b)},_enableDraggables:function(a,b){var c;for(c=0;c<a.length;c++)a[c].setButtonState("active",{$dragTile:a[c].$el}),a[c].$el.draggable("enable");if("base"===b&&this._formEquationManager.setBaseArray([]),"parentheses"===b){var d=this.model.get("buildModeDivisionMode")?this.getAccMessage("extra-messages",3):this.getAccMessage("extra-messages",2);this.changeAccMessage("parenthesis-tile-dispenser-container",1,[d])}},_enableDisableAllBinTiles:function(a){var b,c,d,e=[],f=MathInteractives.global.Theme2.Button,g=MathInteractives.Common.Components.Theme2.Views.ToggleButton;b=a?f.BUTTON_STATE_ACTIVE:f.BUTTON_STATE_DISABLED,c=a?g.TOGGLEBUTTON_STATE_ON:g.TOGGLEBUTTON_STATE_DISABLED,e=this.baseTilesViews?this.baseTilesViews.dragButtonViews:[],d=this.exponentTilesViews?this.exponentTilesViews.dragButtonViews:[],e=e.concat(d),d=this.parenthesisTilesViews?this.parenthesisTilesViews.dragButtonViews:[],e=e.concat(d),e.forEach(function(c,d,e){c.setButtonState(b,{$dragTile:c.$el}),c.$el.draggable(a?"enable":"disable")},this),this.internalToggle=!1,this.toggleButtonView&&this.toggleButtonView.changeStateOfToggleButton(c),this.internalToggle=!0,this._enableDisableAllButtonGroupTitleText(a)},_enableDisableAllButtonGroupTitleText:function(a){this.enableDisableBaseTilesTitle(a),this.enableDisableExponentTilesTitle(a),this.enableDisableParanthesisTilesTitle(a),this.enableDisableRaiseToPowerTitle(a)},_enableBinGroupTitleText:function(b,c){switch(c=c!==!1,b){case a.FormExpression.BASE_TYPE:this.enableDisableBaseTilesTitle(c);break;case a.FormExpression.EXPONENT_TYPE:this.enableDisableExponentTilesTitle(c);break;case a.FormExpression.PARENTHESIS_TYPE:this.enableDisableParanthesisTilesTitle(c);break;case a.FormExpression.RAISE_FRACTION:this.enableDisableRaiseToPowerTitle(c)}},_activateAllBinTiles:function(a){var b,c,d,e=[],f=MathInteractives.global.Theme2.Button,g=MathInteractives.Common.Components.Theme2.Views.ToggleButton;b=a?f.BUTTON_STATE_ACTIVE:f.BUTTON_STATE_DISABLED,d=a?g.TOGGLEBUTTON_STATE_ENABLED:g.TOGGLEBUTTON_STATE_DISABLED,e=this.baseTilesViews?this.baseTilesViews.dragButtonViews:[],c=this.exponentTilesViews?this.exponentTilesViews.dragButtonViews:[],e=e.concat(c),c=this.parenthesisTilesViews?this.parenthesisTilesViews.dragButtonViews:[],e=e.concat(c),e.forEach(function(c,d,e){c.setButtonState(b),c.$el.draggable(a?"enable":"disable"),a?c.$el.removeClass("inactive"):c.$el.addClass("inactive")},this),this.internalToggle=!1,this.toggleButtonView&&(this._enableDisableToggleButtonState(!0),this.toggleButtonView.changeStateOfToggleButton(g.TOGGLEBUTTON_STATE_OFF),this.toggleButtonView.changeStateOfToggleButton(d)),this.internalToggle=!0,this._enableDisableAllButtonGroupTitleText(a)},_enabledBinTiles:function(a){var b,c;b=MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE,c=this.baseTilesViews.dragButtonViews.concat(this.exponentTilesViews.dragButtonViews.concat(this.parenthesisTilesViews.dragButtonViews)),c.forEach(function(a,c,d){a.setButtonState(b,{$dragTile:a.$el}),a.$el.draggable("enable"),a.$el.removeClass("inactive")},this),this.enableDisableBaseTilesTitle(!0)},enableDisableBaseTilesTitle:function(a){var b=this.$(".base-tile-dispenser-title");a===!1?b.addClass("disabled-bin-title"):b.removeClass("disabled-bin-title")},enableDisableExponentTilesTitle:function(a){var b=this.$(".exponents-tile-dispenser-title");a===!1?b.addClass("disabled-bin-title"):b.removeClass("disabled-bin-title")},enableDisableParanthesisTilesTitle:function(a){var b=this.$(".parenthesis-tile-dispenser-title");a===!1?b.addClass("disabled-bin-title"):b.removeClass("disabled-bin-title")},enableDisableRaiseToPowerTitle:function(a){var b=this.$(".raised-to-power-toggle-button-title");a===!1?b.addClass("disabled-bin-title"):b.removeClass("disabled-bin-title")},_findUniqueTiles:function(a){var b,c=[];for(b=0;b<a.length;b++)this._findTermInArray(a[b],c)===!1&&c.push(a[b]);return c},_findAbsoluteTermInArray:function(a,b){var c;for(c=0;c<b.length;c++)if(Math.abs(b[c])===a)return!0;return!1},_findTermInArray:function(a,b){var c;for(c=0;c<b.length;c++)if(b[c]===a)return!0;return!1},_attachDataEvents:function(){var b=d.EquationManager.EVENTS;this.listenTo(this._equationManager,a.EquationManager.GET_CURRENT_LEVEL,this.setCurrentLevelOfEquationManager),this.listenTo(this._equationManager,b.NEW_EXPRESSION_START,this._addDataForNewExpression),this.listenTo(this._equationManager,b.ADD_STEP,this._addDataForNewStep),this.listenTo(this._equationManager,b.REMOVE_STEP,this._removeDataForNewStep),this.listenTo(this._equationManager,b.CHECK_PURE_SIMPLE,this._checkPureAndSimple),this.listenTo(this._equationManager,b.MAX_LIMIT_CROSSED_TOOLTIP,this._showMaxLimitCrossedToolTip),this.listenTo(this._equationManager,b.INVALID_COMBINE_WITHIN_DIFF_PARENT,this._showInvalidCombineWithinDiffParentTooltip),this.listenTo(this._equationManager,b.INVALID_COMBINE_WITHIN_SAME_PARENT,this._showInvalidCombineWithinSameParentTooltip),this.listenTo(this._equationManager,b.INVALID_COMBINE_FOR_TILE_VALUE_EXCEEDING,this._showInvalidCombineForTileValueExceeding),this.listenTo(this._equationManager,b.INVALID_COMBINE_FOR_BASE_VALUE_EXCEEDING,this._showInvalidCombineForBaseValueExceeding),this.listenTo(this._equationManager,b.INVALID_COMBINE_FOR_MARQUEE,this._showInvalidCombineForMarquee),this.listenTo(this._equationManager,b.TILE_DRAGGING_START,this._tileDragStart),this.listenTo(this._equationManager,b.MARQUEE_START,this._marqueeDrawingStart),this.listenTo(this._equationManager,b.MARQUEE_DRAG_START,this._onMarqueeDragging),this.listenTo(this._equationManager,b.PARENTHESIS_EXPONENT_CLICK,this._parenthesisExponentClick),this.listenTo(this._equationManager,b.REVERT_START,this.onTileItemRevertStart),this.listenTo(this._equationManager,b.REVERT_END,this.onTileItemRevertEnd),this.listenTo(this._equationManager,b.ATTEMPT_OPERATION,this._hideCombineLikeBasesTooltip),this.listenTo(this._equationManager,b.TILE_MOUSE_DOWN,this._tileMouseDown),this.listenTo(this._equationManager,b.SOLVE_TAB,this._solveTabPressed),this.listenTo(this._equationManager,b.SOLVE_SHIFT_TAB,this._solveShiftTabPressed),this.listenTo(this._equationManager,b.SOLVE_SET_FOCUS_ON_TOOLTIP,this._setFocusToCombineLikeBasesTooltip),this.listenTo(this._equationManager,b.FANNING_ANIMATION_START,this.animationStart),this.listenTo(this._equationManager,b.FANNING_ANIMATION_END,this.animationEnd),this.listenTo(this._equationManager,b.TILE_DRAGGING_START,this.removeHighlightTiles),this.listenTo(this._equationManager,b.TILE_MOUSE_DOWN,this.removeHighlightTiles),this.listenTo(this._equationManager,b.MARQUEE_START,this.removeHighlightTiles),this.listenTo(this._equationManager,b.MARQUEE_DRAG_START,this.removeHighlightTiles),this.listenTo(this._equationManager,b.PARENTHESIS_EXPONENT_CLICK,this.removeHighlightTiles)},_solveTabPressed:function(){var a=MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE;"none"!==this.combineLikeBasesTooltip.$el.css("display")?this.setFocus("solve-text-in-tooltip"):this.solveModeUndoButtonView.getButtonState()===a?this.setFocus("solve-mode-undo-button"):this.solveModeResetButtonView.getButtonState()===a?this.setFocus("solve-mode-reset-button"):this.setFocus("view-data-button")},_solveShiftTabPressed:function(){this.setFocus("main-activity-area-container")},onTileItemRevertStart:function(){this.animationStart()},onTileItemRevertEnd:function(){this.animationEnd()},_parenthesisExponentClick:function(){this.stopReading()},setCurrentLevelOfEquationManager:function(){this._equationManager.setCurrentLevel(this.model.get("accordionLevel"))},_onMarqueeDragging:function(){this.stopReading(),this._hideCombineLikeBasesTooltip()},_marqueeDrawingStart:function(){this.stopReading(),this._hideCombineLikeBasesTooltip()},_tileDragStart:function(){this.stopReading(),this._hideCombineLikeBasesTooltip(),this._equationManager.hideAllTooltips()},_tileMouseDown:function(){this.stopReading(),this._hideCombineLikeBasesTooltip()},_showInvalidCombineForTileValueExceeding:function(){var a=this._invalidCombineForTileValueExceedingText();this._changeCombineLikeBasesTooltipText(a),this.combineLikeBasesTooltip.showTooltip()},_showInvalidCombineForBaseValueExceeding:function(){var a=this._invalidCombineForBaseValueExceedingText();this._changeCombineLikeBasesTooltipText(a),this.combineLikeBasesTooltip.showTooltip()},_showInvalidCombineForMarquee:function(){var a=this._invalidCombineForMarquee();this._changeCombineLikeBasesTooltipText(a),this.combineLikeBasesTooltip.showTooltip()},_showMaxLimitCrossedToolTip:function(){var a=this._maxLimitCrossedTooltipText();this._changeCombineLikeBasesTooltipText(a),this.combineLikeBasesTooltip.showTooltip()},_showInvalidCombineWithinSameParentTooltip:function(){var a=this._invalidCombineWithinSameParentText();this._changeCombineLikeBasesTooltipText(a),this.combineLikeBasesTooltip.showTooltip()},_showInvalidCombineWithinDiffParentTooltip:function(){var a=this._invalidCombineWithinDiffParentText();this._changeCombineLikeBasesTooltipText(a),this.combineLikeBasesTooltip.showTooltip()},_resetAccordionData:function(){var a=this.model,b=a.get("accordionEquationData"),c=a.get("currentEquationDataIndex"),d=b[c];MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED;d&&(d.steps=[]),a.set("stepCount",0),this.model.set("isAccordionEqnDataChanged",!0),a.set("accordionEquationData",b),a.set("pureAndSimpleShown",!1),this._disableEnableButtons(this.solveModeUndoButtonView,!1),this._disableEnableButtons(this.solveModeResetButtonView,!1)},_checkPureAndSimple:function(){var b,c,d=this.model.get("stepCount"),e=[],f=[],g=!1,h=!1;if(this.model.get("pureAndSimpleShown")!==!0&&this._equationManager&&this._equationManager.equationView){if(b=this._equationManager.equationView.model,e=b.getAllBases(),c=b.isNegativeExpPresent(),b.isParenthesisPresent()||c===!1)return;if(1===e.length){var i=this;window.setTimeout(function(){i._showPureAndSimple()},200),this.animationStart()}else if(f=this._findUniqueTiles(e),-1!==f.indexOf(1)&&(g=!0),-1!==f.indexOf(-1)&&b.isExpAbsOne()===!0&&(h=!0),f.length===e.length&&d>=a.FormExpression.RULES.MIN_NUM_STEPS&&g===!1&&h===!1){var i=this;window.setTimeout(function(){i._showPureAndSimple()},200),this.animationStart()}}},_showPureAndSimple:function(){this._equationManager&&this._equationManager.removeCurrentAccDiv(),this._showPureAndSimplePopup(),this.model.set("pureAndSimpleShown",!0)},_showPureAndSimplePopup:function(){var a=this,b={title:this.getMessage("pure-and-simple-popup","title"),text:this.getMessage("pure-and-simple-popup","text"),accText:this.getAccMessage("pure-and-simple-popup","text"),manager:this.manager,player:this.player,path:this.filePath,idPrefix:this.idPrefix,width:462,containsTts:!0,buttons:[{id:"pure-and-simple-continue",text:this.getMessage("pure-and-simple-popup","continue"),response:{isPositive:!0,buttonClicked:this.idPrefix+"pure-and-simple-continue"},baseClass:"btn-yellow",textColor:"#222222",clickCallBack:{fnc:this.onClickContinue,scope:this}},{id:"pure-and-simple-try-again",text:this.getMessage("pure-and-simple-popup","try-again"),response:{isPositive:!0,buttonClicked:this.idPrefix+"pure-and-simple-try-again"},baseClass:"btn-yellow",textColor:"#222222",clickCallBack:{fnc:this._resetSolveModeScreen,scope:this}}]};this.pureAndSimplePopup=MathInteractives.global.Theme2.PopUpBox.createPopup(b),this.setFocus("theme2-pop-up-title-text-combined-acc",500),this.pureAndSimplePopup.$el.find(".theme2-pop-up-text.theme2-pop-up-text-defaultType").addClass("pure-and-simple-body-text"),this.pureAndSimplePopup.$el.find(".theme2-pop-up-title-text").addClass("pure-and-simple-title-text"),this.pureAndSimplePopup.$el.find(".btn-yellow").off("keydown").on("keydown",function(b){var c=b.keyCode?b.keyCode:b.charCode;32===c&&setTimeout(function(){a.setFocus("workspace-scrollable")},5)})},onClickContinue:function(){this.setFocus("workspace-scrollable"),this.animationEnd()},onClickTryAgain:function(){this._goToIntialScreen()},_addDataForNewExpression:function(a){var b=this.model,c=b.get("currentEquationDataIndex"),d=b.get("accordionEquationData"),e={};c+=1,e.header=a.equationHtml,e.headerAccString=a.equationAccString,e.steps=[],d.push(e),b.set("currentEquationDataIndex",c),b.set("accordionEquationData",d),this.model.set("isAccordionEqnDataChanged",!0),this.model.set("stepCount",0)},_addDataForNewStep:function(a){var b=this.model,c=b.get("accordionEquationData"),d=b.get("currentEquationDataIndex"),e=c[d],f=e.steps,g={},h=(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE,b.get("stepCount"));h+=1,b.set("stepCount",h),g.htmlString=a.equationHtml,g.accString=a.equationAccString,f.push(g),c=this._getTotalAccordionTupleCount(c,d),this.model.set("isAccordionEqnDataChanged",!0),b.set("accordionEquationData",c),h>=1&&(this._disableEnableButtons(this.solveModeResetButtonView,!0),this._disableEnableButtons(this.solveModeUndoButtonView,!0))},_getTotalAccordionTupleCount:function(a,b){var c,d=0,e=this.model.get("accordionMaxTupleCount"),f=0;for(c=0;c<a.length;c++)d+=a[c].steps.length;for(;d>e&&f!=b;)d-=a[f].steps.length+1,a.shift(),b-=1,this.model.set("accordionRowsToDelete",this.model.get("accordionRowsToDelete")+1),f++;return this.model.set("currentEquationDataIndex",b),a},_removeDataForNewStep:function(){var a=this.model,b=a.get("accordionEquationData"),c=a.get("currentEquationDataIndex"),d=b[c],e=d.steps,f=(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED,a.get("stepCount"));e.pop(),this.model.set("isAccordionEqnDataChanged",!0),a.set("accordionEquationData",b),f-=1,this.model.set("stepCount",f),0===f&&(this._disableEnableButtons(this.solveModeUndoButtonView,!1),this._disableEnableButtons(this.solveModeResetButtonView,!1))},_changeMaxBasesAllowedTooltipWidth:function(a){var b,c=22;a===!0?(this.maxBasesAllowedTooltip.changeContainerWidth(562),this.maxBasesAllowedTooltip.$el.find(".text-in-tooltip").css({width:562-c})):(b=this.player.getTextHeightWidth(a).width+20,this.maxBasesAllowedTooltip.changeContainerWidth(b+c),this.maxBasesAllowedTooltip.$el.find(".text-in-tooltip").css({width:b}))},animationStart:function(){this._$animationDiv.show()},animationEnd:function(){this._$animationDiv.hide()},_stopPropagationOnAnimation:function(a){a.stopPropagation()},activateEventOnTiles:function(a){var b,c={},d=0;if(a){d=a.length;for(var e=0;d>e;e++)c=a[e],c&&(b=this._getBinElementFromIndex(c.index),b&&b.isTile&&this._attachEventOnBinTiles(b,c.simulateAction))}},deActivateClickEventsOnTiles:function(){this._detachNegateTileEvents(".base-draggable-tiles"),this._detachNegateTileEvents(".exponent-draggable-tiles"),this._detachNegateTileEvents(".parenthesis-draggable-tiles")},_attachEventOnBinTiles:function(b,c){switch(c){case 1:case 7:case 11:var d=b.element.el.getAttribute("data-tilevalue"),e="",f="";b.groupTitle===a.FormExpression.BASE_TYPE?(f=".base-draggable-tiles",e=".tile-value"+Math.abs(parseInt(d,10))):b.groupTitle===a.FormExpression.EXPONENT_TYPE?(f=".exponent-draggable-tiles",e=".tile-value"+Math.abs(parseInt(d,10))):b.groupTitle===a.FormExpression.PARENTHESIS_TYPE&&(f=".parenthesis-draggable-tiles",e=".tile-value"+d),this._attachNegateTileEvents(f+e+".clickEnabled");break;case 2:case 8:break;case 3:case 9:b.element.$el.draggable("enable");break;case 6:}},applyHandCursor:function(a){var b,c,d=this;null===this._isTouch&&this._setIsTouch(),this._isTouch||(b="mouseenter",c="mouseleave",a.off("mouseover").on("mouseover",function(){a.hasClass("disabled")||a.hasClass("inactive")||(this._isTouch?a.removeClass("down").addClass("hover"):a.addClass("hover"))}).off("mouseout").on("mouseout",function(){this._isTouch?a.removeClass("hover"):a.removeClass("hover")}),a.off(b).on(b,function(){a.hasClass("disabled")||a.hasClass("inactive")||a.css({cursor:"url('"+d.getImagePath("open-hand")+"'), move"})}).off(c).on(c,function(){a.hasClass("disabled")||a.hasClass("inactive")||a.css({cursor:"default"})}).off("mousedown.cursor-change").on("mousedown.cursor-change",function(){a.hasClass("disabled")||a.hasClass("inactive")||a.css({cursor:"url('"+d.getImagePath("closed-hand")+"'), move"})}).off("mouseup.cursor-change").on("mouseup.cursor-change",function(){a.hasClass("disabled")||a.hasClass("inactive")||a.css({cursor:"url('"+d.getImagePath("open-hand")+"'), move"})}))}},{BASE_TILE_MIN_VALUE:2,BASE_TILE_MAX_VALUE:9,POSITIVE_EXPONENT_TILE_MIN_VALUE:1,POSITIVE_EXPONENT_TILE_MAX_VALUE:9,BASE_TYPE:"base",EXPONENT_TYPE:"exponent",PARENTHESIS_TYPE:"parenthesis",RAISE_FRACTION:"fraction",ALLOWED_BASES:3,SEPERATOR_ELEMENT_INDEX:"$",SEPERATOR_MENU_INDEX:"|",BASE_TILES_RESET_ARRAY:[2,3,4,5,6,7,8,9],EXPONENT_TILES_RESET_ARRAY:[1,2,3,4,5,6,7,8,9],BIN_BASE_TILE_WIDTH_HEIGHT:48,BIN_EXPONENT_TILE_WIDTH_HEIGHT:36,BUILD_MODE_PARENTHESIS_SIZE:{width:48,height:48},RULES:{MIN_NUM_STEPS:1},BASE_CTX_ITEM_ID:{CHANGE_SIGN:"bin-base-tiles-context-menu-0",ADD_MUL:"bin-base-tiles-context-menu-1",ADD_NUM_DIV:"bin-base-tiles-context-menu-2",ADD_DEN_DIV:"bin-base-tiles-context-menu-3"},EXP_CTX_ITEM_ID:{CHANGE_SIGN:"bin-exponent-tiles-context-menu-0",ADD_MUL:"bin-exponent-tiles-context-menu-1",ADD_NUM_DIV:"bin-exponent-tiles-context-menu-2",ADD_DEN_DIV:"bin-exponent-tiles-context-menu-3",RAISE_TO_FRACTION:"bin-exponent-tiles-context-menu-4"},PARENS_CTX_ITEM_ID:{NOT_USED:"bin-parenthesis-tiles-context-menu-0",ADD_EXPR:"bin-parenthesis-tiles-context-menu-1",ADD_NUM:"bin-parenthesis-tiles-context-menu-2",ADD_DEN:"bin-parenthesis-tiles-context-menu-3"}})}(),function(){"use strict";var a=MathInteractives.Common.Interactivities.ExponentAccordion.Views,b=MathInteractives.Common.Components.Models.EquationManager,c=MathInteractives.Common.Components.Views.EquationManager;a.TutorialFormExpression=a.FormExpression.extend({_parseStep:null,_currentMode:null,_isClickToNegate:!1,_setNegateTile:!1,_gotItPopupView:null,_totalAction:-1,_EMOptions:{},_menuItem:null,_isScrollInSolveMode:null,accTutSourceData:{},accTutDestData:{},_bindEventsOnButtons:function(){a.TutorialFormExpression.__super__._bindEventsOnButtons.apply(this,arguments);var b=this;this.$el.off("click",".replay-btn.clickEnabled").on("click",".replay-btn.clickEnabled",function(a){b._onReplayBtnClick(a)}),this.$el.off("mousedown")},_onReplayBtnClick:function(){this.stopReading(),this.$(".fake-marquee").remove(),this._setNegateTile=!1,this.tutorialView.playParsedStep()},enableDisableReplayBtn:function(a){var b=MathInteractives.global.Theme2.Button,c=a?b.BUTTON_STATE_ACTIVE:b.BUTTON_STATE_DISABLED;this.buildModeReplayBtn.setButtonState(c),this.solveModeReplayBtn.setButtonState(c)},initialize:function(){this.$el.removeClass("form-expression-tab"),this.accordionLevel=this.model.get("accordionLevel");var a=(this.model.get("currentView"),MathInteractives.Common.Utilities.Models.BrowserCheck);MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion;this._isIE9=a.isIE===!0&&"9.0"===a.browserVersion,this._isIE=a.isIE===!0||a.isIE11===!0,this.initializeDefaultProperties(),this.options.idPrefix&&(this.idPrefix=this.options.idPrefix),null!==this.options.tutorialMode&&void 0!==this.options.tutorialMode&&(this._tutorialMode=this.options.tutorialMode),this.loadScreen("direction-text-screen"),this.loadScreen("form-expression-screen"),this._cacheDomElements(),this._renderDirectionText(),this.createFormEquationManager(),this.render(),this._bindAccEvents(),this._bindEventsOnButtons(),this.loadScreen("swipe-region-screen"),this._handleTouchScroll(),this._createContextMenu(),this.listenTo(this.model,"change:tutorialDataSelectorView",this.setAccessibilityTextForMainActivityArea,this)},createFormEquationManager:function(){var c,d;c="*",d={player:this.player,allowedOperation:this.model.get("allowedOperation"),maxPrimeLimit:this.model.get("maxPrimeLimit"),fractionMode:this.model.get("fractionMode"),isParenthesesAllowed:this.model.get("isParenthesesAllowed"),adjustContainment:!1,mode:b.EquationManager.MODES.BuildMode,buildModeParenthesisSize:a.FormExpression.BUILD_MODE_PARENTHESIS_SIZE},this._formEquationManager=new a.FormExpressionEquationManager({element:this.$("#"+this.idPrefix+"droppable-region"),strDroppables:c,marqueeDiv:"#"+this.idPrefix+"droppable-region-holder",model:new b.EquationManager(d),tutorialMode:!0,player:this.player,filePath:this.filePath,manager:this.manager}),this._attchBinEvents(),MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile||this._attachAccEvents(),this._currentMode=b.EquationManager.MODES.BuildMode;
},_createEquationManager:function(){if(!this._equationManager){var c={allowedOperation:this.model.get("allowedTutorialOperation"),maxPrimeLimit:this.model.get("maxPrimeLimit"),allowManagerLevelOperations:4095,player:this.player,filePath:this.filePath,manager:this.manager,fractionMode:this.model.get("fractionMode"),isParenthesesAllowed:this.model.get("isParenthesesAllowed"),numOfTilesInNumDen:this.model.get("numOfTilesInNumDen"),adjustContainment:!0,mode:b.EquationManager.MODES.SolveMode};this._equationManager=new a.EquationManager({model:new b.EquationManager(c),element:this.$("#"+this.idPrefix+"workspace-scrollable"),draggableContainment:this.$("#"+this.idPrefix+"workspace-draggable-containment"),tutorialMode:!0,player:this.player,filePath:this.filePath,idPrefix:this.idPrefix,manager:this.manager}),this._attachDataEvents(),this._currentMode=b.EquationManager.MODES.SolveMode}},_setNewEquation:function(a,b,c,d,e){var f={};f={cmdFactoryData:{allowedOperation:this.model.get("allowedTutorialOperation"),maxPrimeLimit:this.model.get("maxPrimeLimit"),undoStack:[]},equationData:c,equationViewContainer:b},f.player=this.player,f.filePath=this.filePath,f.manager=this.manager,f.idPrefix=this.idPrefix,a.setData(f,e),d&&(a.render(),this.unloadScreen("expression-text"),this.loadScreen("expression-text")),this._enableDisableEquationViewDroppable(a)},playTutorialMode:function(){this._tutorialMode&&this.tutorialView&&this.tutorialView.play()},_cursorEnumsForStep:null,_cursorChangeCounter:0,_createTutorialPlayer:function(a){var b=MathInteractives.Common.Components.Theme2.Models.TutorialPlayer,c=b.EVENTS,d=new b({steps:a});this.tutorialView=new MathInteractives.Common.Components.Theme2.Views.TutorialPlayer({player:this.player,idPrefix:this.idPrefix,model:d}),this.tutorialView.off(c.ALL_STEPS_COMPLETED).on(c.ALL_STEPS_COMPLETED,$.proxy(this._allStepsCompleted,this))},_setTutorialPlayerEl:function(a){this.tutorialView.setElement(a),this.tutorialView.render()},_renderButtons:function(){a.TutorialFormExpression.__super__._renderButtons.apply(this,arguments),this._renderReplayAnimationButtons(),this.loadScreen("tutorial-buttons-screen")},_renderReplayAnimationButtons:function(){var a,b;a=MathInteractives.global.Theme2.Button,b={idPrefix:this.idPrefix,player:this.player,manager:this.manager,path:this.filePath,data:{id:this.idPrefix+"replay-btn",text:this.getMessage("replay-button-text",0),type:MathInteractives.global.Theme2.Button.TYPE.TEXT,baseClass:"btn-yellow",textColor:"#222222"}},this.buildModeReplayBtn=new a.generateButton(b),b.data.id=this.idPrefix+"solve-mode-replay-btn",this.solveModeReplayBtn=new a.generateButton(b)},_disableParenthesis:function(a){var b,c,d=this.parenthesisTilesViews.dragButtonViews;for(b=0;b<a.length;b++)c=a[b],d[a[b]].setButtonState("disabled"),d[a[b]].$el.draggable("disable");2===b&&this.player.enableHelpElement("parenthesis-tile-container-value-1",0,!1)},_tutorialBuildModeDivisionMode:!1,_tutorialSolveModeDivisionMode:!1,updateViewForTutorialMode:function(){var a,c=this.model,d=MathInteractives.Common.Components.Theme2.Models.TutorialPlayer.EVENTS,e=c.get("tutorialView"),f=c.get("tutorialLessons"),g=c.get("currentTutorialLessonNumber");switch(this.$el.addClass("tutorial-area").removeClass("tutorial-0 tutorial-1 tutorial-2 tutorial-3 tutorial-4 tutorial-5").addClass("tutorial-"+g),this._renderDirectionText(),this.unloadScreen("tutorial-bin-tiles-screen"),this.loadScreen("tutorial-bin-tiles-screen"),this.enableTab("droppable-region",!1),this.binBaseTilesContextMenuView.editContextMenu([this.idPrefix+"bin-base-tiles-context-menu-0",this.idPrefix+"bin-base-tiles-context-menu-1",this.idPrefix+"bin-base-tiles-context-menu-2",this.idPrefix+"bin-base-tiles-context-menu-3",this.idPrefix+"bin-base-tiles-context-menu-4",this.idPrefix+"bin-base-tiles-context-menu-5"],!1),this.binExponentTilesContextMenuView.editContextMenu([this.idPrefix+"bin-exponent-tiles-context-menu-0",this.idPrefix+"bin-exponent-tiles-context-menu-1",this.idPrefix+"bin-exponent-tiles-context-menu-2",this.idPrefix+"bin-exponent-tiles-context-menu-3",this.idPrefix+"bin-exponent-tiles-context-menu-4",this.idPrefix+"bin-exponent-tiles-context-menu-5",this.idPrefix+"bin-exponent-tiles-context-menu-6"],!1),g){case 0:this.binBaseTilesContextMenuView.editContextMenu([this.idPrefix+"bin-base-tiles-context-menu-0",this.idPrefix+"bin-base-tiles-context-menu-2",this.idPrefix+"bin-base-tiles-context-menu-3",this.idPrefix+"bin-base-tiles-context-menu-4",this.idPrefix+"bin-base-tiles-context-menu-5"],!0),this.binExponentTilesContextMenuView.editContextMenu([this.idPrefix+"bin-exponent-tiles-context-menu-0",this.idPrefix+"bin-exponent-tiles-context-menu-2",this.idPrefix+"bin-exponent-tiles-context-menu-3",this.idPrefix+"bin-exponent-tiles-context-menu-4",this.idPrefix+"bin-exponent-tiles-context-menu-5",this.idPrefix+"bin-exponent-tiles-context-menu-6"],!0);break;case 1:this.binBaseTilesContextMenuView.editContextMenu([this.idPrefix+"bin-base-tiles-context-menu-1",this.idPrefix+"bin-base-tiles-context-menu-2",this.idPrefix+"bin-base-tiles-context-menu-3",this.idPrefix+"bin-base-tiles-context-menu-4",this.idPrefix+"bin-base-tiles-context-menu-5"],!0),this.binExponentTilesContextMenuView.editContextMenu([this.idPrefix+"bin-exponent-tiles-context-menu-0",this.idPrefix+"bin-exponent-tiles-context-menu-2",this.idPrefix+"bin-exponent-tiles-context-menu-3",this.idPrefix+"bin-exponent-tiles-context-menu-4",this.idPrefix+"bin-exponent-tiles-context-menu-5",this.idPrefix+"bin-exponent-tiles-context-menu-6"],!0);break;case 5:this.binExponentTilesContextMenuView.editContextMenu([this.idPrefix+"bin-exponent-tiles-context-menu-1",this.idPrefix+"bin-exponent-tiles-context-menu-2",this.idPrefix+"bin-exponent-tiles-context-menu-3",this.idPrefix+"bin-exponent-tiles-context-menu-4",this.idPrefix+"bin-exponent-tiles-context-menu-5",this.idPrefix+"bin-exponent-tiles-context-menu-6"],!0)}(null===e||e===ExponentAccordionModel.EXPLORE_VIEW.FORMATION)&&(this._resetAllBinTiles(),this._activateAllBinTiles(!1)),this._disableAllButtons(),f[g]&&(null===this.tutorialView?(this._createTutorialPlayer(f[g].steps),this._setTutorialPlayerEl(this._$elmTutorialContainer)):this.tutorialView.updateSteps(f[g].steps),f[g].equationData&&(a=f[g].equationData,this._currentMode=a.startMode,this._currentMode===b.EquationManager.MODES.BuildMode?(this.tileDropped=!0,a.tileArray[0].type===b.TileItem.BinTileType.FRACTION?(this._$elmFormExpDropRegion.addClass("division").removeClass("multiplication"),this._tutorialBuildModeDivisionMode=!0):(this._$elmFormExpDropRegion.removeClass("division").addClass("multiplication"),this._tutorialBuildModeDivisionMode=!1),this._setNewEquation(this._formEquationManager,this.$("#"+this.idPrefix+"form-expression-area"),a,!0),this._showHideFormEquationView(!0)):this._currentMode===b.EquationManager.MODES.SolveMode&&(this._createEquationManager(),this._tutorialSolveModeDivisionMode=this.model.get("accordionLevel")>2,this._setNewEquation(this._equationManager,this.$("#"+this.idPrefix+"workspace-expression-area"),a,!0),this._renderInitialExpression(a),this._showHideEquationManager(!0)),this._isTouch&&(this._isScrollInSolveMode=a.scrollMode,this._isScrollInSolveMode?this._setScrollForSolveMode():this._resetScrollForSolveMode())),this.tutorialView.off(d.PARSED_STEP_REQUIRED).on(d.PARSED_STEP_REQUIRED,this._parsedStepRequired,this).off(d.ANIMATION_START).on(d.ANIMATION_START,$.proxy(this._onTutorialAnimationStart,this)).off(d.STEP_ANIMATION_END).on(d.STEP_ANIMATION_END,$.proxy(this._onTutorialStepAnimationComplete,this)).off(d.HANDLE_CSS_ANIMATION_FOR_IE9).on(d.HANDLE_CSS_ANIMATION_FOR_IE9,$.proxy(this._handleIe9CssAnimation,this)).off(d.CURSOR_CHANGE_REQUIRED).on(d.CURSOR_CHANGE_REQUIRED,$.proxy(this._onCursorChangeRequired,this)),this.$(".fake-marquee").remove(),this.toggleButtonView&&this.toggleButtonView.$el.removeClass("inactive on-inactive off-inactive")),this._equationManager&&this._equationManager.removeMarquee(),this._formEquationManager&&this._formEquationManager.removeMarquee()},updateAccessibilityTextForBinTiles:function(){this.setAccMessage("base-tile-value2",this.getAccMessage("base-tile-value2",0)+this.getAccMessage("tutorial-base-exp-messages",0)+this.getAccMessage("tutorial-base-exp-messages",2)),this.setAccMessage("base-tile-value4",this.getAccMessage("base-tile-value4",0)+this.getAccMessage("tutorial-base-exp-messages",0)+this.getAccMessage("tutorial-base-exp-messages",2)),this.setAccMessage("exponent-tile-value1",this.getAccMessage("exponent-tile-value1",0)+this.getAccMessage("tutorial-base-exp-messages",0)+this.getAccMessage("tutorial-base-exp-messages",1)),this.setAccMessage("exponent-tile-value2",this.getAccMessage("exponent-tile-value2",0)+this.getAccMessage("tutorial-base-exp-messages",0)+this.getAccMessage("tutorial-base-exp-messages",1)),this.setAccMessage("exponent-tile-value6",this.getAccMessage("exponent-tile-value6",0)+this.getAccMessage("tutorial-base-exp-messages",0)+this.getAccMessage("tutorial-base-exp-messages",1))},setAccessibilityTextForMainActivityArea:function(a,c){if(c===MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.TUTORIAL_VIEW.TUTORIAL_SCREEN){if(this._currentMode===b.EquationManager.MODES.SolveMode)return void this.setAccMessage("main-activity-area-container",this.getAccMessage("tutorial-acc-container",5)+this.getAccMessage("tutorial-acc-container",1));switch(a.get("currentTutorialLessonNumber")){case 0:this.setAccMessage("main-activity-area-container",this.getAccMessage("tutorial-acc-container",0)+this.getAccMessage("tutorial-acc-container",1));break;case 1:case 5:this.setAccMessage("main-activity-area-container",this.getAccMessage("tutorial-acc-container",0)+this.getAccMessage("tutorial-acc-container",2)+this.getAccMessage("tutorial-acc-container",1))}}},_setScrollForSolveMode:function(){var a=this.$el.find(".workspace-bottom-container");a.removeClass("withScroll").addClass("withScroll");var b=this.$el.find(".replay-btn-container");b.removeClass("withScroll").addClass("withScroll"),this._showHideScrollRegion(!0)},_resetScrollForSolveMode:function(){var a=this.$el.find(".workspace-bottom-container");a.removeClass("withScroll");var b=this.$el.find(".replay-btn-container");b.removeClass("withScroll"),this._showHideScrollRegion(!1)},_showHideScrollRegion:function(a){var b=this.$el.find(".swipe-region");a?b.show():b.hide()},_renderInitialExpression:function(a){var b=$.extend(!0,{},a).tileArray,c=this._getExpression(b,a.type),d=this.$(".original-expression-holder").html(c),e=this.filePath,f=e.getFontAwesomeClass("dot");d.find(".operator-data-tab").addClass(f),d.find(".denominator").hasClass("denominator-empty")&&d.find(".vincullum").hide()},_getOriginalExpression:function(){var a=this._equationManager.getCurrentEquationJSON(),b={tileArray:a.tileArray,type:a.type};return this._getExpression(b.tileArray,b.type,"")},_allStepsCompleted:function(){this._EMOptions={},this._updateEventOnEquationManager();var c=this;window.setTimeout(function(){c.animationStart()},100),this.enableDisableReplayBtn(!1);var d=null;this._currentMode===b.EquationManager.MODES.BuildMode?d=this._formEquationManager:this._currentMode===b.EquationManager.MODES.SolveMode&&(d=this._equationManager),d.deActivateEventOnAllTiles(!0),this.$el.find(".custom-droppable-disabled").removeClass("custom-droppable-disabled"),this.$el.find(".inactive").removeClass("inactive"),window.setTimeout($.proxy(this._showGotItPopup,this),a.TutorialFormExpression.ANIMATION_DURATIONS.PAUSE_BETWEEN_ANIMATIONS)},_onTutorialAnimationStart:function(){var a;this.player.enableAllHeaderButtons(!1),this.enableDisableReplayBtn(!1),this._isTutorialPlaying=!0,this._cursorChangeCounter=0,this._currentMode===b.EquationManager.MODES.BuildMode?a=this._formEquationManager:this._currentMode===b.EquationManager.MODES.SolveMode&&(a=this._equationManager),a.animationOn=!0},_onCursorChangeRequired:function(){var a,b=this._cursorEnumsForStep[this._cursorChangeCounter];null===b&&"undefined"==typeof b&&(b=0),a=this._getCursorInfo(b),this.tutorialView.updateCursor(a),this._cursorChangeCounter++},_getCursorInfo:function(b){var c,d=a.TutorialFormExpression.CURSORS,e=d[b];switch(c={cursorImage:"",interactionPointOffset:{x:0,y:0}},b){case"0":break;case"1":case"2":case"3":case"4":c.cursorImage="url('data:image/png;base64,"+e.BASE_64+"')",c.size={width:e.WIDTH+"px",height:e.HEIGHT+"px"}}return c},_parsedStepRequired:function(c){var d=a.TutorialFormExpression.SEPERATOR_ACTION,e=a.TutorialFormExpression.SEPERATOR_DATA,f=a.TutorialFormExpression.SEPERATOR_TARGET,g=MathInteractives.Common.Components.Theme2.Models.TutorialPlayer.EVENTS,h=null,i=0,j=null,k=null,l=null,m=0,n=null,o=null,p=null,q=null,r=null,s=null,t=null,u=null,v=null,w=[],x=[],y=[],z=[],A=null,B={},C={},D=null,E={},F=[],G=-1,H=!1,I=null,J=this,K=[];if(this.stepContainsMarquee=!1,c){if(h=c.action){j=h.split(d),i=parseInt(j,10),this._totalAction=i;for(var L=1;i>=L;L++)if(A={},k=j[L],k&&(l=k.split(e))){G=parseInt(l[0],10),A.nextStepToJump=isNaN(G)?-1:G,A.simulateActionEnum=parseInt(l[1],10),K.push(A.simulateActionEnum),m=l.length;for(var M=2;m>M;M++)if(D={},C={},n=l[M],n&&(o=n.split(f))){if(p=o[0],q=o[1],"string"===$.type(q)&&(q=Number(q)),p){var N=p.split("|");if(2===N.length&&(H=!0),this._validTargetElement(N[0])){B=this._getTutorialElementIndex(N[0]);var O=this._getViewWithOffset(B,q);K.push(B,q),O&&(O.element.length?2===M?D.element=O.element[0]:D.element=O.element.slice(1):D.element=O.element,D.offset=O.offset,D.isButton=O.isButton),C.index=B.elementIndex,C.simulateAction=A.simulateActionEnum,C.offset=q,H&&(C.menuIndex=N[1]),B.isBin?z.push($.extend({},C)):(2===M?B.isNotTile?s=!0:y.push($.extend({},C)):B.isNotTile?t=!0:x.push(B.elementIndex),B.isNotTile&&!this.stepContainsMarquee&&(this.stepContainsMarquee=!0))}}if(r=o[2]){F=r.split(a.FormExpression.SEPERATOR_MENU_INDEX),this._dynamicGenElemAnimationData=[];for(var P=1;P<F.length;P++)this._dynamicGenElemAnimationData[P-1]=this._getParsedAnimationObject(F[P]);D.animation=this._getParsedAnimationObject(F[0]),D.animation.isButton=D.isButton}2===M?A.target=$.extend({},D):3===M&&(A.nextTarget=$.extend({},D))}w.push($.extend({},A))}}this._resetSimulatedStep=!!c.requiresUndo,this._cursorEnumsForStep=c.cursor?c.cursor.split("."):[],this._parseStep=w,this._currentMode===b.EquationManager.MODES.BuildMode?I=this._formEquationManager:this._currentMode===b.EquationManager.MODES.SolveMode&&(I=this._equationManager),this.deActivateClickEventsOnTiles(),this._enableDisableToggleButtonState(!1),I.deActivateEventOnAllTiles(!0)}window.setTimeout(function(){E={},w[0]&&(E.actionEnum=w[0].simulateActionEnum),E.lstTargetIndex=x,E.lstAllowTargetIndexEM=y,E.isMarqueeDraggable=s,E.isMarqueeDroppable=t,J._EMOptions=E,J._updateEventOnEquationManager(),c&&(u=c.enable,J._enableDisableTiles(u,!0,!1),v=c.disable,J._enableDisableTiles(v,!1)),J._updateEventOnBin(z),J.tutorialView.trigger(g.STEP_PARSED,w),J.animationEnd()},300),c&&this.accGetFocusOnRequiredElements(K)},_attachAccEvents:function(){this.listenTo(this._formEquationManager,c.FormExpressionEquationManager.EVENTS.TUT_SPACE_PRESSED_GO_TO_BIN,this.accTutorialSetFocusToBinElement)},accGetFocusOnRequiredElements:function(a){var d,e,f,g,h,i,j,k=a[0],l=MathInteractives.Common.Components.Theme2.Models,m=c.EquationManager.EVENTS;if(this._currentMode===b.EquationManager.MODES.BuildMode?d=this._formEquationManager:this._currentMode===b.EquationManager.MODES.SolveMode&&(d=this._equationManager),e=a[1],f=a[2],e.isBin?(g=this._getBinElementViewFromIndex(e.elementIndex),this.accTutSourceData=d.accTutSourceData={sourceView:g,isBin:!0,offset:f,operation:k,index:e.elementIndex},0===this.model.get("currentTutorialLessonStepNumber")&&this.accTutorialSetFocusToBinElement(this.accTutSourceData,!0)):(g=e.isNotTile?d.marqueeView:d.getViewFromIndex(e.elementIndex),this.accTutSourceData=d.accTutSourceData={sourceView:g,isBin:!1,offset:f,operation:k,index:e.elementIndex}),k===l.TutorialPlayer.METHOD_ENUM_INVERSE._promptUserToDrag&&(h=a[3],i=a[4],j=h.isNotTile?d.marqueeView:d.getViewFromIndex(h.elementIndex),this.accTutDestData=d.accTutDestData={sourceView:j,isBin:!1,offset:i,index:h.elementIndex}),this._currentMode===b.EquationManager.MODES.BuildMode)switch(k){case 6:d.equationView.customTutorialString=this.getAccMessage("build-equation-manager",0),d.tutorialCustomTileString=this.getAccMessage("build-equation-manager",1);break;case 9:"2"===e.elementIndex.charAt(0)?(d.equationView.customTutorialString=this.getAccMessage("build-equation-manager",0),d.tutorialCustomTileString=this.getAccMessage("build-equation-manager",2)):(d.equationView.customTutorialString="",d.tutorialCustomTileString="");break;default:d.equationView.customTutorialString="",d.tutorialCustomTileString=""}else switch(d.equationView.customTutorialString=this.getAccMessage("build-equation-manager",0),k){case 6:d.tutorialCustomTileString=this.getAccMessage("build-equation-manager",1);break;case 7:d.tutorialCustomTileString=1===f?this.getAccMessage("build-equation-manager",3):this.getAccMessage("build-equation-manager",4);break;case 9:d.tutorialCustomTileString=this.getAccMessage("build-equation-manager",5);break;default:d.tutorialCustomTileString=""}d.trigger(m.TUTORIAL_STEP_CHANGE)},accTutorialSetFocusToBinElement:function(a,b){var c=a.sourceView.$el.attr("id").replace(this.idPrefix,""),d=a.operation;if(9===d||11===d){var e,f=a.sourceView.$el.attr("data-tilevalue"),g=1===+a.index.charAt(0)?1:2;e=-1===f.indexOf("-")?1===+a.index.charAt(0)?5:4:1===+a.index.charAt(0)?7:6,9===d&&this.setAccMessage(c,this.getAccMessage("tutorial-base-exp-messages",e,[Math.abs(+f)])+this.getAccMessage("tutorial-base-exp-messages",0)+this.getAccMessage("tutorial-base-exp-messages",g)),11===d&&this.setAccMessage(c,this.getAccMessage("tutorial-base-exp-messages",e,[Math.abs(+f)])+this.getAccMessage("tutorial-base-exp-messages",3))}b!==!0&&this.setFocus(c)},_contextMenuSelectEvent:function(a,b){var c=this;a.off(b).on(b,function(a,b){var d=b.currentTarget.id,e=$(a.currentTarget),f=parseInt(d.substring(d.lastIndexOf("-")+1),10);switch(f){case 0:var g=a.currentTarget,h=$(g),i=g.id.replace(c.idPrefix,"");c._tileClickEvent(c,h),window.setTimeout(function(){c.setFocus(i)},1020),c.binBaseTilesContextMenuView.editContextMenu([c.idPrefix+"bin-base-tiles-context-menu-0",c.idPrefix+"bin-base-tiles-context-menu-1",c.idPrefix+"bin-base-tiles-context-menu-2",c.idPrefix+"bin-base-tiles-context-menu-3",c.idPrefix+"bin-base-tiles-context-menu-4",c.idPrefix+"bin-base-tiles-context-menu-5"],!1),c.binBaseTilesContextMenuView.editContextMenu([c.idPrefix+"bin-base-tiles-context-menu-0",c.idPrefix+"bin-base-tiles-context-menu-2",c.idPrefix+"bin-base-tiles-context-menu-3",c.idPrefix+"bin-base-tiles-context-menu-4",c.idPrefix+"bin-base-tiles-context-menu-5"],!0),5===c.model.get("currentTutorialLessonNumber")&&"EXPONENT"===h.attr("data-tiletype")&&(c.binExponentTilesContextMenuView.editContextMenu([c.idPrefix+"bin-exponent-tiles-context-menu-0",c.idPrefix+"bin-exponent-tiles-context-menu-1",c.idPrefix+"bin-exponent-tiles-context-menu-2",c.idPrefix+"bin-exponent-tiles-context-menu-3",c.idPrefix+"bin-exponent-tiles-context-menu-4",c.idPrefix+"bin-exponent-tiles-context-menu-5",c.idPrefix+"bin-exponent-tiles-context-menu-6"],!1),c.binExponentTilesContextMenuView.editContextMenu([c.idPrefix+"bin-exponent-tiles-context-menu-0",c.idPrefix+"bin-exponent-tiles-context-menu-1",c.idPrefix+"bin-exponent-tiles-context-menu-2",c.idPrefix+"bin-exponent-tiles-context-menu-3",c.idPrefix+"bin-exponent-tiles-context-menu-4",c.idPrefix+"bin-exponent-tiles-context-menu-5"],!0));break;case 1:if("none"!==c._formEquationManager.$el.css("display"))c._formEquationManager.selectedTile=e,c._dropBinTileUsingContextMenu(!1),1===c.model.get("currentTutorialLessonNumber")&&(c.binBaseTilesContextMenuView.editContextMenu([c.idPrefix+"bin-base-tiles-context-menu-0",c.idPrefix+"bin-base-tiles-context-menu-1",c.idPrefix+"bin-base-tiles-context-menu-2",c.idPrefix+"bin-base-tiles-context-menu-3",c.idPrefix+"bin-base-tiles-context-menu-4",c.idPrefix+"bin-base-tiles-context-menu-5"],!1),c.binBaseTilesContextMenuView.editContextMenu([c.idPrefix+"bin-base-tiles-context-menu-1",c.idPrefix+"bin-base-tiles-context-menu-2",c.idPrefix+"bin-base-tiles-context-menu-3",c.idPrefix+"bin-base-tiles-context-menu-4",c.idPrefix+"bin-base-tiles-context-menu-5"],!0));else{var j=c._$elmStartDropRegionMultiplication;c._onTileDropForAcc(a,b,j,!1,"0",e)}break;case 2:if("none"===c._formEquationManager.$el.css("display")){var j=c._$elmStartDropRegionDivision;c._onTileDropForAcc(a,b,j,!0,"0.0",e)}else c._formEquationManager.selectedTile=e,c._dropBinTileUsingContextMenu(!1);break;case 3:if("none"===c._formEquationManager.$el.css("display")){var j=c._$elmStartDropRegionDivision;c._onTileDropForAcc(a,b,j,!0,"0.1",e)}else c._formEquationManager.selectedTile=e,c._dropBinTileUsingContextMenu(!0);break;case 4:c._formEquationManager.selectedTile=e,c._dropBinTileUsingContextMenu(!1,!0)}})},_bindAccEvents:function(){var a=this;this.$(".base-draggable-tiles, .exponent-draggable-tiles").off("keyup").on("keyup",function(b){return a._formEquationManager&&a._formEquationManager.animationOn||"block"===a._$animationDiv.css("display")?(b.preventDefault(),b.stopImmediatePropagation(),!1):void 0}),this.$(".base-draggable-tiles, .exponent-draggable-tiles").off("keydown").on("keydown",function(b){if(a._formEquationManager&&a._formEquationManager.animationOn||"block"===a._$animationDiv.css("display"))return b.preventDefault(),!1;var c=b.keyCode?b.keyCode:b.charCode;32===c?(b.preventDefault(),a.$el.trigger("mousedown").trigger("mouseup").trigger("click"),9===a.accTutSourceData.operation?(a._formEquationManager.selectedTile=$(this),$(this).trigger("dragstart"),5===a.model.get("currentTutorialLessonNumber")&&1===a.accTutDestData.offset?a._setFocusToExponentBigParenthesis(!0):a._setFocusToNumerator()):11===a.accTutSourceData.operation&&b.preventDefault()):13===c&&b.preventDefault()}),this.$(".raised-to-power-toggle-button").off("keydown").on("keydown",function(b){var c=b.keyCode?b.keyCode:b.charCode;32===c&&(a._formEquationManager.equationView&&(a._formEquationManager.equationView.tileDroppedString=a.getMessage("base-exp-pair",21)),setTimeout(function(){a.setFocus("droppable-region")},500))}),this.$(".replay-btn").off("keydown").on("keydown",function(b){var c=b.keyCode?b.keyCode:b.charCode;32===c&&setTimeout(function(){a.setFocusToAnimatingElement()},5)}),this.focusIn("workspace-scrollable",function(){a._equationManager.equationView.startAcc()}),this.focusIn("droppable-region",function(b){a._formEquationManager.equationView.buildStartAcc()})},setFocusToAnimatingElement:function(){this.accTutSourceData.isBin===!0&&"2"!==this.accTutSourceData.index.charAt(0)?this.accTutorialSetFocusToBinElement(this.accTutSourceData):this._currentMode===b.EquationManager.MODES.BuildMode?this.setFocus("droppable-region"):this._currentMode===b.EquationManager.MODES.SolveMode&&this.setFocus("workspace-scrollable")},_setFocusToNumerator:function(){var a,b=this._tutorialBuildModeDivisionMode,c=5===this.model.get("currentTutorialLessonNumber"),d=!1;b&&c?a="0.0":b?a="0":(a="0",d=!0),this._formEquationManager.setFocusToNumerator(a,d)},_dropBinTileUsingContextMenu:function(a,b){var c,d=this._tutorialBuildModeDivisionMode,e=5===this.model.get("currentTutorialLessonNumber"),f=!1;b?c="0":d&&e?c="0.0":d?c="0":(c="0",f=!0),this._formEquationManager.dropBinTileUsingContextMenu(c,f,a,b)},_setFocusToMaxBasesAllowedTooltip:function(){if(this._formEquationManager.getCurrentAccView()&&this._formEquationManager.getCurrentAccView().removeAccDiv(),1===this.model.get("currentTutorialLessonNumber")&&(this.binBaseTilesContextMenuView.editContextMenu([this.idPrefix+"bin-base-tiles-context-menu-0",this.idPrefix+"bin-base-tiles-context-menu-1",this.idPrefix+"bin-base-tiles-context-menu-2",this.idPrefix+"bin-base-tiles-context-menu-3",this.idPrefix+"bin-base-tiles-context-menu-4",this.idPrefix+"bin-base-tiles-context-menu-5"],!1),this.binBaseTilesContextMenuView.editContextMenu([this.idPrefix+"bin-base-tiles-context-menu-1",this.idPrefix+"bin-base-tiles-context-menu-2",this.idPrefix+"bin-base-tiles-context-menu-3",this.idPrefix+"bin-base-tiles-context-menu-4",this.idPrefix+"bin-base-tiles-context-menu-5"],!0)),this._parseStep[0].nextTarget){var a=this._parseStep[0].nextTarget;a.animation&&a.animation.className&&$(a.element).removeClass(a.animation.className).removeClass("animated")}this.setFocus("droppable-region"),this._proceedToNextStep()},_getViewWithOffset:function(a,c){var d,e,f,g,h,i,j=null,k=null,l=null,m=!1;return a&&(a.isBin?(i=this._getBinElementViewFromIndex(a.elementIndex),j=i.el,k=this._getBinElementOffsetFromView(i,c),d=a.elementIndex,e=d.indexOf("."),f=d.substring(0,e),"3"===f&&(f=d.substring(e+1,d.length),e=f.indexOf("."),e>0?(g=f.substring(0,e),"0"===g&&(f=f.substring(e+1,f.length),"1"===f&&(j=i.$(".handle")[0],k=this._getElementOffsetFromElement(j,c)))):m=!0),l={element:j,offset:k,isButton:m}):(this._currentMode===b.EquationManager.MODES.BuildMode?h=this._formEquationManager:this._currentMode===b.EquationManager.MODES.SolveMode&&(h=this._equationManager),a.isNotTile?(j=h.marqueeView.$marqueeDiv[0],l={element:j,offset:this._getElementOffsetFromElement(j,0),isButton:m}):(i=h.getViewFromIndex(a.elementIndex),i&&(l=i._getTutorialMouseEventPoint(c))))),l},_updateEventOnBin:function(a){this.activateEventOnTiles(a)},_updateEventOnEquationManager:function(){var a,c,d,e,f,g,h=this._EMOptions;switch(a=h.lstTargetIndex||[],c=h.lstAllowTargetIndexEM||[],d=MathInteractives.Common.Components.Theme2.Models.TutorialPlayer.METHOD_ENUM_INVERSE,this._currentMode===b.EquationManager.MODES.BuildMode?e=this._formEquationManager:this._currentMode===b.EquationManager.MODES.SolveMode&&(e=this._equationManager),e.disableTiles(!0),h.actionEnum){case d._promptUserToMarquee:e.marqueeView.enableMarquee(),f=c[0].index,g=a[0],e.setTutorialMarqueeTargetsIndex(f,g);break;default:this.stepContainsMarquee&&(e.marqueeView.showMarquee(),h.isMarqueeDraggable&&e.marqueeView.$marqueeDiv.draggable("enable"),h.isMarqueeDroppable&&e.marqueeView.$marqueeDiv.droppable("enable")),e.setTutorialTargetViewIndex(a),e.activateEventOnTiles(c)}},_getTutorialElementIndex:function(b){var c,d,e={};if(b&&(c=b.split(a.FormExpression.SEPERATOR_ELEMENT_INDEX),c[1]))switch(d=c[1],e.elementIndex=d,c[0]){case"0":e.isBin=!0;break;case"2":e.isNotTile=!0;default:e.isBin=!1}return e},_getParsedAnimationObject:function(b){b=b.split(a.FormExpression.SEPERATOR_ELEMENT_INDEX);var c=b[0],d={className:c,isNotStandard:!!b[1]};switch(c){case"bounce":break;case"pulse":d.times=3,d.duration=a.TutorialFormExpression.ANIMATION_DURATIONS.PULSE_3_TIMES}return d},_handleIe9CssAnimation:function(a,b,c){switch(b){case"flashBorder":this._flashBorderInIE9(a,c);break;case"flashShadow":this._flashShadowInIE9(a,c);break;case"flashShadowReverse":this._flashShadowInIE9Reverse(a,c)}},_flashBorderInIE9:function(b,c){b=b instanceof $?b:$(b);var d,e=a.TutorialFormExpression.ANIMATION_DURATIONS.FLASH_BORDER,f=6,g=e/f;(d=function h(){return 0===f?void(c&&c.apply(arguments)):void window.setTimeout(function(){b.css({"border-color":"#ffc000"}),f--,window.setTimeout(function(){b.css({"border-color":"rgba(0,0,0,0)"}),f--,h()},g)},g)})()},_flashShadowInIE9:function(b,c){b=b instanceof $?b:$(b);var d,e=a.TutorialFormExpression.ANIMATION_DURATIONS.FLASH_BORDER,f=6,g=e/f;(d=function h(){return 0===f?void(c&&c.apply(arguments)):void window.setTimeout(function(){b.css({"box-shadow":"inset 0px -5px 0px 0px rgba(0,0,0,0.42)"}),f--,window.setTimeout(function(){b.css({"box-shadow":"0px 0px 15px 0px rgba(255,255,255,1), inset 0px -5px 0px 0px rgba(0,0,0,0.42)"}),f--,h()},g)},g)})()},_flashShadowInIE9Reverse:function(b,c){b=b instanceof $?b:$(b);var d,e=a.TutorialFormExpression.ANIMATION_DURATIONS.FLASH_BORDER,f=6,g=e/f;(d=function h(){return 0===f?void(c&&c.apply(arguments)):void window.setTimeout(function(){b.css({"box-shadow":"0px 0px 0px 4px #ffc000"}),f--,window.setTimeout(function(){b.css({"box-shadow":"none"}),f--,h()},g)},g)})()},_onTutorialStepAnimationComplete:function(c){var d,e,f=this;this._currentMode===b.EquationManager.MODES.BuildMode?d=this._formEquationManager:this._currentMode===b.EquationManager.MODES.SolveMode&&(d=this._equationManager),window.setTimeout(function(){d.animationOn=!1},200),f._resetSimulatedStep?(f.tutorialView.$el.show(),window.setTimeout(function(){f._parseStep[0].simulateActionEnum===MathInteractives.Common.Components.Theme2.Models.TutorialPlayer.METHOD_ENUM_INVERSE._simulateToggleButtonToggle?f.toggleButtonView.changeStateOfToggleButton(MathInteractives.Common.Components.Theme2.Views.ToggleButton.TOGGLEBUTTON_STATE_OFF):f._parseStep[0].simulateActionEnum===MathInteractives.Common.Components.Theme2.Models.TutorialPlayer.METHOD_ENUM_INVERSE._simulateTileClick&&(f._setNegateTile=!1,$(f._parseStep[0].nextTarget.element).trigger("click",[{isTutorialUndoTrigger:!0}])),f.player.enableAllHeaderButtons(!0),f.player.enableHelp(!1),f.tutorialView.$el.hide(),f._isTutorialPlaying=!1,f.enableDisableReplayBtn(!0),d.deActivateEventOnAllTiles(!0),f._updateEventOnEquationManager()},a.TutorialFormExpression.ANIMATION_DURATIONS.PAUSE_BETWEEN_ANIMATIONS_FOR_TOGGLE_BUTTON)):(c[0].simulateActionEnum===MathInteractives.Common.Components.Theme2.Models.TutorialPlayer.METHOD_ENUM_INVERSE._promptUserToMarquee&&(e=this.getMessage("prompt-user-to-marquee-tooltip-text",0),f._currentMode===b.EquationManager.MODES.BuildMode?(f._changeMaxBasesAllowedTooltipText(e),f.maxBasesAllowedTooltip.showTooltip(),this.updateFocusRect("build-text-in-tooltip")):f._currentMode===b.EquationManager.MODES.SolveMode&&(f.$(".marquee-inline-feedback-container").removeClass("show-at-top"),2===f.model.get("currentTutorialLessonNumber")&&f.$(".marquee-inline-feedback-container").addClass("show-at-top"),f.solveModeMarqueeTooltip.showTooltip())),f.player.enableAllHeaderButtons(!0),f.player.enableHelp(!1),f._isTutorialPlaying=!1,f.enableDisableReplayBtn(!0))},_generateRaisedToPowerToggle:function(){a.TutorialFormExpression.__super__._generateRaisedToPowerToggle.apply(this,arguments);var b=MathInteractives.Common.Components.Theme2.Views.ToggleButton;this.listenTo(this.toggleButtonView,b.ACTION_COMPLETE_EVENT,this._onToggleStateChangeComplete)},_onToggleStateChangeComplete:function(a){this.stopReading();var c=MathInteractives.Common.Components.Theme2.Views.ToggleButton;this.resetClicked!==!0&&(a===c.TOGGLEBUTTON_STATE_ON?this.internalToggle===!0&&this.tileDropped===!0&&(this._isTutorialPlaying||this._proceedToNextStep()):(this._currentMode===b.EquationManager.MODES.BuildMode?this._formEquationManager.deActivateEventOnAllTiles(!0):this._currentMode===b.EquationManager.MODES.SolveMode&&this._equationManager.deActivateEventOnAllTiles(!0),this._updateEventOnEquationManager()))},_changeToggleStateOnOrOff:function(a){this.internalToggle===!0&&this._formEquationManager.toggleBigParenthesis(a)},_createFormExpressionDroppable:function(){},_tileClickEvent:function(b,c){this._parseStep[0].simulateActionEnum===MathInteractives.Common.Components.Theme2.Models.TutorialPlayer.METHOD_ENUM_INVERSE._simulateTileClick&&(this._setNegateTile&&(this._isClickToNegate=!0,this.deActivateClickEventsOnTiles()),this._setNegateTile=!0);var d=this.model.get("tryAnotherBtnStatus");a.TutorialFormExpression.__super__._tileClickEvent.apply(this,arguments),this.model.set("tryAnotherBtnStatus",d)},animationEnd:function(){a.TutorialFormExpression.__super__.animationEnd.apply(this,arguments),this._isClickToNegate&&(this._parseStep[0].target&&this._isIE&&this.forceRefreshElementInDOM(this._parseStep[0].target.element),this._proceedToNextStep(),this._isClickToNegate=!1,this._setNegateTile=!1)},forceRefreshElementInDOM:function(a){if(a){var b,c=a.style.visibility;a.style.visibility="hidden",b=a.style.clientWidth,a.style.visibility=c}},_onBinTileDragStart:function(b){
a.TutorialFormExpression.__super__._onBinTileDragStart.apply(this,arguments)},_addMarqueeScope:function(){a.TutorialFormExpression.__super__._addMarqueeScope.apply(this,arguments),this.$(".fake-marquee").remove(),this._currentMode===b.EquationManager.MODES.BuildMode?this._formEquationManager.detachListenersOnMarqueeContainment():this._currentMode===b.EquationManager.MODES.SolveMode&&this._equationManager.detachListenersOnMarqueeContainment(),this._proceedToNextStep()},_createTooltips:function(){a.TutorialFormExpression.__super__._createTooltips.apply(this,arguments),this._createSolveModeMarqueeTooltip()},solveModeMarqueeTooltip:null,_createSolveModeMarqueeTooltip:function(){if(null===this.solveModeMarqueeTooltip){var a={elementEl:this.idPrefix+"marquee-inline-feedback-container",idPrefix:this.idPrefix,manager:this.manager,_player:this.player,type:MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.FORM_VALIDATION,arrowType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.BOTTOM_MIDDLE,path:this.filePath,filePath:this.filePath,isTts:!1,isArrow:!1,closeOnDocumentClick:!0},b=this;a.text='<div class="text-in-tooltip">'+this.getMessage("prompt-user-to-marquee-tooltip-text",0)+'</div><div id="'+this.idPrefix+'close-btn-in-marquee-tooltip" class="close-btn-in-tooltip"></div>',this.solveModeMarqueeTooltip=MathInteractives.global.Theme2.Tooltip.generateTooltip(a),this.solveModeMarqueeTooltipCloseBtn=new MathInteractives.global.Theme2.Button.generateButton({player:this.player,manager:this.manager,path:this.filePath,idPrefix:this.idPrefix,data:{id:this.idPrefix+"close-btn-in-marquee-tooltip",type:MathInteractives.global.Theme2.Button.TYPE.FA_ICON,baseClass:"close-btn-base-class",height:17,tooltipText:this.getMessage("button-tooltip-text","close"),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE,icon:{faClass:b.filePath.getFontAwesomeClass("close"),fontColor:"#744b11"}}}),this.solveModeMarqueeTooltipCloseBtn.$el.on("click",function(){b.solveModeMarqueeTooltip.hideTooltip()}),this._attachCloseButtonEvents(this.solveModeMarqueeTooltipCloseBtn.$el)}},_onBinTileDragStop:function(a){if(this._formEquationManager&&this._formEquationManager.setIsDropped(!1),a.ui&&a.ui.helper.data("isValidDrop")){if(this._parseStep[0].nextTarget){var b=this._parseStep[0].nextTarget;b.animation&&b.animation.className&&$(b.element).removeClass(b.animation.className).removeClass("animated")}this._proceedToNextStep()}var c=a.ui,d=a.$element;c.helper.removeData("cur-droppable"),d.removeData("isDropped"),this.animationEnd()},_tutorialAddDataForNewStep:function(a){this._proceedToNextStep(a)},_tutorialBreakCommand:function(a){var b=this,c=this._$animationDiv.clone().appendTo(this.$el).show();window.setTimeout(function(){b._proceedToNextStep(a),c.remove()},2e3)},_proceedToNextStep:function(a){var b=this._parseStep[0].nextStepToJump;if(this._parseStep.length>1){var c=this._getActionCount(a);-1!==c&&(b=this._parseStep[c].nextStepToJump)}this.animationStart(),this.enableDisableReplayBtn(!1),this.stopEvent=!1,this.tutorialView.proceedToNextStep(b),this.removeHighlightDisabledTiles()},_getActionCount:function(a){var b="",c=null;if(a&&a.source){b=a.source.index;for(var d=this._EMOptions.lstAllowTargetIndexEM.length,e=0;d>e;e++)if(c=this._EMOptions.lstAllowTargetIndexEM[e],c&&c.index===b)return e}return-1},_renderDirectionText:function(){var a=this.model,b=-1===a.get("currentTutorialLessonNumber")?0:a.get("currentTutorialLessonNumber"),c="tutorial-"+b,d=this.getMessage("direction-text",c),e=this.getAccMessage("direction-text",c),f=a.get("tutorialLessons"),g=f.length,h=!1;null===this.directionBoxView?(g>1&&(h=!0),this.directionBoxView=new MathInteractives.global.Theme2.DirectionText.generateDirectionText({idPrefix:this.idPrefix,containerId:this.idPrefix+"direction-text-container",manager:this.manager,player:this.player,path:this.filePath,text:d,accText:e,btnBaseClass:"btn-yellow",ttsBaseClass:"tts-yellow",showButton:h,btnColorType:MathInteractives.global.Theme2.Button.COLORTYPE.HEADER_BLUE,btnTextColor:"#222222",buttonText:this.getMessage("try-another-text","tutorial"),clickCallback:{fnc:this._onClickPickTutorial,scope:this},textColor:"#FFFFFF",containmentBGcolor:"#282828",buttonTabIndex:3e3,tabIndex:501})):this.directionBoxView.changeDirectionText(d,!1,e)},_attchBinEvents:function(){var b=this._formEquationManager;this.listenTo(b,c.FormExpressionEquationManager.EVENTS.DONE_BUTTON_STATUS,this._checkDoneButtonStaus),this.listenTo(b,c.EquationManager.EVENTS.MARQUEE_DRAWN,this._addMarqueeScope),this.listenTo(b,c.EquationManager.EVENTS.MARQUEE_REMOVED,this._removeMarqueeScope),this.listenTo(b,a.FormExpressionEquationManager.EVENTS.BIG_PARENTHESIS_ADDED,this._onAddBigParenthesis),this.listenTo(b,a.FormExpressionEquationManager.EVENTS.BIG_PARENTHESIS_REMOVED,this._onRemoveBigParenthesis),this.listenTo(b,c.EquationManager.EVENTS.BUILD_SET_FOCUS_ON_TOOLTIP,this._setFocusToMaxBasesAllowedTooltip),this.listenTo(b,c.EquationManager.EVENTS.TILE_DRAGGING_START,this._tileDraggingStart)},_tileDraggingStart:function(){this.maxBasesAllowedTooltip.hideTooltip(),this.stopReading()},_attachDataEvents:function(){var b=c.EquationManager.EVENTS;a.TutorialFormExpression.__super__._attachDataEvents.apply(this,arguments),this.listenTo(this._equationManager,b.MARQUEE_DRAWN,this._onMarqueeDrawn),this.listenTo(this._equationManager,b.TUTORIAL_ADD_STEP,this._tutorialAddDataForNewStep),this.listenTo(this._equationManager,b.TUTORIAL_BREAK_COMMAND,this._tutorialBreakCommand),this.listenTo(this._equationManager,b.TOOLTIP_VISIBLE,this._tooltipVisible),this.listenTo(this._equationManager,b.TOOLTIP_HIDE,this._tooltipHide),this.listenTo(this._equationManager,b.SOLVE_SET_FOCUS_ON_TOOLTIP,this._setFocusToCombineLikeBasesTooltip),this.listenTo(this._equationManager,b.TILE_DRAGGING_START,this._tileDragStart)},_tileDragStart:function(){this.solveModeMarqueeTooltip.hideTooltip(),this._equationManager.hideAllTooltips(),this.stopReading()},_setFocusToCombineLikeBasesTooltip:function(){this._equationManager.getCurrentAccView()&&this.setFocus("workspace-scrollable")},_tooltipVisible:function(a){var b=this._EMOptions.lstAllowTargetIndexEM,c=null,d=null;b&&b.length>0&&(c=b[0],c&&("0"===c.menuIndex?d=a.applyExponent:"1"===c.menuIndex&&(d=a.changeSign))),d&&(this.tutorialView.animateDynamicGeneratedElements([{element:d.el,animation:this._dynamicGenElemAnimationData[0]}]),this._menuItem=d)},_dynamicGenElemAnimationData:null,_tooltipHide:function(){this._menuItem&&(this._menuItem=null)},_onMarqueeDrawn:function(){this.$(".fake-marquee").remove(),this._currentMode===b.EquationManager.MODES.BuildMode?this._formEquationManager.detachListenersOnMarqueeContainment():this._currentMode===b.EquationManager.MODES.SolveMode&&this._equationManager.detachListenersOnMarqueeContainment(),this._proceedToNextStep()},_enableDisableTiles:function(a,c,d){var e=null;a&&(e=this._getListOfElements(a),this._validTargetElement(e)&&(c?this._enableDisableSpecificBinElements(e.bin,!0,d):this._inactivateSpecificBinElement(e.bin),this._currentMode===b.EquationManager.MODES.BuildMode?this._formEquationManager.enableDisableTilesItems(e.equationManager,c):this._currentMode===b.EquationManager.MODES.SolveMode&&this._equationManager.enableDisableTilesItems(e.equationManager,c)))},_enableDisableEquationViewDroppable:function(a){var c=b.EquationManager.MODES;a.model.get("mode")===c.BuildMode?this._tutorialBuildModeDivisionMode?a.enableDroppableEquationView(!1):a.enableDroppableEquationView(!0):this._tutorialSolveModeDivisionMode?a.enableDroppableEquationView(!1):a.enableDroppableEquationView(!0)},_doneButtonClick:function(){this._currentMode=b.EquationManager.MODES.SolveMode,this.setAccessibilityTextForMainActivityArea(this.model,this.model.get("tutorialDataSelectorView"));var a;MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED;this.stopReading(),this._equationManager&&this._equationManager.resetData(),this._formEquationManager.addTileForNegativeParCoeff(),a=JSON.parse(JSON.stringify(this._formEquationManager.equationView.model.toJSON())),this._tutorialSolveModeDivisionMode=this._tutorialBuildModeDivisionMode,this._tutorialBuildModeDivisionMode===!1&&this.model.get("accordionLevel")>2&&(a=this._formEquationManager.wrapFractionTileItem(a),this._tutorialSolveModeDivisionMode=!0),this._formEquationManager.resetData(),this._showHideEquationManager(!0),this._createEquationManager(),this._setNewEquation(this._equationManager,this.$("#"+this.idPrefix+"workspace-expression-area"),a,!0,!1),this._renderOriginalExpression(),this._equationManager.showMarquee(),this._equationManager.removeMarquee(),this._proceedToNextStep(),this.setFocus("direction-text-container-direction-text-text")},_showGotItPopup:function(){var a=[],b=this.model.get("currentTutorialLessonNumber"),c=this.model.get("tutorialLessons"),d=c.length,e=this.getMessage("got-it-popup","title"),f=this.getMessage("got-it-popup","msg"),g=null;this._equationManager&&this._equationManager.removeCurrentAccDiv(),d>0&&(d-1>b&&a.push({id:this.idPrefix+"next-btn",width:169,text:this.getMessage("got-it-popup","next"),type:MathInteractives.global.Theme2.Button.TYPE.FA_ICONTEXT,icon:{faClass:this.getFontAwesomeClass("fixed-next"),fontColor:"#222222",fontWeight:"bold",height:15,width:9},response:{isPositive:!0,buttonClicked:this.idPrefix+"next-btn"},clickCallBack:{fnc:this._onClickNext,scope:this},textPosition:"left",baseClass:"btn-yellow"}),a.push({id:"try-btn",width:169,text:this.getMessage("got-it-popup","try"),response:{isPositive:!0,buttonClicked:this.idPrefix+"try-btn"},clickCallBack:{fnc:this._onClickTryAgain,scope:this},baseClass:"btn-yellow"}),d>1?a.push({id:"pick-btn",width:169,text:this.getMessage("got-it-popup","pick"),response:{isPositive:!0,buttonClicked:this.idPrefix+"pick-btn"},clickCallBack:{fnc:this._onClickPickTutorial,scope:this},baseClass:"btn-yellow"}):g=465,d-1>b&&a.push({id:"skip-btn",width:169,text:this.getMessage("got-it-popup","skip"),response:{isPositive:!0,buttonClicked:this.idPrefix+"skip-btn"},clickCallBack:{fnc:this._onClickSkipTutorials,scope:this},baseClass:"btn-yellow"})),b===d-1&&(f=this.getMessage("got-it-popup","msg-of-last-pop-up"),e=this.getMessage("got-it-popup","title-of-last-pop-up"),a.push({id:"go-explore-btn",width:169,text:this.getMessage("got-it-popup","explore"),response:{isPositive:!0,buttonClicked:this.idPrefix+"go-explore-btn"},clickCallBack:{fnc:this._onClickSkipTutorials,scope:this},baseClass:"btn-yellow"})),this._gotItPopupView=MathInteractives.global.Theme2.PopUpBox.createPopup({text:f,title:e,manager:this.manager,player:this.player,path:this.filePath,idPrefix:this.idPrefix,titleTextColorClass:"popup-title-text",bodyTextColorClass:"popup-body-text",buttons:a,width:g}),this._changeDimensionsOfGotItPopup(this._gotItPopupView.$el)},_changeDimensionsOfGotItPopup:function(a){var b=this.model.get("accordionLevel");a.find(".theme2-pop-up-dialogue").css({width:"502px",top:"",left:"",bottom:"25px",right:"25px"}),a.find(".theme2-pop-up-btns-container").addClass("buttons-container-adjust-margin"),a.find(".theme2-pop-up-btns-aligner").css("width","377px"),a.find(".theme2-pop-up-title").addClass("adjust-margin-got-it-title"),a.find(".theme2-pop-up-body").addClass("got-it-popup-body"),a.find(".theme2-pop-up-tts-container").css("left","").addClass("got-it-popup-tts"),a.find(".theme2-pop-up-bottom-btn").addClass("adjust-margin-got-it-buttons"),b>1?(a.find(".theme2-pop-up-title-text-combined-acc-defaultType").css({top:"35px"}),a.find("#"+this.idPrefix+"go-explore-btn").addClass("go-explore-tutorial-complete")):a.find(".theme2-pop-up-title-text-combined-acc-defaultType").css({top:"35px",height:"66px"}),this.updateFocusRect("theme2-pop-up-title-text-combined-acc")},_onClickSkipTutorials:function(){this.stopReading(),this.trigger(a.TutorialFormExpression.SHOW_EXPLORE_TAB)},_onClickPickTutorial:function(){this.stopReading(),this._setNegateTile=!1,this.trigger(a.TutorialFormExpression.PICK_TUTORIAL)},_onClickTryAgain:function(){this.stopReading(),this.updateViewForTutorialMode(),this.setAccessibilityTextForMainActivityArea(this.model,this.model.get("tutorialDataSelectorView")),this.playTutorialMode(),this.setFocus("direction-text-container-direction-text-text")},_onClickNext:function(){this.stopReading();var b=this.model.get("currentTutorialLessonNumber"),c=this.model.get("tutorialLessons");-1!==b&&(b+=1,c[b]?(this.model.set("currentTutorialLessonNumber",b),this.trigger(a.TutorialFormExpression.UPDATE_TUTORIAL_SCREEN,b),this.updateViewForTutorialMode(),this.setAccessibilityTextForMainActivityArea(this.model,this.model.get("tutorialDataSelectorView")),this.playTutorialMode(),this.setFocus("direction-text-container-direction-text-text")):this.trigger(a.TutorialFormExpression.PICK_TUTORIAL))},_checkPureAndSimple:function(){},_showPureAndSimple:function(){},_updateTileValueInModel:function(a){},_getNegationsFromModel:function(a,b){for(var c=[],d=0;d<a.length;d++)c[d]='<span class="tile-number">'+a[d]+"</span>";return{newArray:a,textForTiles:c}},removeHighlightDisabledTiles:function(){var a=$(".custom-droppable-disabled .new-created-tile"),b=$(".inactive");a.removeClass("new-created-tile"),b.removeClass("new-created-tile")}},{ANIMATION_DURATIONS:{PAUSE_BETWEEN_ANIMATIONS:200,PAUSE_BETWEEN_ANIMATIONS_FOR_TOGGLE_BUTTON:1e3,FLASH_BORDER:2e3,PULSE_3_TIMES:2e3},CURSORS:{1:{BASE_64:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAZCAYAAAA4/K6pAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyRTVDMTE5ODdCNzgxMUU0QTk5N0ZFQTBERUExODFCMyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyRTVDMTE5OTdCNzgxMUU0QTk5N0ZFQTBERUExODFCMyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjJFNUMxMTk2N0I3ODExRTRBOTk3RkVBMERFQTE4MUIzIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjJFNUMxMTk3N0I3ODExRTRBOTk3RkVBMERFQTE4MUIzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+WPxSggAAAr5JREFUeNqcVF1IU2EYPn/bBJ0rXWQLNkIZzkYJBuqFCKNw88oushuvEq+yuxEVRJfhpSAxJgy2YBfihTS1RTGJghJkrMU2WGwSFcw/1qxG07Pz9bxjwZQpRz94t33Pvvf53uc9z3tEjuNeIxTEZ+6U6wfiA+LWaQmSPT09bHBwMMXz/E3sxRNlIynl9XrZ2tqabDabdwBdRmjV5guMMU6WZQ5ViOFw2GA0Gl8Bv6OagD7K5XJlY7PZxNnZ2YtOp/MutrfVEEiHgZGREdbc3GwvlUqPVlZWdICeI5hqAmqLw+HgJEm6srm56Ukmk18gMw78z5ES6q3+/n62tLSkaWlpCR33iI8k0Gg0vMVikQKBQOvQ0NB9QONqJRxYw8PDil6vt4mi6F5eXqYLfdR31QRU5cDAAPWkc2tr6xn88g09WYV/8mQBQe3zhk+UhYUF3mq1BkE2RsnH9uDw0mq1gslkEufn58+Ojo4+BPSA8qWTDo7dbmdut/sCzDeOikqqCLLZLMtkMjyqqPgET4jr6+vrWFxcfFqXALOhkEYcJInM5/PJU1NTEgio+2VBELj9/X0Obt2oR8BmZma49fV1YXp6ugIUi0UJpO8R97Ddq04rdXGPZn/S5XIZe3t7K4f9fj+PeBuLxT7ipo7u7m5Rp9MJhUJhG6Q/of1N9SW0gdimnJTH42E4wObm5hjKXgV2HXEDJf/N5XIkh0UiEdbU1ES3dh62skCa4vE4NzExsQNtY8DoFqPBYNijflC50Cs3NDT8rpqPP9DktrY2Bt+/w++rNbgexNdgnO/BYJAIlEQiIbe3t3+tnQtie4Iyz+GbRvZTDcEvRVFS6XTakM/nyUh8V1eX2NjYaMZ/lv+HxGoivZWz9QyIOI8Kz6B5rdFolIVCoZe7u7svgKfVmk+E9x9DfxFVZDBEl2p78E+AAQBZ+Boe1D0ffQAAAABJRU5ErkJggg==",WIDTH:16,HEIGHT:25},2:{BASE_64:"iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfeDAQILh5RacheAAAAXUlEQVRIx+2T0Q4AEAhF+/+fvhhDk61i86DjwXroTBdEHOTlojaiQLBremPdW3VBALOCCUznEAT6QaYAB3oBmx+LRimAKNAmgB3GCK8LHE/pRCBco+NDPRcEQfA3CVmCLOLKzprfAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTEyLTA0VDA4OjQ2OjMxKzAxOjAwlLoGZQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMi0wNFQwODo0NjozMCswMTowMEOQtW0AAAAASUVORK5CYII=",WIDTH:32,HEIGHT:32},3:{BASE_64:"iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfeDAQILzJ6qpX8AAAAQklEQVRIx2NgGAVUBP+BEJUkTTsIoJKkGfIfHTBADKHECNIM+E+ZAf+xAwoNoGsIYDGC9JSAZsSAGDAKRsEoGNkAABiywj6PuunXAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTEyLTA0VDA4OjQ3OjUwKzAxOjAwG2BvaAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMi0wNFQwODo0Nzo1MCswMTowMGo919QAAAAASUVORK5CYII=",WIDTH:32,HEIGHT:32},4:{BASE_64:"iVBORw0KGgoAAAANSUhEUgAAABMAAAAYCAYAAAAYl8YPAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oGBhA5NghChMYAAAFdSURBVDjLrVV/C4IwEH1XK9SGW0Oi7//9smloYeX1T5uTZiX1YHBMeffu54iZ8S8spj5orVlrPc8TM78crTU7SCk59k/sRJX1fe/t5XL5W5jX69Xb5/P5N7JQjVLqN7IkSbxd1zWklCyl/FgMEbvsus7baZrieDw6lczMEEKgLEv6ikyI4fp+v4/y5xwZY7jve1hr6W2YIUHY1MYYb18uF1hroZTiEVme56yU4t1uxwBANEQQ2qfTydvr9RoAUFUVXD6F817XtZfftu2oAA5N00SdpGk6KAtboSxLbDabj23gigIAt9ttILPWUpZl0Tx91V+LxbgAbdtSURR4ks+e75dqOrlzlblZHpFZa2m73c7eY1FlYfzfwhiDqqooSnY4HGapc6mZnICwh+aQTW7N54Z9i/1+zx83bTgu7xBOx+TWcMiyDKvVCkSEruuQ5zmapoEQAsz8stLpn0/dA4k3DbMumUlFAAAAAElFTkSuQmCC",WIDTH:19,HEIGHT:24}},SEPERATOR_ELEMENT_INDEX:"$",SEPERATOR_ACTION:"#",SEPERATOR_DATA:"&",SEPERATOR_TARGET:"*",PICK_TUTORIAL:"pick-tutorial",UPDATE_TUTORIAL_SCREEN:"update-tutorial-screen",SHOW_EXPLORE_TAB:"show-explore-tab"})}(),function(a){"use strict";var b=a.Common.Interactivities.ExponentAccordion.Views;a.Common.Interactivities.DataSetSelector;b.TutorialScreen=a.Common.Player.Views.Base.extend({tutorialsScreen1Model:null,tutorialsScreen1View:null,tutorialsScreen2Model:null,tutorialsScreen2View:null,previouslySelectedTile1:null,previouslySelectedTile2:null,_tutorialFormExpression:null,_playTutorialFromSaveState:!1,initialize:function(){this.initializeDefaultProperties(),this.player.bindTabChange(function(a){this._generateTabChange(a)},this,1),this.$el.css({"background-image":'url("'+this.filePath.getImagePath("sprites")+'")'}).addClass("bg"),this.loadScreen("tutorials-tab-screen"),this.loadScreen("direction-text-screen"),this._addTutorialsScreen1(),this._addTutorialsScreen2(),this._addBackground(),this._bindEvents(),null===this.model.get("tutorialDataSelectorView")&&this._hideScreen2AndShowScreen1(),this.render(),this._renderFromSavedState(),this._updateFOcusRectsOfScreen1(),this._initialiseHelpElements(),this.model.on("change:clearAllData",this.clearAllData,this)},_updateFOcusRectsOfScreen1:function(){this.updateFocusRect("screen-1data-set-0"),this.updateFocusRect("screen-1data-set-1")},_generateTabChange:function(b){this.model.set("currentTab",1);var c=a.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion;this.model.set("currentView",c.CURRENT_VIEW.TUTORIAL),this._playTutorialFromSaveState&&(this._tutorialFormExpression.playTutorialMode(),this._playTutorialFromSaveState=!1),this.model.get("tutorialDataSelectorView")!==c.TUTORIAL_VIEW.TUTORIAL_MAIN&&this.player.enableHelp(!1),b.isLetsGoClicked||this.model.get("backButtonClick")?this.setFocus("header-subtitle",20):this.model.get("tutorialDataSelectorView")===c.TUTORIAL_VIEW.TUTORIAL_MAIN?this.setFocus("screen-1data-set-selector-direction-text-direction-text-text"):this.model.get("tutorialDataSelectorView")===c.TUTORIAL_VIEW.TUTORIAL_SUB_SELECT?this.setFocus("screen-2data-set-selector-direction-text-direction-text-text"):this.model.get("tutorialDataSelectorView")===c.TUTORIAL_VIEW.TUTORIAL_SCREEN&&this.setFocus("tutorial-direction-text-container-direction-text-text"),this.model.set("backButtonClick",!1),this._updateFocusRectsOfTutorial()},_updateFocusRectsOfTutorial:function(){this.updateFocusRect("tutorial-direction-text-container-direction-text-text"),this.updateFocusRect("tutorial-main-activity-area-container"),this.updateFocusRect("tutorial-droppable-region")},_disableAccTabs:function(){this.enableTab("tutorial-base-tile-dispenser-container",!1),this.enableTab("tutorial-exponents-tile-dispenser-container",!1),this.enableTab("tutorial-parenthesis-tile-dispenser-container",!1),this.setTabIndex("tutorial-main-activity-area-container",504),this.enableTab("tutorial-droppable-region",!1)},_renderFromSavedState:function(){var b=this.model.get("tutorialSelectScreenIndex"),c=this.model.get("currentTutorialLessonNumber"),d=this.model.get("tutorialDataSelectorView"),e=this.model.get("currentTab"),f=a.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.TUTORIAL_VIEW;-1!==b&&this._updateTutorialScreen1View(b),-1!==c&&this._updateTutorialScreen2View(c),d===f.TUTORIAL_MAIN?this._hideScreen2AndShowScreen1():d===f.TUTORIAL_SUB_SELECT?this._hideScreen1AndShowScreen2():d===f.TUTORIAL_SCREEN&&(this._tutorialFormExpression.updateViewForTutorialMode(),this._hideScreenAndShowTutorial(),1===e?this._tutorialFormExpression.playTutorialMode():this._playTutorialFromSaveState=!0)},render:function(){this._initializeTutorialFormExpression()},clearAllData:function(){this.model.get("clearAllData")&&(this._resetScreen1(),this._resetScreen2(),this._hideScreen2AndShowScreen1(),this._showHideTutorialFormExpression(!1),this.setFocus("header-subtitle",50))},_initializeTutorialFormExpression:function(){var b=a.Common.Interactivities.ExponentAccordion.Views,c=this.idPrefix+"tutorial-",d=a.Common.Interactivities.ExponentAccordion.templates.formExpression({idPrefix:c,tutorialMode:!0}).trim();this.$el.append(d),this._tutorialFormExpression=new b.TutorialFormExpression({el:"#"+c+"form-expression-tab",model:this.model,idPrefix:c,tutorialMode:!0}),this._showHideTutorialFormExpression(!1),this.listenTo(this._tutorialFormExpression,b.TutorialFormExpression.PICK_TUTORIAL,this._pickTutorial),this.listenTo(this._tutorialFormExpression,b.TutorialFormExpression.UPDATE_TUTORIAL_SCREEN,this._updateTutorialScreen2View),this.listenTo(this._tutorialFormExpression,b.TutorialFormExpression.SHOW_EXPLORE_TAB,this._showExploreTab)},_addTutorialsScreen1:function(){for(var b,c=[],d=0;2>d;d++)b={dataSetName:this.getMessage("tutorial-screen-1-title",d),dataSetAccName:this.getAccMessage("tutorial-screen-1-title",d)},c[d]=b;var e={containerId:this.idPrefix+"tutorials-screen-1",idSuffix:"screen-1",showNumbers:!1,locAccText:{directionText:{loc:this.getMessage("direction-text",1),acc:this.getMessage("direction-text",1)},dataSetContainer:{loc:this.getMessage("tutorial-activity-area",1),acc:this.getAccMessage("tutorial-activity-area",1)}},hasClearAllBtn:!1,buttons:[],directionText:{textColor:"",ttsBaseClass:"tts-yellow"},data:{path:this.filePath,manager:this.manager,player:this.player,userDataSetLimit:0,noOfPredefinedSets:2,noOfSetsToSelect:2,dataSets:null,jsonData:c},isRoleButtonEnabled:!0};this.tutorialsScreen1View=new a.global.Theme2.DataSelector.createSelectorScreen(e),this.tutorialsScreen1View.$el.find(".data-set-container .data-set-0").addClass("screen-1-tiles").css({"background-image":'url("'+this.filePath.getImagePath("sprites")+'")'})},_blah:function(){},_addTutorialsScreen2:function(){for(var b=this.model,c=b.get("numberOfTutorial"),d=[],e=this,f=b.get("accordionLevel"),g=0;c>g;g++){var h={dataSetName:this.getMessage("tutorial-screen-2-title",g),dataSetAccName:this.getAccMessage("tutorial-screen-2-title",g)};d[g]=h}var i={containerId:this.idPrefix+"tutorials-screen-2",idSuffix:"screen-2",showNumbers:!0,locAccText:{directionText:{loc:this.getMessage("direction-text",2),acc:this.getMessage("direction-text",2)},dataSetContainer:{loc:this.getMessage("tutorial-activity-area",2),acc:this.getAccMessage("tutorial-activity-area",2)}},hasClearAllBtn:!1,directionText:{textColor:"",ttsBaseClass:"tts-yellow"},buttons:[{name:"skipTutorialsButtonView",container:"skip-tutorial-button",baseClass:"btn-yellow",text:this.getMessage("skip-tutorial-button-container",0),type:a.global.Theme2.Button.TYPE.TEXT,callback:function(){e._skipButtonHandler()}},{name:"backButtonView",container:"back-button",baseClass:"btn-yellow",type:a.global.Theme2.Button.TYPE.FA_ICONTEXT,text:this.getMessage("back-button-container",0),icon:{faClass:this.getFontAwesomeClass("fixed-back"),fontSize:14,fontColor:"#222",fontWeight:"bold",height:14,width:17},callback:function(){e._backButtonHandler()},width:115}],data:{path:this.filePath,manager:this.manager,player:this.player,userDataSetLimit:0,noOfPredefinedSets:0,noOfSetsToSelect:c,dataSets:null,jsonData:d},isRoleButtonEnabled:!0};this.tutorialsScreen2View=new a.global.Theme2.DataSelector.createSelectorScreen(i);var j=this.tutorialsScreen2View.$el;j.find(".data-set-container").addClass("screen-2-tutorial-view");for(var g=0;c>g;g++)j.find(".data-set-container .data-set-"+g).addClass("screen-2-tiles"),j.find(".data-set-container .data-set-"+g).addClass("accordion-level-"+f)},_hideScreen2AndShowScreen1:function(){this.tutorialsScreen2View.hideSelector(),this.tutorialsScreen1View.showSelector(),this.player.enableHelp(!0),this.model.set("tutorialDataSelectorView",a.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.TUTORIAL_VIEW.TUTORIAL_MAIN)},_hideScreen1AndShowScreen2:function(){this.tutorialsScreen1View.hideSelector(),this.tutorialsScreen2View.showSelector(),this.setFocus("screen-2data-set-selector-direction-text-direction-text-textholder"),this.player.enableHelp(!1),this.model.set("tutorialDataSelectorView",a.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.TUTORIAL_VIEW.TUTORIAL_SUB_SELECT),this._updateFOcusRectsOfScreen2()},_updateFOcusRectsOfScreen2:function(){this.updateFocusRect("screen-2data-set-0"),this.updateFocusRect("screen-2data-set-1"),this.updateFocusRect("screen-2data-set-2"),this.updateFocusRect("screen-2data-set-3"),this.updateFocusRect("screen-2data-set-4"),this.updateFocusRect("screen-2data-set-5")},_hideScreenAndShowTutorial:function(){this.tutorialsScreen1View.hideSelector(),this.tutorialsScreen2View.hideSelector(),this._showHideTutorialFormExpression(!0),this.model.set("tutorialDataSelectorView",null),this.model.set("tutorialDataSelectorView",a.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.TUTORIAL_VIEW.TUTORIAL_SCREEN),this._updateFocusRectsOfTutorial(),this.setFocus("tutorial-direction-text-container-direction-text-text")},_showHideTutorialFormExpression:function(a){var b=this._tutorialFormExpression.$el;a?b.show():b.hide()},_addBackground:function(){this.tutorialsScreen1View.$el.find(".data-set-container .data-set-0").addClass("screen-1-tiles").css({"background-image":'url("'+this.filePath.getImagePath("sprites")+'")'}),this.tutorialsScreen1View.$el.find(".data-set-container .data-set-1").addClass("screen-1-tiles").css({"background-image":'url("'+this.filePath.getImagePath("sprites")+'")'});var a=this.model.get("accordionLevel"),b=[];switch(a){case 1:b=[4,2,4,6];break;case 2:b=[-4,2,4,6];break;case 3:case 4:b=[5,2,4,2];break;case 5:b=[5,-2,4,2]}this._renderTextInsideScreen1Button(b)},_renderTextInsideScreen1Button:function(a){var b,c,d=this.tutorialsScreen1View.$el.find(".data-set-container .data-set-0"),e=this.tutorialsScreen1View.$el.find(".data-set-container .data-set-1"),f=$("<div>5</div>").attr({id:this.idPrefix+"tutorial-button-base","class":"tutorial-button-base"}),g=$("<div>2</div>").attr({id:this.idPrefix+"tutorial-button-exponent","class":"tutorial-button-exponent"});f.appendTo(d),g.appendTo(d);var h=$("<div>"+a[2]+"</div>").attr({id:this.idPrefix+"explore-button-base-2","class":"explore-button-base-2 explore-button-base"}),i=$("<div>"+a[3]+"</div>").attr({id:this.idPrefix+"explore-button-exponent-2","class":"explore-button-exponent-2 explore-button-exponent"});b=a[0]<0?$("<div>&minus;"+Math.abs(a[0])+"</div>").attr({id:this.idPrefix+"explore-button-base-1","class":"explore-button-base-1 explore-button-base"}).addClass("explore-base-button-left-adjust"):$("<div>"+a[0]+"</div>").attr({id:this.idPrefix+"explore-button-base-1","class":"explore-button-base-1 explore-button-base"}),c=a[1]<0?$("<div>&minus;"+Math.abs(a[1])+"</div>").attr({id:this.idPrefix+"explore-button-exponent-1","class":"explore-button-exponent-1 explore-button-exponent"}).addClass("explore-exponent-button-left-adjust"):$("<div>"+a[1]+"</div>").attr({id:this.idPrefix+"explore-button-exponent-1","class":"explore-button-exponent-1 explore-button-exponent"}),b.appendTo(e),c.appendTo(e),h.appendTo(e),i.appendTo(e)},_onTutorialMouseOver:function(){this.onRequiredElementMouseOver(this.tutorialsScreen1View.$el.find(".data-set-container .data-set-0"))},_onTutorialMouseOut:function(){this.onRequiredElementMouseOut(this.tutorialsScreen1View.$el.find(".data-set-container .data-set-0"))},_onExploreMouseOver:function(){this.onRequiredElementMouseOver(this.tutorialsScreen1View.$el.find(".data-set-container .data-set-1"))},_onExploreMouseOut:function(){this.onRequiredElementMouseOut(this.tutorialsScreen1View.$el.find(".data-set-container .data-set-1"))},_bindEvents:function(){this.listenTo(this.tutorialsScreen1View,a.global.Theme2.DataSelector.EVT_SEL_DATASET,this._screen1TileClickHandler),this.listenTo(this.tutorialsScreen2View,a.global.Theme2.DataSelector.EVT_SEL_DATASET,this._screen2TileClickHandler)},_pickTutorial:function(){var a=this.model.get("numberOfTutorial");1===a?(this._hideScreen2AndShowScreen1(),this._showHideTutorialFormExpression(!1)):this._showTutorialChoosenScreen()},_showTutorialChoosenScreen:function(){this._hideScreen1AndShowScreen2(),this._showHideTutorialFormExpression(!1)},_screen1TileClickHandler:function(c){this.stopReading();var d=b.TutorialScreen;if(this.model.set("tutorialSelectScreenIndex",c.index),this._updateTutorialScreen1View(c.index),c.index===d.TUTORIAL_SCREEN){var e=this.model.get("numberOfTutorial");1===e?this._showAndPlayTutorialMode(0):this._hideScreen1AndShowScreen2()}else this.model.set("currentTab",2),null===this.model.get("exploreView")&&this.model.set("exploreView",a.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.EXPLORE_VIEW.FORMATION),this.model.set("expolreBtnClick",!0),this.player.switchToTab(2)},_screen2TileClickHandler:function(a){if(this.stopReading(),this._updateTutorialScreen2View(a.index),void 0!==a.index&&null!==a.index){var b=parseInt(a.index,10);this._showAndPlayTutorialMode(b)}},_showAndPlayTutorialMode:function(a){this.model.set("currentTutorialLessonNumber",a),this._tutorialFormExpression.updateViewForTutorialMode(),this._hideScreenAndShowTutorial(),this._tutorialFormExpression.playTutorialMode()},_skipButtonHandler:function(){this.stopReading(),this._showExploreTab()},_backButtonHandler:function(){this.stopReading(),this._hideScreen2AndShowScreen1()},_initialiseHelpElements:function(){var a=this.model.get("helpElements");0===a.length&&a.push({elementId:"screen-1data-set-0",helpId:"tutorial-button-help",msgId:0,position:"top"},{elementId:"screen-1data-set-1",helpId:"explore-button-help",msgId:0,position:"top"},{elementId:"direction-text-container-direction-text-buttonholder",helpId:"try-another-help",msgId:0,position:"bottom",dynamicArrowPosition:!0},{elementId:"base-exp-tile-container",helpId:"base-exp-tile-container-help",msgId:0,position:"top",offset:{x:5,y:228},hideArrowDiv:!0},{elementId:"parenthesis-tile-container-value-1",helpId:"parenthesis-container-help",msgId:0,position:"right",offset:{x:10,y:0}},{elementId:"raised-to-power-toggle-button-container",helpId:"raise-fraction-to-power-help",msgId:0,position:"top"},{elementId:"build-mode-undo-button",helpId:"build-mode-undo-help",msgId:0,position:"top"},{elementId:"build-mode-reset-button",helpId:"build-mode-reset-help",msgId:0,position:"top"},{elementId:"random-expression-button",helpId:"create-random-expression-help",msgId:0,position:"top"},{elementId:"done-button",helpId:"done-button-help",msgId:0,position:"top",dynamicArrowPosition:!0},{elementId:"original-expression-title",helpId:"original-expression-help",msgId:0,position:"top"},{elementId:"workspace-scrollable",helpId:"workspace-scrollable-help",msgId:0,position:"top",offset:{x:0,y:230},hideArrowDiv:!0},{elementId:"solve-mode-undo-button",helpId:"solve-mode-undo-help",msgId:0,
position:"top"},{elementId:"solve-mode-reset-button",helpId:"solve-mode-reset-help",msgId:0,position:"top"},{elementId:"view-data-button",helpId:"view-data-button-help",msgId:0,position:"top",dynamicArrowPosition:!0},{elementId:"data-tab-direction-text-direction-text-buttonholder",helpId:"try-another-help",msgId:0,position:"bottom",dynamicArrowPosition:!0},{elementId:"accordion-container-title",helpId:"accodion-data-table-help",msgId:0,position:"bottom",hideArrowDiv:!0},{elementId:"dummy-help-arrow-div",helpId:"accordion-table-arrow-help",msgId:0,position:"bottom",dynamicArrowPosition:!0,hideArrowDiv:!0},{elementId:"back-button",helpId:"data-back-btn-help",msgId:0,position:"top",dynamicArrowPosition:!0},{elementId:"clear-data-button",helpId:"clear-data-btn-help",msgId:0,position:"top",dynamicArrowPosition:!0})},_showExploreTab:function(){this._hideScreen2AndShowScreen1(),this._showHideTutorialFormExpression(!1),this._updateTutorialScreen1View(b.TutorialScreen.EXPLORE_SCREEN),this.model.set("tutorialSelectScreenIndex",b.TutorialScreen.EXPLORE_SCREEN),this._resetScreen2(),this.model.set("currentTutorialLessonNumber",-1),this.model.set("expolreBtnClick",!0),this.player.switchToTab(2)},_updateTutorialScreen1View:function(a){this._resetScreen1(),this._setScreen1(a)},_updateTutorialScreen2View:function(a){this._resetScreen2(),this._setScreen2(a)},_setScreen1:function(a){this.tutorialsScreen1View.$el.find(".data-set-container .data-set-"+a).addClass("screen-1-tile-selected"),this.previouslySelectedTile1=a},_resetScreen1:function(){this.tutorialsScreen1View.$el.find(".data-set-container .data-set-"+this.previouslySelectedTile1).removeClass("screen-1-tile-selected hover")},_setScreen2:function(a){this.tutorialsScreen2View.$el.find(".data-set-container .data-set-"+a).addClass("screen-2-tile-selected"),this.tutorialsScreen2View.$el.find(".data-set-container .data-set-"+a+" .data-set-number-container").addClass("screen-2-tile-selected"),this.tutorialsScreen2View.$el.find(".data-set-container .data-set-"+a+" .data-set-number-container .data-set-number-text").addClass("screen-2-tile-selected"),this.previouslySelectedTile2=a},_resetScreen2:function(){this.tutorialsScreen2View.$el.find(".data-set-container .data-set-"+this.previouslySelectedTile2).removeClass("screen-2-tile-selected"),this.tutorialsScreen2View.$el.find(".data-set-container .data-set-"+this.previouslySelectedTile2+" .data-set-number-container").removeClass("screen-2-tile-selected"),this.tutorialsScreen2View.$el.find(".data-set-container .data-set-"+this.previouslySelectedTile2+" .data-set-number-container .data-set-number-text").removeClass("screen-2-tile-selected")}},{TUTORIAL_SCREEN:"0",EXPLORE_SCREEN:"1"})}(window.MathInteractives),function(){"use strict";var a=MathInteractives.Common.Interactivities.ExponentAccordion.Views;a.Data=MathInteractives.Common.Player.Views.Base.extend({directionBoxView:null,accordionView:null,resetPopupView:null,$arrowHelp:null,_$animationDiv:null,initialize:function(){this.initializeDefaultProperties(),this.loadScreen("data-tab-direction-text-screen"),this.loadScreen("data-tab-screen"),this.unloadScreen("expression-text"),this.loadScreen("expression-text"),this.$arrowHelp=this.$(".dummy-help-arrow-div"),this._$animationDiv=this.$(".animation-progress-div").hide(),this._render(),this._bindEvents(),this.player.bindTabChange(function(){this._generateAccordion(),this._clearAllDataBtnStatus(),this._updateFocusRects(),this.model.get("viewDataBtnClick")?this.setFocus("header-subtitle",20):this.setFocus("data-tab-direction-text-direction-text-text"),this.model.set("viewDataBtnClick",!1),this.updateFocusRect("data-tab-main-container")},this,3)},_render:function(){this._setBackgroundImage(),this._renderDirectionText(),this._generateButtons(),this._generateAccordion(),this.loadScreen("data-tab-buttons-screen")},_clearAllDataBtnStatus:function(){this.model.get("accordionEquationData").length?(this.clearDataButtonView.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE),this.player.enableHelpElement("clear-data-button",0,!0)):(this.clearDataButtonView.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED),this.player.enableHelpElement("clear-data-button",0,!1))},_generateButtons:function(){var a,b;a=MathInteractives.global.Theme2.Button,b={idPrefix:this.idPrefix,player:this.player,manager:this.manager,path:this.filePath,data:{id:this.idPrefix+"back-button",text:this.getMessage("back-button-text",0),type:MathInteractives.global.Theme2.Button.TYPE.FA_ICONTEXT,baseClass:"btn-yellow",textColor:"#222222",icon:{faClass:this.getFontAwesomeClass("back"),fontSize:14,fontColor:"#222222",fontWeight:"bold",height:14,width:16},width:115}},this.backButtonView=new a.generateButton(b),b.data.id=this.idPrefix+"clear-data-button",b.data.text=this.getMessage("clear-data-button-text",0),b.data.icon.faClass=this.getFontAwesomeClass("trash"),b.data.icon.height=16,b.data.width=null,this.clearDataButtonView=new a.generateButton(b)},_setBackgroundImage:function(){this.$el.css({"background-image":'url("'+this.getImagePath("sprites")+'")'}).addClass("bg")},_renderDirectionText:function(){if(null===this.directionBoxView){var a=this.getTabIndex("view-data-button");this.directionBoxView=new MathInteractives.global.Theme2.DirectionText.generateDirectionText({idPrefix:this.idPrefix,containerId:this.idPrefix+"data-tab-direction-text",manager:this.manager,player:this.player,path:this.filePath,text:this.getMessage("data-tab-instuction-text",0),accText:this.getAccMessage("data-tab-instuction-text",0),btnBaseClass:"btn-yellow",ttsBaseClass:"tts-yellow",showButton:!0,btnColorType:MathInteractives.global.Theme2.Button.COLORTYPE.HEADER_BLUE,btnTextColor:"#222222",buttonText:this.getMessage("try-another-text",0),clickCallback:{fnc:this._clickedTryAnother,scope:this},textColor:"#FFFFFF",containmentBGcolor:"#282828",tabIndex:a+1,buttonTabIndex:4e3})}},_tryAnotherBtnStatus:function(a){a===!0?(this.directionBoxView.changeButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE),this.player.enableHelpElement("data-tab-direction-text-direction-text-buttonholder",0,!0)):(this.directionBoxView.changeButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED),this.player.enableHelpElement("data-tab-direction-text-direction-text-buttonholder",0,!1))},_showResetPopup:function(){this.resetPopupView=MathInteractives.global.Theme2.PopUpBox.createPopup({text:this.getMessage("clear-all-popup","text"),title:this.getMessage("clear-all-popup","title"),manager:this.manager,player:this.player,path:this.filePath,idPrefix:this.idPrefix,type:MathInteractives.global.Theme2.PopUpBox.CONFIRM,buttons:[{id:this.idPrefix+"yes-btn",text:this.getMessage("clear-all-popup","yes"),response:{isPositive:!0,buttonClicked:this.idPrefix+"yes-btn"},clickCallBack:{fnc:this._clearAllData,scope:this}},{id:this.idPrefix+"cancel-btn",text:this.getMessage("clear-all-popup","cancel"),response:{isPositive:!1,buttonClicked:this.idPrefix+"cancel-btn"},clickCallBack:{fnc:this._onClickCancelOfClearDataPopup,scope:this}}]})},_clearAllData:function(){this.player.switchToTab(1),this.model.set("accordionEquationData",[]),this.model.set("currentEquationDataIndex",-1),this.model.set("clearAllData",!0),this.model.set("accordionEquationData",[]),this.model.set("noOfRowsRendered",0),this.model.set("accordionRowsToDelete",0),this.model.set("currentEquationDataIndex",-1),this.accordionView.destroyAccordion(),this.accordionView.$el.empty().off(),this.accordionView=null,this._generateAccordion()},_onClickCancelOfClearDataPopup:function(){this.setFocus("clear-data-button")},_clickedTryAnother:function(){this.stopReading(),this._showTryAnotherPopup()},_showTryAnotherPopup:function(){this.tryAnotherPopupView=MathInteractives.global.Theme2.PopUpBox.createPopup({text:this.getMessage("try-another-popup","text-workspace"),title:this.getMessage("try-another-popup","title"),manager:this.manager,player:this.player,path:this.filePath,idPrefix:this.idPrefix,type:MathInteractives.global.Theme2.PopUpBox.CONFIRM,buttons:[{id:this.idPrefix+"yes-btn",text:this.getMessage("try-another-popup","yes"),response:{isPositive:!0,buttonClicked:this.idPrefix+"yes-btn"},clickCallBack:{fnc:this._goToExploreTab,scope:this}},{id:this.idPrefix+"cancel-btn",text:this.getMessage("try-another-popup","cancel"),response:{isPositive:!1,buttonClicked:this.idPrefix+"cancel-btn"},clickCallBack:{fnc:this._onClickCancel,scope:this}}]})},_goToExploreTab:function(){this.model.set("currentTab",2),this.model.set("dataTabTryAnotherClick",!0),this.player.switchToTab(2)},_onClickCancel:function(){this.setFocus("data-tab-direction-text-direction-text-buttonholder")},_bindEvents:function(){var a=this;this.backButtonView.$el.off("click").on("click",function(){$(this).hasClass("clickEnabled")&&a._backButtonClick()}),this.clearDataButtonView.$el.off("click").on("click",function(){$(this).hasClass("clickEnabled")&&a._clearDataButtonClick()})},_backButtonClick:function(){var a=this.model.get("dataPreviousTab");this.stopReading(),this.model.set("currentTab",a),this.model.set("currentView",this.model.get("previousView")),this.model.set("backButtonClick",!0),this.player.switchToTab(a)},_clearDataButtonClick:function(){this.stopReading(),this._showResetPopup()},_generateAccordion:function(){var a,b,c,d=this.model.get("accordionEquationData"),e=this.model.get("currentEquationDataIndex"),f=this.model.get("noOfRowsRendered"),g=this.model.get("accordionRowsToDelete"),h=this.model.get("currentTab");if(this._tryAnotherBtnStatus(this.model.get("tryAnotherBtnStatus")),3!==h&&(this.model.set("dataPreviousTab",h),this.model.set("previousView",this.model.get("currentView"))),this.model.set("currentTab",3),this.model.set("currentView",MathInteractives.Common.Interactivities.ExponentAccordion.Models.ExponentAccordion.CURRENT_VIEW.DATA),0===d.length?this.$arrowHelp.hide():this.$arrowHelp.show(),null===this.accordionView)this.model.set("noOfRowsRendered",d.length),a={player:this.player,containerId:this.idPrefix+"accordion-container",isTts:!1,data:d,accordionSetting:{active:!1,animate:!0},headerBaseClass:"accordion-data-header-class",contentBaseClass:"accordion-data-content-class",icon:{header:this.filePath.getFontAwesomeClass("slide-down"),activeHeader:this.filePath.getFontAwesomeClass("slide-up")},isHeaderClickDisable:!0,screen:"accordion-screen",$animationDiv:this._$animationDiv},this.accordionView=new MathInteractives.Common.Interactivities.ExponentAccordion.Views.DerivedAccordion.createAccordion(a),this.listenTo(this.accordionView,MathInteractives.Common.Interactivities.ExponentAccordion.Views.DerivedAccordion.ACCORDION_HEADER_ICON_CLICK,this._onClickHeaderIcon),this.listenTo(this.accordionView,MathInteractives.Common.Components.Theme2.Views.Accordion.ACCORDION_CHANGE_EVENT,this._onChangeAccordion);else if(this.model.get("isAccordionEqnDataChanged")===!0){var i,j=f-1;if(i=d[j],void 0!==i&&(this.accordionView.removeAccordion(j),this.accordionView.addAccordion(i)),g){var k=f>g?f:g;for(c=0;k>c;c++)this.accordionView.removeAccordion(0),f-=1,this.model.set("noOfRowsRendered",f-1)}if(e>=f-1)if(f===e+1)b=d[d.length-1],void 0!==b&&(this.accordionView.removeAccordion(e),this.accordionView.addAccordion(b));else for(c=f;e>=c;c++)b=d[c],this.accordionView.addAccordion(b),this.model.set("noOfRowsRendered",this.model.get("noOfRowsRendered")+1);this.model.set("accordionRowsToDelete",0)}this.model.set("isAccordionEqnDataChanged",!1)},_updateFocusRects:function(){for(var a=this.accordionView.getAccObjects(),b=a.length,c=0;b>c;c++)this.updateFocusRect(a[c].elemId.replace(this.idPrefix,""))},_onClickHeaderIcon:function(a){var b=a.data.headerNo;this.headerNo=b,this.headerIcon=$(a.target),this.stopReading()},_onChangeAccordion:function(a,b){this._updateFocusRects(),this.previousHeaderNo=this.headerNo}},{})}(),function(){"use strict";var a=MathInteractives.Common.Interactivities.ExponentAccordion.Views;a.DerivedAccordion=MathInteractives.Common.Components.Theme2.Views.Accordion.extend({initialize:function(){this.accObjectsOnAddAccordion=[],a.DerivedAccordion.__super__.initialize.apply(this,arguments)},_appendHeadersAndContents:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this.options.data,s=0,t=r.length,u=this.icon,v=this.options.headerBaseClass,w=this.options.contentBaseClass,x=550,y=10,z="";for(this.accObjects=[],this.disableTabElements=[];t>s;s++){for(m=r[s].steps,n=m.length,z="",m.length>0&&(z=this.getAccMessage("base-exp-pair",24)),c=$("<h3></h3>").attr({"class":v+" headers"}).appendTo(a),d=$("<div></div>").attr({"class":"accordion-header-content",id:this.idPrefix+"header-content-"+s}).appendTo(c),this._createAccForHeadersAndContents("header-content-"+s,x+(y+1),r[s].headerAccString+z,!1,!1),i=$("<div></div>").attr({"class":"accordion-header-counter",id:this.idPrefix+"header-content-counter-"+s}).html(s+1).appendTo(d),j=$(r[s].header),$(j).appendTo(d),u&&(b=this.idPrefix+"accordion-header-icon-container-"+s,g=$("<div></div>").attr({"class":"accordion-header-icon-container",id:b}).appendTo(d),q=$("<div></div>").attr({"class":"accordion-header-icon",id:this.idPrefix+"accordion-header-icon-"+s}).appendTo(g)),this._numeratorDenominatorCases(j,d),e=$("<div></div>").attr({"class":"contents"}).appendTo(a),h=$("<div></div>").attr({id:this.idPrefix+"panel-container"+s,"class":w+" panel-container"}).appendTo(e),o=0;n>o;o++)k=$("<div></div>").attr({id:this.idPrefix+"panel-row-container"+s+o,"class":"panel-row-container"}).appendTo(h),l=$("<div></div>").attr({"class":"panel-row-blue-patch"}).appendTo(k),p=$(m[o].htmlString),f=$("<div></div>").attr({"class":"accordion-panel-content",id:this.idPrefix+"panel-content-"+s+"-"+o}).html(p).appendTo(k),this._createAccForHeadersAndContents("panel-content-"+s+"-"+o,y+2+(o+1),m[o].accString,!0,!1),this._numeratorDenominatorCases(p,k);this._autoScrollToLastRow(),u&&this._bindEventOnIcon(n,b,s),y=y+2+n}this._convertToAccordion(a),this._applyFontAwesomeForOperator(),this._applyParenthesis(),this._createAccDivs()},events:{"keydown .accordion-header-content":"_headerContentKeydown"},_headerContentKeydown:function(a){var b=a.keyCode?a.keyCode:a.charCode;MathInteractives.Common.Utilities.Models.BrowserCheck;if("block"===this.options.$animationDiv.css("display")&&a.preventDefault(),32===b){a.preventDefault();var c,d,e,f=$(a.currentTarget),g=f.find(".accordion-header-icon-container"),h=g.find(".accordion-header-icon"),i=f.attr("id"),j=i.substring(i.lastIndexOf("-")+1,i.length);g.hasClass("disabled")||(c=this.$(".active-accordion-header").closest(".accordion-header-content"),c.length>0&&(d=c.attr("id"),e=d.substring(d.lastIndexOf("-")+1,d.length),this.setAccMessage("header-content-"+e,this.options.data[+e].headerAccString+this.getAccMessage("base-exp-pair",24))),h.hasClass("inactive-accordion-header")?(this.setAccMessage("header-content-"+j,this.options.data[+j].headerAccString+this.getAccMessage("base-exp-pair",27)),g.trigger("mousedown").trigger("mouseup").trigger("click"),this.setFocus("panel-content-"+j+"-0",450)):(this.setAccMessage("header-content-"+j,this.options.data[+j].headerAccString+this.getAccMessage("base-exp-pair",24)),g.trigger("mousedown").trigger("mouseup").trigger("click"),this.setFocus("header-content-"+j,450)))}},_bindEventOnIcon:function(b,c,d){a.DerivedAccordion.__super__._bindEventOnIcon.apply(this,arguments),b||this.disableTabElements.push(c.replace(this.idPrefix,""))},_createAccForHeadersAndContents:function(a,b,c,d,e){var f={elementId:a,elemId:a,tabIndex:b,loc:"",acc:c,offsetLeft:-3,offsetTop:-3};d&&(f.offsetLeft=-6,f.offsetTop=0),e&&this.accObjectsOnAddAccordion.push(f),this.accObjects.push(f)},_createAccDivs:function(a){var b=this.accObjects,c=0,d=this.accObjectsOnAddAccordion;if(a)for(;c<d.length;c++)this.createAccDiv(d[c]);else for(;c<b.length;c++)this.createAccDiv(b[c]);this._disableTabElements()},_disableTabElements:function(){for(var a=this.disableTabElements,b=0;b<a.length;b++)this.enableTab(a[b],!1);this.disableTabElements=[]},getAccObjects:function(){return this.accObjects},setAccObjects:function(){this.accObjects=[]},_applyFontAwesomeForOperator:function(){var a=this.filePath,b=a.getFontAwesomeClass("dot");this.$(".accordion-header-content .operator-data-tab div, .accordion-panel-content .operator-data-tab div").addClass(b)},_applyParenthesis:function(){this.$(".open-parenthesis-data-tab, .close-parenthesis-data-tab").addClass("bracket-data-tab")},addAccordion:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this.icon,s=this.options.headerBaseClass,t=this.options.contentBaseClass,u=this.$(".accordion"),v=this.$(".accordion h3").length,r=this.icon,w=550,x=0,y="";for(this.accObjectsOnAddAccordion=[],this.disableTabElements=[],l=a.steps,m=l.length,x=this.accObjects[this.accObjects.length-1]?this.accObjects[this.accObjects.length-1].tabIndex:x+2+m+w,b=$("<h3></h3>").attr({"class":s+" headers"}).appendTo(u),c=$("<div></div>").attr({"class":"accordion-header-content",id:this.idPrefix+"header-content-"+v}).appendTo(b),this.options.data[v].steps.length>0&&(y=this.getAccMessage("base-exp-pair",24)),this._createAccForHeadersAndContents("header-content-"+v,x+2,a.headerAccString+y,!1,!0),h=$("<div></div>").attr({"class":"accordion-header-counter",id:this.idPrefix+"header-content-counter"+v}).html(v+1).appendTo(c),i=$(a.header),$(i).appendTo(c),r&&(q=this.idPrefix+"accordion-header-icon-container-"+v,f=$("<div></div>").attr({"class":"accordion-header-icon-container",id:q}).appendTo(c),p=$("<div></div>").attr({"class":"accordion-header-icon",id:this.idPrefix+"accordion-header-icon-"+v}).appendTo(f)),this._numeratorDenominatorCases(i,c),d=$("<div></div>").attr({"class":"contents"}).appendTo(u),g=$("<div></div>").attr({id:this.idPrefix+"panel-container"+v,"class":t+" panel-container"}).appendTo(d),n=0;m>n;n++)j=$("<div></div>").attr({id:this.idPrefix+"panel-row-container"+v+n,"class":"panel-row-container"}).appendTo(g),k=$("<div></div>").attr({"class":"panel-row-blue-patch"}).appendTo(j),o=$(l[n].htmlString),e=$("<div></div>").attr({"class":"accordion-panel-content",id:this.idPrefix+"panel-content-"+v+"-"+n}).html(o).appendTo(j),this._createAccForHeadersAndContents("panel-content-"+v+"-"+n,x+2+(n+1),l[n].accString,!0,!0),this._numeratorDenominatorCases(o,j);this.refreshAccordion(),r&&this._bindEventOnIcon(m,q,v),this._applyFontAwesomeForOperator(),this._applyParenthesis(),this._autoScrollToLastRow(),this._createAccDivs(!0)},removeAccordion:function(b){a.DerivedAccordion.__super__.removeAccordion.apply(this,arguments);for(var c=this.accObjects.length-1;0!==c&&(this.accObjects[c].elemId==="header-content-"+b||0===this.accObjects[c].elemId.indexOf("panel-content-"+b+"-"));)this.accObjects.pop(),c--},_onClickIcon:function(b){var c=this.options.$animationDiv,d=b.data.isEmpty;a.DerivedAccordion.__super__._onClickIcon.apply(this,arguments),d===!1&&(c.show(),this.trigger(a.DerivedAccordion.ACCORDION_HEADER_ICON_CLICK,b))},_onAccordionChange:function(b,c){a.DerivedAccordion.__super__._onAccordionChange.apply(this,arguments),this.options.$animationDiv.hide()},_createAccordion:function(){a.DerivedAccordion.__super__._createAccordion.apply(this,arguments),this.$(".accordion").css({width:891})},_numeratorDenominatorCases:function(a,b){(0===a.find(".fraction-data-tab").length||a.find(".denominator").hasClass("denominator-empty"))&&(0===a.find(".big-parenthesis-container").length?(b.addClass("only-multiplication-data-tab"),b.find(".panel-row-blue-patch").addClass("adjust--blue-patch-height"),b.find(".accordion-panel-content").addClass("adjust-height")):(a.find(".fraction-data-tab").addClass("adjust-bottom-for-big-parenthesis"),a.find(".close-parenthesis-data-tab, .open-parenthesis-data-tab").addClass("scale-down-size"),a.find(".big-parenthesis-exponent-data-tab").addClass("adjust-exponent-bottom")),a.find(".vincullum").hide(),a.find(".denominator").hide())}},{createAccordion:function(b){var c=null;return b&&(c=new a.DerivedAccordion({el:"#"+b.containerId,options:b})),c},ACCORDION_HEADER_ICON_CLICK:"accordion-header-icon-click"})}(window.MathInteractives),function(){var a=MathInteractives.Common.Interactivities.ExponentAccordion.Views;a.DerivedContextMenu=MathInteractives.Common.Components.Views.ContextMenu.extend({initialize:function(){a.DerivedContextMenu.__super__.initialize.apply(this,arguments)},_elementKeyup:function(a,b){if(219===a.keyCode){var c,d,e,f,g,h=this.model.getInteractivityPrefix(),i=this.model.getContextMenuCount(),j=this.model.getScreenID(),k=-this.$el.offset().top+$(a.currentTarget).offset().top+$(a.currentTarget).height()/2,l=-this.$el.offset().left+$(a.currentTarget).offset().left+$(a.currentTarget).width()/2,m=this.model.getIgnoreIds(),n=null,o=this.model.get("maxItemCount"),p=null;this._$contextElement=$(a.currentTarget),("undefined"==typeof j||0===j.trim().length)&&(j="ContextMenu"),this.$el.find(".contextMenuHolder").empty().append('<div class="contextWrapper"></div>');for(var q=0;i>q;q++)n=$.inArray(h+j+"-"+q,m),-1===n&&(null===p&&(p=h+j+"-"+q),c=h+j+"-"+q,d=$("<div id="+c+' class="ContextMenuItem"></div>'),this.$el.find(".contextMenuHolder .contextWrapper").append(d),this.model.isParentToChildMenu(c)===!0&&d.addClass("notAnElement"));null===p||(this.$el.find(".contextMenuHolder").show().css({left:0,top:0}),this._manager.loadScreen(j,h),o>0&&(e=this.$el.find(".contextMenuHolder .ContextMenuItem").first().height(),e+=5,this.$el.find(".contextMenuHolder").css({height:e*o})),this.$el.find(".contextMenuHolder").height()<this.$el.find(".contextWrapper").height()&&this.$el.find(".contextMenuHolder").css("width",this.$el.find(".contextMenuHolder").width()+17),g=this.$el.find(".contextMenuHolder").height()+2*MathInteractives.global.ContextMenu.WRAPPER_PADDING+2*MathInteractives.global.ContextMenu.PLAYER_PADDING,f=this.$el.find(".contextMenuHolder").width()+2*MathInteractives.global.ContextMenu.WRAPPER_PADDING+2*MathInteractives.global.ContextMenu.PLAYER_PADDING,k+g>this.$el.height()&&(k-=g),l<this.$el.offset().left?l=this.$el.offset().left+10:l+f>this.$el.width()&&(l=this.$el.width()-f-10),this.$el.find(".contextMenuHolder").css({left:l,top:k}),this.$el.find(".contextMenuHolder .ContextMenuItem").off("keyup.contextmenu focusin.contextmenu focusout.contextmenu keydown.contextmenu").on("keyup.contextmenu",$.proxy(this._contextMenuItemKeyup,this)).on("focusout.contextmenu",$.proxy(this._focusoutContextMenuItem,this)).on("focusin.contextmenu",$.proxy(this._focusinContextMenuItem,this)).on("keydown.contextmenu",$.proxy(this._contextMenuItemKeydown,this)),this._manager.setFocus(this.$el.find(".contextMenuHolder .ContextMenuItem").first().attr("id")),this._$contextElement.trigger(MathInteractives.global.ContextMenu.CONTEXTMENU_OPEN,[a,b]))}}},{SCROLLBAR_WIDTH:17,WRAPPER_PADDING:5,PLAYER_PADDING:8,CONTEXTMENU_OPEN:"context-menu-displayed",CONTEXTMENU_HIDE:"context-menu-hidden",CONTEXTMENU_SELECT:"context-menu-selected",initContextMenu:function(b){if(b){var c=new MathInteractives.Common.Components.Models.ContextMenu(b);c.setInteractivityPrefix(b.prefix),c.setElements(b.elements),c.setContextMenuCount(b.contextMenuCount),c.setScreenID(b.screenId),c.setManager(b.manager),c.setNestedMenuData({}),b.nestedMenuData&&c.setNestedMenuData(b.nestedMenuData);var d=new a.DerivedContextMenu({el:b.el,model:c});return d._callerView=b.thisView,d}}})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Interactivities.ExponentAccordion.templates=MathInteractives.Common.Interactivities.ExponentAccordion.templates||{};b.tiles=a(function(a,b,c,d,e){function f(a,b,c){var d,e="";return e+='\r\n    <div id="'+l((d=c&&c.idPrefix,typeof d===k?d.apply(a):d))+l((d=c&&c.type,typeof d===k?d.apply(a):d))+"-tile-container-value"+l(typeof a===k?a.apply(a):a)+'" class="'+l((d=c&&c.type,typeof d===k?d.apply(a):d))+"-tile-containers container-value"+l(typeof a===k?a.apply(a):a)+'">\r\n        <div id="'+l((d=c&&c.idPrefix,typeof d===k?d.apply(a):d))+l((d=c&&c.type,typeof d===k?d.apply(a):d))+"-tile-value"+l(typeof a===k?a.apply(a):a)+'" class="'+l((d=c&&c.type,typeof d===k?d.apply(a):d))+"-draggable-tiles tile-value"+l(typeof a===k?a.apply(a):a)+'" data-tiletype="'+l((d=c&&c.tileType,typeof d===k?d.apply(a):d))+'" data-tilevalue="'+l(typeof a===k?a.apply(a):a)+'"></div>\r\n    </div>\r\n    '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this.escapeExpression,m=this,n=c.blockHelperMissing;return j+='<div id="',(h=c.idPrefix)?g=h.call(b,{hash:{},data:e}):(h=b&&b.idPrefix,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=l(g)+'tile-container" class="tiles-container">\r\n    ',i={hash:{},inverse:m.noop,fn:m.programWithDepth(1,f,e,b),data:e},(h=c.tiles)?g=h.call(b,i):(h=b&&b.tiles,g=typeof h===k?h.call(b,i):h),c.tiles||(g=n.call(b,g,{hash:{},inverse:m.noop,fn:m.programWithDepth(1,f,e,b),data:e})),(g||0===g)&&(j+=g),j+="\r\n</div>"})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Interactivities.ExponentAccordion.templates=MathInteractives.Common.Interactivities.ExponentAccordion.templates||{};b.formExpression=a(function(a,b,c,d,e){function f(a,b){return"tutorial-"}function g(a,b){var d,e,f="";return f+='\r\n        <div id="',(e=c.idPrefix)?d=e.call(a,{hash:{},data:b}):(e=a&&a.idPrefix,d=typeof e===m?e.call(a,{hash:{},data:b}):e),f+=n(d)+'replay-btn-container" class="replay-btn-container">\r\n          <div id="',(e=c.idPrefix)?d=e.call(a,{hash:{},data:b}):(e=a&&a.idPrefix,d=typeof e===m?e.call(a,{hash:{},data:b}):e),f+=n(d)+'replay-btn" class="replay-btn"></div>\r\n        </div>\r\n        '}function h(a,b){var d,e,f="";return f+='\r\n      <div id="',(e=c.idPrefix)?d=e.call(a,{hash:{},data:b}):(e=a&&a.idPrefix,d=typeof e===m?e.call(a,{hash:{},data:b}):e),f+=n(d)+'marquee-inline-feedback-container" class="marquee-inline-feedback-container"></div>\r\n      '}function i(a,b){var d,e,f="";return f+='\r\n      <div id="',(e=c.idPrefix)?d=e.call(a,{hash:{},data:b}):(e=a&&a.idPrefix,d=typeof e===m?e.call(a,{hash:{},data:b}):e),f+=n(d)+'solve-mode-replay-btn-container" class="replay-btn-container solve-mode">\r\n        <div id="',(e=c.idPrefix)?d=e.call(a,{hash:{},data:b}):(e=a&&a.idPrefix,d=typeof e===m?e.call(a,{hash:{},data:b}):e),f+=n(d)+'solve-mode-replay-btn" class="replay-btn"></div>\r\n      </div>\r\n      '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var j,k,l="",m="function",n=this.escapeExpression,o=this;return l+='<div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'form-expression-tab" class="form-expression-tab">\r\n  <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'animation-progress-div" class="animation-progress-div"></div>\r\n  <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'direction-text-holder" class="direction-text-holder">\r\n    <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'direction-text-container" class="direction-text-container"></div>\r\n  </div>\r\n  <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'main-activity-area-container" class="main-activity-area-container">\r\n    <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'form-expression-container" class="form-expression-container">\r\n      <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'bin-tile-containment" class="bin-tile-containment"></div>\r\n      <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'form-expression-tile-roster-container" class="form-expression-tiles-roster">\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'base-exp-tile-container" class="base-exp-tile-container">\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'base-tile-dispenser-container" class="base-tile-dispenser-container">\r\n            <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'base-tile-dispenser-title" class="base-tile-dispenser-title"></div>\r\n            <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'base-tile-dispenser" class="base-tile-dispenser"></div>\r\n          </div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'exponents-tile-dispenser-container" class="exponents-tile-dispenser-container">\r\n            <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'exponents-tile-dispenser-title" class="exponents-tile-dispenser-title"></div>\r\n            <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'exponents-tile-dispenser-sub-container" class="exponents-tile-dispenser-sub-container">\r\n              <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'exponents-tile-dispenser" class="exponents-tile-dispenser"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'parenthesis-tile-dispenser-container" class="parenthesis-tile-dispenser-container">\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'parenthesis-tile-dispenser-title" class="parenthesis-tile-dispenser-title"></div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'parenthesis-tile-dispenser" class="parenthesis-tile-dispenser"></div>\r\n        </div>\r\n\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'raised-to-power-toggle-button-container" class="raised-to-power-toggle-button-container">\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'raised-to-power-toggle-button-title" class="raised-to-power-toggle-button-title"></div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'raised-to-power-toggle-button" class="raised-to-power-toggle-button"></div>\r\n        </div>\r\n      </div>\r\n\r\n      <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'form-expression-tile-dispenser-separator" class="form-expression-tile-dispenser-separator"></div>\r\n\r\n      <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'droppable-region-container" class="droppable-region-container">\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j),j=c["if"].call(b,b&&b.tutorialMode,{hash:{},inverse:o.noop,fn:o.program(1,f,e),data:e}),(j||0===j)&&(l+=j),l+='droppable-region-title-text" class="droppable-region-title-text"></div>\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},
data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'droppable-region-holder" class="droppable-region-holder">\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'droppable-region-start-multiplication" class="droppable-region-start-multiplication">\r\n            <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'multiplication-text" class="multiplication-text"></div>\r\n            <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'multiplication-img" class="multiplication-img"></div>\r\n          </div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'horizontal-saperator" class="horizontal-saperator"></div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'droppable-region-start-division" class="droppable-region-start-division">\r\n            <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'division-text" class="division-text"></div>\r\n            <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'division-img" class="division-img">\r\n              <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'division-numerator" class="division-numerator"></div>\r\n              <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'division-denominator" class="division-denominator"></div>\r\n            </div>\r\n          </div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'droppable-region" class="droppable-region">\r\n            <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'form-expression-equation-container" class="equation-container">\r\n              <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'form-expression-draggable-containment" class="form-equation-draggable-containment"></div>\r\n              <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'form-expression-area" class="form-expression-area">\r\n\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'droppable-region-buttons-container" class="droppable-region-buttons-container">\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'build-mode-undo-button" class="build-mode-undo-button"></div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'build-mode-reset-button" class="build-mode-reset-button"></div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'random-expression-button" class="random-expression-button"></div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'done-button" class="done-button"></div>\r\n        </div>\r\n        ',j=c["if"].call(b,b&&b.tutorialMode,{hash:{},inverse:o.noop,fn:o.program(3,g,e),data:e}),(j||0===j)&&(l+=j),l+='\r\n      </div>\r\n      <div id ="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'dummy-droppable"></div>\r\n    </div>\r\n    <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'workspace-container" class="workspace-container">\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j),j=c["if"].call(b,b&&b.tutorialMode,{hash:{},inverse:o.noop,fn:o.program(1,f,e),data:e}),(j||0===j)&&(l+=j),l+='workspace-title-text" class="workspace-title-text"></div>\r\n      <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'tooltip-demo-container" class="tooltip-demo-container"></div>\r\n      ',j=c["if"].call(b,b&&b.tutorialMode,{hash:{},inverse:o.noop,fn:o.program(5,h,e),data:e}),(j||0===j)&&(l+=j),l+='\r\n      <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'inline-feedback-container" class="inline-feedback-container"></div>\r\n      <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'workspace-scrollable" class="workspace-scrollable">\r\n\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'workspace-equation-container" class="equation-container">\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'workspace-draggable-containment" class="workspace-draggable-containment"></div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'workspace-expression-area" class="workspace-expression-area">\r\n\r\n          </div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'workspace-overlay-div" class="overlay-div">\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'swipe-region" class="swipe-region">\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'double-angle-left" class="double-angle double-angle-left"></div>\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'swipe-region-text" class="swipe-region-text"></div>\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'double-angle-right" class="double-angle double-angle-right"></div>\r\n      </div>\r\n      <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'workspace-bottom-container" class="workspace-bottom-container">\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'workspace-bottom-left-container" class="workspace-bottom-left-container">\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'original-expression-title" class="original-expression-title"></div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'original-expression-container" class="original-expression-container">\r\n            <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'original-expression-holder" class="original-expression-holder"></div>\r\n          </div>\r\n        </div>\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'workspace-bottom-saperator" class="workspace-bottom-saperator"></div>\r\n        <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'workspace-bottom-right-container" class="workspace-bottom-right-container">\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'solve-mode-undo-button" class="solve-mode-undo-button"></div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'solve-mode-reset-button" class="solve-mode-reset-button"></div>\r\n          <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'view-data-button" class="view-data-button"></div>\r\n        </div>\r\n      </div>\r\n      ',j=c["if"].call(b,b&&b.tutorialMode,{hash:{},inverse:o.noop,fn:o.program(7,i,e),data:e}),(j||0===j)&&(l+=j),l+='\r\n    </div>\r\n  </div>\r\n  <div id="',(k=c.idPrefix)?j=k.call(b,{hash:{},data:e}):(k=b&&b.idPrefix,j=typeof k===m?k.call(b,{hash:{},data:e}):k),l+=n(j)+'tutorial-container" class="tutorial-container" tabindex="-1">\r\n  </div>\r\n</div>\r\n'})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Interactivities.ExponentAccordion.templates=MathInteractives.Common.Interactivities.ExponentAccordion.templates||{};b["tutorial-screen"]=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'tutorials-tab" class="tutorials-tab">\r\n  <div class="temp-class">\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'tutorials-screen-1" class="tutorials-screen-1"></div>\r\n  </div>\r\n  <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'tutorials-screen-2" class="tutorials-screen-2"></div>\r\n</div>\r\n'})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Interactivities.ExponentAccordion.templates=MathInteractives.Common.Interactivities.ExponentAccordion.templates||{};b["term-tile"]=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"term-tile-container",(g=c.tile)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tile,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" class="term-tile-container term-tile-container',(g=c.tile)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tile,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n  <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"base-tile-in-term",(g=c.tile)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tile,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" class="base-tile-in-term base-tile-in-term',(g=c.tile)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tile,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'"></div>\r\n  <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"exponent-tile-in-term",(g=c.tile)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tile,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" class="exponent-tile-in-term exponent-tile-in-term',(g=c.tile)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tile,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'"></div>\r\n</div>'})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Interactivities.ExponentAccordion.templates=MathInteractives.Common.Interactivities.ExponentAccordion.templates||{};b.data=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'data-tab" class="data-tab">\r\n  <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'data-tab-animation-progress-div" class="animation-progress-div"></div>\r\n  <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'data-tab-direction-text" class="data-tab-direction-text"></div>\r\n  <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'data-tab-main-container" class="data-tab-main-container">\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'accordion-holder" class="accordion-holder">\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'accordion-container-title" class="accordion-container-title">\r\n          <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'dummy-help-arrow-div" class="dummy-help-arrow-div"></div>\r\n        </div>\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'accordion-container" class="accordion-container"></div>\r\n    </div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'buttons-container" class="buttons-container">\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'back-button" class="back-button"></div>\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'clear-data-button" class="clear-data-button"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'})}();