!function(a){"use strict";"undefined"==typeof a.Common.Interactivities.LineStretcher&&(a.Common.Interactivities.LineStretcher={},a.Common.Interactivities.LineStretcher.Views={},a.Common.Interactivities.LineStretcher.Models={}),a.Common.Interactivities.LineStretcher.Views.Explore=a.Common.Player.Views.Base.extend({filePath:null,manager:null,player:null,idPrefix:null,scope:null,leftInputBoxView:null,rightInputBoxView:null,chopButtonView:null,seeMathButtonView:null,tryAnotherButtonview:null,tryAgainButtonview:null,kickButtonView:null,modelPath:null,$yourAnswer:null,$plankLeftCordinate:null,$plankRightCordinate:null,$feedbackRatioDiv:null,$yourAnswerBullet:null,$yourAnswerContainer:null,$objectContainer:null,leftInputToolTip:null,rightInputToolTip:null,errorToolTip:null,horizontalPlankBase64:null,verticalPlankBase64:null,trophyBase64:null,punchingBagBase64:null,$booksShort:null,$booksLong:null,currentPaperGroup:null,chosenSet:null,currentObject:null,rodneyPlankGroup:null,rodneyBrickGroup:null,feedbackGroup:null,feedbackPlankGroup:null,$answerFt1:null,$feedbackAnswers:null,$startCoordinate:null,$endCoordinate:null,$exploreTabCoordinates:null,$answerFt2:null,dottedSideIndex:null,isScreenDirty:null,rightBrokenRasterGroup:null,leftBrokenRasterGroup:null,directionTextView:null,$chopButton:null,$seeMathButton:null,$tryAgainButton:null,$kickButton:null,currentObjectMessage:null,counter:0,initialize:function(){var b=this,c=b.model;b.modelPath=a.Common.Interactivities.LineStretcher.Models.Line,b.filePath=c.get("path"),b.manager=c.get("manager"),b.player=c.get("player"),b.idPrefix=this.player.getIDPrefix(),this.$el.append(a.Common.Interactivities.LineStretcher.templates.explore({idPrefix:b.idPrefix}).trim()),b._cacheDomElements(),b._generateImageBase64(),b.loadScreen("explore-tab"),this.counter=0,this.player.bindTabChange(function(){null===this.directionTextView&&(this._createDirectionText(),this._changeInstructionText(this.currentObject,this.chosenSet.get("isMidPoint"),this.chosenSet.get("ratio")),this.$(".direction-text-text").css("font-size","14px")),this.setFocus("explorer-direction-text-direction-text-text")},this,1),b.counter=0,b.possibleArrayLength=0,b.render(),this._storeImagePaths(),b._hideOnRender(),b._renderNewScenario(!0),this._attachCustomEventsToPlanks(),this._bindEvents(),this._changeText()},_changeText:function(){var a,b,c,d=this.chosenSet.attributes;"horizontal"===d.type?(a="horizontal",b="left",c="right"):"diagonal"===d.type?(a="diagonal",b="left",c="right"):(a="vertical",c="top",b="bottom");var e=d.coordinates,f=e.startPoint[0],g=e.startPoint[1],h=e.endPoint[0],i=e.endPoint[1];this.inputBoxCanvasArea=[a,b,f,g,c,h,i,this.currentObjectMessage],this.changeAccMessage("canvas-activity-area",0,this.inputBoxCanvasArea)},_attachCustomEventsToPlanks:function(){var a,b=this;this.on("plank-hit",function(){if(b.rodneyPlankGroup){b.rodneyPlankGroup.remove(),b.$exploreTabCoordinates.hide();var c=parseFloat(b.leftInputBoxView.getCurrentInputValue()),d=parseFloat(b.rightInputBoxView.getCurrentInputValue()),e=b.chosenSet,f=e.get("coordinates"),g=f.startPoint,h=f.endPoint;window.setTimeout(function(){a=e.get("type"),b.scope.activate(),"horizontal"===a||"diagonal"===a?b._drawDiagonalHorizontalBrokenPlanks(g,h,[c,d]):"vertical"===a&&b._drawVerticalBrokePlanks(h,g,[c,d]),paper.view.draw()},100)}}),this.on("breaking-animation-ends",function(){var a,c,d,e=parseFloat(b.leftInputBoxView.getCurrentInputValue()),f=parseFloat(b.rightInputBoxView.getCurrentInputValue()),g=b.chosenSet,h=g.get("coordinates"),i=h.startPoint,j=h.endPoint,k=!1,l=g.get("answers");this._fadeOutPlanks(),a=this.model.getSectionLengths({x:i[0],y:i[1]},{x:j[0],y:j[1]},{x:e,y:f}),a[1]>a[0]?(c=a[1],d=a[0]):(c=a[0],d=a[1]);var m=this.model.getLengthsRatio(Math.round(10*a[0]),Math.round(10*a[1])),n=g.get("ratio");if(e===l[0][0]&&f===l[0][1]||e===l[1][0]&&f===l[1][1]||m[0]===n[0]&&m[1]===n[1]||m[0]===n[1]&&m[1]===n[0]){k=!0,m=n,a[0]>a[1]&&(m=[m[1],m[0]]);var o=g.get("segments");d=o[0],c=o[1]}this._displayFeedbackPlanks([c,d],k),this._dataForFeedbackScreen={ratio:m,type:g.get("type"),startPoint:i,endPoint:j,userAnswer:[e,f],isCorrect:k,sectionLengths:a}}),this.on("feedback-animation-ends",function(){var a=null;b.$inputBoxContainer.hide(),b.kickButtonView.hideButton(),b.chopButtonView.hideButton(),b.seeMathButtonView.showButton(),b._enableState(),this._dataForFeedbackScreen.isCorrect?(a=this._positiveFeedback,this.isScreenDirty=!1):a=this._negativeFeedback,this.$rodney.css("background-position",a),b.setFocus("see-math-button")})},_checkAnswerForDiagonals:function(a,b){},_createDirectionText:function(){var b={containerId:this.idPrefix+"explorer-direction-text",idPrefix:this.idPrefix,player:this.player,manager:this.manager,path:this.filePath,text:this.getMessage("instruction-text",3),accText:this.getMessage("instruction-text",3),showButton:!0,buttonText:this.getMessage("try-another",0),buttonAccText:this.getAccMessage("try-another",0),btnColorType:a.global.Theme2.Button.COLORTYPE.GREEN,containmentBGcolor:"rgba(34, 34, 34, 0.0)",btnBaseClass:"custom-black-button",clickCallback:{fnc:this._tryAnotherCallback,scope:this},textColor:"#000000",tabIndex:510,buttonTabIndex:600,customClass:"direction-text-custom-class"};this.directionTextView=a.global.Theme2.DirectionText.generateDirectionText(b),this.tryAnotherButtonview=this.directionTextView.tryAnotherView},_tryAnotherCallback:function(){this._renderPopUps("try-another")},_hideOnRender:function(){var a=this;a.seeMathButtonView.hideButton(),a._disableButton(a.chopButtonView),a._disableButton(a.kickButtonView),a.$feedbackInstructionTryAgain.hide(),a.$yourAnswerContainer.hide()},_bindEvents:function(){this.$chopButton.on("click.chopClickEnabled",$.proxy(this._showToolTip,this)),this.$seeMathButton.on("click.seeMathClickEnabled",$.proxy(this._feedbackScreen,this)),this.$tryAgainButton.on("click.tryAgainClickEnabled",$.proxy(this._renderOnTryAgain,this)),this.$kickButton.on("click.kickClickEnabled",$.proxy(this._showToolTip,this))},_setScreenDirtyFlag:function(){var a=this,b=a.leftInputBoxView.getCurrentInputValue(),c=a.rightInputBoxView.getCurrentInputValue();null!==b||null!==c?a.isScreenDirty=!0:a.isScreenDirty=!1},_enableDisableChopButton:function(){var b=this,c=(a.global.Theme2.Button,b.leftInputBoxView.getCurrentInputValue()),d=b.rightInputBoxView.getCurrentInputValue();null===c||null===d||isNaN(c)||isNaN(d)?(b._disableButton(b.chopButtonView),b._disableButton(b.kickButtonView)):(b._enableButton(b.chopButtonView),b._enableButton(b.kickButtonView)),b._hideAllTooltip()},_hideAllTooltip:function(){var a=this;null!==a.leftInputBoxView&&a.leftInputToolTip.hideTooltip(),null!==a.rightInputBoxView&&a.rightInputToolTip.hideTooltip(),null!==a.leftInputBoxView&&null!==a.rightInputBoxView&&a.errorToolTip.hideTooltip()},_showToolTip:function(){var b=this,c=b.chosenSet.attributes.type,d=b.leftInputBoxView.getCurrentInputValue(),e=b.rightInputBoxView.getCurrentInputValue();if(("vertical"!==c||"disabled"!==b.kickButtonView.getButtonState())&&("horizontal"!==c&&"diagonal"!==c||"disabled"!==b.chopButtonView.getButtonState()))if(a.global.SpeechStream.stopReading(),null!==d&&(1>d||d>11)&&null!==e&&(1>e||e>10))b.errorToolTip.showTooltip(),b._disableButton(b.chopButtonView),b._disableButton(b.kickButtonView),b.setFocus("input-box-container-tooltip-text-container"),this.changeAccMessage("x-input-boxtextbox",1,[b.leftInputBoxView.getCurrentInputValue()]),this.changeAccMessage("y-input-boxtextbox",1,[b.rightInputBoxView.getCurrentInputValue()]);else if(null!==d&&(1>d||d>11))b.leftInputToolTip.showTooltip(),b._disableButton(b.chopButtonView),b._disableButton(b.kickButtonView),b.setFocus("x-input-box-tooltip-text-container"),this.changeAccMessage("x-input-boxtextbox",1,[b.leftInputBoxView.getCurrentInputValue()]),this.changeAccMessage("y-input-boxtextbox",1,[b.rightInputBoxView.getCurrentInputValue()]);else if(null!==e&&1>e||e>10)b.rightInputToolTip.showTooltip(),b._disableButton(b.chopButtonView),b._disableButton(b.kickButtonView),b.setFocus("y-input-box-tooltip-text-container"),this.changeAccMessage("x-input-boxtextbox",1,[b.leftInputBoxView.getCurrentInputValue()]),this.changeAccMessage("y-input-boxtextbox",1,[b.rightInputBoxView.getCurrentInputValue()]);else{var f=parseFloat(d),g=parseFloat(e),h=this.modelPath,i=(f+h.xAxisOffset)*h.gridSize,j=this.chosenSet,k=(j.get("answers"),j.get("coordinates")),l=k.startPoint,m=k.endPoint,n=j.get("type"),o=this.model,p=(h.yAxisOffset-g)*h.gridSize,q=o.liesOnPlank({x:l[0],y:l[1]},{x:m[0],y:m[1]},{x:f,y:g},n);q.liesOnPlank?"horizontal"===n&&(f<=l[0]+1||f>=m[0]-1)||"vertical"===n&&(g<=l[1]+.3||g>=m[1]-.3)||"diagonal"===n&&!q.isAllowed?(b._headScratch(!1,!0),b._disableButton(b.chopButtonView),b._disableButton(b.kickButtonView)):(this._disableState(),this._breakPlank(this.chosenSet.get("type"),{x:i,y:p})):(this._headScratch(!0),b.leftInputBoxView.disableInputBox(),b.rightInputBoxView.disableInputBox(),b._disableButton(b.chopButtonView),b._disableButton(b.kickButtonView))}},_headScratch:function(a,b){var c,d=this.$rodney,e=0,f=this._headScratchAnim,g=f.indexOf("last-frame"),h=this;this._disableState(),h.leftInputBoxView.disableInputBox(),h.rightInputBoxView.disableInputBox(),-1!==g&&("vertical"===this.chosenSet.get("type")?f[g]={imgPath:this._kickImages.kickInitialPos}:f[g]={imgPath:this.horizontalChopImgs.startPos}),c=setInterval(function(){d.css("background-position",f[e].imgPath),e++,e===f.length&&(clearInterval(c),h._enableState(),a&&h._renderPopUps("out-of-plank"),b===!0&&h._renderPopUps("boundary-input"))},400)},_feedbackScreen:function(){a.global.SpeechStream.stopReading();var b=this;this._resetClippedPathPosition(),b.$feedbackAnswers.show(),b.$yourAnswerContainer.show(),b.$inputBoxContainer.hide(),b.$exploreTabCoordinates.hide(),b.seeMathButtonView.hideButton(),b.chopButtonView.hideButton(),b.kickButtonView.hideButton(),b._axisGroup.visible=!1,null!==this.rodneyPlankGroup&&this.rodneyPlankGroup.remove(),null!==this.rodneyBrickGroup&&this.rodneyBrickGroup.remove(),b.$booksShort.hide(),b.$booksLong.hide(),b.$rodney.hide(),b.currentPaperGroup.remove(),b.$axisLabel.hide(),b.$objectContainer.hide(),b.$feedbackInstructionTryAgain.show(),b.feedbackPlankGroup&&b.feedbackPlankGroup.remove();var c=this._dataForFeedbackScreen,d=(c.ratio[0]+":"+c.ratio[1],this.chosenSet.get("ratio")),e=b.modelPath.color;this.scope.activate(),b._drawSeeMathPlank(),b._disableState(),b._disableButton(b.tryAgainButtonview),b.$feedbackInstructionTryAgain.css({bottom:"-95px"}).animate({bottom:"0px"},400,function(){b._enableState(),b._enableButton(b.tryAgainButtonview)}),c.isCorrect?(b.changeMessage("feedback-instruction-text",0,[c.ratio[0],c.ratio[1]]),b.changeAccMessage("feedback-instruction-try-again",0,[c.ratio[0],c.ratio[1]]),b.isScreenDirty=!1,b.tryAgainButtonview.hideButton(),b.$yourAnswer.css({color:e.green}),b.$yourAnswerBullet.css({"background-color":e.green}),b.$feedbackInstructionHeadingText.text(this.getMessage("feedback-heading",1))):(d[0]===d[1]?(b.changeMessage("feedback-instruction-text",1,[c.ratio[0],c.ratio[1],d[0],d[1]]),b.changeAccMessage("feedback-instruction-try-again",1,[c.ratio[0],c.ratio[1],d[0],d[1]])):(b.changeMessage("feedback-instruction-text",2,[c.ratio[0],c.ratio[1],d[0],d[1],d[1],d[0]]),b.changeAccMessage("feedback-instruction-try-again",2,[c.ratio[0],c.ratio[1],d[0],d[1],d[1],d[0]])),b.tryAgainButtonview.showButton(),b.$yourAnswer.css({color:e.red}),b.$yourAnswerBullet.css({"background-color":e.red}),b.$feedbackInstructionHeadingText.text(this.getMessage("feedback-heading",0))),b.setFocus("canvas-activity-area")},_getPixelValues:function(a){var b=this.modelPath,c=(a[0]+b.xAxisOffset)*b.gridSize,d=(b.yAxisOffset-a[1])*b.gridSize;return{x:c,y:d}},_getPosition:function(a,b,c){return{top:b-a.height()/2,left:c-a.width()/2}},_drawSeeMathPlank:function(){var a,b,c,d,e=this._dataForFeedbackScreen,f=this._getPixelValues(e.startPoint),g=this._getPixelValues(e.endPoint),h=this._getPixelValues(e.userAnswer),i=this.scope,j=this.model,k=this.modelPath,l=k.tickLength,m=j.getDistance(f,g),n=j.getDistance(f,h),o=new i.Path.Circle({radius:5,position:{x:h.x+.5,y:h.y-1}}),p=11,q=new i.Path.Line({x:f.x,y:f.y-p},{x:f.x,y:f.y-l-p}),r=new i.Path.Line({x:f.x+m,y:f.y-p},{x:f.x+m,y:f.y-l-p}),s=new i.Path.Line({x:f.x+n,y:f.y-p},{x:f.x+n,y:f.y-l-p}),t=new i.Path.Line({x:f.x,y:f.y-l/2-p},{x:f.x+m,y:f.y-l/2-p}),u=new i.Group([q,r,s,t]),v=this.$plankLeftCordinate,w=this.$plankRightCordinate,x=this.$answerFt1,y=this.$answerFt2,z=this.$feedbackRatioDiv,A=77,B=17,C=0,D=0,E=u.children,F=this.getMessage("feedback-answer-Ft",0);if(u.strokeColor=k.color.feedBackLine,u.strokeWidth=2,e.isCorrect?(o.fillColor=k.color.green,this.$yourAnswer.removeClass("wrong-answer").addClass("right-answer"),this.$yourAnswerBullet.removeClass("wrong-answer-bullet").addClass("right-answer-bullet")):(o.fillColor=k.color.red,this.$yourAnswer.removeClass("right-answer").addClass("wrong-answer"),this.$yourAnswerBullet.removeClass("right-answer-bullet").addClass("wrong-answer-bullet")),a=this._drawDiagonalPlank(f.x,f.y,g.x,g.y,!0,!0),b=Math.atan2(g.y-f.y,g.x-f.x),"diagonal"===e.type){var G=Math.tan(b),H=e.startPoint[1]-(e.userAnswer[0]-e.startPoint[0])*G,I=this._getPixelValues([e.userAnswer[0],H]);o.position={x:I.x+.5,y:I.y-1}}if(d=new i.Group([a,u]),d.rotate(180*b/Math.PI,f),a.children[0].children[1].rotate(180*-b/Math.PI,f),this.changeMessage("your-answer",0,[e.userAnswer[0],e.userAnswer[1]]),z.html(e.ratio[0]+":"+e.ratio[1]),v.html(this.getMessage("start-coordinate",0,e.startPoint)),w.html(this.getMessage("start-coordinate",0,e.endPoint)),x.html("<span>"+e.sectionLengths[0]+F+"</span>"),y.html("<span>"+e.sectionLengths[1]+F+"</span>"),"vertical"===e.type){A=40,c=this._getPosition(z,g.y-A,g.x);var J=this._getPosition(v,f.y,f.x+50),K=this._getPosition(w,g.y,g.x+50);v.css({top:J.top,left:J.left+6}),w.css({top:K.top,left:K.left+6}),C=3}else c=this._getPosition(z,(f.y+g.y)/2-A,(f.x+g.x)/2),v.css({top:f.y-v.height()/2,left:f.x-B-v.width()+8}),w.css({top:g.y-w.height()/2,left:g.x+B-8});"diagonal"===e.type&&(D=25,C=0>b?11*Math.cos(b):-11*Math.cos(b)),z.css({left:c.left,top:c.top-11});var L=this._getPosition(x,(E[0].position.y+E[2].position.y)/2,(E[0].position.x+E[2].position.x)/2);x.css({top:L.top-D,left:L.left-C});var M=this._getPosition(y,(E[1].position.y+E[2].position.y)/2,(E[1].position.x+E[2].position.x)/2);y.css({top:M.top-D,left:M.left-C}),b*=180/Math.PI;var N=0;if(x.css({"-webkit-transform":"rotate("+N+"deg)","-moz-transform":"rotate("+N+"deg)","-ms-transform":"rotate("+N+"deg)",transform:"rotate("+N+"deg)","-ms-transform-origin":"50% 50%","-webkit-transform-origin":"50% 50%"}),y.css({"-webkit-transform":"rotate("+N+"deg)","-moz-transform":"rotate("+N+"deg)","-ms-transform":"rotate("+N+"deg)",transform:"rotate("+N+"deg)","-ms-transform-origin":"50% 50%","-webkit-transform-origin":"50% 50%"}),"vertical"!==e.type)x.css({"-webkit-transform":"rotate("+b+"deg)","-moz-transform":"rotate("+b+"deg)","-ms-transform":"rotate("+b+"deg)",transform:"rotate("+b+"deg)","-ms-transform-origin":"50% 50%","-webkit-transform-origin":"50% 50%"}),y.css({"-webkit-transform":"rotate("+b+"deg)","-moz-transform":"rotate("+b+"deg)","-ms-transform":"rotate("+b+"deg)",transform:"rotate("+b+"deg)","-ms-transform-origin":"50% 50%","-webkit-transform-origin":"50% 50%"});else{var O=y.position().left+y.outerWidth()-f.x;Math.abs(O)<2&&(y.css("left",y.position().left+=O),x.css("left",x.position().left+=O)),d.position.x=d.position.x+1.5}this.feedbackPlankGroup=new i.Group([a,u,o]),o.bringToFront(),this.feedbackCanvasArea=[e.userAnswer[0],e.userAnswer[1],e.startPoint[0],e.startPoint[1],e.endPoint[0],e.endPoint[1],e.sectionLengths[0],e.sectionLengths[1]],this.changeAccMessage("canvas-activity-area",1,this.feedbackCanvasArea)},_renderPopUps:function(b){var c,d,e=this,f=e.filePath,g=e.idPrefix,h=e.manager,i=e.player;switch(c=a.global.Theme2.PopUpBox,d={path:f,manager:h,player:i,idPrefix:g,type:c.CONFIRM,closeCallback:{fnc:function(){e.leftInputBoxView.enableInputBox(),e.rightInputBoxView.enableInputBox(),this.changeAccMessage("x-input-boxtextbox",1,[e.leftInputBoxView.getCurrentInputValue()]),this.changeAccMessage("y-input-boxtextbox",1,[e.rightInputBoxView.getCurrentInputValue()]),e.setFocus("x-input-boxtextbox")},scope:e}},b){case"out-of-plank":d.text=this.getMessage("pop-up-box",1),d.title=this.getMessage("pop-up-box",0),e.leftInputBoxView.disableInputBox(),e.rightInputBoxView.disableInputBox(),c.createPopup(d),e._disableButton(e.kickButtonView),e._disableButton(e.chopButtonView);break;case"boundary-input":d.text=this.getMessage("pop-up-box",7),d.title=this.getMessage("pop-up-box",0),e.leftInputBoxView.disableInputBox(),e.rightInputBoxView.disableInputBox(),c.createPopup(d),e._disableButton(e.kickButtonView),e._disableButton(e.chopButtonView);break;case"try-another":if(a.global.SpeechStream.stopReading(),"disabled"===this.tryAnotherButtonview.getButtonState())return;if(this.isScreenDirty===!0){var e=this;d.text=this.getMessage("pop-up-box",4),d.title=this.getMessage("pop-up-box",3),d.closeCallback={fnc:e._tryAnotherBoard,scope:e},d.buttons=[{id:e.idPrefix+"ok-btn",text:e.getMessage("pop-up-box",5),response:{isPositive:!0,buttonClicked:e.idPrefix+"ok-btn"}},{id:e.idPrefix+"cancel-btn",text:e.getMessage("pop-up-box",6),response:{isPositive:!1,buttonClicked:e.idPrefix+"cancel-btn"}}],c.createPopup(d),this.errorToolTip.hideTooltip(),this.leftInputToolTip.hideTooltip(),this.rightInputToolTip.hideTooltip()}else this._tryAnotherBoard(!0)}},_renderChopScenarioHorizontal:function(a){var b,c,d,e,f,g,h,i,j=this.chosenSet,k=(j.get("plankLength"),[]),l=[],m=this.scope,n=this.modelPath,o=n.plankWidth,p=n.gridSize,q=n.xAxisOffset,r=n.yAxisOffset,s=n.horizontalBrickWidth,t=n.horizontalBrickHeight;null!==this.rodneyPlankGroup&&this.rodneyPlankGroup.remove(),null!==this.rodneyBrickGroup&&this.rodneyBrickGroup.remove(),b=this.chosenSet.get("coordinates");var u=(14-b.startPoint[1])*p-p/4,v=b.startPoint[0]*p-p/3,w=u-p/2,x=(1+b.endPoint[0])*p+p/4-1;for(this.$startCoordinate.css({top:u,left:v}),this.$endCoordinate.css({top:w+3,left:x-3}),this.changeMessage("start-coordinate",0,[b.startPoint[0],b.startPoint[1]]),this.changeMessage("end-coordinate",0,[b.endPoint[0],b.endPoint[1]]),c=(b.startPoint[0]+q)*p,d=(r-b.startPoint[1])*p-1,e=(b.endPoint[0]+q)*p,f=d+o,l=this._drawEndPointsPlank(c,d,e,f,a),g=0,h=0;4>g;g++,h++)k[h]=this._drawBricks(c,f+1,a),k[h+4]=this._drawBricks(e-s,f+1,a),f+=t;this.rodneyPlankGroup=new m.Group(l),i=new m.Group(k),this.rodneyBrickGroup=i,this.rodneyPlankGroup.bringToFront(),this._positionRodney(this.rodneyPlankGroup.position,"horizontal")},_renderKickScenarioVertical:function(a){var b,c,d,e,f,g,h,i=this.chosenSet,j=(i.get("plankLength"),[]),k=[],l=this.scope,m=this.modelPath,n=m.plankWidth,o=m.gridSize,p=m.xAxisOffset,q=m.yAxisOffset;null!==this.rodneyPlankGroup&&this.rodneyPlankGroup.remove(),null!==this.rodneyBrickGroup&&this.rodneyBrickGroup.remove(),b=this.chosenSet.get("coordinates");var r=(14-b.startPoint[1])*o-o/4,s=(b.startPoint[0]+1.5)*o,t=(13-b.endPoint[1])*o+10,u=s;for(this.$startCoordinate.css({top:r,left:s}),this.$endCoordinate.css({top:t,left:u}),this.changeMessage("start-coordinate",0,[b.startPoint[0],b.startPoint[1]]),this.changeMessage("end-coordinate",0,[b.endPoint[0],b.endPoint[1]]),c=(b.startPoint[0]+p)*o,d=(q-b.startPoint[1])*o-1,f=(q-b.endPoint[1])*o,e=c+n,k=this._drawEndPointsPlank(c,d,e,f,a,!0),g=0;3>g;g++)j[g]=k[g];h=new l.Group(j),this.rodneyPlankGroup=h,this._positionRodney(h.position,"vertical",d-f)},_positionRodney:function(a,b,c){var d,e,f=this.modelPath,g=(f.rodneyHorizontalTopOffset,f.rodneyImageHeight),h=f.rodneyImageWidth;switch(b){case"horizontal":d=a.y-f.horizontalRodneyTopOffset,e=a.x-h/2;break;case"vertical":d=a.y+c/2-g,e=a.x-270;break;case"diagonal":d=this.diagonalBase-302,e=a.x-145.5}this.$rodney.css({top:d,left:e})},_setBookshelfDimensions:function(a){var b,c,d,e;if(b=[null,0,0,0,0],a[0]===a[1])a[0]<=7.5&&a[0]>=5&&(b=[null,a[0],a[1],4,4],c=[1,2]),a[0]<=4&&a[0]>=3.5&&(b=[null,7.5,7.5,a[0],a[0]],c=[3,4]);else{for(b=[null,7.5,7.5,null,null],c=[],d=0;2>d;d++)a[d]>=3.5&&a[d]<=4?(b[3]=a[d],b[4]=a[d],c[d]=3):a[d]>=4.5&&a[d]<=5?(b[0]=a[d],c[d]=0):a[d]>5&&a[d]<=7.5&&(b[1]=a[d],b[2]=a[d],c[d]=1);e=c[0],c[0]=c[1],c[1]=e}this._drawBookshelf(b,c)},_drawBookshelf:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=[],o=this.modelPath,p=o.verticalDirection,q=o.horizontalDirection,r=o.plankWidth,s=o.containerHeightOffset,t=(o.containerTopOffset,o.longBookImageCoOrdinates,o.gridSize),u=o.objectContainerXMidPoint,v=0,w=this.scope;d=0,e=null!==a[0]?a[0]*t:a[3]*t+2*r,h=(e-d)/2,f=0,g=r,v=r,-1===b.indexOf(0)?(n[0]=this._drawPlank(d,f,e,g,q),n[0].visible=!1):n[0]=this._drawEmptyPlank(d,f,e,g),d=e-r,e=e,f=g,g=a[2]*t+f,v+=g-f,-1===b.indexOf(2)?(n[2]=this._drawPlank(d,f,e,g,p),n[2].visible=!1):n[2]=this._drawEmptyPlank(d,f,e,g),d=0,e=d+r,f=f,g=g,-1===b.indexOf(1)?(n[1]=this._drawPlank(d,f,e,g,p),n[1].visible=!1):n[1]=this._drawEmptyPlank(d,f,e,g),d=e,e=null!==a[0]?a[0]*t-2*r+d:a[3]*t+d,f=2*t+r,g=f+r,i=f-35,-1===b.indexOf(3)?(n[3]=this._drawPlank(d,f,e,g,q),n[3].visible=!1):n[3]=this._drawEmptyPlank(d,f,e,g),d=d,e=e,f=4*t+r,g=f+r,j=h,k=f-33,-1===b.indexOf(4)?(n[4]=this._drawPlank(d,f,e,g,q),n[4].visible=!1):n[4]=this._drawEmptyPlank(d,f,e,g),n[5]=new w.Raster({source:this.booksLongBase64,position:{x:h,y:i}});var x=k;for(c=new w.Group(n),this.$el.find(".object-container").css({height:v+s}),m=this._adjustObjectContainerDivHeight(),l=0;5>l;l++)n[l].visible=!0;c.position=new w.Point(u,m+80+v/2);var x=n[4].position.y-66;x=Math.floor(x),this.$booksShort.css({top:x-8,left:u-55});var x=n[3].position.y-71;x=Math.floor(x),this.$booksLong.css({top:x-8,left:u-65}),this.$booksShort.show(),this.$booksLong.show(),this.currentPaperGroup=c,this.dottedSideIndex=b,this._adjustObjectContainerDivHeight()},_drawTrophyStand:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o=[],p=this.modelPath,q=p.verticalDirection,r=p.horizontalDirection,s=p.plankWidth,t=p.containerHeightOffset,u=p.containerTopOffset,v=p.gridSize,w=p.objectContainerXMidPoint,x=0,y=this.scope;for(g=0,i=2*p.trophyCoOrdinates[1],h=a[0]*v,h=Math.round(10*h)/10,j=i+s,x+=j,k=h/2,l=p.trophyCoOrdinates[1],-1===b.indexOf(0)?(o[0]=this._drawPlank(g,i,h,j,r),o[0].visible=!1):o[0]=this._drawEmptyPlank(g,i,h,j,r),g=h-s,i=j-1,h=h,j=a[2]*v+i,j=Math.round(10*j)/10,x+=j-i,-1===b.indexOf(2)?(o[2]=this._drawPlank(g,i,h,j,q),o[2].visible=!1):o[2]=this._drawEmptyPlank(g,i,h,j,q),g=0,i=i,h=s,j=a[1]*v+i,j=Math.round(10*j)/10,-1===b.indexOf(1)?(o[1]=this._drawPlank(g,i,h,j,q),o[1].visible=!1):o[1]=this._drawEmptyPlank(g,i,h,j,q),d=new y.Raster({source:this.trophyBase64,position:{x:k,y:l}}),c=new y.Group(o),this.$el.find(".object-container").css({height:x+t}),m=this._adjustObjectContainerDivHeight(),e=m+u+x/2+p.trophyCoOrdinates[1],c.position=new y.Point(w,e),n=0;3>n;n++)o[n].visible=!0;d.position.y=e-p.trophyCoOrdinates[1]-(s+(j-i)/2),-1===b.indexOf(0)?(d.position.y=d.position.y+12,c.position.y=c.position.y+10):(d.position.y=d.position.y+12,c.position.y=c.position.y+3),d.position.x=w,f=new y.Group([c,d]),this.currentPaperGroup=f,this.dottedSideIndex=b},_setBagStandDimensions:function(a){var b,c;a[0]===a[1]?(b=[a[0],7,a[1]],c=[0,2]):(b=[a[0],a[1],a[0]],c=[1,0]),this._drawBagStand(b,c)},_drawBagStand:function(a,b){var c,d,e,f,g,h,i=this.scope,j=[],k=null,l=this.modelPath,m=l.punchingBagCoOrdinates[0],n=l.punchingBagCoOrdinates[1],o=l.verticalDirection,p=l.horizontalDirection,q=l.plankWidth,r=l.containerHeightOffset,s=l.containerTopOffset,t=l.gridSize,u=l.objectContainerXMidPoint,v=0;for(c=0,e=0,d=a[0]*t,d=Math.round(10*d)/10,f=q,v+=f,-1===b.indexOf(0)?(j[0]=this._drawPlank(c,e,d,f,p),j[0].visible=!1):j[0]=this._drawEmptyPlank(c,e,d,f),c=d-q,e=f-1,d=d,f=a[1]*t+q,f=Math.round(10*f)/10,v+=f-e,-1===b.indexOf(1)?(j[1]=this._drawPlank(c,e,d,f,o),j[1].visible=!1):j[1]=this._drawEmptyPlank(c,e,d,f),c=0,e=f,d=a[2]*t,d=Math.round(10*d)/10,f=e+q,v+=q-1,-1===b.indexOf(2)?(j[2]=this._drawPlank(c,e,d,f,p),j[2].visible=!1):j[2]=this._drawEmptyPlank(c,e,d,f),j[3]=new i.Raster({source:this.punchingBagBase64,position:{x:m,y:n}}),k=new i.Group(j),this.$el.find(".object-container").css({height:v+r}),h=this._adjustObjectContainerDivHeight(),g=0;3>g;g++)j[g].visible=!0;k.position=new i.Point(u,h+s+v/2),this.dottedSideIndex=b,this.currentPaperGroup=k},_adjustObjectContainerDivHeight:function(){var a=this.$el.find(".object-container"),b=40,c=20,d=parseInt(a.css("height"),10),e=this.modelPath.Points.xAxisCenterPoints[1],f=(e-b-c-d)/2+b+c-4;return a.css({top:f}),f},_displayFeedbackPlanks:function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this.currentPaperGroup.children,n=this.dottedSideIndex,o=[],p=[],q=[],r=[],s=[],t=this,u=this.scope;for("trophy-stand"===this.currentObject&&(m=m[0].children),o[1]=m[n[1]],f=0;2>f;f++)if(o[f]=m[n[f]],d=o[f].bounds.height,e=o[f].bounds.width,d>e?(h=0,j=0,i=16,k=42*a[f]-1,l="vertical"):(h=0,j=0,i=42*a[f],k=16,l="horizontal"),q[f]=this._drawPlank(h,j,i,k,l),q[f].opacity=0,q[f].position=o[f].position,b===!1){switch(l){case"vertical":g=(o[f].bounds.height-k)/2,q[f].position.y=q[f].position.y-g+1;break;case"horizontal":g=(o[f].bounds.width-i)/2,q[f].position.x=q[f].position.x-g}var v=new this.scope.Rectangle({x:h,y:j},{x:i,y:k});s[f]=new this.scope.Path.Rectangle(v),r[f]=new this.scope.Path.Rectangle(v),r[f].fillColor=new u.Color(1,0,0),s[f].fillColor=new u.Color(1,1,1),r[f].opacity=0,s[f].visible=!1,s[f].shadowColor=new u.Color(1,0,0),s[f].shadowBlur=10,s[f].position=q[f].position,r[f].position=q[f].position,s[f].shadowOffset=new u.Point(0,0)}u.view.onFrame=function(){if(q[1]&&(q[1].opacity+=.05),q[0]&&(q[0].opacity+=.05),q[0]&&q[0].opacity>.95){if(u.view.onFrame=null,t.trigger("feedback-animation-ends"),b===!0&&(m[n[0]].visible=!1,m[n[1]].visible=!1,p.push(q[0]),p.push(q[1])),r!==[]&&r[0]&&r[1])for(c=1;c>=0;c--)s[c].visible=!0,p.push(s[c]),p.push(q[c]),p.push(r[c]),s[c].sendToBack(),p[c].bringToFront(),r[c].opacity=.3,r[c].bringToFront();t.feedbackPlankGroup=new u.Group(p)}}},_drawEmptyPlank:function(a,b,c,d){var e=this.scope,f=new e.Rectangle({x:a,y:b},{x:c,y:d}),g=new e.Path.Rectangle(f);return g.strokeColor=this.modelPath.color.plankBorder,g.dashArray=[1,2],g},render:function(){var a=new paper.PaperScope,b=this,c=b.idPrefix+"my-canvas",d=b.model,e=this.$(".canvas-container");$("<canvas height="+d.get("canvasHeight")+" width="+d.get("canvasWidth")+">").attr({id:c}).appendTo(e),a.setup(c),b.scope=a,b.$el.css({"background-image":'url("'+b.filePath.getImagePath("explore-grid")+'")'}),b._drawAxis(),b._renderButtonsAndInputBox(),b.loadScreen("buttons-screen"),b._renderToolTip(),b._setBrokenPlankGroup()},_renderButtonsAndInputBox:function(){var b,c,d=this,e=a.global.Theme2.InputBox,f=a.global.Theme2.Button,g=a.Common.Components.Theme2.Views.InputBox,h=d.filePath,i=d.idPrefix,j=d.manager,k=d.player,l=new RegExp("^[0-9]{0,2}\\.[0-9]?$|^[0-9]{0,2}$"),m={filePath:h,manager:j,player:k,idPrefix:i,defaultValue:"",height:42,width:58,inputType:g.INPUT_TYPE_CUSTOM,maxCharLength:4,precision:1,customClass:"line-stretcher-coordinate-input-box"};m.regexString=l,m.containerId=i+"x-input-box",m.defaultTabIndexToInputBox=!1,b=i+"x-input-box"+g.CUSTOM_CHANGE_EVENT_NAME,d.leftInputBoxView=e.createInputBox(m),d.leftInputBoxView.on(b,function(){d._enableDisableChopButton(),d._setScreenDirtyFlag(),null!==d.leftInputBoxView.getCurrentInputValue()&&this.changeAccMessage("x-input-boxtextbox",1,[d.leftInputBoxView.getCurrentInputValue()])}),d.leftInputBoxView.on(m.containerId+g.KEYUP_EVENT_NAME,function(a){(13===a.keyCode||13===a.which)&&(this.setAccMessage("x-input-boxtextbox"," "),d._showToolTip(),this.$(" input").blur())}),m.containerId=i+"y-input-box",c=i+"y-input-box"+g.CUSTOM_CHANGE_EVENT_NAME,d.rightInputBoxView=e.createInputBox(m),d.loadScreen("input-box-screen"),d.rightInputBoxView.on(c,function(){d._enableDisableChopButton(),d._setScreenDirtyFlag(),null!==d.rightInputBoxView.getCurrentInputValue()&&this.changeAccMessage("y-input-boxtextbox",1,[d.rightInputBoxView.getCurrentInputValue()])}),d.rightInputBoxView.on(m.containerId+g.KEYUP_EVENT_NAME,function(a){(13===a.keyCode||13===a.which)&&(this.setAccMessage("y-input-boxtextbox"," "),d._showToolTip(),this.$("input").blur())});var n={idPrefix:i,player:k,manager:j,path:h,colorType:a.global.Theme2.Button.COLORTYPE.BLUE};n.data={id:i+"chop-button",text:d.getMessage("chop-button",0),type:a.global.Theme2.Button.TYPE.TEXT,baseClass:"custom-black-button"},d.chopButtonView=new f.generateButton(n),n.data={id:i+"see-math-button",text:d.getMessage("see-math-button",0),type:a.global.Theme2.Button.TYPE.TEXT,baseClass:"custom-black-button"},d.seeMathButtonView=new f.generateButton(n),n.data={id:i+"kick-button",text:d.getMessage("kick-button",0),type:a.global.Theme2.Button.TYPE.TEXT,baseClass:"custom-black-button"},d.kickButtonView=new f.generateButton(n),n.data={id:i+"try-again",text:d.getMessage("try-again",0),type:a.global.Theme2.Button.TYPE.TEXT,baseClass:"custom-black-button"},d.tryAgainButtonview=new f.generateButton(n)},_drawAxis:function(){this.scope.activate();var a,b,c=this.scope,d=this.modelPath,e=d.color,f=d.Points,g=d.strokeWidth,h=new c.Path.Line({x:f.xAxisStartPoints[0],y:f.xAxisStartPoints[1]},{x:f.xAxisEndPoints[0],y:f.xAxisEndPoints[1]}),i=new c.Path.Line({x:f.yAxisStartPoints[0],y:f.yAxisStartPoints[1]},{x:f.yAxisEndPoints[0],y:f.yAxisEndPoints[1]});h.strokeColor=e.axis,h.strokeWidth=g.axisStrokeWidth,i.strokeColor=e.axis,i.strokeWidth=g.axisStrokeWidth,b=new c.Path,b.add({x:-(f.axisTriangleWidth/2),y:0}),b.add({x:f.axisTriangleWidth/2,y:0}),b.add({x:0,y:-f.axisTriangleHeight}),b.closed=!0,b.position=[f.yAxisArrowCenterPoints[0],f.yAxisArrowCenterPoints[1]],b.strokeColor=e.axis,b.fillColor=e.axis,a=b.clone(),a.strokeColor=e.axis,a.rotate(90),a.position=[f.xAxisArrowCenterPoints[0],f.xAxisArrowCenterPoints[1]],c.view.draw(),this._axisGroup=new c.Group([h,i,b,a])},_cacheDomElements:function(){var a=this;a.$yourAnswer=a.$(".your-answer"),a.$plankLeftCordinate=a.$(".plank-left-cordinate"),a.$plankRightCordinate=a.$(".plank-right-cordinate"),a.$feedbackRatioDiv=a.$(".feedback-ratio-div"),a.$yourAnswerBullet=a.$(".your-answer-bullet"),a.$yourAnswerContainer=a.$(".your-answer-container"),a.$axisLabel=a.$(".axis-label"),a.$objectContainer=a.$(".object-container"),a.$feedbackInstructionTryAgain=a.$(".feedback-instruction-try-again"),a.$feedbackInstructionHeadingText=a.$(".feedback-instruction-heading-text"),a.$inputBoxContainer=a.$(".input-box-container"),a.$rodney=a.$(".child-cont"),a.$answerFt1=a.$(".answerFt1"),a.$answerFt2=a.$(".answerFt2"),a.$feedbackAnswers=a.$(".feedback-answers"),a.$startCoordinate=a.$(".start-coordinate"),a.$endCoordinate=a.$(".end-coordinate"),a.$exploreTabCoordinates=a.$(".explore-tab-coordinates"),a.$tryAnotherButton=a.$(".try-another-button"),a.$chopButton=a.$(".chop-button"),a.$seeMathButton=a.$(".see-math-button"),a.$tryAgainButton=a.$(".try-again"),a.$kickButton=a.$(".kick-button"),a.$booksShort=a.$(".book-container-2"),a.$booksLong=a.$(".book-container-1"),a.$booksShort.hide(),a.$booksLong.hide()},_renderToolTip:function(){var b=a.global.Theme2.Tooltip,c=this,d=a.Common.Components.Theme2.Views.Tooltip,e=(c.leftInputBoxView.getCurrentInputValue(),c.rightInputBoxView.getCurrentInputValue(),{_player:c.player,idPrefix:this.idPrefix,manager:c.manager,path:c.filePath,borderColor:"1 px solid #A16106",backgroundColor:"#FFD08E",textColor:"#7C5218",type:d.TYPE.FORM_VALIDATION,isTts:!1});e.id=c.idPrefix+"left-input-tooltip",e.elementEl=c.idPrefix+"x-input-box",e.text=c.getMessage("tool-tip-text",0),e.arrowType=d.ARROW_TYPE.TOP_MIDDLE,e.tabIndex=524,c.leftInputToolTip=b.generateTooltip(e),e.id=c.idPrefix+"right-input-tooltip",e.elementEl=c.idPrefix+"y-input-box",e.text=c.getMessage("tool-tip-text",1),e.arrowType=d.ARROW_TYPE.TOP_MIDDLE,e.tabIndex=535,c.rightInputToolTip=b.generateTooltip(e),e.containerWidth=302,e.id=c.idPrefix+"error-tooltip",
e.elementEl=c.idPrefix+"input-box-container",e.text=c.getMessage("tool-tip-text",2),e.isArrow=!1,e.tabIndex=526,c.errorToolTip=b.generateTooltip(e)},_generateImageBase64:function(){this.horizontalPlankBase64=this.getSpritePartBase64URL("raster-sprite",0,344,928,14),this.verticalPlankBase64=this.getSpritePartBase64URL("raster-sprite",0,368,14,599),this.trophyBase64=this.getSpritePartBase64URL("raster-sprite",0,224,64,110),this.punchingBagBase64=this.getSpritePartBase64URL("raster-sprite",0,0,41,57),this.diagonalPlankBase64=this.getSpritePartBase64URL("raster-sprite",0,977,928,599);var a=this.getImagePath("raster-sprite");this.$booksShort.css({"background-image":"url("+a+")","background-position":"0px -147px"}),this.$booksLong.css({"background-image":"url("+a+")","background-position":"0px -66px"})},_tryAnotherBoard:function(b){a.global.SpeechStream.stopReading();var c=this;c.leftInputToolTip.hideTooltip(),c.rightInputToolTip.hideTooltip(),c.errorToolTip.hideTooltip(),b.isPositive||b===!0?(c._renderNewScenario(!1),c._hideOnRender(),c.$rodney.show(),c.$objectContainer.show(),c._hideFeedbackScreen(),c._resetClippedPathPosition(),c._setBrokenPlankGroup(),this._changeText(),c.setFocus("canvas-activity-area")):c.setFocus("explorer-direction-text-direction-text-buttonholder"),null!==c.leftInputBoxView.getCurrentInputValue()?this.changeAccMessage("x-input-boxtextbox",1,[c.leftInputBoxView.getCurrentInputValue()]):this.changeAccMessage("x-input-boxtextbox",0,[c.leftInputBoxView.getCurrentInputValue()]),null!==c.rightInputBoxView.getCurrentInputValue()?this.changeAccMessage("y-input-boxtextbox",1,[c.rightInputBoxView.getCurrentInputValue()]):this.changeAccMessage("y-input-boxtextbox",0,[c.rightInputBoxView.getCurrentInputValue()])},_hideFeedbackScreen:function(){var a=this;a.$feedbackInstructionTryAgain.hide(),a.$yourAnswerContainer.hide(),a.$axisLabel.show(),a.$feedbackAnswers.hide(),a.$inputBoxContainer.show(),a.$exploreTabCoordinates.show(),a.$rodney.show(),a.seeMathButtonView.hideButton(),a.$objectContainer.show(),null!==a.feedbackGroup&&a.feedbackGroup.remove(),null!==a.feedbackGroup&&a.feedbackGroup.remove(),null!==this.feedbackPlankGroup&&(this.feedbackPlankGroup.remove(),paper.view.draw()),a._axisGroup.visible=!0,a.leftInputBoxView.clearInputBox(),a.rightInputBoxView.clearInputBox(),a._hideOnRender()},_renderNewScenario:function(a){this._renderObject(a),this._changeInstructionText(this.currentObject,this.chosenSet.get("isMidPoint"),this.chosenSet.get("ratio"))},_renderOnTryAgain:function(){a.global.SpeechStream.stopReading();var b=this;this._resetClippedPathPosition(),this._setBrokenPlankGroup(),this._hideFeedbackScreen(),this._renderObject(!1,!0),this.changeAccMessage("x-input-boxtextbox",0,[b.leftInputBoxView.getCurrentInputValue()]),this.setFocus("x-input-boxtextbox"),this.changeAccMessage("y-input-boxtextbox",0,[b.rightInputBoxView.getCurrentInputValue()]),this.changeAccMessage("canvas-activity-area",0,this.inputBoxCanvasArea)},_renderObject:function(a,b){if(this.scope.activate(),b!==!0){var c,d,e,f,g,h,i,j,k,l=this.model,m=l.ValidItems;null!==this.currentPaperGroup&&(this.currentPaperGroup.remove(),this.$booksShort.hide(),this.$booksLong.hide()),a===!0?(c=m.filter(function(a){return a.get("isMidPoint")===!0&&"diagonal"!==a.get("type")}),h=l.getRandomInt(0,c.length-1)):(c=m,h=this.counter,this.counter++,this.counter===m.length&&(this.counter=0)),null!==this.feedbackPlankGroup&&(this.feedbackPlankGroup.remove(),paper.view.draw()),k=c[h],this.chosenSet=k,f=k.get("type"),this.type=f}var n=this.chosenSet,o=n.get("coordinates"),p=(o.startPoint,o.endPoint,n.get("type"));switch(p){case"horizontal":this._renderChopScenarioHorizontal(p),this.chopButtonView.showButton(),this.kickButtonView.hideButton(),g=this.filePath.getImagePath("horizontal-sequence-sprite"),i=this.horizontalChopImgs.startPos;break;case"vertical":this._renderKickScenarioVertical(p),this.chopButtonView.hideButton(),this.kickButtonView.showButton(),g=this.filePath.getImagePath("vertical-sequence-sprite"),i=this._kickImages.kickInitialPos;break;case"diagonal":this._renderChopScenarioDiagonal(p),this.chopButtonView.showButton(),this.kickButtonView.hideButton(),g=this.filePath.getImagePath("diagonal-sequence-sprite"),i=this.horizontalChopImgs.startPos}switch(this.$rodney.css("background-image","url("+g+")"),this.$rodney.css("background-position",i),b!==!0?(d=k.get("possibleObjects"),e=d.length,j=d[l.getRandomInt(0,e-1)],this.isScreenDirty=!1,this.currentObject=j,this.loadScreen("object-acc-text"),"bag-stand"===this.currentObject?this.currentObjectMessage=this.getAccMessage("object-text",0):"trophy-stand"===this.currentObject?this.currentObjectMessage=this.getAccMessage("object-text",1):this.currentObjectMessage=this.getAccMessage("object-text",2),this.type=f,this.segments=k.get("segments")):this.isScreenDirty=!0,this.currentObject){case"trophy-stand":this._setTrophyStandDimensions(this.segments),this.changeMessage("object-name-text",0);break;case"book-shelf":this._setBookshelfDimensions(this.segments),this.changeMessage("object-name-text",2);break;case"bag-stand":this._setBagStandDimensions(this.segments),this.changeMessage("object-name-text",1)}},_setTrophyStandDimensions:function(a){var b,c;a[0]===a[1]?(b=[4,a[0],a[1]],c=[1,2]):(b=[a[1],a[0],a[0]],c=[0,1]),this._drawTrophyStand(b,c)},_renderChopScenarioDiagonal:function(){var a,b,c,d,e,f,g=this.chosenSet,h=(g.get("plankLength"),this.scope,this.modelPath),i=(h.plankWidth,h.gridSize),j=h.xAxisOffset;null!==this.rodneyPlankGroup&&this.rodneyPlankGroup.remove(),null!==this.rodneyBrickGroup&&this.rodneyBrickGroup.remove(),b=g.get("coordinates");var k=(14-b.startPoint[1])*i-i/4,l=(13-b.endPoint[1])*i+11,m=b.endPoint[0]*i+1.3*i;a=b.startPoint[0]%1!==0&&b.startPoint[1]%1!==0?b.startPoint[0]*i-1.3*i:b.startPoint[0]%1!==0||b.startPoint[1]%1!==0?(b.startPoint[0]-.7)*i:(b.startPoint[0]-.1)*i-i/3,this.$startCoordinate.css({top:k,left:a-1}),this.$endCoordinate.css({top:l,left:m-5}),this.changeMessage("start-coordinate",0,[b.startPoint[0],b.startPoint[1]]),this.changeMessage("end-coordinate",0,[b.endPoint[0],b.endPoint[1]]),c=(b.startPoint[0]+j)*i,d=(14-b.startPoint[1])*i-1,f=(14-b.endPoint[1])*i-1,e=(b.endPoint[0]+j)*i,this.rodneyPlankGroup=this._drawDiagonalPlank(c,d,e,f),this._positionRodney(this.rodneyBrickGroup.position,"diagonal")},_drawPlank:function(a,b,c,d,e,f){var g,h,i,j,k,l=this.scope,m=new l.Rectangle({x:a,y:b},{x:c,y:d}),n=new l.Path.Rectangle(m),o=(a+c)/2,p=(b+d)/2;switch(b-=1,d+=1,e){case"horizontal":h=this.horizontalPlankBase64;break;case"vertical":h=this.verticalPlankBase64,f&&(b+=3,d-=3);break;case"none":h=this.diagonalPlankBase64}return i=new l.Raster({source:h,position:{x:o,y:p}}),g=new l.Rectangle({x:a-2,y:b},{x:c+2,y:d}),n.strokeWidth=2,n.strokeColor=this.modelPath.color.plankBorder,k=new l.Path.Rectangle(g),j=new l.Group(k,n,i),j.clipped=!0,n.bringToFront(),j},_drawEndPointsPlank:function(a,b,c,d,e,f){var g=this.scope,h=this.modelPath.color.plankEndpoint,i=a,j=b,k=this._drawPlank(a,b,c,d,e,f),l=g.Path.Circle({position:{x:i,y:j},radius:5});switch(l.fillColor=h,e){case"horizontal":i=c,j=b;break;case"vertical":j=a,j=d}var m=g.Path.Circle({position:{x:i,y:j},radius:5});return m.fillColor=h,[k,l,m]},_drawDiagonalPlank:function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n=this.scope,o=Math.sqrt(Math.pow(c-a,2)+Math.pow(d-b,2)),p=2,q=16,r=(new n.Rectangle({x:a,y:b},{x:a+o,y:b+q}),new n.Rectangle({x:a-p,y:b-p},{x:a+o+p,y:b+q+p})),s=a+(c-a)/2,t=b+(d-b)/2,u=new n.Raster({source:this.diagonalPlankBase64,position:{x:s,y:t}}),v=this.modelPath,w=v.diagonalFixedBricks,x=this.modelPath.diagonalBrickHeight,y=this.modelPath.diagonalBrickWidth;if(p=.8,m=new n.Path.Rectangle({x:a-p,y:b-p},{x:a+o+p,y:b+q+p}),m.strokeWidth=2,m.strokeColor=this.modelPath.color.plankBorder,g=new n.Path.Rectangle(r),h=new n.Group(g,u,m),h.clipped=!0,i=Math.atan2(d-b,c-a),i*=180/Math.PI,f||(m.rotate(i,new n.Point(a,b)),g.rotate(i,new n.Point(a,b))),k=n.Path.Circle({position:h.children[2].segments[1].point,radius:5}),k.fillColor=this.modelPath.color.plankEndpoint,l=n.Path.Circle({position:h.children[2].segments[2].point,radius:5}),l.fillColor=this.modelPath.color.plankEndpoint,!e){var z,A,B,C,D,E,F,G=new n.Group,H=h.children[2].segments;0>i?(z=H[0].point.y,C=H[0].point.x,A=H[3].point.y,B=H[3].point.x,D=!0):(z=H[3].point.y,C=H[3].point.x,A=H[0].point.y,B=H[0].point.x,D=!1);var I,J,K=z-A,L=21*Math.tan(Math.abs(i*Math.PI/180)),M=Math.floor((K-L)/21),N=B-y/2,O=z+x*w;for(this.diagonalBase=O,M+=w,J=0;M>J;J++)I=new n.Path.RoundRectangle({x:N,y:O-(J+1)*x},{x:N+y,y:O-J*x},3),G.addChild(I);I=new n.Path.RoundRectangle({x:N,y:A+L+2},{x:N+y,y:O-M*x},3),G.addChild(I);var P=I.segments[2].point;for(E=G.bounds.height,F=w*x,N=C-y/2,O=z,J=0;w>J;J++)I=new n.Path.RoundRectangle({x:N,y:O+(J+1)*x},{x:N+y,y:O+J*x},3),G.addChild(I);var Q=I.segments[2].point;D?this.bricksHeight=[{height:F,tipPoint:Q,plankPoint:{x:C,y:z}},{height:E,tipPoint:P,plankPoint:{x:B,y:A}}]:this.bricksHeight=[{height:E,tipPoint:P,plankPoint:{x:B,y:A}},{height:F,tipPoint:Q,plankPoint:{x:C,y:z}}],G.strokeColor="#222",G.strokeWidth=2,G.fillColor="#FFF",this.rodneyBrickGroup=G}return j=new n.Group([h,k,l])},_drawBricks:function(a,b,c){var d,e,f,g,h,i=this.scope,j=this.modelPath;return"diagonal"===c?(d=a+j.diagonalBrickWidth,e=b+j.diagonalBrickHeight):(d=a+j.horizontalBrickWidth,e=b+j.horizontalBrickHeight),f=new i.Rectangle({x:a,y:b},{x:d,y:e}),g=new i.Size(j.brickCornerRadius,j.brickCornerRadius),h=new i.Path.RoundRectangle(f,g),h.fillColor=new i.Color(1,1,1),h.strokeWidth=2,h.strokeColor=j.color.brickColor,h},_breakPlank:function(a,b){var c=this.$(".child-cont"),d={},e=this.modelPath,f=c.position(),g=c.width(),h=c.height();switch(d.x=f.left+g/2,d.y=f.top+h/2,a){case"horizontal":var i=null,j=null,k=e.horizontalBarAnimData,l=1,m=this,n=!1,o=!0,p=null,q=null,r=null,m=this,s=k.minDistanceForSlide,t=k.chopOffset;b.x>d.x?q=this.horizontalChopImgs.chopLeft:(t=-t,q=this.horizontalChopImgs.chopRight),Math.abs(b.x-t-g/2-f.left)<s?(o=!1,i=this._horizontalImgSeq.slice(0)):i=this._horizontalImgSeqWithSlide.slice(0),r=i.length,p=i.indexOf("direction-place-holder"),-1!==p&&(i[p]={imgPath:q,isStrikeFrame:!0}),c.css("background-image",'url("'+this.filePath.getImagePath("horizontal-sequence-sprite")+'")'),j=setInterval(function(){c.css({"background-position":i[l].imgPath}),o&&i[l].toFade&&c.fadeOut(k.fadeDuration,function(){n?(c.css("left",d.x-g/2).fadeIn(0),n=!1):(c.css("left",b.x-t-g/2).fadeIn(0),n=!0)}),i[l].isStrikeFrame&&m.trigger("plank-hit"),l++,l===r&&(clearInterval(j),m.trigger("breaking-animation-ends"))},k.frameDuration);break;case"vertical":var j,p,u,i=this._verticalKickWithJump.slice(0),l=1,q=null,v=e.verticalAnimData,m=this,w=this._kickImages,x=!1,y=f.top+v.rodneyEffectiveHeight-b.y,z=!1,A=!1,B=0;y<v.kickLowMax?(q={imgPath:w.kickLow,isStrikeFrame:!0},y-v.kickLowMin>0&&(A=!0,B=y-v.kickLowMin)):y>=v.kickLowMax&&y<=v.kickMidMax?q={imgPath:w.kickMid,isStrikeFrame:!0}:y>v.kickMidMax&&y<v.kickMidWithJumpMax?(q={imgPath:w.kickMid,isStrikeFrame:!0},y-v.kickMidMax>0&&(A=!0,B=y-v.kickMidMax)):(q={imgPath:w.kickHigh1},x=!0,y-v.kickMidWithJumpMax>2&&(A=!0,B=y-v.kickMidWithJumpMax)),i=A?this._verticalKickWithJump.slice(0):this._verticalKick.slice(0),p=i.indexOf("kick-type"),-1!==p&&(i[p]=q),x&&i.splice(p+1,0,{imgPath:w.kickHigh2,isStrikeFrame:!0}),u=i.length,j=setInterval(function(){c.css("background-position",i[l].imgPath),i[l].toMove&&(z?(c.css("top","+="+B),z=!1):(c.css("top","-="+B),z=!0)),i[l].isStrikeFrame&&m.trigger("plank-hit"),l++,l===u&&(clearInterval(j),m.trigger("breaking-animation-ends"))},v.frameDuration);break;case"diagonal":var j,p,C,i=this._diagonalImgs.slice(0),l=1,n=!1,r=i.length,D=!1,m=this,m=this,E=f.top-(b.y-224),F=this.chosenSet.get("coordinates");F.startPoint[1]<F.endPoint[1]?(q="0px -314px",C=b.x-230-f.left):(q="0px -628px",C=b.x-61-f.left),p=i.indexOf("direction-place-holder"),-1!==p&&(i[p]={imgPath:q,isStrikeFrame:!0}),j=setInterval(function(){c.css("background-position",i[l].imgPath),i[l].toFade&&c.fadeOut(200,function(){n?(c.css("left","-="+C).fadeIn(0),n=!1):(c.css("left","+="+C).fadeIn(0),n=!0)}),i[l].toJump&&(D?(c.css("top","+="+E),D=!1):(c.css("top","-="+E),D=!0)),i[l].isStrikeFrame&&m.trigger("plank-hit"),l++,l===r&&(clearInterval(j),m.trigger("breaking-animation-ends"))},400)}},_setBrokenPlankGroup:function(){var a=null,b=null,c=this.scope,d=this.diagonalPlankBase64,e=null;a=new c.Path.Rectangle({from:[0,0],to:[1,1],position:[0,0]}),e=new c.Raster({source:d,position:c.view.center}),b=new c.Path.Rectangle({from:[0,0],to:[1,1],position:[0,0],strokeWidth:1,strokeColor:"black"}),this.rightBrokenRasterGroup=new c.Group(a,e,b),this.rightBrokenRasterGroup.clipped=!0,a=new c.Path.Rectangle({from:[0,0],to:[1,1],position:[0,0]}),e=new c.Raster({source:d,position:c.view.center}),b=new c.Path.Rectangle({from:[0,0],to:[1,1],position:[0,0],strokeWidth:1,strokeColor:"black"}),this.leftBrokenRasterGroup=new c.Group(a,e,b),this.leftBrokenRasterGroup.clipped=!0},_drawDiagonalHorizontalBrokenPlanks:function(a,b,c){var d=this,e=d.model,f=this.modelPath,g=f.plankWidth+2,h=(this.rightBrokenRasterGroup,this.leftBrokenRasterGroup,f.diagonalBrickWidth),i=this.rodneyBrickGroup,j=i.children,k=null,l=d._getPixelValues(a),m=(l.x,l.y,{}),n=null,o=null,p=[],q=[],r=null,s=null,t=d._getPixelValues(b),u=(t.x,t.y,{}),v=null,w=null,x=d._getPixelValues(c),y=e.getDistance(t,t),z=null,A=null,B=null,C=null,D=null,E=null,F=null,G=null,H=null,I=0,J=0,K=null,L=d.rightBrokenRasterGroup.children[0],M=d.rightBrokenRasterGroup.children[2],N=d.leftBrokenRasterGroup.children[0],O=d.leftBrokenRasterGroup.children[2],P=null;for(r=j[0],p.push(r),P=1;P<j.length;P++)r.bounds.x===j[P].bounds.x?p.push(j[P]):q.push(j[P]);for(r.bounds.x>q[0].bounds.x?(k=q,s=p):(k=p,s=q),K=k[0].bounds,m.x=K.x+h,m.y=K.y,I=K.height,P=1;P<k.length;P++)K=k[P].bounds,I+=K.height,K.y<m.y&&(m.y=K.y);for(K=s[0].bounds,u.x=K.x,u.y=K.y,J=K.height,P=1;P<s.length;P++)K=s[P].bounds,J+=K.height,K.y<u.y&&(u.y=K.y);v=u.x,w=u.y,n=m.x,o=m.y,z=e.getDistance(l,x),A=e.getDistance(t,x),B=z-h,C=A-h,D=z-B,E=A-C,d._setClippedPathPosition(d.leftBrokenRasterGroup,[n-h,o-g],[z,g]),d._setClippedPathPosition(d.rightBrokenRasterGroup,[v-A+h,w-g],[A,g]),z>=I?(F=180*Math.asin(I/B)/Math.PI,isNaN(F)&&(G=I-B+12,N.translate(G,0),O.translate(G,0),F=180*Math.asin(I/(G+B))/Math.PI),N.rotate(F,m),O.rotate(F,m)):(F=this._returnRotatingAngleForSmallPlank(y,z),H=I-Math.sin(F*Math.PI/180)*z,N.translate(h,H).rotate(F,[m.x,m.y+H]),O.translate(h,H).rotate(F,[m.x,m.y+H])),A>=J?(F=180*Math.asin(J/C)/Math.PI,isNaN(F)&&(G=J-C+12,L.translate(-G,0),M.translate(-G,0),F=180*Math.asin(J/(G+C))/Math.PI),L.rotate(-F,u),M.rotate(-F,u)):(F=this._returnRotatingAngleForSmallPlank(y,A),H=J-Math.sin(F*Math.PI/180)*A,L.translate(-h,H).rotate(-F,[u.x,u.y+H]),M.translate(-h,H).rotate(-F,[u.x,u.y+H]))},_drawVerticalBrokePlanks:function(a,b,c){var d=this,e=(d.model,this.modelPath),f=null,g=null,h=null,i=null,j=null,k=null,l=e.plankWidth,m=d.leftBrokenRasterGroup.children[0],n=d.leftBrokenRasterGroup.children[2],o=42,p=null,q=null,r=null,s=5;k=i=d._getPixelValues(b),j=d._getPixelValues(c),h=d._getPixelValues(a),g=i.y-j.y,f=j.y-h.y,d._setClippedPathPosition(d.rightBrokenRasterGroup,[i.x,i.y],[g,l],!0),d._setClippedPathPosition(d.leftBrokenRasterGroup,[i.x,i.y],[f,l],!0),q=g-o,0>=f-o&&(q=q+o-4,o=0),r=Math.sqrt(Math.pow(f-o,2)+Math.pow(l,2)),m.translate(-q,0),n.translate(-q,0),p=180*Math.asin(l/r)/Math.PI,isNaN(p)?(m.translate(-o+s,0),n.translate(-o+s,0),p=180*Math.asin(l/(f+s))/Math.PI,m.rotate(-p,[i.x-q-2*f+s,i.y]),n.rotate(-p,[i.x-q-2*f+s,i.y])):(m.rotate(-p,[i.x-q-f,i.y]),n.rotate(-p,[i.x-q-f,i.y]))},_setClippedPathPosition:function(a,b,c,d){var e=a.children[0],f=a.children[2],d=d||!1;e.scale(c),f.scale([c[0]-2,c[1]-2]),d?(e.position=[b[0]-c[0]/2,b[1]-c[1]/2],f.position=[b[0]-c[0]/2,b[1]-c[1]/2]):(e.position=[b[0]+c[0]/2,b[1]+c[1]/2],f.position=[b[0]+c[0]/2,b[1]+c[1]/2])},_resetClippedPathPosition:function(){null!==this.rightBrokenRasterGroup&&(this.rightBrokenRasterGroup.remove(),this.rightBrokenRasterGroup=null),null!==this.leftBrokenRasterGroup&&(this.leftBrokenRasterGroup.remove(),this.leftBrokenRasterGroup=null)},_returnRotatingAngleForSmallPlank:function(a,b){var c=this.modelPath,d=c.rotationStartAngle,e=c.rotationAngleDecerementor;return b>=4*a/10?d:b>=3.5*a/10?d-e:b>=3*a/10?d-2*e:b>=2.5*a/10?d-3*e:b>=2*a/10?d-4*e:b>=1.5*a/10?d-5*e:d-6*e},_fadeOutPlanks:function(){var a=this.modelPath,b=a.plankOpacity,c=a.plankOpacityDivident,d=a.plankFadeOutInterval,e=this,f=e.scope.view,g=setInterval(function(){b>.1?(e.rightBrokenRasterGroup.opacity=b,e.leftBrokenRasterGroup.opacity=b,b/=c,f.draw()):(clearInterval(g),e._resetClippedPathPosition(),f.draw())},d)},_storeImagePaths:function(){var a={startPos:"0px -942px",eyeBrowRaise:"0px -1256px",chopRight:"0px -314px",chopLeft:"0px 0px",slidingImg:"0px -628px"};this._horizontalImgSeq=[{imgPath:a.startPos},{imgPath:a.eyeBrowRaise},{imgPath:a.startPos},"direction-place-holder",{imgPath:a.startPos}],this._horizontalImgSeqWithSlide=[{imgPath:a.startPos},{imgPath:a.eyeBrowRaise},{imgPath:a.startPos},{imgPath:a.slidingImg,toFade:!0},{imgPath:a.startPos},"direction-place-holder",{imgPath:a.startPos},{imgPath:a.slidingImg,toFade:!0},{imgPath:a.startPos}],this.horizontalChopImgs=a;var b={kickLow:"-341px -628px",kickMid:"-341px -942px",kickHigh1:"0px 0px",kickHigh2:"0px -314px",kickIntermediatePos:"0 -628px",kickInitialPos:"0px -942px",kickJumpCrouch:"0px -1256px"};this._verticalKick=[{imgPath:b.kickInitialPos},{imgPath:b.kickIntermediatePos},"kick-type",{imgPath:b.kickInitialPos}],this._verticalKickWithJump=[{imgPath:b.kickInitialPos},{imgPath:b.kickJumpCrouch},{imgPath:b.kickIntermediatePos,toMove:!0},"kick-type",{imgPath:b.kickJumpCrouch,toMove:!0},{imgPath:b.kickInitialPos}],this._kickImages=b,this._headScratchAnim=[{imgPath:"0px -1884px"},{imgPath:"-341px 0px"},{imgPath:"0px -1884px"},{imgPath:"0 -1570px"},"last-frame"],this._diagonalImgs=[{imgPath:"0px -942px"},{imgPath:"0px -1256px"},{imgPath:"0px -942px"},{imgPath:"-341px -628px",toFade:!0},{imgPath:"0px -942px"},{imgPath:"0px 0px"},{imgPath:"0px -942px",toJump:!0},"direction-place-holder",{imgPath:"0px 0px",toJump:!0},{imgPath:"0px -942px"},{imgPath:"-341px -628px",toFade:!0},{imgPath:"0px -942px"}],this._positiveFeedback="-341px -315px",this._negativeFeedback="0px -1571px"},_changeInstructionText:function(a,b,c){if(this.directionTextView){var d,e,f=c[0],g=this,h=c[1];switch(a){case"trophy-stand":b?(d=g.getMessage("instruction-text",1),e=g.getAccMessage("instruction-text",1),g.directionTextView.changeDirectionText(d,!1,e)):(d=g.getMessage("instruction-text",0,[f,h,h,f]),e=g.getAccMessage("instruction-text",0,[f,h,h,f]),g.directionTextView.changeDirectionText(d,!1,e));break;case"bag-stand":b?(d=g.getMessage("instruction-text",3),e=g.getAccMessage("instruction-text",3),g.directionTextView.changeDirectionText(d,!1,e)):(d=g.getMessage("instruction-text",2,[f,h,h,f]),e=g.getAccMessage("instruction-text",2,[f,h,h,f]),g.directionTextView.changeDirectionText(d,!1,e));break;case"book-shelf":b?(d=g.getMessage("instruction-text",5),e=g.getAccMessage("instruction-text",5),g.directionTextView.changeDirectionText(d,!1,e)):(d=g.getMessage("instruction-text",4,[f,h,h,f]),e=g.getAccMessage("instruction-text",4,[f,h,h,f]),g.directionTextView.changeDirectionText(d,!1,e))}}},_enableButton:function(b){"disabled"===b.getButtonState()&&b.setButtonState(a.global.Theme2.Button.BUTTON_STATE_ACTIVE)},_disableButton:function(b){b.setButtonState(a.global.Theme2.Button.BUTTON_STATE_DISABLED)},_disableState:function(){var a=this;a.kickState=this.kickButtonView.getButtonState(),a.chopState=this.chopButtonView.getButtonState(),a.player.enableAllHeaderButtons(!1),a._disableButton(a.tryAnotherButtonview),a.leftInputBoxView.disableInputBox(),a.rightInputBoxView.disableInputBox(),a._disableButton(a.kickButtonView),a._disableButton(a.chopButtonView)},_enableState:function(){var a=this;a.player.enableAllHeaderButtons(!0),a._enableButton(a.tryAnotherButtonview),a.leftInputBoxView.enableInputBox(),a.rightInputBoxView.enableInputBox(),"active"===a.kickState&&a._enableButton(a.kickButtonView),"active"===a.chopState&&a._enableButton(a.chopButtonView)}})}(window.MathInteractives),function(a){"use strict";a.Common.Interactivities.LineStretcher.Models.Line=a.Common.Player.Models.BaseInteractive.extend({defaults:function(){return{allowOnlyMidpoint:!1,canvasHeight:599,canvasWidth:928}},ValidItems:null,ValidCombination:null,initialize:function(){this.ValidItems=new Backbone.Collection,this.ValidCombination=Backbone.Model.extend({}),this._computeValidItemsFromCoordinates(),this.ValidItems=this.ValidItems.shuffle()},_computeValidItemsFromCoordinates:function(){var b=a.Common.Interactivities.LineStretcher.Models.Line,c=b.coordinatesData.horizontal,d=b.coordinatesData.vertical,e=b.coordinatesData.diagonal,f=!1;this.get("allowOnlyMidpoint")&&(f=!0);for(var g=0;g<c.length;g++)this._calculateObjects(c[g],"horizontal",f);for(g=0;g<d.length;g++)this._calculateObjects(d[g],"vertical",f);for(var g=0;g<e.length;g++)this._calculateObjects(e[g],"diagonal",f)},_calculateObjects:function(b,c,d){var e,f,g,h,i,j,k=a.Common.Interactivities.LineStretcher.Models.Line,l=k.ratios,m=b.startPoint,n=b.endPoint,o=parseFloat(this.getDistance({x:m[0],y:m[1]},{x:n[0],y:n[1]}).toFixed(1));d&&(l=[[1,1]]);for(var p=0;p<l.length;p++)if(i=l[p],h=i[0]+i[1],j=o/h,("diagonal"===c||("horizontal"===c||"vertical"===c)&&10*j%1===0)&&(g=this._getSectionsLength(c,i,j),e=this._checkPossibleObjects(parseFloat(g.piece1.toFixed(1)),parseFloat(g.piece2.toFixed(1)),c),e.length>0)){var q={};if(q.type=c,q.plankLength=o,q.ratio=i,q.coordinates=b,q.answers=this._calculateCorrectAnswers(i,{x:m[0],y:m[1]},{x:n[0],y:n[1]}),!this._checkOneDecimalPrecision(q.answers))continue;i[0]===i[1]?q.isMidPoint=!0:q.isMidPoint=!1,q.segments=[parseFloat(g.piece1.toFixed(1)),parseFloat(g.piece2.toFixed(1))],q.possibleObjects=e,f=new this.ValidCombination(q),this.ValidItems.add(f)}},_calculateCorrectAnswers:function(a,b,c){var d=a[0],e=a[1],f=d+e,g=[],h=[],i=[];return b.x=10*b.x,b.y=10*b.y,c.x=10*c.x,c.y=10*c.y,h[0]=(d*c.x+e*b.x)/f/10,h[1]=(d*c.y+e*b.y)/f/10,e!==d?(i[0]=(d*b.x+e*c.x)/f/10,i[1]=(d*b.y+e*c.y)/f/10):i=h,g.push(h),g.push(i),g},_getSectionsLength:function(a,b,c){var d={},e=b[0],f=b[1];return d.piece1=e*(10*c)/10,d.piece2=f*(10*c)/10,d},_checkPossibleObjects:function(b,c,d){var e=b+c,f=a.Common.Interactivities.LineStretcher.Models.Line,g=[],h={trophyFlag:!1,bagFlag:!1,bookFlag:!1};return(1>=b||1>=c)&&"horizontal"===d?g:(e<=f.trophyValues.totalMax&&e>=f.trophyValues.totalMin&&b>=f.trophyValues.partMin&&b<=f.trophyValues.partMax&&c>=f.trophyValues.partMin&&c<=f.trophyValues.partMax&&(b>f.trophyValues.emptyZoneMin&&b<f.trophyValues.emptyZoneMax||c>f.trophyValues.emptyZoneMin&&c<f.trophyValues.emptyZoneMax||b>f.trophyValues.parts[1].maxLength&&c>f.trophyValues.parts[1].maxLength||(h.trophyFlag=!0,g.push(f.objectsToForm[1]))),e<=f.bagStandValues.totalMax&&e>=f.bagStandValues.totalMin&&b>=f.bagStandValues.partMin&&b<=f.bagStandValues.partMax&&c>=f.bagStandValues.partMin&&c<=f.bagStandValues.partMax&&(b>f.bagStandValues.emptyZoneMin&&b<f.bagStandValues.emptyZoneMax||c>f.bagStandValues.emptyZoneMin&&c<f.bagStandValues.emptyZoneMax||b>f.bagStandValues.parts[0].maxLength&&c>f.bagStandValues.parts[0].maxLength||(h.bagFlag=!0,g.push(f.objectsToForm[3]))),e<=f.bookShelfValues.totalMax&&e>=f.bookShelfValues.totalMin&&b>=f.bookShelfValues.partMin&&b<=f.bookShelfValues.partMax&&c>=f.bookShelfValues.partMin&&c<=f.bookShelfValues.partMax&&(b>f.bookShelfValues.emptyZoneMin&&b<f.bookShelfValues.emptyZoneMax||c>f.bookShelfValues.emptyZoneMin&&c<f.bookShelfValues.emptyZoneMax||b>f.bookShelfValues.parts[2].maxLength&&b<f.bookShelfValues.parts[1].minLength&&c>f.bookShelfValues.parts[2].maxLength&&c<f.bookShelfValues.parts[1].minLength||(c>5||4.5>c)&&(h.bookFlag=!0,g.push(f.objectsToForm[2]))),g)},_checkOneDecimalPrecision:function(a){var b=new RegExp("^[0-9]{0,2}\\.[0-9]?$|^[0-9]{0,2}$");return b.test(a[0][0])&&b.test(a[0][1])&&b.test(a[1][0])&&b.test(a[1][1])},getDistance:function(a,b){var c=a.x-b.x,d=a.y-b.y,e=Math.sqrt(c*c+d*d);return e},getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},liesOnPlank:function(a,b,c,d){var e,f,g,h,i=!1,j=!0;if(a.x>b.x?(e=b.x,f=a.x):(e=a.x,f=b.x),a.y>b.y?(g=b.y,h=a.y):(g=a.y,h=b.y),c.x>=e&&c.x<=f&&c.y>=g&&c.y<=h&&(i=!0),i&&"diagonal"===d){c.x=10*c.x,c.y=10*c.y,a.x=10*a.x,a.y=10*a.y,b.x=10*b.x,b.y=10*b.y;var k=(c.y-a.y)/(c.x-a.x),l=(b.y-c.y)/(b.x-c.x);if(Math.abs(k-l)>.07)i=!1;else{var m=this.getDistance(c,a),n=this.getDistance(c,b);(.7>m/10||.7>n/10)&&(j=!1)}}return{liesOnPlank:i,isAllowed:j}},getSectionLengths:function(a,b,c){var d=(parseFloat(this.getDistance(a,b).toFixed(4)),parseFloat(this.getDistance(a,c).toFixed(4))),e=parseFloat(this.getDistance(c,b).toFixed(4));return[d,e]},getLengthsRatio:function(a,b){var c=function d(a,b){return b?d(b,a%b):a};return c=c(a,b),[a/c,b/c]}},{color:{white:"#ffffff",black:"#000000",inputBoxBorderColor:"#888888",plankBorder:"#624A1D",axis:"#2d2d2d",answer:"#ff000c",plankEndpoint:"#624A1D",red:"#ff000c",green:"#248000",feedBackLine:"#624a1d",brickColor:"3e3e3e"},Points:{xAxisStartPoints:[40,587],xAxisEndPoints:[886,587],yAxisStartPoints:[42,587],yAxisEndPoints:[42,124],xAxisCenterPoints:[464,587],yAxisCenterPoints:[46,331],xAxisArrowCenterPoints:[892,587],yAxisArrowCenterPoints:[42,119],axisTriangleHeight:12,axisTriangleWidth:10},strokeWidth:{axisStrokeWidth:4,displayAnswerStrokeWidth:2},ratios:[[1,1],[1,2],[1,3],[2,3],[1,4],[1,5],[3,5],[4,5],[1,8],[7,8],[7,9],[3,7]],objectsToForm:{1:"trophy-stand",2:"book-shelf",3:"bag-stand"},validDataSet:[],coordinatesData:{horizontal:[{startPoint:[4,5],endPoint:[10,5]},{startPoint:[3,6],endPoint:[10,6]},{startPoint:[3,5],endPoint:[11,5]},{startPoint:[2,6],endPoint:[11,6]},{startPoint:[5,5],endPoint:[9,5]}],vertical:[{startPoint:[10,2],endPoint:[10,9]},{startPoint:[11,2],endPoint:[11,8]},{startPoint:[10,4],endPoint:[10,8]},{startPoint:[9,3],endPoint:[9,9]},{startPoint:[8,2],endPoint:[8,6]}],diagonal:[{startPoint:[3,4.5],endPoint:[7,6.5]},{startPoint:[5,5.5],endPoint:[9,6.5]},{startPoint:[5,4],endPoint:[9.5,5.5]},{startPoint:[4,5],endPoint:[9,6]},{startPoint:[4,4.5],endPoint:[10,6.5]},{startPoint:[4,4.5],endPoint:[10,6]},{startPoint:[3,6.5],endPoint:[7,4.5]},{startPoint:[5,6.5],endPoint:[9,5.5]},{startPoint:[5,5.5],endPoint:[9.5,4]},{startPoint:[4,6],endPoint:[9,5]},{startPoint:[4,6.5],endPoint:[10,4.5]},{startPoint:[4,6],endPoint:[10,4.5]}]},trophyValues:{totalMin:1,totalMax:6,partMin:.5,partMax:4,emptyZoneMin:2,emptyZoneMax:2.5,parts:[{count:1,minLength:2.5,maxLength:4},{count:2,minLength:.5,maxLength:2}]},bagStandValues:{totalMin:5,totalMax:11.5,partMin:2.5,partMax:7.5,emptyZoneMin:4,emptyZoneMax:5,parts:[{count:2,minLength:2.5,maxLength:4},{count:1,minLength:5,maxLength:7.5}]},bookShelfValues:{totalMin:7,totalMax:15,partMin:3.5,partMax:7.5,emptyZoneMin:4,emptyZoneMax:4.5,parts:[{count:1,minLength:4.5,maxLength:6},{count:2,minLength:5,maxLength:7.5},{count:2,minLength:3.5,maxLength:4}]},punchingBagCoOrdinates:[14,42],xAxisOffset:1,yAxisOffset:14,tickLength:25,plankOpacity:1,plankOpacityDivident:2,plankFadeOutInterval:50,rotationStartAngle:80,rotationAngleDecerementor:4,trophyCoOrdinates:[27,55],plankWidth:16,gridSize:42,brickCornerRadius:3,horizontalBrickHeight:22.25,horizontalBrickWidth:42,diagonalBrickHeight:21,diagonalBrickWidth:42,verticalDirection:"vertical",horizontalDirection:"horizontal",containerHeightOffset:96,containerTopOffset:70,horizontalRodneyTopOffset:203,rodneyImageHeight:300,rodneyImageWidth:291,objectContainerXMidPoint:736,horizontalBrickCountEachSide:4,diagonalFixedBricks:3,horizontalBarAnimData:{chopOffset:86,frameDuration:300,minDistanceForSlide:1,fadeDuration:300},verticalAnimData:{rodneyEffectiveHeight:300,kickLowMin:14,kickLowMax:194,kickMidMax:204,kickMidWithJumpMax:248,frameDuration:300}})}(window.MathInteractives),function(){var a=Handlebars.template,b=MathInteractives.Common.Interactivities.LineStretcher.templates=MathInteractives.Common.Interactivities.LineStretcher.templates||{};b.explore=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff<div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'explore-tab" class="explore">\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'child-cont" class="child-cont"></div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'canvas-container" class="canvas-container"></div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'canvas-activity-area" class="canvas-activity-area"></div>\r\n\r\n    <!--<div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'instruction-container" class="instruction-container">\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'instruction-text" class="instruction-text"></div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'try-another-button" class="try-another-button"></div>\r\n    </div>-->\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'explorer-direction-text" class="explorer-direction-text"></div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'explore-tab-coordinates" class="explore-tab-coordinates">\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'start-coordinate" class="start-coordinate"></div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'end-coordinate" class="end-coordinate"></div>\r\n    </div>\r\n\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'axis-label" class="axis-label">\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'x-axis-label" class="x-axis-label"></div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'y-axis-label" class="y-axis-label"></div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'origin-label" class="origin-label">0</div>\r\n    </div>\r\n\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'input-box-container" class="input-box-container">\r\n        <span id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'left-bracket" class="left-bracket">(</span>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'x-input-box" class="x-input-box"></div>\r\n        <span id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'comma" class="comma">,</span>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},
data:e}):g),h+=j(f)+'y-input-box" class="y-input-box"></div>\r\n        <span id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'right-bracket" class="right-bracket">)</span>\r\n    </div>\r\n\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'chop-button" class="chop-button"></div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'see-math-button" class="see-math-button"></div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'kick-button" class="kick-button"></div>  \r\n\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'book-container-1" class ="book-container-1"></div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'book-container-2" class ="book-container-2"></div>\r\n\r\n    <div id ="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'object-container" class="object-container">\r\n        <div id ="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'object-name-text" class ="object-name-text"></div>\r\n    </div>\r\n\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'feedback-screen" class="feedback-screen">\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'your-answer-container" class="your-answer-container">\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'your-answer-bullet" class="your-answer-bullet"></div>\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'your-answer" class="your-answer"> </div>\r\n        </div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'feedback-answers" class="feedback-answers">\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'plank-left-cordinate" class="plank-left-cordinate"></div>\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'plank-right-cordinate" class="plank-right-cordinate"></div>\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'feedback-ratio-div" class="feedback-ratio-div"></div>\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'answerFt1" class="answerFt1"></div>\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'answerFt2" class="answerFt2"></div>\r\n        </div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'feedback-instruction-try-again" class="feedback-instruction-try-again">\r\n            <div  id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'try-again" class="try-again"></div>\r\n            <div  id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'feedback-instruction-heading-text" class="feedback-instruction-heading-text"></div>\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'feedback-instruction-text" class="feedback-instruction-text"></div>\r\n        </div>\r\n    </div>   \r\n\r\n</div>'})}();