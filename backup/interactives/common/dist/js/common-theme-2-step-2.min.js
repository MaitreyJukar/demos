!function(){"use strict";MathInteractives.Common.Components.Theme2.Models.DragDropTile=Backbone.Model.extend({defaults:{tileData:null,footprintData:null,castorData:null,dropSlotData:null,dropSlotModelData:null,dragModelData:null}},{})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.DragDropTile=MathInteractives.Common.Player.Views.Base.extend({idPrefix:null,manager:null,player:null,filePath:null,dragDropSlotModelArr:[],dragButtonViews:[],dragTilesModel:[],dragModelArr:[],shadow:5,initialize:function(){this.filePath=this.model.get("filePath"),this.idPrefix=this.model.get("idPrefix"),this.manager=this.model.get("manager"),this.player=this.model.get("player"),this.dragDropSlotModelArr=[],this.dragButtonViews=[],this.dragTilesModel=[],this.dragModelArr=[],this._render()},_render:function(){var a;null!=this.model.get("dropSlotData")&&(a=this._createDroppableSlot()),null!=this.model.get("tileData")&&this._createDraggableTile(a),null!=this.model.get("footprintData")&&this._createFootprint(),null!=this.model.get("castorData")&&this._createCastorBin()},_createDroppableSlot:function(){var a,b,c=this.model.get("dropSlotData").length,d=!1,e=this,f=MathInteractives.Common.Components.Models.DragDrop,g=[];for(a=0;c>a;a++)MathInteractives.global.Theme2.DropSlot.generateDropSlot({player:this.player,manager:this.manager,filePath:this.filePath,idPrefix:this.idPrefix,data:this.model.get("dropSlotData")[a]}),this.model.get("dropSlotData")[a].preventDefaultFunctionality&&(d=this.model.get("dropSlotData")[a].preventDefaultFunctionality),(null===this.model.get("dropSlotModelData")||"undefined"==typeof this.model.get("dropSlotModelData"))&&(b=f.createDragDropModel({type:"drop",elements:[this.idPrefix+this.model.get("dropSlotData")[a].containerId],idPrefix:this.idPrefix,preventDefaultFunctionality:d,options:this.model.get("dropSlotData")[a].options})),g.push(this.idPrefix+this.model.get("dropSlotData")[a].containerId),e.dragDropSlotModelArr[a]=b;if(null!==this.model.get("dropSlotModelData")){var h=this.model.get("dropSlotModelData");this.dropSlotModel=f.createDragDropModel({type:h.type,elements:h.elements,idPrefix:h.idPrefix,preventDefaultFunctionality:h.preventDefaultFunctionality,options:h.options})}return g},getDropSlotModelArr:function(){return this.dragDropSlotModelArr},addOptionsForDraggable:function(a){for(var b=this.dragModelArr.length,c=0;b>c;c++)this.dragModelArr[c].addOptions(a)},addOptionsForDroppable:function(a){for(var b=this.dragDropSlotModelArr.length,c=0;b>c;c++)this.dragDropSlotModelArr[c].addOptions(a)},getDragModelArr:function(){return this.dragModelArr},_createDraggableTile:function(a){var b,c=this.model.get("tileData").length,d=!1,e="clone",f={},g=MathInteractives.Common.Components.Models.DragDrop;for(b=0;c>b;b++)this.dragButtonViews[b]=MathInteractives.global.Theme2.Button.generateButton({player:this.player,manager:this.manager,path:this.filePath,idPrefix:this.idPrefix,data:{id:this.model.get("tileData")[b].id,type:this.model.get("tileData")[b].type,height:this.model.get("tileData")[b].height,width:this.model.get("tileData")[b].width,colorType:this.model.get("tileData")[b].colorType,boxShadowColor:this.model.get("tileData")[b].boxShadowColor,text:this.model.get("tileData")[b].text,imagePath:this.model.get("tileData")[b].imagePath}}),this.model.get("tileData")[b].preventDefaultFunctionality&&(d=this.model.get("tileData")[b].preventDefaultFunctionality),this.model.get("tileData")[b].options&&(f=this.model.get("tileData")[b].options),this.model.get("tileData")[b].helper&&(e=this.model.get("tileData")[b].helper,f.helper=e),f.containment=this.model.get("tileData")[b].containment,(null===this.model.get("dragModelData")||"undefined"==typeof this.model.get("dragModelData"))&&(this.dragTilesModel[b]=g.createDragDropModel({type:"drag",elements:[this.model.get("tileData")[b].id],dropSlots:a,idPrefix:this.idPrefix,player:this.player,manager:this.manager,contextMenuScreenId:this.model.get("contextMenuScreenId"),preventDefaultFunctionality:d,options:f})),this.dragModelArr[b]=this.dragTilesModel[b],null!==this.model.get("tileData")[b].tooltipData&&"undefined"!=typeof this.model.get("tileData")[b].tooltipData&&this._generateTooltipForDraggable(b);if(null!==this.model.get("dragModelData")){var h=this.model.get("dragModelData");this.dragModel=g.createDragDropModel({type:h.type,elements:h.elements,dropSlots:h.dropSlots,idPrefix:h.idPrefix,player:this.player,manager:this.manager,contextMenuScreenId:this.model.get("contextMenuScreenId"),preventDefaultFunctionality:h.preventDefaultFunctionality,options:h.options})}},_generateTooltipForDraggable:function(a){var b={},c=this.model.get("tileData")[a],d=c.tooltipData;$.extend(b,d),b.idPrefix=this.model.get("idPrefix"),b.manager=this.model.get("manager"),b._player=this.model.get("player"),b.path=this.model.get("filePath"),b.id=c.id+"-tooltip-container",b.elementEl=c.id;MathInteractives.global.Theme2.Tooltip.generateTooltip(b)},editContextMenu:function(a,b){var c,d=this.model.get("tileData").length;for(c=0;d>c;c++)(null===this.model.get("dragModelData")||"undefined"==typeof this.model.get("dragModelData"))&&this.dragTilesModel[c].editContextMenu(a,b);null!==this.model.get("dragModelData")&&this.dragModel.editContextMenu(a,b)},_createFootprint:function(){var a,b,c=this.model.get("footprintData").length;for(a=0;c>a;a++)b=this.model.get("footprintData")[a].text?this.model.get("footprintData")[a].text:null,MathInteractives.global.Theme2.Footprint.generateFootprint({player:this.player,manager:this.manager,filePath:this.filePath,idPrefix:this.idPrefix,data:this.model.get("footprintData")[a],text:b})},disableDraggable:function(a){if(void 0!==a)for(var b=0;b<this.dragButtonViews.length;b++)this.dragButtonViews[b].model.get("id")===a&&this.dragTilesModel[b].disable();else for(var b=0;b<this.dragButtonViews.length;b++)this.dragTilesModel[b].disable()},enableDraggables:function(a){if(void 0!==a)for(var b=0;b<this.dragButtonViews.length;b++)this.dragButtonViews[b].model.get("id")===a&&this.dragTilesModel[b].enable();else for(var b=0;b<this.dragButtonViews.length;b++)this.dragTilesModel[b].enable()},disableTile:function(a){this.dragModel.disableIndividialElement(a)},enableTile:function(a){this.dragModel.enableIndividialElement(a)},disableAllTiles:function(){this.dragModel.disable()},enableAllTiles:function(){this.dragModel.enable()},setButtonDisabled:function(a,b,c){var d,e,f;for(d=0;d<this.dragButtonViews.length;d++)this.dragButtonViews[d].el.id===a&&(e=this.dragButtonViews[d].$el,c&&(e=c),f={$dragTile:e,isCenterAlign:b,shadow:this.shadow},this.dragButtonViews[d].setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED,f))},setAllButtonsDisabled:function(a){for(var b=0;b<this.dragButtonViews.length;b++)a?(a.$dragTile=this.dragButtonViews[b].$el,this.dragButtonViews[b].setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED,a)):this.dragButtonViews[b].setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED)},setButtonEnabled:function(a,b){var c,d,e;for(c=0;c<this.dragButtonViews.length;c++)this.dragButtonViews[c].el.id===a&&(d=this.dragButtonViews[c].$el,b&&(d=b),e={$dragTile:d,isCenterAlign:!0},this.dragButtonViews[c].setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE,e))},setAllButtonsEnabled:function(a){if(a)var b={$dragTile:null,isCenterAlign:!0};for(var c=0;c<this.dragButtonViews.length;c++)a?(b.$dragTile=this.dragButtonViews[c].$el,this.dragButtonViews[c].setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE,b)):this.dragButtonViews[c].setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE)},_createCastorBin:function(){var a,b=this.model.get("castorData").length;for(a=0;b>a;a++)MathInteractives.global.Theme2.BinCastor.generateBinCastor({player:this.player,manager:this.manager,filePath:this.filePath,idPrefix:this.idPrefix,data:this.model.get("castorData")[a]})}},{generateDragDropTile:function(a){var b,c;return b=new MathInteractives.Common.Components.Theme2.Models.DragDropTile(a),c=new MathInteractives.Common.Components.Theme2.Views.DragDropTile({model:b})}}),MathInteractives.global.Theme2.DragDropTile=MathInteractives.Common.Components.Theme2.Views.DragDropTile}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.BinCastor=Backbone.Model.extend({defaults:{height:null,width:null,color:null,imageId:null,borderColor:null},initialize:function(){var a=MathInteractives.Common.Components.Theme2.Models.BinCastor;"undefined"!=typeof this.get("data").height?this.set("height",this.get("data").height):this.set("height",a.HEIGHT),"undefined"!=typeof this.get("data").width?this.set("width",this.get("data").width):this.set("width",a.WIDTH),"undefined"!=typeof this.get("data").color?this.set("color",this.get("data").color):this.set("color",a.BG_COLOR),"undefined"!=typeof this.get("data").imageId&&this.set("imageId",this.get("data").imageId),"undefined"!=typeof this.get("data").borderColor?this.set("borderColor",this.get("data").borderColor):this.set("borderColor",a.BORDER_COLOR)}},{HEIGHT:50,WIDTH:200,BG_COLOR:"#FFFFFF",BORDER_COLOR:"#aaa"})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.BinCastor=MathInteractives.Common.Player.Views.Base.extend({idPrefix:null,manager:null,player:null,filePath:null,initialize:function(){this.filePath=this.model.get("filePath"),this.idPrefix=this.model.get("idPrefix"),this.manager=this.model.get("manager"),this.player=this.model.get("player"),this._render()},_render:function(){var a=this.$el;a.addClass("bin-castor"),a.css({height:this.model.get("height"),"min-width":this.model.get("width")}),null===this.model.get("imageId")?a.css({"background-color":this.model.get("color"),border:"2px solid"+this.model.get("borderColor")}):a.css({"background-image":'url("'+this.filePath.getImagePath(this.model.get("imageId"))+'")'})}},{generateBinCastor:function(a){var b,c,d;return d="#"+a.idPrefix+a.data.containerId,b=new MathInteractives.Common.Components.Theme2.Models.BinCastor(a),c=new MathInteractives.Common.Components.Theme2.Views.BinCastor({el:d,model:b})}}),MathInteractives.global.Theme2.BinCastor=MathInteractives.Common.Components.Theme2.Views.BinCastor}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.DropSlot=Backbone.Model.extend({defaults:{height:null,width:null,color:null,boxShadowColor:null,imageId:null,borderColor:null},initialize:function(){var a=MathInteractives.Common.Components.Theme2.Models.DropSlot;"undefined"!=typeof this.get("data").height?this.set("height",this.get("data").height):this.set("height",a.HEIGHT),"undefined"!=typeof this.get("data").width?this.set("width",this.get("data").width):this.set("width",a.WIDTH),"undefined"!=typeof this.get("data").color?this.set("color",this.get("data").color):this.set("color",a.BG_COLOR),"undefined"!=typeof this.get("data").boxShadowColor?this.set("boxShadowColor",this.get("data").boxShadowColor):this.set("boxShadowColor",a.BOX_SHADOW_COLOR),"undefined"!=typeof this.get("data").imageId&&this.set("imageId",this.get("data").imageId),"undefined"!=typeof this.get("data").borderColor?this.set("borderColor",this.get("data").borderColor):this.set("borderColor",a.BORDER_COLOR)}},{HEIGHT:44,WIDTH:44,BG_COLOR:"#FFFFFF",BORDER_COLOR:"#aaa",BOX_SHADOW_COLOR:"#aaa"})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.DropSlot=MathInteractives.Common.Player.Views.Base.extend({idPrefix:null,manager:null,player:null,filePath:null,initialize:function(){this.filePath=this.model.get("filePath"),this.idPrefix=this.model.get("idPrefix"),this.manager=this.model.get("manager"),this.player=this.model.get("player"),this._render()},_render:function(){var a=$("<div/>",{"class":"drop-slot"}).appendTo(this.$el),b=null;a.css({height:this.model.get("height"),width:this.model.get("width")}),b="none"===this.model.get("borderColor")?"none":"2px solid "+this.model.get("borderColor"),null===this.model.get("imageId")?a.css({"background-color":this.model.get("color"),border:b,"box-shadow":"inset 2px 2px 2px"+this.model.get("boxShadowColor")}):a.css({"background-image":'url("'+this.filePath.getImagePath(this.model.get("imageId"))+'")'}),this.$el.css({height:a.outerHeight(),width:a.outerWidth()})}},{generateDropSlot:function(a){var b,c,d;return d="#"+a.idPrefix+a.data.containerId,b=new MathInteractives.Common.Components.Theme2.Models.DropSlot(a),c=new MathInteractives.Common.Components.Theme2.Views.DropSlot({el:d,model:b})}}),MathInteractives.global.Theme2.DropSlot=MathInteractives.Common.Components.Theme2.Views.DropSlot}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.Footprint=Backbone.Model.extend({defaults:{height:null,width:null,color:null,boxShadowColor:null,imageId:null,borderColor:null,text:null},initialize:function(){var a=MathInteractives.Common.Components.Theme2.Models.Footprint;"undefined"!=typeof this.get("data").height?this.set("height",this.get("data").height):this.set("height",a.HEIGHT),"undefined"!=typeof this.get("data").width?this.set("width",this.get("data").width):this.set("width",a.WIDTH),"undefined"!=typeof this.get("data").color?this.set("color",this.get("data").color):this.set("color",a.BG_COLOR),"undefined"!=typeof this.get("data").boxShadowColor?this.set("boxShadowColor",this.get("data").boxShadowColor):this.set("boxShadowColor",a.BOX_SHADOW_COLOR),"undefined"!=typeof this.get("data").imageId&&this.set("imageId",this.get("data").imageId),"undefined"!=typeof this.get("data").borderColor?this.set("borderColor",this.get("data").borderColor):this.set("borderColor",a.BORDER_COLOR)}},{HEIGHT:48,WIDTH:48,BG_COLOR:"#BFBFBF",BORDER_COLOR:"#aaa",BOX_SHADOW_COLOR:"#aaa"})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.Footprint=MathInteractives.Common.Player.Views.Base.extend({idPrefix:null,manager:null,player:null,filePath:null,initialize:function(){this.filePath=this.model.get("filePath"),this.idPrefix=this.model.get("idPrefix"),this.manager=this.model.get("manager"),this.player=this.model.get("player"),this._render()},_render:function(){var a,b=this.$el;if(b.css({height:this.model.get("height"),width:this.model.get("width")}),b.addClass("border-radius"),null===this.model.get("imageId")?b.css({"background-color":this.model.get("color"),"box-shadow":"inset 4px 4px "+this.model.get("boxShadowColor")}):b.css({"background-image":'url("'+this.filePath.getImagePath(this.model.get("imageId"))+'")'}),null!==this.model.get("text")){var a=$("<div></div>");a.attr("id",this.$el.attr("id")+"-text").addClass(this.$el.attr("id")+"-text  text-div").html(this.model.get("text")),this.$el.addClass("display-property"),this.$el.append(a)}}},{generateFootprint:function(a){var b,c,d;return d="#"+a.idPrefix+a.data.containerId,b=new MathInteractives.Common.Components.Theme2.Models.Footprint(a),c=new MathInteractives.Common.Components.Theme2.Views.Footprint({el:d,model:b})}}),MathInteractives.global.Theme2.Footprint=MathInteractives.Common.Components.Theme2.Views.Footprint}(),function(a){"use strict";a.Common.Components.Theme2.Models.InputBox=Backbone.Model.extend({defaults:{maxCharLength:10,maxValue:null,previousValue:"",precision:2,defaultValue:null,keyCodeArray:[],regexString:null,unit:null,unitColor:null,unitElementPosition:null,allowNegative:!0,inputType:null,defaultTextOnEmptyInputBox:null,lastInputValue:null,customClass:null,style:null,width:null,defaultInput:null,bAllowQuotes:null,currentRegex:null,androidDevicePreviousValue:null},initialize:function(){this._setRegexForCurrentType()},getDefaultTextOnEmptyInputBox:function(){return this.get("defaultTextOnEmptyInputBox")},getPreviousValue:function(){return this.get("previousValue")},setPreviousValue:function(a){this.set("previousValue",a)},getLastInputValue:function(){return this.get("lastInputValue")},getWidth:function(){return this.get("width")},getMaxValue:function(){return this.get("maxValue")},setMaxValue:function(a){this.set("maxValue",a)},getDefaultInput:function(){return this.get("defaultInput")},setDefaultInput:function(a){this.set("defaultInput",a)},setLastInputValue:function(a){this.set("lastInputValue",a)},setWidth:function(a){this.set("width",a)},getHeight:function(){return this.get("height")},setHeight:function(a){this.set("height",a)},setDefaultTextOnEmptyInputBox:function(a){this.set("defaultTextOnEmptyInputBox",a)},setMaxCharLength:function(a){this.set("maxCharLength",a)},getMaxCharLength:function(){return this.get("maxCharLength")},getUnit:function(){return this.get("unit")},getUnitColor:function(){return this.get("unitColor")},setUnit:function(a){this.set("unit",a)},getUnitElementPosition:function(){return this.get("unitElementPosition")},setUnitElementPosition:function(a){this.set("unitElementPosition",a)},setUnitColor:function(a){this.set("unitColor",a)},setPrecision:function(a){this.set("precision",a)},getPrecision:function(){return this.get("precision")},setDefaultValue:function(a){this.set("defaultValue",a)},getDefaultValue:function(){return this.get("defaultValue")},setKeyCodeArray:function(a){this.set("keyCodeArray",a)},getKeyCodeArray:function(){return this.get("keyCodeArray")},setregexString:function(a){this.set("regexString",a)},getregexString:function(){return this.get("regexString")},getCustomClass:function(){return this.get("customClass")},setCustomClass:function(a){this.set("customClass",a)},getStyle:function(){return this.get("style")},setStyle:function(a){this.set("style",a)},getCurrentRegex:function(){return this.get("currentRegex")},setCurrentRegex:function(a){this.set("currentRegex",a)},getAndroidDevicePreviousValue:function(){return this.get("androidDevicePreviousValue")},setAndroidDevicePreviousValue:function(a){this.set("androidDevicePreviousValue",a)},_setRegexForCurrentType:function(){var b=this.get("inputType"),c=this.get("allowNegative"),d=null,e=this.get("precision"),f=this.get("maxCharLength"),g=a.global.Theme2.InputBox;switch(b){case g.INPUT_TYPE_INTEGER:d=c?new RegExp("^\\-?\\d{0,"+f+"}$"):new RegExp("^\\d{0,"+f+"}$");break;case g.INPUT_TYPE_FLOATING:d=c?new RegExp("^\\-?\\d{0,"+f+"}\\.\\d{0,"+e+"}$|^\\-?\\d{0,"+f+"}$"):new RegExp("^\\d{0,"+f+"}\\.\\d{0,"+e+"}$|^\\d{0,"+f+"}$");break;case g.INPUT_TYPE_ALPHANUMERIC:d=new RegExp("^[a-zA-Z0-9_]*$");break;case g.INPUT_TYPE_CUSTOM:d=this.get("regexString")}this.set("currentRegex",d)}})}(window.MathInteractives),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.InputBox=MathInteractives.Common.Player.Views.Base.extend({idPrefix:null,manager:null,filePath:null,player:null,inputEle:null,inputType:null,maxValue:null,precision:null,defaultValue:null,maxCharLength:null,keyCodeArray:null,regexString:null,allowNegative:null,resultantString:"",isValidInput:null,unit:null,unitColor:null,unitElementPosition:null,containerId:null,keyDownCase:!1,defaultTextOnEmptyInputBox:null,isMaxValueExceeded:!1,entryFieldText:null,width:null,_customClass:null,style:null,defaultInput:null,isTouchDevice:!1,staticDataHolder:null,initialize:function(){var a=MathInteractives.Common.Utilities.Models.BrowserCheck;this.isTouchDevice=a.isMobile,this.idPrefix=this.model.get("idPrefix"),this.manager=this.model.get("manager"),this.filePath=this.model.get("filePath"),this.player=this.model.get("player"),this.inputType=this.model.get("inputType"),this.maxValue=this.model.getMaxValue(),this.maxCharLength=this.model.get("maxCharLength"),this.precision=this.model.get("precision"),this.defaultValue=this.model.get("defaultValue"),this.keyCodeArray=this.model.get("keyCodeArray"),this.regex=this.model.get("regexString"),this.allowNegative=this.model.get("allowNegative"),this.regexString=this.model.get("regexString"),this.unit=this.model.get("unit"),this.unitColor=this.model.get("unitColor"),this.unitElementPosition=this.model.get("unitElementPosition"),this.containerId=this.model.get("containerId"),this.defaultTextOnEmptyInputBox=this.model.getDefaultTextOnEmptyInputBox(),this._customClass=this.model.getCustomClass(),this.style=this.model.getStyle("style"),this.width=this.model.getWidth("width"),this.height=this.model.getHeight("height"),this.defaultInput=this.model.getDefaultInput("defaultInput"),this.tabIndex=this.model.get("tabIndex"),this._addJqueryFunction(),this._addStringFunction(),this._render(),this._bindEvents(),this.staticDataHolder=MathInteractives.global.Theme2.InputBox},_render:function(){var a=MathInteractives.Common.Components.Theme2.Views.InputBox;this.unitElementPosition===a.UNIT_ELEMENT_POSITION_LEFT||this.unitElementPosition===a.UNIT_ELEMENT_POSITION_TOP?(null!==this.unit&&(this._createUnitElement(),null!==this.unitColor&&this._setUnitElementColor()),this._renderInputBox(),this.unitElementPosition===a.UNIT_ELEMENT_POSITION_LEFT&&this._changePaddingOfUnitElement()):this.unitElementPosition===a.UNIT_ELEMENT_POSITION_RIGHT||this.unitElementPosition===a.UNIT_ELEMENT_POSITION_BOTTOM?(this._renderInputBox(),null!==this.unit&&(this._createUnitElement(),null!==this.unitColor&&this._setUnitElementColor()),this.unitElementPosition===a.UNIT_ELEMENT_POSITION_RIGHT&&this._changePaddingOfUnitElement()):null===this.unitElementPosition&&(this._renderInputBox(),null!==this.unit&&(this._createUnitElement(),null!==this.unitColor&&this._setUnitElementColor()),this._changePaddingOfUnitElement()),null!==this.style&&this._applyStyle(),null!==this.width&&this._setWidth(),null!==this.height&&this._setHeight(),this._setEntryField(),this._createHackDivForInputBox()},_renderInputBox:function(){var a,b=this.containerId;a=$("<div></div>"),a.attr("id",b+"textbox"),a.addClass("textbox"),this.$el.append(a),this.inputEle=$("<input></input>"),this.inputEle.attr("id",b+"-input-box"),this.inputEle.attr("autocomplete","off"),this._addCustomClass(),this.inputEle.addClass("input-box-common-component"),this.inputEle.val(this.defaultValue),null!==this.defaultInput&&(this.inputEle.val(""),this.inputEle.val(this.defaultInput),this.resultantString=this.defaultInput.toString()),a.append(this.inputEle),"top"===this.unitElementPosition&&this.$el.css({width:this.$el.find("#"+this.containerId+"-input-box").outerWidth()})},_createHackDivForInputBox:function(){if(this.$(".textbox").css({height:this.$(".input-box-common-component").outerHeight()+"px",width:this.$(".input-box-common-component").outerWidth()+"px"}),this.tabIndex){this.loadScreen("input-box-acc-screen");var a={elementId:this.containerId.replace(this.idPrefix,"")+"textbox",tabIndex:this.tabIndex,acc:this.tabIndex?this.getAccMessage("input-box-acc-text",0):""};this.createAccDiv(a)}},_changePaddingOfUnitElement:function(){var a=MathInteractives.Common.Components.Theme2.Views.InputBox,b="#"+this.containerId+"-input-box",c=this.$el.find(b),d=this.$el.find(b).height(),e=c.css("padding-top"),f=c.css("padding-bottom"),g=a.HEIGHT_UNIT_ELEMENT_TEXT,h=c.css("border-top-width"),i=(d+parseInt(f)+parseInt(e)+2*parseInt(h)-g)/2;this.$el.find(".unit").css({"padding-top":i+"px","padding-bottom":i+"px","padding-right":+a.DEFAULT_PADDING_BETWEEN_INPUT_AND_UNIT+"px","padding-left":+a.DEFAULT_PADDING_BETWEEN_INPUT_AND_UNIT+"px"})},_applyStyle:function(){var a="#"+this.containerId+"-input-box",b=this.$el.find(a),c=this.style.color,d=this.style.backgroundColor,e=this.style.backgroundImage,f=this.style.borderColor;"undefined"!=typeof c&&b.css({color:c}),"undefined"!=typeof d&&b.css({"background-color":d}),"undefined"!=typeof e&&b.css({"background-image":'url("'+this.filePath.getImagePath(e)+'")'}),"undefined"!=typeof f&&b.css({"border-color":f})},_setWidth:function(){var a="#"+this.containerId+"-input-box",b=this.$el.find(a);b.css({width:this.width})},_setHeight:function(){var a="#"+this.containerId+"-input-box",b=this.$el.find(a);b.css({height:this.height})},_applyStyleOnFocus:function(){var a="#"+this.containerId+"-input-box",b=this.$el.find(a),c=this.style.onFocusColor,d=this.style.onFocusBackgroundColor,e=this.style.onFocusBackgroundImage,f=this.style.onFocusBorderColor;"undefined"!=typeof c&&b.css({color:c}),"undefined"!=typeof d&&b.css({"background-color":d}),"undefined"!=typeof e&&b.css({"background-image":'url("'+this.filePath.getImagePath(e)+'")'}),"undefined"!=typeof f&&b.css({"border-color":f})},_createUnitElement:function(){var a,b="#"+this.containerId+"-input-box",c=this.$el.find(b);a=$("<div></div>"),a.attr("id",this.idPrefix+"unit"),a.attr("class","unit"),this.$el.append(a),this.$el.find("#"+this.idPrefix+"unit").text(this.unit),"top"===this.unitElementPosition?a.addClass("unit-element-at-top"):"bottom"===this.unitElementPosition&&(this.$el.find("#"+this.containerId+"textbox").css({"float":"none"}),c.css({"float":"none"}),a.addClass("unit-element-at-bottom"))},_setUnitElementColor:function(){if(0===this.unitColor.indexOf("#"))this.$el.find("#"+this.idPrefix+"unit").css({color:this.unitColor});else{if(-1!==this.unitColor.indexOf("#"))return;this.$el.find("#"+this.idPrefix+"unit").addClass(this.unitColor)}},_setEntryField:function(){var a="#"+this.containerId+"-input-box",b=this.$el.find(a);this.entryFieldText=this.manager.getMessage("entry-field-text",0),null===this.defaultValue&&(this.defaultValue=this.entryFieldText),b.val(this.defaultValue),null!==this.defaultInput&&(b.val(""),b.val(this.defaultInput))},clearInputBox:function(){var a=this.model,b=this.getAccMessage("input-box-acc-text",0);this.inputEle.val(""),a.setPreviousValue(""),this.tabIndex&&this.setAccMessage(this.containerId.replace(this.idPrefix,"")+"textbox",b),a.setAndroidDevicePreviousValue("")},enableInputBox:function(){"#"+this.containerId+"-input-box",this.manager;this.inputEle.removeAttr("disabled").removeClass("disabled"),this.enableTab(this.containerId.replace(this.idPrefix,"")+"textbox",!0)},hideInputBox:function(){this.inputEle.hide()},showInputBox:function(){this.inputEle.show()},disableInputBox:function(){this.inputEle.attr("disabled","disabled").addClass("disabled"),this.inputEle.hasClass("focused")&&this.inputEle.blur(),this.enableTab(this.containerId.replace(this.idPrefix,"")+"textbox",!1)},_enableInputTab:function(a){if(this.isAccessible()===!0){var b=this,c=this.$el,d=this.player.model.get("startTabindex"),e="#"+this.containerId+"-input-box",f=c.find(e),g=b.containerId.split(b.idPrefix)[1]+"textbox",h=b.getTabIndex(g);a===!0?(b.enableTab(g,!1),f.attr("tabindex",d+h)):(b.enableTab(g,!0),f.removeAttr("tabindex"))}},_bindEvents:function(){var a=this.containerId,b="#"+a+"-input-box",c=this,d=null,e=this.$el.find("#"+a+"textbox"),f=e.find(b),g=(this.manager,MathInteractives.Common.Components.Theme2.Views.InputBox),h=c.defaultTextOnEmptyInputBox,i=null;this.player.$el.off("mousedown.player-click"+a).on("mousedown.player-click"+a,function(b){i=$(b.target),i.attr("id")!==f.attr("id")&&0===i.parents("#"+a).length&&f.hasClass("focused")&&f.blur()}),e.off("click.element-click").on("click.element-click",function(a){"disabled"!==f.attr("disabled")&&(c.setAccMessage(c.containerId.replace(c.idPrefix,"")+"textbox",""),f.focus(),f.val()===c.defaultValue&&(f.val(""),null!==this.defaultInput&&f.val(this.defaultInput)))}),f.on("focus.input-box-focus",function(a){"disabled"!==f.attr("disabled")&&f.hasClass("focused")===!1&&(MathInteractives.global.SpeechStream.stopReading(),f.val()===c.defaultValue&&(f.val(""),null!==this.defaultInput&&f.val(this.defaultInput),null!==c.style&&c._applyStyleOnFocus()),f.addClass("focused"),c._setFocusToEnd(f[0]),c._isValidated=!1,window.setTimeout(function(){c.model.setAndroidDevicePreviousValue(f.val())},0),c.trigger(g.INPUT_TYPE_FOCUS_EVENT,a))}),e.off("keydown.element-keydown").on("keydown.element-keydown",function(a){32===a.keyCode&&"disabled"!==f.attr("disabled")&&(MathInteractives.global.SpeechStream.stopReading(),c.setAccMessage(c.containerId.replace(c.idPrefix,"")+"textbox",""),c._enableInputTab(!0))}),f.off("blur.input-box-blur").on("blur.input-box-blur",function(a){var b=f.val()||null,d=null;(null===b||""===b.trim())&&(b=h,f.val(c.defaultValue),null!==c.style&&c._applyStyle()),c._enableInputTab(!1),c._checkForMinusZero(a),c.trigger(g.INPUT_TYPE_BLUR_EVENT,b,a,c.isValidInput),d=""!==$(a.target).val()?c.getAccMessage("input-box-acc-text",1,[$(a.target).val(),c.model.get("unitAccText")?c.model.get("unitAccText"):""]):c.getAccMessage("input-box-acc-text",0),c.tabIndex&&c.setAccMessage(c.containerId.replace(c.idPrefix,"")+"textbox",d),f.removeClass("focused")}),f.off("paste.input-box").on("paste.input-box",function(a){var b=a.originalEvent.clipboardData,d="",e=f.prop("selectionStart")||null,h=f.prop("selectionEnd")||null;"undefined"!=typeof b&&(b=b.getData("text/plain"),d=f.val().inputBoxCommonComponentInsertT2(e,h,b)),c._checkForValidInput(a,d)===!1||MathInteractives.Common.Utilities.Models.BrowserCheck.isAndroid?a.preventDefault():c._checkIfInputChanged(d)&&c.trigger(j+g.CUSTOM_CHANGE_EVENT_NAME,a,c.charCode,c.isValidInput,c.model.getPreviousValue())}),f.off("keydown.input-box-keydown").on("keydown.input-box-keydown",function(a){a=a?a:window.event;var b=a.keyCode?a.keyCode:a.which;if(c.model.get("bAllowQuotes")!==!0){if(b===g.CHAR_CODE_ENUM.SINGLEQUOTE)return c.keyDownCase=!0,!1;c.keyDownCase=!1}return c.isTouchDevice&&c._setValuesOnKeyDown(a),b==g.CHAR_CODE_ENUM.ENTER&&a.preventDefault(),b===g.CHAR_CODE_ENUM.BACKSPACE||b===g.CHAR_CODE_ENUM.DELETE?c._checkForValidInput(a):void 0}),f.off("keypress.input-box-keypress").on("keypress.input-box-keypress",function(a){return c.isTouchDevice===!0?!0:void(l==g.CHAR_CODE_ENUM.ENTER&&a.preventDefault())});var g=MathInteractives.Common.Components.Theme2.Views.InputBox,j=c.containerId,k=null,l=null,m=null;f.off("keyup.input-box-keyup").on("keyup.input-box-keyup",function(a){if(!c.isTouchDevice){a=a?a:window.event;var b=a.keyCode?a.keyCode:a.which;return b===g.CHAR_CODE_ENUM.BACKSPACE&&(c.isValidInput=!0),c.trigger(j+g.KEYUP_EVENT_NAME,a,b,c.isValidInput,c.resultantString),b==g.CHAR_CODE_ENUM.ENTER&&c.trigger(j+g.ENTER_PRESS_EVENT_NAME,a,b,c.isValidInput,c.resultantString),m=f.val(),null!==c.maxValue&&Number(m)>c.maxValue&&(f.val(c.model.getMaxValue()),m=f.val()),c._checkIfInputChanged(m)&&c.trigger(j+g.CUSTOM_CHANGE_EVENT_NAME,a,c.charCode,c.isValidInput,c.model.getPreviousValue()),c.model.setPreviousValue(m),c._keyPressEventHandle(a)}d="keyup",b=a.keyCode||a.which,k=c.model.getAndroidDevicePreviousValue(),c.resultantString=c.$el.find("input").val().toString(),c.trigger(g.ANDROID_KEYUP_EVENT,a,k),c.trigger(j+g.KEYUP_EVENT_NAME,a,k),b==g.CHAR_CODE_ENUM.ENTER&&c.trigger(j+g.ENTER_PRESS_EVENT_NAME,a,k)}),f.off("input.input-box-input").on("input.input-box-input",function(a){a=a?a:window.event;var b,e,h=a.keyCode?a.keyCode:a.which;$(a.target);d="input",c._isValidated!==!0&&(c.resultantString=c.$el.find("input").val().toString(),c._checkForSpecialCharInAndroid(a,d)),e=f.val().length,c.allowNegative&&0===c.resultantString.indexOf("-")&&(e-=1),e<=c.maxCharLength?c.trigger(c.containerId+g.INPUT_EVENT_NAME,a,h,c.isValidInput,c.resultantString):(b=f.val().substring(0,c.maxCharLength),c._checkForValidInput(a,b)===!0&&(f.val(b),c.trigger(c.containerId+g.INPUT_EVENT_NAME,a,h,c.isValidInput,c.resultantString)),a.preventDefault())})},_checkIfInputChanged:function(a){if(isNaN(a)){if(this.model.getPreviousValue()!==a)return!0}else if(parseFloat(this.model.getPreviousValue())!==parseFloat(a))return!0;return!1},_addJqueryFunction:function(){$.fn.inputBoxCommonComponenetgetCursorPosition||($.fn.inputBoxCommonComponenetgetCursorPosition=function(){var a=this.get(0);if(a){if("selectionStart"in a)return a.selectionStart;if(document.selection){a.focus();var b=document.selection.createRange(),c=document.selection.createRange().text.length;return b.moveStart("character",-a.value.length),b.text.length-c}}})},_checkForSpecialCharInAndroid:function(a,b){var c=this,d=(this.staticData,this.staticDataHolder),e=(c.inputType,c.model),f=$(a.target),g=f.prop("selectionStart")||null,h=f.prop("selectionEnd")||null,i=f.val(),j=this._getActualLength(g,h),k=!1,l=e.getAndroidDevicePreviousValue()||"",m=e.getCurrentRegex();
return m.test(i)&&j<=c.maxCharLength?(e.setAndroidDevicePreviousValue(i),k=!0,i!==l&&c.trigger(c.containerId+d.CUSTOM_CHANGE_EVENT_NAME,a,c.charCode,k,l),!0):(f.val(l),!1)},_addStringFunction:function(){String.prototype.inputBoxCommonComponentInsertT2||(String.prototype.inputBoxCommonComponentInsertT2=function(a,b,c){return this.substring(0,a)+c+this.substring(b,this.length)}),String.prototype.inputBoxCommonComponentDeleteT2||(String.prototype.inputBoxCommonComponentDeleteT2=function(a,b,c){return a!==b?this.substring(0,a)+this.substring(b,this.length):c?this.substring(0,a)+this.substring(b+1,this.length):this.substring(0,a-1)+this.substring(b,this.length)})},_keyPressEventHandle:function(a){var b=$(a.target),c=b.prop("selectionStart")||null,d=b.prop("selectionEnd")||null,e="#"+this.containerId+"-input-box",f=(this.$el.find(e),MathInteractives.Common.Utilities.Models.BrowserCheck),g=MathInteractives.Common.Components.Theme2.Views.InputBox,h=null,a=a?a:window.event,i=a.keyCode?a.keyCode:a.which;if(f.isFirefox&&this._checkSpecialKeys(a))return!0;if(this.keyDownCase)return this.isValidInput=!1,this.isValidInput;this.charCode=i,h=this._checkForValidInput(a);var j=this._getActualLength(c,d);return j>this.maxCharLength?i!=g.CHAR_CODE_ENUM.BACKSPACE&&i!=g.CHAR_CODE_ENUM.ENTER&&i!=g.CHAR_CODE_ENUM.LEFTARROW&&i!=g.CHAR_CODE_ENUM.TOPARROW&&i!=g.CHAR_CODE_ENUM.RIGHTARROW&&i!=g.CHAR_CODE_ENUM.BOTTOMARROW||a.shiftKey?this.isValidInput=!1:this.isValidInput=!0:this.isValidInput=h,this.trigger(this.containerId+g.KEYPRESS_EVENT_NAME,a,this.charCode,this.isValidInput,this.resultantString),this.isValidInput},_getActualLength:function(a,b){var c=this.resultantString.length;return this.allowNegative&&0===this.resultantString.indexOf("-")&&(c-=1),c-=b-a},_checkForValidInput:function(a,b){var c=this.inputType,d=MathInteractives.Common.Components.Theme2.Views.InputBox,e=null,f=this.inputEle.val(),a=a?a:window.event,g=a.type,h=null,i=$(a.target),j=i.prop("selectionStart"),k=i.prop("selectionEnd"),l=a.keyCode?a.keyCode:a.which;switch(h=b&&""!==b.trim()?b:"keydown"===g?l===d.CHAR_CODE_ENUM.DELETE?f.inputBoxCommonComponentDeleteT2(j,k,!0):f.inputBoxCommonComponentDeleteT2(j,k,!1):f.inputBoxCommonComponentInsertT2(j,k,String.fromCharCode(l)),c){case d.INPUT_TYPE_INTEGER:e=this._isValidInteger(f,a,l,h);break;case d.INPUT_TYPE_FLOATING:e=this._isValidFloat(f,a,l,h);break;case d.INPUT_TYPE_ALPHANUMERIC:e=this._isValidAlphanumeric(f,a,l,h);break;case d.INPUT_TYPE_CURRENCY:e=this._isValidCurrency(f,a,l,h);break;case d.INPUT_TYPE_CUSTOM:e=this._isValidCustom(f,a,l,h);break;case d.INPUT_TYPE_TITLE:e=this._isValidTitle(f,a,l,h)}return e},_checkSpecialKeys:function(a){var b=a.keyCode,c=MathInteractives.Common.Components.Theme2.Views.InputBox;return b==c.CHAR_CODE_ENUM.BACKSPACE||b==c.CHAR_CODE_ENUM.TAB||b==c.CHAR_CODE_ENUM.DELETE||b==c.CHAR_CODE_ENUM.LEFTARROW||b==c.CHAR_CODE_ENUM.TOPARROW||b==c.CHAR_CODE_ENUM.RIGHTARROW||b==c.CHAR_CODE_ENUM.BOTTOMARROW?!0:!1},_isValidInteger:function(a,b,c,d){var e=new RegExp(/^\-{0,1}\d*$/),f=new RegExp(/[$%(&]/),g=$(b.target),h=g.prop("selectionStart"),i=g.prop("selectionEnd"),j=e.test(d),k=MathInteractives.Common.Components.Theme2.Views.InputBox,l=b.keyCode;return this.resultantString=d,this.keyCodeArray.indexOf(c)>=0?!0:b.shiftKey?!1:f.test(d)?!1:c===k.CHAR_CODE_ENUM.SINGLEQUOTE?!1:MathInteractives.Common.Utilities.Models.BrowserCheck.isFirefox&&l===k.CHAR_CODE_ENUM.DELETE?!0:c==k.CHAR_CODE_ENUM.BACKSPACE||c==k.CHAR_CODE_ENUM.ENTER||c==k.CHAR_CODE_ENUM.LEFTARROW||c==k.CHAR_CODE_ENUM.TOPARROW||c==k.CHAR_CODE_ENUM.RIGHTARROW||c==k.CHAR_CODE_ENUM.BOTTOMARROW?!0:-1!==d.substring(h+1,i+1).indexOf("-")&&l>=48&&57>=l?!0:this.allowNegative&&i-h===a.length&&c===k.CHAR_CODE_ENUM.MINUS_KEY_KEYCODE?!0:(j||(this.allowNegative?g.val(a.replace(/[^-0-9]/g,"")):g.val(a.replace(/[^0-9]/g,""))),this.allowNegative?j:d.indexOf("-")>=0?(g.val(a.replace(/[^0-9]/g,"")),!1):j)},_setValuesOnKeyDown:function(a){this.charCode=a.charCode||a.which,this.trigger(this.staticDataHolder.ANDROID_KEYDOWN_EVENT,a)},_checkForMinusZero:function(a){var b=$(a.target),c=b.val();a.keyCode||a.which,MathInteractives.Common.Components.Theme2.Views.InputBox;return Number(c)===-0?(c=c.replace("-",""),b.val(c),!0):!1},_isValidFloat:function(a,b,c,d){var e=this.precision,f=$(b.target),g=f.val(),h=f.prop("selectionStart"),i=f.prop("selectionEnd"),j=new RegExp("^\\-{0,1}\\d*(?:\\.\\d{0,"+e+"})?$"),k=new RegExp(/[$%(&]/),l=j.test(d),m=MathInteractives.Common.Components.Theme2.Views.InputBox,n=this.model,o=b.keyCode,p=this.maxCharLength,q=(n.getLastInputValue()||null,this.allowNegative);if(this.resultantString=d,this.keyCodeArray.indexOf(c)>=0)return!0;if(b.shiftKey)return!1;if(c===m.CHAR_CODE_ENUM.SINGLEQUOTE)return!1;if(MathInteractives.Common.Utilities.Models.BrowserCheck.isIOS&&k.test(d))return!1;if(MathInteractives.Common.Utilities.Models.BrowserCheck.isFirefox&&o===m.CHAR_CODE_ENUM.DELETE)return!0;if(c==m.CHAR_CODE_ENUM.BACKSPACE||c==m.CHAR_CODE_ENUM.ENTER||c==m.CHAR_CODE_ENUM.LEFTARROW||c==m.CHAR_CODE_ENUM.TOPARROW||c==m.CHAR_CODE_ENUM.RIGHTARROW||c==m.CHAR_CODE_ENUM.BOTTOMARROW)return!0;if(-1!==d.substring(h+1,i+1).indexOf("-")&&(o>=48&&57>=o||110===o||45===c)){if(q===!0&&45===c)return!0;if(q===!1)return!0}return-1!==d.substring(h+1,i+1).indexOf("-")&&o>=48&&57>=o?!0:(l||(a.length<=p&&a.split(".").length<3?q?f.val(a.replace(/[^-0-9.]/g,"")):f.val(a.replace(/[^0-9.]/g,"")):(null===g&&(g=""),f.val(g))),n.setLastInputValue(f.val()),q?l:d.indexOf("-")>=0?(a.length<=p&&a.split(".").length<3?q?f.val(a.replace(/[^-0-9.]/g,"")):f.val(a.replace(/[^0-9.]/g,"")):(null===g&&(g=""),f.val(g)),n.setLastInputValue(f.val()),!1):l)},_isValidAlphanumeric:function(a,b,c,d){var e=new RegExp(/^\w*$/),f=e.test(d);return this.keyCodeArray.indexOf(c)>=0?!0:(this.resultantString=d,f)},_isValidCurrency:function(a,b,c,d){var e=new RegExp(/^-?(?:0|[1-9]\d{0,2}(?:,?\d{3})*)(?:\.\d+)?$/),f=$(b.target),g=f.prop("selectionStart"),h=f.prop("selectionEnd"),i=e.test(d),j=b.keyCode;return-1!==d.substring(g+1,h+1).indexOf("-")&&(j>=48&&57>=j||188===j)?!0:(i||(this.allowNegative?f.val(a.replace(/[^-0-9.]/g,"")):f.val(a.replace(/[^0-9.]/g,""))),this.resultantString=d,i)},_isValidCustom:function(a,b,c,d){var e,f,g=$(b.target),h=g.val(),i=g.prop("selectionStart"),j=g.prop("selectionEnd"),k=MathInteractives.Common.Components.Theme2.Views.InputBox,l=h.length,m=new RegExp(this.regexString),n=String.fromCharCode(c);return this.keyCodeArray.indexOf(c)>=0?!0:l-(j-i)===0&&0!==l&&(f=m.test(n))?(this.resultantString=n,f):(e=d&&""!==d.trim()?d:"keydown"===b.type?c===k.CHAR_CODE_ENUM.DELETE?a.inputBoxCommonComponentDeleteT2(i,j,!0):a.inputBoxCommonComponentDeleteT2(i,j,!1):0!==Math.abs(j-i)?l>j?h.substring(0,i)+n+h.substring(j+1,l-1):h.substring(0,i)+n:a.inputBoxCommonComponentInsertT2(i,j,n),f=m.test(e),this.resultantString=e,f)},_isValidTitle:function(a,b,c,d){var e=new RegExp(/^[^<>]*$/),f=e.test(d);return this.keyCodeArray.indexOf(c)>=0?!0:(this.resultantString=d,f)},_addCustomClass:function(){null!==this._customClass&&null!==this.inputEle&&this.inputEle.addClass(this._customClass)},getCurrentInputValue:function(){return this.$el.find("input").val()||null},setCurrentInputValue:function(a){a=null==a?"":a,this.$el.find("input").val(a),this.model.set("previousValue",a),this.resultantString=a.toString(),this.isTouchDevice&&this.model.set("androidDevicePreviousValue",a)},updateRegularExpression:function(a){this.regexString=a,this.model.set("regexString",a),this.model._setRegexForCurrentType()},_setFocusToEnd:function(a){var b;b=a.value.length,a.setSelectionRange(b,b),a.scrollLeft=a.scrollWidth}},{INPUT_TYPE_FOCUS_EVENT:"input-focus",INPUT_TYPE_BLUR_EVENT:"input-blur",CHAR_CODE_ENUM:{BACKSPACE:8,ENTER:13,LEFTARROW:37,TOPARROW:38,RIGHTARROW:39,BOTTOMARROW:40,SINGLEQUOTE:222,DELETE:46,TAB:9,MINUS_KEY_KEYCODE:45},INPUT_TYPE_INTEGER:"integer",INPUT_TYPE_FLOATING:"floating",INPUT_TYPE_ALPHANUMERIC:"alphanumeric",INPUT_TYPE_CURRENCY:"currency",INPUT_TYPE_CUSTOM:"custom",INPUT_TYPE_TITLE:"title",ANDROID_KEYUP_EVENT:"android-keyup-event",ANDROID_KEYDOWN_EVENT:"android-input-keydown",KEYPRESS_EVENT_NAME:"input-box-keypress",KEYUP_EVENT_NAME:"input-box-keyup",ENTER_PRESS_EVENT_NAME:"input-box-enterpress",INPUT_EVENT_NAME:"input-box-input-event",CUSTOM_CHANGE_EVENT_NAME:"input-box-value-changed",HEIGHT_UNIT_ELEMENT_TEXT:22,DEFAULT_PADDING_BETWEEN_INPUT_AND_UNIT:7,UNIT_ELEMENT_POSITION_LEFT:"left",UNIT_ELEMENT_POSITION_TOP:"top",UNIT_ELEMENT_POSITION_RIGHT:"right",UNIT_ELEMENT_POSITION_BOTTOM:"bottom",createInputBox:function(a){if(null!==a.containerId){var b,c,d="#"+a.containerId;return b=new MathInteractives.Common.Components.Theme2.Models.InputBox(a),c=new MathInteractives.Common.Components.Theme2.Views.InputBox({el:d,model:b})}}}),MathInteractives.global.Theme2.InputBox=MathInteractives.Common.Components.Theme2.Views.InputBox}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.CustomSpinner=Backbone.Model.extend({defaults:function(){return{spinId:null,manager:null,path:null,screenId:null,idPrefix:null,height:35,width:50,minValue:-10,maxValue:10,value:null,step:1,showSign:!1,buttonState:"disabled",isEditable:!1,inputPrecision:null,maxCharLength:4,alignType:null,inputType:null,inputRegEx:null,inputCustomClass:null,textBoxStyle:null,defaultText:"---",emptySpinnerAccText:null,defaultAccText:null,minLimitAccText:null,maxLimitAccText:null,onIncreaseAccText:null,onDecreaseAccText:null,emptySpinnerPlaceHolders:null,defaultPlaceHolders:null,minLimitPlaceHolders:null,maxLimitPlaceHolders:null,onIncreasePlaceHolders:null,onDecreasePlaceHolders:null,upArrowAccText:null,downArrowAccText:null,textAccId:null,upArrowAccId:null,downArrowAccId:null,tabIndex:0,upArrowTabIndex:2,downArrowTabIndex:4,textAccObj:null,upArrowAccObj:null,downArrowAccObj:null,isStepper:!1,stepperValues:[],currentStepperIndex:0,buttonFontColor:"#FFFFFF",buttonFontSize:14,downBtnFontAwesomeClass:"minus",upBtnFontAwesomeClass:"plus"}},initialize:function(){var a=null;null===this.get("emptySpinnerAccText")&&this.setEmptySpinnerAccText("%@$%"),null===this.get("defaultAccText")&&this.setDefaultAccText("%@$%"),null===this.get("minLimitAccText")&&this.setMinLimitAccText("%@$%"),null===this.get("maxLimitAccText")&&this.setMaxLimitAccText("%@$%"),null===this.get("onIncreaseAccText")&&this.setOnIncreaseAccText("%@$%"),null===this.get("onDecreaseAccText")&&this.setOnDecreaseAccText("%@$%"),null===this.get("emptySpinnerPlaceHolders")&&this.setEmptySpinnerPlaceHolders([MathInteractives.global.Theme2.CustomSpinner.MIN_VAL,MathInteractives.global.Theme2.CustomSpinner.MAX_VAL]),null===this.get("defaultPlaceHolders")&&this.setDefaultPlaceHolders([MathInteractives.global.Theme2.CustomSpinner.CURR_VAL]),null===this.get("minLimitPlaceHolders")&&this.setMinLimitPlaceHolders([MathInteractives.global.Theme2.CustomSpinner.MIN_VAL]),null===this.get("maxLimitPlaceHolders")&&this.setMaxLimitPlaceHolders([MathInteractives.global.Theme2.CustomSpinner.MAX_VAL]),null===this.get("onIncreasePlaceHolders")&&this.setOnIncreasePlaceHolders([MathInteractives.global.Theme2.CustomSpinner.CURR_VAL]),null===this.get("onDecreasePlaceHolders")&&this.setOnDecreasePlaceHolders([MathInteractives.global.Theme2.CustomSpinner.CURR_VAL]),this.setScreenId(this.getSpinId().replace(this.getIdPrefix(),"")),this.getIsEditable()?this._setTextAccId(this.getScreenId()+"-texttextbox"):this._setTextAccId(this.getScreenId()+"-text"),this._setTabIndex(this.getTabIndex()),a={elementId:this.getTextAccId(),tabIndex:this.getTabIndex(),acc:this.getDefaultAccText()},this._setTextAccObj(a)},setButtonAccText:function(){var a=null,b=null;this._setUpArrowAccId(this.getScreenId()+"-up-arrow"),this._setDownArrowAccId(this.getScreenId()+"-down-arrow"),this._setUpArrowTabIndex(this.getTabIndex()+2),this._setDownArrowTabIndex(this.getUpArrowTabIndex()+2),a={elementId:this.getUpArrowAccId(),tabIndex:this.getUpArrowTabIndex(),acc:this.getUpArrowAccText(),role:"button"},b={elementId:this.getDownArrowAccId(),tabIndex:this.getDownArrowTabIndex(),acc:this.getDownArrowAccText(),role:"button"},this._setUpArrowAccObj(a),this._setDownArrowAccObj(b)},getSpinId:function(){return this.get("spinId")},setSpinId:function(a){this.set("spinId",a)},getIdPrefix:function(){return this.get("idPrefix")},setIdPrefix:function(a){this.set("idPrefix",a)},getPath:function(){return this.get("path")},setPath:function(a){this.set("path",a)},getManager:function(){return this.get("manager")},setManager:function(a){this.set("manager",a)},getPlayer:function(){return this.get("player")},getHeight:function(){return this.get("height")},setHeight:function(a){this.set("height",a)},getWidth:function(){return this.get("width")},setWidth:function(a){this.set("width",a)},getMinValue:function(){return this.get("minValue")},setMinValue:function(a){this.set("minValue",a)},getMaxValue:function(){return this.get("maxValue")},setMaxValue:function(a){this.set("maxValue",a)},getValue:function(){return this.get("value")},setValue:function(a){this.set("value",a)},getStepValue:function(){return this.get("step")},setStepValue:function(a){this.set("step",a)},getShowSign:function(){return this.get("showSign")},setShowSign:function(a){this.set("showSign",a)},getScreenId:function(){return this.get("screenId")},setScreenId:function(a){this.set("screenId",a)},getButtonState:function(){return this.get("buttonState")},setButtonState:function(a){this.set("buttonState",a)},getIsEditable:function(){return this.get("isEditable")},setIsEditable:function(a){this.set("isEditable",a)},getAlignType:function(){return this.get("alignType")},setIsBottomAligned:function(a){this.set("isBottomAligned",a)},getInputType:function(){return this.get("inputType")},getInputPrecision:function(){return this.get("inputPrecision")},getMaxCharLength:function(){return this.get("maxCharLength")},getInputRegEx:function(){return this.get("inputRegEx")},setEmptySpinnerAccText:function(a){var b=this.getTextAccObj();this.set("emptySpinnerAccText",a),null===b||null===a&&void 0===a||(b.acc=a,this._setTextAccObj(b))},getEmptySpinnerAccText:function(){return this.get("emptySpinnerAccText")},setEmptySpinnerPlaceHolders:function(a){this.set("emptySpinnerPlaceHolders",a)},getEmptySpinnerPlaceHolders:function(){return this.get("emptySpinnerPlaceHolders")},setDefaultAccText:function(a){var b=this.getTextAccObj(),c=this.getEmptySpinnerAccText();this.set("defaultAccText",a),null===b||null!==c&&void 0!==c||(b.acc=a,this._setTextAccObj(b))},getDefaultAccText:function(){return this.get("defaultAccText")},setDefaultPlaceHolders:function(a){this.set("defaultPlaceHolders",a)},getDefaultPlaceHolders:function(){return this.get("defaultPlaceHolders")},setMinLimitAccText:function(a){this.set("minLimitAccText",a)},getMinLimitAccText:function(){return this.get("minLimitAccText")},setMinLimitPlaceHolders:function(a){this.set("minLimitPlaceHolders",a)},getMinLimitPlaceHolders:function(){return this.get("minLimitPlaceHolders")},setMaxLimitAccText:function(a){this.set("maxLimitAccText",a)},getMaxLimitAccText:function(){return this.get("maxLimitAccText")},setMaxLimitPlaceHolders:function(a){this.set("maxLimitPlaceHolders",a)},getMaxLimitPlaceHolders:function(){return this.get("maxLimitPlaceHolders")},setOnIncreaseAccText:function(a){this.set("onIncreaseAccText",a)},getOnIncreaseAccText:function(){return this.get("onIncreaseAccText")},setOnIncreasePlaceHolders:function(a){this.set("onIncreasePlaceHolders",a)},getOnIncreasePlaceHolders:function(){return this.get("onIncreasePlaceHolders")},setOnDecreaseAccText:function(a){this.set("onDecreaseAccText",a)},getOnDecreaseAccText:function(){return this.get("onDecreaseAccText")},setOnDecreasePlaceHolders:function(a){this.set("onDecreasePlaceHolders",a)},getOnDecreasePlaceHolders:function(){return this.get("onDecreasePlaceHolders")},setUpArrowAccText:function(a){this.set("upArrowAccText",a);var b=this.getUpArrowAccObj();null!==b&&(b.acc=a,this._setTextAccObj(b))},getUpArrowAccText:function(){return this.get("upArrowAccText")},setDownArrowAccText:function(a){this.set("downArrowAccText",a);var b=this.getDownArrowAccObj();null!==b&&(b.acc=a,this._setDownArrowAccObj(b))},getDownArrowAccText:function(){return this.get("downArrowAccText")},_setTextAccId:function(a){this.set("textAccId",a);var b=this.getTextAccObj();null!==b&&(b.elementId=a,this._setTextAccObj(b))},getTextAccId:function(){return this.get("textAccId")},_setUpArrowAccId:function(a){this.set("upArrowAccId",a);var b=this.getUpArrowAccObj();null!==b&&(b.elementId=a,this._setTextAccObj(b))},getUpArrowAccId:function(){return this.get("upArrowAccId")},_setDownArrowAccId:function(a){this.set("downArrowAccId",a);var b=this.getDownArrowAccObj();null!==b&&(b.elementId=a,this._setDownArrowAccObj(b))},getDownArrowAccId:function(){return this.get("downArrowAccId")},_setTabIndex:function(a){this.set("tabIndex",parseInt(a));var b=this.getTextAccObj();null!==b&&(b.tabIndex=a,this._setTextAccObj(b))},getTabIndex:function(){return this.get("tabIndex")},_setUpArrowTabIndex:function(a){this.set("upArrowTabIndex",parseInt(a));var b=this.getUpArrowAccObj();null!==b&&(b.tabIndex=a,this._setTextAccObj(b))},getUpArrowTabIndex:function(){return this.get("upArrowTabIndex")},_setDownArrowTabIndex:function(a){this.set("downArrowTabIndex",parseInt(a));var b=this.getDownArrowAccObj();null!==b&&(b.tabIndex=a,this._setDownArrowAccObj(b))},getDownArrowTabIndex:function(){return this.get("downArrowTabIndex")},_setTextAccObj:function(a){this.set("textAccObj",a)},getTextAccObj:function(){return this.get("textAccObj")},_setUpArrowAccObj:function(a){this.set("upArrowAccObj",a)},getUpArrowAccObj:function(){return this.get("upArrowAccObj")},_setDownArrowAccObj:function(a){this.set("downArrowAccObj",a)},getDownArrowAccObj:function(){return this.get("downArrowAccObj")}})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.CustomSpinner=MathInteractives.Common.Player.Views.Base.extend({manager:null,spinBoxId:null,_path:null,screenId:null,idPrefix:null,player:null,minValue:null,maxValue:null,stepValue:null,spinValue:null,spinnerHeight:null,spinnerWidth:null,spinSign:!1,upBtn:null,downBtn:null,disableSpin:!1,previousValue:"",currentValue:"",isEditable:!1,alignType:!1,inputPrecision:null,inputRegEx:null,spinnerTextbox:null,emptySpinnerPlaceHolderValues:null,defaultAllPlaceHolderValues:null,minLimitAllPlaceHolderValues:null,maxLimitAllPlaceHolderValues:null,onDecreaseAllPlaceHolderValues:null,onIncreaseAllPlaceHolderValues:null,btnInterval:null,isFocusedPress:!1,buttonWidth:null,buttonHeight:null,inputBoxWidth:null,inputBoxHeight:null,initialize:function(){var a,b=this.model,c=MathInteractives.global.Theme2.CustomSpinner,d=b.get("buttonWidth"),e=b.get("buttonHeight"),f=b.get("inputBoxHeight"),g=b.get("inputBoxWidth");this.manager=b.getManager(),this.player=b.getPlayer(),this.idPrefix=b.getIdPrefix(),this.spinBoxId=b.getSpinId(),this.alignType=a=b.getAlignType(),this.minValue=b.getMinValue(),this.maxValue=b.getMaxValue(),this.stepValue=b.getStepValue(),this.buttonWidth=a===c.VERTICAL_ALIGN||a===c.CENTER_ALIGN||a===c.VERTICAL_RIGHT||a===c.VERTICAL_LEFT?null!==d&&"undefined"!=typeof d?d:43:30,this.buttonHeight=a===c.VERTICAL_ALIGN||a===c.CENTER_ALIGN||a===c.VERTICAL_RIGHT||a===c.VERTICAL_LEFT?null!==e&&"undefined"!=typeof e?e:31:30,this.inputBoxWidth=a===c.VERTICAL_ALIGN||a===c.CENTER_ALIGN||a===c.VERTICAL_RIGHT||a===c.VERTICAL_LEFT?null!==g&&"undefined"!=typeof g?g:39:g||66,this.inputBoxHeight=a===c.VERTICAL_ALIGN||a===c.CENTER_ALIGN||a===c.VERTICAL_RIGHT||a===c.VERTICAL_LEFT?null!==f&&"undefined"!=typeof f?f:34:f||42,this.buttonBaseClass=b.get("buttonBaseClass"),this.downBtnFontAwesomeClass=b.get("downBtnFontAwesomeClass"),this.upBtnFontAwesomeClass=b.get("upBtnFontAwesomeClass"),this.spinValue=b.getValue(),this.spinnerHeight=b.getHeight(),this.spinnerWidth=b.getWidth(),this.spinSign=b.getShowSign(),this.screenId=b.getScreenId(),this._path=b.getPath(),this.isEditable=b.getIsEditable(),this.inputPrecision=b.getInputPrecision(),this.inputRegEx=b.getInputRegEx(),this.currentValue=this.spinValue,this.previousValue=this.currentValue,this.loadScreen("spinner-acc-text-screen"),"%@$%"===b.getEmptySpinnerAccText()&&this.setEmptySpinnerAcc(this.getAccMessage("empty-spinner-acc-text",0)),this.emptySpinnerPlaceHolderValues=[],this.defaultAllPlaceHolderValues=[],this.minLimitAllPlaceHolderValues=[],this.maxLimitAllPlaceHolderValues=[],this.onDecreaseAllPlaceHolderValues=[],this.onIncreaseAllPlaceHolderValues=[],this._setPlaceHolderValues(b.getEmptySpinnerPlaceHolders(),this.emptySpinnerPlaceHolderValues),this._setPlaceHolderValues(b.getDefaultPlaceHolders(),this.defaultAllPlaceHolderValues),this._setPlaceHolderValues(b.getMinLimitPlaceHolders(),this.minLimitAllPlaceHolderValues),this._setPlaceHolderValues(b.getMaxLimitPlaceHolders(),this.maxLimitAllPlaceHolderValues),this._setPlaceHolderValues(b.getOnDecreasePlaceHolders(),this.onDecreaseAllPlaceHolderValues),this._setPlaceHolderValues(b.getOnIncreasePlaceHolders(),this.onIncreaseAllPlaceHolderValues),null===this.alignType&&(this.alignType=MathInteractives.global.Theme2.CustomSpinner.CENTER_ALIGN);var h={spinBoxId:this.spinBoxId},i=MathInteractives.Common.Components.templates.theme2CustomSpinner(h);this._render(i),this._setAlignments()},_render:function(a){var b,c=this.model,d=c.get("value"),e=MathInteractives.global.Theme2.CustomSpinner,f=(this.$(".spin-down-arrow"),c.get("textBoxStyle")),g=this.alignType,h=this.inputBoxHeight,i=this,j=null!==c.get("inputCustomClass")?"spinner-input-box "+c.get("inputCustomClass"):"spinner-input-box",k=c.getInputType(),l=c.getMaxCharLength();if(this.$el.append(a.trim()),this.isEditable&&(b={containerId:this.spinBoxId+"-text",filePath:this._path,manager:this.manager,player:this.player,idPrefix:this.idPrefix,inputType:k,customClass:j,precision:this.inputPrecision,maxCharLength:l,width:this.inputBoxWidth,height:h},k===MathInteractives.global.Theme2.InputBox.INPUT_TYPE_CUSTOM&&(b.regexString=this.inputRegEx),null!=f&&(b.style=f),this.spinnerTextbox=MathInteractives.global.Theme2.InputBox.createInputBox(b),this.$(".spin-textbox,.spin-down-arrow,.spin-up-arrow").addClass("editable-textbox")),this.$(".spinbox,.spin-textbox,.spin-down-arrow,.spin-up-arrow").addClass(g+"-aligned"),g===e.TOP_ALIGN)$(this.$(".spin-down-arrow").parent()).append(this.$(".spin-down-arrow")),$(this.$(".spin-up-arrow").parent()).append(this.$(".spin-up-arrow")),$('<div style="clear:both" ></div>').insertBefore(this.$(".spin-down-arrow"));else if(g===e.LEFT_ALIGN)$(this.$(".spin-down-arrow").parent()).append(this.$(".spin-down-arrow"));else if(g===e.VERTICAL_ALIGN)$(this.$(".spin-up-arrow").parent()).prepend(this.$(".spin-up-arrow")),$(this.$(".spin-down-arrow").parent()).append(this.$(".spin-down-arrow"));else if(this.alignType===e.VERTICAL_LEFT||this.alignType===e.VERTICAL_RIGHT){var m=$("<div id="+this.idPrefix+'custom-spinner-button-container class="custom-spinner-'+this.alignType+'"></div>'),n=$("<div id="+this.idPrefix+'custom-spinner-input-box-container class="custom-spinner-input-box-container-'+this.alignType+'"></div>');if(this.isEditable===!0&&n.addClass("editable-input-box"),this.alignType===e.VERTICAL_LEFT?($(this.$(".spin-down-arrow").parent()).prepend(m),$(this.$(".spin-down-arrow").parent()).append(n)):($(this.$(".spin-down-arrow").parent()).prepend(n),$(this.$(".spin-down-arrow").parent()).append(m)),m.append(this.$(".spin-up-arrow")),m.append(this.$(".spin-down-arrow")),n.append(this.$(".spin-textbox")),this.isEditable===!1){var o=(n.height()-this.inputBoxHeight-2)/2;n.css("margin-top",o+"px")}}this.isEditable?this.createAccDiv(this.model.getTextAccObj()):(this.$(".spin-textbox").css({height:h,width:this.inputBoxWidth,"line-height":h+"px"}),this.createAccDiv({elementId:c.getTextAccId(),tabIndex:c.getTabIndex(),acc:d})),this.setAccMessage(this.model.getTextAccId(),this.model.getDefaultAccText(),this.defaultAllPlaceHolderValues),this.focusOut(this.model.getTextAccId(),function(){i.isEditable||(null===i.currentValue?i.setAccMessage(i.model.getTextAccId(),i.model.getEmptySpinnerAccText(),i.emptySpinnerPlaceHolderValues):i.setAccMessage(i.model.getTextAccId(),i.model.getDefaultAccText(),i.defaultAllPlaceHolderValues))})},_setPlaceHolderValues:function(a,b){this._setPlaceHolderValue(a,MathInteractives.global.Theme2.CustomSpinner.PREV_VAL,b,Number(this.previousValue)),this._setPlaceHolderValue(a,MathInteractives.global.Theme2.CustomSpinner.CURR_VAL,b,Number(this.currentValue)),this._setPlaceHolderValue(a,MathInteractives.global.Theme2.CustomSpinner.MIN_VAL,b,Number(this.minValue)),this._setPlaceHolderValue(a,MathInteractives.global.Theme2.CustomSpinner.MAX_VAL,b,Number(this.maxValue)),this.isEditable&&this._setPlaceHolderValue(a,MathInteractives.global.Theme2.CustomSpinner.CURR_VAL,b,Number(this.$(".spinbox .spinner-input-box").val()))},_setPlaceHolderValue:function(a,b,c,d){var e=a.indexOf(b);e>=0&&(c[e]=$.isNumeric(d)?MathInteractives.Common.Utilities.Models.Utils.commaSeparateNumber(d).result:d)},_setAlignments:function(){var a=this,b=this.$el.find(".spin-up-arrow"),c=this.$el.find(".spin-down-arrow");this._generateButtons(),this.setSpinBoxValue(this.spinValue);var d=0,e=0;clearInterval(d),clearInterval(e),c.mousedown(function(b){clearInterval(a.btnInterval),a.downBtn.getButtonState()!=MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED?(a.$el.find(".spin-down-arrow").unbind("click"),(void 0!==b&&"undefined"!=typeof b.which&&1===b.which||MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile)&&(a.btnInterval=setInterval($.proxy(a.spinDownArrowClick,a),500))):a.$el.find(".spin-down-arrow").unbind("click").bind("click",$.proxy(a.spinDownArrowClick,a))}).on("touchstart",function(){clearInterval(a.btnInterval),a.downBtn.getButtonState()!=MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED?(a.$el.find(".spin-down-arrow").unbind("click"),a.btnInterval=setInterval($.proxy(a.spinDownArrowClick,a),500)):a.$el.find(".spin-down-arrow").unbind("click").bind("click",$.proxy(a.spinDownArrowClick,a))}).mouseup(function(){clearInterval(a.btnInterval),a.$el.find(".spin-down-arrow").unbind("click").bind("click",$.proxy(a.spinDownArrowClick,a))}).mouseout(function(){clearInterval(a.btnInterval),a.$el.find(".spin-down-arrow").unbind("click").bind("click",$.proxy(a.spinDownArrowClick,a))}).on("touchend",function(){clearInterval(a.btnInterval),a.$el.find(".spin-down-arrow").unbind("click").bind("click",$.proxy(a.spinDownArrowClick,a))}),b.mousedown(function(b){clearInterval(a.btnInterval),a.upBtn.getButtonState()!=MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED?(a.$el.find(".spin-up-arrow").unbind("click"),(void 0!==b&&"undefined"!=typeof b.which&&1===b.which||MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile)&&(a.btnInterval=setInterval($.proxy(a.spinUpArrowClick,a),500))):a.$el.find(".spin-up-arrow").unbind("click").bind("click",$.proxy(a.spinUpArrowClick,a))}).on("touchstart",function(){clearInterval(a.btnInterval),a.upBtn.getButtonState()!=MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED?(a.$el.find(".spin-up-arrow").unbind("click"),a.btnInterval=setInterval($.proxy(a.spinUpArrowClick,a),500)):a.$el.find(".spin-up-arrow").unbind("click").bind("click",$.proxy(a.spinUpArrowClick,a))}).mouseup(function(){clearInterval(a.btnInterval),a.$el.find(".spin-up-arrow").unbind("click").bind("click",$.proxy(a.spinUpArrowClick,a))}).mouseout(function(){clearInterval(a.btnInterval),a.$el.find(".spin-up-arrow").unbind("click").bind("click",$.proxy(a.spinUpArrowClick,a))}).on("touchend",function(){clearInterval(a.btnInterval),a.$el.find(".spin-up-arrow").unbind("click").bind("click",$.proxy(a.spinUpArrowClick,a))})},_generateButtons:function(){var a,b=this,c=this.model,d=(MathInteractives.global.Theme2.CustomSpinner,MathInteractives.global.Theme2.Button.TYPE),e=MathInteractives.global.Theme2.Button,f=this.buttonBaseClass,g=c.getUpArrowAccText(),h=this.buttonWidth,i=this.buttonHeight,j=c.getDownArrowAccText(),k=c.get("buttonFontColor"),l=c.get("buttonFontSize");g=null!==g?g:this.getAccMessage("up-arrow-acc-text",0),j=null!==j?j:this.getAccMessage("down-arrow-acc-text",0),c.setUpArrowAccText(g),c.setDownArrowAccText(j),a=function(a,c){var g=e.generateButton({player:b.player,manager:b.manager,path:b._path,idPrefix:b.idPrefix,data:{id:b.spinBoxId+a,type:d.FA_ICON,icon:{faClass:b._path.getFontAwesomeClass(c),fontSize:l,fontColor:k,fontWeight:"normal",applyIconButtonWrapper:!0,iconButtonWrapperClass:"custom-spinner-font-awesome-icon-container"},width:h,height:i,baseClass:f}});return g},this.upBtn=a("-up-arrow",this.upBtnFontAwesomeClass),this.downBtn=a("-down-arrow",this.downBtnFontAwesomeClass),this.$(".spin-down-arrow .button-icon").addClass("spinner-minus-btn"),this.$(".spin-up-arrow .button-icon").addClass("spinner-plus-btn"),c.setButtonAccText(),this.createAccDiv(c.getUpArrowAccObj()),this.createAccDiv(c.getDownArrowAccObj())},setSpinBoxValue:function(a){var b=this,c=this.minValue,d=this.maxValue,e=(this.spinSign,this.spinBoxId,this.model.get("defaultText"));this.disableSpin||(null===a||a===e?(this.isEditable?(this.$(".spinner-input-box").val(e),this.setAccMessage(this.model.getTextAccId(),this.model.getEmptySpinnerAccText(),this.emptySpinnerPlaceHolderValues)):(this.$(".spin-value").text(e),this.setAccMessage(this.model.getTextAccId(),this.model.getEmptySpinnerAccText(),this.emptySpinnerPlaceHolderValues)),this.model.set("value",null),this.currentValue=null,this._disableBtn(this.downBtn)):(this.currentValue=this.spinSign?b.getSpinBoxSignValue(a):a,this.model.set("value",a),this.isEditable?this.$(".spinner-input-box").val(this.currentValue):this.$(".spin-value").text(this.currentValue)),c==a?(this.upBtn.getButtonState()!==MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE&&this._enableBtn(this.upBtn,this.model.getUpArrowAccId()),this._disableBtn(this.downBtn,this.model.getDownArrowAccId()),this.$el.find(".spin-down-arrow").unbind("click"),this.$el.find(".spin-up-arrow").unbind("click").bind("click",$.proxy(this.spinUpArrowClick,this))):d==a?(this._disableBtn(this.upBtn,this.model.getUpArrowAccId()),this.downBtn.getButtonState()!==MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE&&this._enableBtn(this.downBtn,this.model.getDownArrowAccId()),this.$el.find(".spin-down-arrow").unbind("click").bind("click",$.proxy(this.spinDownArrowClick,this)),this.$el.find(".spin-up-arrow").unbind("click")):(this.upBtn.getButtonState()!==MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE&&this._enableBtn(this.upBtn,this.model.getUpArrowAccId()),this.downBtn.getButtonState()!==MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE&&null!=this.currentValue&&this._enableBtn(this.downBtn,this.model.getDownArrowAccId()),this.$el.find(".spin-down-arrow").unbind("click").bind("click",$.proxy(this.spinDownArrowClick,this)),this.$el.find(".spin-up-arrow").unbind("click").bind("click",$.proxy(this.spinUpArrowClick,this))))},getSpinBoxValue:function(){var a=this.currentValue;return null!=a?Number(a):null},enableSpinBox:function(){var a=(this.$el.find(".spin-textbox"),this.$el.find(".spin-up-arrow"),this.$el.find(".spin-down-arrow"),this.getSpinBoxValue()),b=this.minValue,c=this.maxValue;Number(this.currentValue);this.$el.removeClass("disabled"),this.$(".spin-textbox").removeClass("disabled-spin-box"),this.isEditable&&this.$(".spinner-input-box").removeAttr("disabled").removeClass("disabled-input-box"),null!=a&&a>b&&this._enableBtn(this.downBtn,this.model.getDownArrowAccId()),c>a&&this._enableBtn(this.upBtn,this.model.getUpArrowAccId()),this.disableSpin=!1,this.enableTab(this.model.getTextAccId(),!0),this.setSpinBoxValue(this.currentValue),MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile&&(this.$el.find(".spin-down-arrow-touch").unbind("click").bind("click",function(){this.$el.find(".spin-down-arrow").trigger("click")}),this.$el.find(".spin-up-arrow-touch").unbind("click").bind("click",function(){
this.$el.find(".spin-up-arrow").trigger("click")}))},disableSpinBox:function(){this.$el.addClass("disabled"),this.disableSpin=!0,this._disableBtn(this.upBtn,this.model.getUpArrowAccId()),this._disableBtn(this.downBtn,this.model.getDownArrowAccId()),this.$(".spin-textbox").addClass("disabled-spin-box"),this.isEditable&&this.$(".spinner-input-box").attr("disabled","disabled").addClass("disabled-input-box"),this.enableTab(this.model.getTextAccId(),!1),MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile&&(this.$el.find(".spin-down-arrow-touch").unbind("click"),this.$el.find(".spin-up-arrow-touch").unbind("click"))},getSpinBoxSignValue:function(a){return a>=0?"+"+a:a},spinUpArrowClick:function(a){if("disabled"!==this.upBtn.getButtonState()&&(void 0===a||"undefined"==typeof a.which||1===a.which)){var b,c=this.maxValue,d=this.stepValue,e=Number(this.currentValue),f=this.spinSign;if(MathInteractives.global.SpeechStream.stopReading(),this.isEditable&&(this.validateInputValue(this.$(".spinner-input-box").val()),e=Number(this.currentValue)),e>c&&(e=c-1),this._enableBtn(this.downBtn,this.model.getDownArrowAccId()),c>e){if(this.model.get("isStepper")!==!0){var g=Number(e)+Number(d);null!==this.inputPrecision&&(g=g.toFixed(this.inputPrecision),b=String(g).split("."),0===Number(b[1])&&(g=parseInt(g)))}else{var g,h=this.model.get("stepperValues"),i=this.model.get("currentStepperIndex");h[i+1]&&(g=h[i+1],this.model.set("currentStepperIndex",i+1))}this.previousValue=this.currentValue,this.currentValue=f?this.getSpinBoxSignValue(g):g,this.validateInputValue(this.currentValue),this.isEditable&&this.$(".spinner-input-box").val(this.currentValue)}this._setPlaceHolderValue(this.model.getDefaultPlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.PREV_VAL,this.defaultAllPlaceHolderValues,Number(this.previousValue)),this._setPlaceHolderValue(this.model.getDefaultPlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.CURR_VAL,this.defaultAllPlaceHolderValues,Number(this.currentValue)),this._setPlaceHolderValue(this.model.getOnIncreasePlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.PREV_VAL,this.onIncreaseAllPlaceHolderValues,Number(this.previousValue)),this._setPlaceHolderValue(this.model.getOnIncreasePlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.CURR_VAL,this.onIncreaseAllPlaceHolderValues,Number(this.currentValue)),this.setAccMessage(this.model.getTextAccId(),this.model.getOnIncreaseAccText(),this.onIncreaseAllPlaceHolderValues),e==c-d&&(this._disableBtn(this.upBtn,this.model.getUpArrowAccId()),clearInterval(this.btnInterval),this.$el.find(".spin-up-arrow").unbind("click"),this.setAccMessage(this.model.getTextAccId(),this.model.getMaxLimitAccText(),this.maxLimitAllPlaceHolderValues)),this.$el.find(".spin-down-arrow").unbind("click").bind("click",$.proxy(this.spinDownArrowClick,this)),this.trigger(MathInteractives.global.Theme2.CustomSpinner.VALUE_CHANGED,{actionPerformed:MathInteractives.global.Theme2.CustomSpinner.BUTTON_CLICK,buttonType:"spinner-up"}),this.model.setButtonState("active"),this.setFocusOnSpinner()}},spinDownArrowClick:function(a){if("disabled"!==this.downBtn.getButtonState()&&(void 0===a||"undefined"==typeof a.which||1===a.which)){var b,c=this.minValue,d=this.stepValue,e=Number(this.currentValue),f=this.spinSign;if(MathInteractives.global.SpeechStream.stopReading(),this.isEditable&&(this.validateInputValue(this.$(".spinner-input-box").val()),e=Number(this.currentValue)),c>e&&(e=c+1),this._enableBtn(this.upBtn,this.model.getUpArrowAccId()),e>c){if(this.previousValue=this.currentValue,this.model.get("isStepper")!==!0)this.currentValue=f?this.getSpinBoxSignValue(e-d):e-d;else{var g=this.model.get("stepperValues"),h=this.model.get("currentStepperIndex");g[h-1]&&(this.currentValue=g[h-1],this.model.set("currentStepperIndex",h-1))}null!==this.inputPrecision&&(this.currentValue=this.currentValue.toFixed(this.inputPrecision),b=String(this.currentValue).split("."),0===parseInt(b[1])&&(this.currentValue=parseInt(this.currentValue))),this.validateInputValue(this.currentValue),this.isEditable?this.$(".spinner-input-box").val(this.currentValue):this.$(".spin-value").text(this.currentValue)}this._setPlaceHolderValue(this.model.getDefaultPlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.PREV_VAL,this.defaultAllPlaceHolderValues,Number(this.previousValue)),this._setPlaceHolderValue(this.model.getDefaultPlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.CURR_VAL,this.defaultAllPlaceHolderValues,Number(this.currentValue)),this._setPlaceHolderValue(this.model.getOnDecreasePlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.PREV_VAL,this.onDecreaseAllPlaceHolderValues,Number(this.previousValue)),this._setPlaceHolderValue(this.model.getOnDecreasePlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.CURR_VAL,this.onDecreaseAllPlaceHolderValues,Number(this.currentValue)),this.setAccMessage(this.model.getTextAccId(),this.model.getOnDecreaseAccText(),this.onDecreaseAllPlaceHolderValues),e===c+d&&(this._disableBtn(this.downBtn,this.model.getDownArrowAccId()),clearInterval(this.btnInterval),this.$el.find(".spin-down-arrow").unbind("click"),this.setAccMessage(this.model.getTextAccId(),this.model.getMinLimitAccText(),this.minLimitAllPlaceHolderValues)),this.$el.find(".spin-up-arrow").unbind("click").bind("click",$.proxy(this.spinUpArrowClick,this)),this.trigger(MathInteractives.global.Theme2.CustomSpinner.VALUE_CHANGED,{actionPerformed:MathInteractives.global.Theme2.CustomSpinner.BUTTON_CLICK,buttonType:"spinner-down"}),this.model.setButtonState("active"),this.setFocusOnSpinner()}},_enableBtn:function(a,b){a.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE),null!=b&&this.enableTab(b,!0)},_disableBtn:function(a,b){a.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED),null!=b&&this.enableTab(b,!1)},events:{"focusout .spinbox .spinner-input-box":"_spinBoxInputFocusOut","focusin .spinbox .spinner-input-box":"_spinBoxInputFocusIn","keyup .spinbox .spinner-input-box":"_spinBoxInputKeyPress"},_spinBoxInputFocusOut:function(){var a,b=this.$(".spinner-input-box");a=b.val(),""!==a?(a=Number(a),this.spinValue=a,isNaN(a)?this.setAccMessage(this.model.getTextAccId(),this.model.getEmptySpinnerAccText(),this.emptySpinnerPlaceHolderValues):(this._setPlaceHolderValues(this.model.getDefaultPlaceHolders(),this.defaultAllPlaceHolderValues),this.setAccMessage(this.model.getTextAccId(),this.model.getDefaultAccText(),this.defaultAllPlaceHolderValues))):(this.spinValue=null,a=this.spinValue,this.validateInputValue(a),this.setAccMessage(this.model.getTextAccId(),this.model.getEmptySpinnerAccText(),this.emptySpinnerPlaceHolderValues)),this.currentValue=this.spinSign?self.getSpinBoxSignValue(a):a,this.trigger(MathInteractives.global.Theme2.CustomSpinner.VALUE_CHANGED,{actionPerformed:MathInteractives.global.Theme2.CustomSpinner.FOCUS_OUT})},_spinBoxInputFocusIn:function(a){var b=(a.which||a.keyCode,this.$("#"+a.currentTarget.id));this.isFocusedPress=!0,b.val()===this.model.get("defaultText")&&b.val("")},_spinBoxInputKeyPress:function(a){var b=a.which||a.keyCode,c=this.$("#"+a.currentTarget.id),d=c.val();d<=this.minValue?(this._enableBtn(this.upBtn,this.model.getUpArrowAccId()),this.$el.find(".spin-up-arrow").unbind("click").bind("click",$.proxy(this.spinUpArrowClick,this)),this._disableBtn(this.downBtn,this.model.getDownArrowAccId()),this.$el.find(".spin-down-arrow").unbind("click")):d>=this.maxValue?(this._disableBtn(this.upBtn,this.model.getUpArrowAccId()),this.$el.find(".spin-up-arrow").unbind("click"),this._enableBtn(this.downBtn,this.model.getDownArrowAccId()),this.$el.find(".spin-down-arrow").unbind("click").bind("click",$.proxy(this.spinDownArrowClick,this))):(this._enableBtn(this.upBtn,this.model.getUpArrowAccId()),this.$el.find(".spin-up-arrow").unbind("click").bind("click",$.proxy(this.spinUpArrowClick,this)),this._enableBtn(this.downBtn,this.model.getDownArrowAccId()),this.$el.find(".spin-down-arrow").unbind("click").bind("click",$.proxy(this.spinDownArrowClick,this))),this.isFocusedPress&&(this.isFocusedPress=!1,b===$.ui.keyCode.ENTER)||(this.currentValue=this.spinSign?self.getSpinBoxSignValue(d):d,this.trigger(MathInteractives.global.Theme2.CustomSpinner.VALUE_CHANGED,{actionPerformed:MathInteractives.global.Theme2.CustomSpinner.KEY_PRESS,keyCode:b}))},validateInputValue:function(a){var b;null!==this.minValue&&null!==this.maxValue?b=a<this.minValue?this.minValue:a>this.maxValue?this.maxValue:a:null!==this.minValue?b=a<this.minValue?this.minValue:a:null!==this.maxValue&&(b=a>this.maxValue?this.maxValue:a),this.setSpinBoxValue(b)},setFocusOnSpinner:function(){this.setFocus(this.model.getTextAccId(),10)},setEmptySpinnerAcc:function(a,b){null!=a&&this.model.setEmptySpinnerAccText(a),null!=b&&this.model.setEmptySpinnerPlaceHolders(b)},getUpButtonState:function(){return this.upBtn.getButtonState()},getDownButtonState:function(){return this.downBtn.getButtonState()},getModel:function(){return this.model},setDefaultAcc:function(a,b){null!=a&&this.model.setDefaultAccText(a),null!=b&&this.model.setDefaultPlaceHolders(b)},setMinLimitAcc:function(a,b){null!=a&&this.model.setMinLimitAccText(a),null!=b&&this.model.setMinLimitPlaceHolders(b)},setMaxLimitAcc:function(a,b){null!=a&&this.model.setMaxLimitAccText(a),null!=b&&this.model.setMaxLimitPlaceHolders(b)},setOnDecreaseAcc:function(a,b){null!=a&&this.model.setOnDecreaseAccText(a),null!=b&&this.model.setOnDecreasePlaceHolders(b)},setOnIncreaseAcc:function(a,b){null!=a&&this.model.setOnIncreaseAccText(a),null!=b&&this.model.setOnIncreasePlaceHolders(b)},setUpArrowAccText:function(a){null!=a&&this.model.setUpArrowAccText(a)},setDownArrowAccText:function(a){null!=a&&this.model.setDownArrowAccText(a)},hideSpinnerButtons:function(){this.upBtn.hideButton(),this.downBtn.hideButton()},showSpinnerButtons:function(){this.upBtn.showButton(),this.downBtn.showButton()},enableDisableButton:function(a,b){b===!0?a===MathInteractives.global.Theme2.CustomSpinner.DOWN_BTN_INDEX?this.downBtn.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE):this.upBtn.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE):a===MathInteractives.global.Theme2.CustomSpinner.DOWN_BTN_INDEX?this.downBtn.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED):this.upBtn.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED)},setMinValue:function(a,b){var c=this.currentValue;this.model.set("minValue",a),this.minValue=a,null!==b&&void 0!==b?this.setSpinBoxValue(b):a>c?this.setSpinBoxValue(a):this.setSpinBoxValue(c)},setMinMaxValue:function(a,b,c){this.setMinValue(a,c),this.setMaxValue(b,c)},setMaxValue:function(a,b){var c=this.currentValue;this.model.set("maxValue",a),this.maxValue=a,null!==b&&void 0!==b?this.setSpinBoxValue(b):c>a?this.setSpinBoxValue(a):this.setSpinBoxValue(c)}},{generateCustomSpinner:function(a){if(a){var b=new MathInteractives.Common.Components.Theme2.Models.CustomSpinner(a),c=new MathInteractives.Common.Components.Theme2.Views.CustomSpinner({model:b,el:"#"+a.spinId});return c}},VALUE_CHANGED:"value-changed",BUTTON_CLICK:"button-click",FOCUS_OUT:"focus-out",KEY_PRESS:"key-press",DEFAULT_VALUE:"---",CENTER_ALIGN:"center",TOP_ALIGN:"top",LEFT_ALIGN:"left",VERTICAL_ALIGN:"vertical",PREV_VAL:"prev_val",CURR_VAL:"curr_val",MIN_VAL:"min_val",MAX_VAL:"max_val",VERTICAL_LEFT:"vertical-left",VERTICAL_RIGHT:"vertical-right",DOWN_BTN_INDEX:0,UP_BTN_INDEX:1}),MathInteractives.global.Theme2.CustomSpinner=MathInteractives.Common.Components.Theme2.Views.CustomSpinner}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.theme2CustomSpinner=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff<div id="',(g=c.spinBoxId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.spinBoxId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-content-holder" class="spinbox">\r\n  <div id ="',(g=c.spinBoxId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.spinBoxId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"-down-arrow\" class='spin-down-arrow arrowbutton'></div>\r\n  <div id=\"",(g=c.spinBoxId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.spinBoxId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-text"  class="spin-textbox">\r\n    <div id="',(g=c.spinBoxId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.spinBoxId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-value"  class="spin-value"></div>\r\n  </div>\r\n  <div id="',(g=c.spinBoxId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.spinBoxId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"-up-arrow\" class='spin-up-arrow arrowbutton'></div>\r\n</div>"})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.EmptyModal=Backbone.Model.extend({defaults:{player:null,manager:null,filePath:null,idPrefix:null,emptyModalId:null,closeButtonVisible:null,closeButtonTooltipType:null,bodyElemAccId:null,dialogAccText:null},initialize:function(){var a=this.get("idPrefix"),b=this.get("emptyModalId");b.indexOf(a)<0&&(b=a+b,this.set("emptyModalId",b)),null===this.get("closeButtonVisible")&&this.set("closeButtonVisible",!1),null===this.get("closeButtonTooltipType")&&this.set("closeButtonTooltipType",MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.GENERAL),null===this.get("bodyElemAccId")&&this.set("bodyElemAccId",b.replace(this.idPrefix,"")+"-body"),null===this.get("dialogAccText")&&this.set("dialogAccText","")}})}(window.MathInteractives),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.EmptyModal=MathInteractives.Common.Player.Views.Base.extend({closeTooltipView:null,manager:null,idPrefix:null,$emptyModalContainer:null,dialogAccId:null,events:{"click .empty-modal-close-button":"_closeButtonClickHandler"},initialize:function(){var a=this.model;this.player=a.get("player"),this.idPrefix=a.get("idPrefix"),this.manager=a.get("manager"),this.filePath=a.get("filePath"),this.$emptyModalContainer=this.player.$el,this.dialogAccId=a.get("emptyModalId").replace(this.idPrefix,""),this.loadScreen("empty-modal-screen"),this._render(),this._attachEvents()},_attachEvents:function(){var a=this,b=this.model,c=b.get("emptyModalId");this.$("#"+c+"-acc-elem").off("keydown").on("keydown",function(b){var c=9;b.keyCode===c&&b.shiftKey===!1&&(a.setFocus(a.model.get("bodyElemAccId")),b.preventDefault())}),this.$el.off("keydown").on("keydown","#"+this.idPrefix+b.get("bodyElemAccId")+"-acc-elem",function(b){var c=9;b.keyCode===c&&b.shiftKey===!0&&(a.setFocus(a.dialogAccId),b.preventDefault())})},_render:function(){var a=null,b=null,c=this.model,d=c.get("emptyModalId");if(this.$emptyModalContainer.append(MathInteractives.Common.Components.templates.theme2EmptyModal({emptyModalId:d}).trim()),this.$el=this.player.$el.find("#"+d+"-modal"),this.el=this.$el.get(0),a={elementId:this.dialogAccId,tabIndex:10,acc:this.model.get("dialogAccText")},this.createAccDiv(a),this.model.get("closeButtonVisible")){var e={path:this.filePath,manager:this.manager,_player:this.player,idPrefix:this.idPrefix,id:this.idPrefix+"close-tooltip",elementEl:d+"-close-button",text:this.getMessage("empty-modal-close-button-tooltip-text",0),type:c.get("closeButtonTooltipType"),arrowType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE};this.$("#"+d+"-close-button").html("X"),this.closeTooltipView=MathInteractives.global.Theme2.Tooltip.generateTooltip(e),b={elementId:this.dialogAccId+"-close-button",tabIndex:4895,acc:this.getAccMessage("empty-modal-close-button-tooltip-text",0),role:"button"},this.createAccDiv(b)}else this.$("#"+d+"-close-button").remove();this.showEmptyModel()},adjustBounds:function(){var a=this.$emptyModalContainer.width(),b=this.$emptyModalContainer.height(),c=this.$("#"+this.model.get("emptyModalId")),d=parseInt((a-c.width())/2),e=parseInt((b-c.height())/2);c.css("left",d).css("top",e),this.updateFocusRect(this.dialogAccId)},setBody:function(a){this.$("#"+this.model.get("emptyModalId")+"-body").html(a),this.adjustBounds(),this.focusDialogBox()},getBody:function(){return this.$("#"+this.model.get("emptyModalId")+"-body")},setActionPanel:function(a){return this.$("#"+this.model.get("emptyModalId")+"-action-panel").html(a)},getActionPanel:function(){return this.$("#"+this.model.get("emptyModalId")+"-action-panel")},focusDialogBox:function(){this.setFocus(this.dialogAccId)},showEmptyModel:function(){this.player.setModalPresent(!0),this.$el.show(),this.adjustBounds(),this.focusDialogBox()},hideEmptyModel:function(){this.player.setModalPresent(!1),this.$el.hide()},_closeButtonClickHandler:function(a){this.trigger(MathInteractives.global.Theme2.EmptyModal.EVENTS.EMPTY_MODAL_CLOSED),this.$("#"+this.closeTooltipView.elementEl).trigger("mouseleave.tooltip"),this.destroyEmptyModel()},destroyEmptyModel:function(){this.player.setModalPresent(!1),this.remove()}},{EVENTS:{EMPTY_MODAL_CLOSED:"EMPTY_MODAL_CLOSED"},createEmptyModal:function(a){var b=null,c=null;return a&&(b=new MathInteractives.Common.Components.Theme2.Models.EmptyModal(a),c=new MathInteractives.Common.Components.Theme2.Views.EmptyModal({el:"#"+a.emptyModalId+"-modal",model:b})),c}}),MathInteractives.global.Theme2.EmptyModal=MathInteractives.Common.Components.Theme2.Views.EmptyModal}(window.MathInteractives),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.theme2EmptyModal=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff<div id="',(g=c.emptyModalId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.emptyModalId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-modal" class="empty-modal-modal">\r\n  <div id="',(g=c.emptyModalId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.emptyModalId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" class="empty-modal-container">\r\n    <div id="',(g=c.emptyModalId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.emptyModalId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-close-button" class="empty-modal-close-button"></div>\r\n    <div id="',(g=c.emptyModalId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.emptyModalId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-body" class="empty-modal-body"></div>\r\n    <div id="',(g=c.emptyModalId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.emptyModalId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-action-panel" class="empty-modal-action-panel"></div>\r\n  </div>\r\n</div>'})}(),function(){MathInteractives.Common.Components.Theme2.Models.DataTable=Backbone.Model.extend({defaults:{isSuperTable:!1,hasAlternateRowColors:!1,idPrefix:"",idSuffix:null,showRedundantValues:!1,showCurrentRowColor:!0,blinkRedundantRow:!1,changeRedundantRowToCurrent:!1,tableData:null,defaultRowCount:null,defaultColumnCount:null,isTableDisabled:null,tabIndex:-1,enableTableSorting:!1,columnsForCustomSort:null,classForCustomSort:"",customSortingOrder:null,filePath:null,manager:null,player:null,tableScreenId:null,prevElementAccId:null,nextElementAccId:null,headerRowCustomClass:null,headerRowBGPath:null,dataRowCustomClass:null,dataRowBGPath:null,tableBorderClass:null,hasInputBoxInTable:!1,currentHighlightedRow:null,disabledHeaders:null,disabledColumns:null,sortDisabledColumns:null,disabledRows:null,enableTableHeaderClick:null,columnsWithTicks:null,tableTabIndex:null,tableBorderClass:null,hasAccDelay:null,isHeaderAutoWidth:null},initialize:function(){"use strict";var a=MathInteractives.Common.Components.Theme2.Models.DataTable;this.get("tableData")?this.set("tableData",new a.DataRows(this.get("tableData"))):this.set("tableData",new a.DataRows),this.get("lastSortedColumn")?this.set("lastSortedColumn",new a.LastSortedColumn(this.get("lastSortedColumn"))):this.set("lastSortedColumn",new a.LastSortedColumn),this.get("tabIndexElements")?this.set("tabIndexElements",new a.ElementsTabIndex(this.get("tabIndexElements"))):this.set("tabIndexElements",new a.ElementsTabIndex),this.get("hasAccDelay")||this.set("hasAccDelay",!1)},highlightRowNumber:function(a){"use strict";var b=MathInteractives.Common.Components.Theme2.Models.DataTable;this.set("currentHighlightedRow",a),this.trigger(b.Events.HIGHLIGHT_ROW_NUMBER)},scrollToRowNumber:function(a){"use strict";var b=MathInteractives.Common.Components.Theme2.Models.DataTable;this.trigger(b.Events.SCROLL_TO_ROW_NUMBER,a)},addRow:function(a){"use strict";var b=MathInteractives.Common.Components.Theme2.Models.DataTable,c=new b.DataRow(a);this.trigger(b.Events.ADD_ROW,c)},modifyTableRow:function(a,b,c){"use strict";var d,e,f,g,h,i=MathInteractives.Common.Components.Theme2.Models.DataTable,j=this.get("tableData"),k=j.length;if(c){if(k>a)for(g=0;g<j.length;g++)if(h=j.at(g),h.get("originalRowNumber")===a){d=h.get("rowNumber"),a=h.get("originalRowNumber"),f=new MathInteractives.Common.Components.Theme2.Models.DataTable.DataRow(b),f.set("rowNumber",d),f.set("originalRowNumber",a);break}this.trigger(i.Events.MODIFY_TABLE_ROW,{rowModel:f,rowNumber:d})}else k>a&&(d=j.at(a).get("rowNumber"),e=j.at(a).get("originalRowNumber"),f=new MathInteractives.Common.Components.Theme2.Models.DataTable.DataRow(b),f.set("rowNumber",d),f.set("originalRowNumber",e)),this.trigger(i.Events.MODIFY_TABLE_ROW,{rowModel:f,rowNumber:a})},modifyHeaderRow:function(a,b){"use strict";var c,d,e,f=MathInteractives.Common.Components.Theme2.Models.DataTable,g=this.get("tableData"),h=g.length;h>a&&(c=g.at(a).get("rowNumber"),d=g.at(a).get("originalRowNumber"),e=new MathInteractives.Common.Components.Theme2.Models.DataTable.DataRow(b),e.set("rowNumber",c),e.set("originalRowNumber",d)),this.trigger(f.Events.MODIFY_HEADER_ROW,{rowModel:e,rowNumber:a})},showAutoFilledValues:function(){"use strict";var a=MathInteractives.Common.Components.Theme2.Models.DataTable;this.trigger(a.Events.SHOW_AUTO_FILLED_VALUES)},hideAutoFilledValues:function(){"use strict";var a=MathInteractives.Common.Components.Theme2.Models.DataTable;this.trigger(a.Events.HIDE_AUTO_FILLED_VALUES)},enableDisableHeader:function(a,b){"use strict";var c=MathInteractives.Common.Components.Theme2.Models.DataTable,d=this.get("disabledHeaders");(null===d||void 0===d)&&(d=[]),b===!0?-1===$.inArray(a,d)&&d.push(a):d.splice($.inArray(a,d),1),this.set("disabledHeaders",d),this.trigger(c.Events.ENABLE_DISABLE_HEADER,{headerColumnNumber:a,toBeDisabled:b})},enableDisableColumn:function(a,b){"use strict";var c=MathInteractives.Common.Components.Theme2.Models.DataTable,d=this.get("disabledColumns");(null===d||void 0===d)&&(d=[]),b===!0?-1===$.inArray(a,d)&&d.push(a):d.splice($.inArray(a,d),1),this.set("disabledColumns",d),this.trigger(c.Events.ENABLE_DISABLE_COLUMN,{columnNumber:a,toBeDisabled:b})},enableDisableRow:function(a,b,c){"use strict";var d=MathInteractives.Common.Components.Theme2.Models.DataTable,e=this.get("disabledRows"),f=0,g=[],h={};if(h.rowNumber=a,h.cellList=c,(null===e||void 0===e)&&(e=[]),b===!0){for(;f<e.length;f++)g.push(e[f].rowNumber);-1===$.inArray(a,g)&&e.push(h)}else for(;f<e.length;f++)e[f].rowNumber===a&&e.splice(f,1);this.set("disabledRows",e),this.trigger(d.Events.ENABLE_DISABLE_ROW,{rowNumber:a,toBeDisabled:b,cellList:c})},sortColumn:function(a,b){"use strict";var c=MathInteractives.Common.Components.Theme2.Models.DataTable;this.isSortingDisabledOnColumn(a)===!1&&(this.set("lastSortedColumn",new c.LastSortedColumn({columnNumber:a,sortingOrder:b})),this.trigger(c.Events.SORT_COLUMN))},getLastSortedColumn:function(){return this.get("lastSortedColumn")},enableDisableSortingOnColumn:function(a,b){"use strict";var c,d=MathInteractives.Common.Components.Theme2.Models.DataTable,e=this.get("sortDisabledColumns"),f=this.get("defaultColumnCount");for((null===e||void 0===e)&&(e=[]),void 0!==b&&(f=b.length),c=0;f>c;c++)void 0!==b&&null!==b?a===!0?e.splice($.inArray(b[c],e),1):-1===$.inArray(b[c],e)&&e.push(b[c]):a===!0?e=[]:-1===$.inArray(c,e)&&e.push(c);this.set("sortDisabledColumns",e),this.trigger(d.Events.ENABLE_DISABLE_SORT_COLUMN,{enableSorting:a,columnList:b})},enableDisableTableHeaderClicks:function(a){"use strict";var b=MathInteractives.Common.Components.Theme2.Models.DataTable;this.set("enableTableHeaderClick",a),this.trigger(b.Events.ENABLE_DISABLE_TABLE_HEADER_CLICK)},getHighlightedRowIndex:function(){return this.get("currentHighlightedRow")},showHideComparisonTicksInTable:function(a,b){"use strict";var c,d=MathInteractives.Common.Components.Theme2.Models.DataTable,e=this.get("columnsWithTicks");(null===e||void 0===e)&&(e=[]),void 0!==b&&(c=b.length);for(var f=0;c>f;f++)void 0!==b&&(a===!0?-1===$.inArray(b[f],e)&&e.push(b[f]):e.splice($.inArray(b[f],e),1));this.set("columnsWithTicks",e),this.trigger(d.Events.SHOW_HIDE_COMPARISON_TICKS_IN_TABLE,{showTicks:a,columnList:b})},setNextAccElement:function(a){"use strict";var b=MathInteractives.Common.Components.Theme2.Models.DataTable;this.set("nextElementAccId",a),this.trigger(b.Events.SET_NEXT_ACC_ELEMENT)},setPreviousAccElement:function(a){"use strict";var b=MathInteractives.Common.Components.Theme2.Models.DataTable;this.set("prevElementAccId",a),this.trigger(b.Events.SET_PREV_ACC_ELEMENT)},deleteTableRow:function(a,b){var c,d,e,f=MathInteractives.Common.Components.Theme2.Models.DataTable,g=this.get("tableData"),h=g.length;if(b===!0){if(h>a)for(d=0;d<g.length;d++)if(e=g.at(d),e.get("originalRowNumber")===a){c=e.get("rowNumber"),g.remove(g.at(c));break}for(d=0;d<g.length;d++)e=g.at(d),e.get("originalRowNumber")>a&&e.set("originalRowNumber",e.get("originalRowNumber")-1)}else h>a&&g.remove(g.at(a)),c=a;for(d=c;h-1>d;d++)g.models[d].set("rowNumber",d);this.trigger(f.Events.DELETE_TABLE_ROW,{rowNumber:c})},setTableTabIndex:function(a){"use strict";var b=MathInteractives.Common.Components.Theme2.Models.DataTable;this.set("tableTabIndex",a),this.trigger(b.Events.SET_TABLE_TAB_INDEX)},setFocusToTable:function(){"use strict";var a=MathInteractives.Common.Components.Theme2.Models.DataTable;this.trigger(a.Events.SET_FOCUS_TO_TABLE)},resetTableSort:function(){"use strict";var a=MathInteractives.Common.Components.Theme2.Models.DataTable;this.get("lastSortedColumn").set({sortingOrder:null,columnNumber:null}),this.trigger(a.Events.RESET_TABLE_SORT)},addTabIndexToElements:function(a,b,c){"us strict";var d,e=MathInteractives.Common.Components.Theme2.Models.DataTable,f=void 0!==c?c:5,b=(this.get("manager").model.get("startTabindex"),b),g=new e.ElementTabIndex;this.get("tabIndexElements")||this.set("tabIndexElements",new e.ElementsTabIndex),g.set({selectorString:a,startTabIndex:b,tabIndexIncrement:f}),d=this.get("tabIndexElements"),this._isDuplicateTabIndexModel(g)===!1&&d.add(g),this.trigger(e.Events.ADD_TAB_INDEX_TO_ELEMENTS,{selectorString:a,startTabIndex:b,tabIndexIncrement:c})},_isDuplicateTabIndexModel:function(a){"use strict";var b,c,d,e,f,g=this.get("tabIndexElements"),h=a.get("selectorString"),i=a.get("startTabIndex"),j=a.get("tabIndexIncrement");if(null!==g&&void 0!==g&&g.models.length>0)for(f=0;f<g.models.length;f++)if(b=g.models[f],c=b.get("selectorString"),d=b.get("startTabIndex"),e=b.get("tabIndexIncrement"),c===h&&d===i&&e===j)return!0;return!1},isSortingDisabledOnColumn:function(a){"use strict";var b=this.get("sortDisabledColumns");return null!==b&&void 0!==b&&b.length>0&&-1!==$.inArray(a,b)?!0:!1},clearDataFromTable:function(){"use strict";var a,b,c=MathInteractives.Common.Components.Theme2.Models.DataTable,d=this,e=d.get("tableData"),f=e.length,g=new c.DataRows;for(b=0;f>b;b++)a=e.at(b),(a.get("isHeaderRow")===!0||a.get("isSubHeaderRow")===!0||a.get("isTableSectionHeaderRow")===!0)&&g.add(a);for(this.set("tableData",new c.DataRows),this.set("lastSortedColumn",new c.LastSortedColumn),this.set("tabIndexElements",new c.ElementsTabIndex),this.set("currentHighlightedRow",null),this.set("disabledHeaders",null),this.set("disabledColumns",null),this.set("disabledRows",null),this.set("columnsWithTicks",null),e=d.get("tableData"),b=0;b<g.models.length;b++)a=g.at(b),e.add(a);this.trigger(c.Events.CLEAR_DATA_FROM_TABLE)},triggerHeaderClick:function(a){var b=MathInteractives.Common.Components.Theme2.Models.DataTable;this.trigger(b.Events.COLUMN_HEADER_CLICK,{columnIndex:a})},refreshTable:function(){"use strict";var a=MathInteractives.Common.Components.Theme2.Models.DataTable;this.trigger(a.Events.REFRESH_TABLE)},setDefaultRowCount:function(a){"use strict";var b=MathInteractives.Common.Components.Theme2.Models.DataTable;this.set("defaultRowCount",a),this.trigger(b.Events.MODIFY_DEFAULT_ROW_COUNT)}},{DataRow:Backbone.Model.extend({defaults:{isHeaderRow:!1,isSubHeaderRow:!1,isTableSectionHeaderRow:!1,rowData:null,rowNumber:null,originalRowNumber:null,isSeparatorRow:!1,separatorBackgroundImage:null,separatorBackgroundImagePosition:null},initialize:function(){"use strict";var a=MathInteractives.Common.Components.Theme2.Models.DataTable;this.get("isHeaderRow")===!0?this.get("rowData")?this.set("rowData",new a.HeaderCells(this.get("rowData"))):this.set("rowData",new a.HeaderCells):this.get("rowData")?this.set("rowData",new a.DataCells(this.get("rowData"))):this.set("rowData",new a.DataCells)}}),DataRows:Backbone.Collection.extend({model:this.DataRow,initialize:function(){"use strict";this.model=MathInteractives.Common.Components.Theme2.Models.DataTable.DataRow}}),DataCell:Backbone.Model.extend({defaults:{text:null,addBlankData:null,formulaForCalculation:null,showCalculatedValues:!1,compareWithColumns:null,columnNumberForTicks:null,showTicksInThisCell:!1}}),DataCells:Backbone.Collection.extend({model:this.DataCell,initialize:function(){"use strict";this.model=MathInteractives.Common.Components.Theme2.Models.DataTable.DataCell}}),HeaderCell:Backbone.Model.extend({defaults:{text:null,rowSpan:1,colSpan:1,width:100}}),HeaderCells:Backbone.Collection.extend({model:this.HeaderCell,initialize:function(){"use strict";this.model=MathInteractives.Common.Components.Theme2.Models.DataTable.HeaderCell}}),LastSortedColumn:Backbone.Model.extend({defaults:{columnNumber:null,sortingOrder:null}}),ElementTabIndex:Backbone.Model.extend({defaults:{selectorString:null,startTabIndex:null,tabIndexIncrement:null}}),ElementsTabIndex:Backbone.Collection.extend({model:this.ElementTabIndex,initialize:function(){"use strict";this.model=MathInteractives.Common.Components.Theme2.Models.DataTable.ElementTabIndex}}),Events:{HIGHLIGHT_ROW_NUMBER:"highlight-row-number",SCROLL_TO_ROW_NUMBER:"scroll-to-row-number",ADD_ROW:"add-row",SHOW_AUTO_FILLED_VALUES:"show-auto-filled-values",HIDE_AUTO_FILLED_VALUES:"hide-auto-filled-values",ENABLE_DISABLE_HEADER:"enable-disable-header",ENABLE_DISABLE_COLUMN:"enable-disable-column",ENABLE_DISABLE_ROW:"enable-disable-row",SORT_COLUMN:"sort-column",ENABLE_DISABLE_SORT_COLUMN:"enable-disable-sort-column",ENABLE_DISABLE_TABLE_HEADER_CLICK:"enable-disable-table-header-click",SHOW_HIDE_COMPARISON_TICKS_IN_TABLE:"show-hide-comparison-ticks-in-table",SET_NEXT_ACC_ELEMENT:"set-next-acc-element",SET_PREV_ACC_ELEMENT:"set-prev-acc-element",MODIFY_TABLE_ROW:"modify-table-row",MODIFY_HEADER_ROW:"modify-header-row",SET_TABLE_TAB_INDEX:"set-table-tab-index",SET_FOCUS_TO_TABLE:"set-focus-to-table",ADD_TAB_INDEX_TO_ELEMENTS:"add-tab-index-to-elements",CLEAR_DATA_FROM_TABLE:"clear-data-from-table",REFRESH_TABLE:"refresh-table",DELETE_TABLE_ROW:"delete-table-row",TABLE_SORT_COMPLETE:"table-sorting-complete",COLUMN_HEADER_CLICK:"column-header-click",RESET_TABLE_SORT:"reset-table-sort",MODIFY_DEFAULT_ROW_COUNT:"modify-table-default-row"}}),MathInteractives.global.Theme2DataTable={},MathInteractives.global.Theme2DataTable.Model=MathInteractives.Common.Components.Theme2.Models.DataTable}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.DataTable=MathInteractives.Common.Player.Views.Base.extend({manager:null,idPrefix:null,player:null,filePath:null,
_columnCount:null,_previousAccElementId:null,_nextAccElementId:null,_bShiftKeyPressed:!1,_hasAccDelay:null,initialize:function(){this.initializeDefaultProperties(),this._initializeTable()},_initializeTable:function(){this._nextAccElementId=this.model.get("nextElementAccId"),this._previousAccElementId=this.model.get("prevElementAccId"),this._hasAccDelay=this.model.get("hasAccDelay"),this.render(),this._bindEventListeners(),this._populateSavedState()},events:function a(){var a={"click .header-table .tbl-header.sorting-enabled":"_onTableHeaderClick"};return this.player.model.get("isAccessible")&&(a["focusin .body-table"]="_onTableFocusIn",a["focusout .body-table"]="_onTableFocusOut",this.model.get("hasInputBoxInTable")===!0&&(a.keydown="_onTableKeyDown")),a},render:function(){var a,b,c,d=this,e=this.model,f=null,g=null,h=null,i=null,j=null,k=null,l=e.get("tableData").length,m=$("<thead></thead>"),n=$("<tbody></tbody>"),o=0,p=0,q=e.get("idSuffix"),r=e.get("showRedundantValues"),s=e.get("showCurrentRowColor"),t=e.get("blinkRedundantRow"),u=e.get("changeRedundantRowToCurrent"),v=0;for(null!==this.manager&&-1!==e.get("tabIndex")&&(v=this.manager.model.get("startTabindex")),q=null===q||void 0===q?"":"-"+q,a=0;l>a;a++){if(c=new MathInteractives.Common.Components.Theme2.Views.DataRow({model:e.get("tableData").models[a],player:this.player,filePath:this.filePath,idSuffix:q,enableTableSorting:e.get("enableTableSorting"),isHeaderAutoWidth:e.get("isHeaderAutoWidth"),defaultColumnCount:e.get("defaultColumnCount")}),c.model.get("isHeaderRow")===!0||c.model.get("isSubHeaderRow")===!0)m.append(c.el),o++,a==l-1&&(this._columnCount=c.model.get("rowData").length);else{var w,x,y=!1,z=[],A=c.model.get("isSeparatorRow");this._columnCount=c.model.get("rowData").length,$(c.el).find("div").each(function(){z.push($(this).text())}),n.find("tr").each(function(){x=[],$(this).find("div").each(function(){x.push($(this).text())});var a=!0;for(b=0;b<z.length;b++)(z[b]!==x[b]||A===!0)&&(a=!1);a===!0&&(w=$(this).find("td"),y=!0,p++)}),y===!0&&t===!0&&w.each(function(){$(this).addClass("blinkRowColor")}),(y===!0&&r===!0||y===!1)&&n.append(c.el),y===!0&&u===!0&&($(w[0]).parents().find("tr.table-row").find("td").removeClass("current-row currentRowColor"),w.each(function(){$(this).addClass("current-row currentRowColor")})),a===l-1&&($(c.el).parent().find("td").removeClass("current-row"),$(c.el).find("td").addClass("current-row"),s===!0&&($(c.el).parent().find("td").removeClass("currentRowColor"),$(c.el).find("td").addClass("currentRowColor")))}c.model.set("rowNumber",a),$(c.el).find("td,th").addClass("row_"+a),$(c.el).attr("rownumber",a)}if(r===!0&&(p=0),e.get("defaultRowCount")+p>=l){var B=e.get("defaultRowCount")+p-(l-1),C=[];for(a=0;a<e.get("defaultColumnCount");a++)C.push({text:MathInteractives.Common.Components.Theme2.Views.DataCell.defaultTextString});for(a=0;B>a;a++){var c=new MathInteractives.Common.Components.Theme2.Views.DataRow({model:new MathInteractives.Common.Components.Theme2.Models.DataTable.DataRow({isHeaderRow:!1,rowData:C}),emptyRow:!0});n.append(c.el)}}h=$("<table></table>",{id:this.idPrefix+"header-table"+q,"class":"header-table tbl",cellpadding:0,cellspacing:0,border:0,role:"presentation",tabIndex:-1}),j=$("<table></table>",{id:this.idPrefix+"body-table"+q,"class":"body-table tbl tablesorter",cellpadding:0,cellspacing:0,border:0,tabIndex:v+this.model.get("tabIndex")}),k=$("<div></div>",{"class":"table-bottom-border"}),m.appendTo([h,j]),n.appendTo(j),g=$("<div></div>",{id:this.idPrefix+"header-table-holder"+q,"class":"header-table-holder"}).append(h),i=$("<div></div>",{id:this.idPrefix+"body-table-holder"+q,"class":"body-table-holder"}).append(j),f=$("<div></div>",{id:this.idPrefix+"complete-table-holder"+q,"class":"complete-table-holder"}).append(g),f.append(i),f.append(k),$(d.el).html("").append(f),this._refreshDOMElements(),this._disableTableUI(),this._initializeTableSorting(),this.$(".body-table-holder,.header-table-holder").removeAttr("tabindex")},_applyCustomStyles:function(){var a=this.model,b=this.$(".tbl-header,.tbl-sub-header,.tbl-section-header"),c=this.$(".tbl-header-up-arrrow-image,.tbl-header-down-arrrow-image"),d=b.attr("style"),e=this.$(".tbl-cell"),f=this.$(".tbl-cell .table-blank-data"),g=e.attr("style"),h=a.get("headerRowCustomClass"),i=a.get("headerRowBGPath"),j=a.get("dataRowCustomClass"),k=a.get("dataRowBGPath"),l=a.get("tableBorderClass");null!==h&&(b.addClass(h),c.addClass(h)),null!==i&&(d=b.attr("style"),(null===d||void 0===d)&&(d=""),b.attr("style",d+'background-image: url("'+i+'") !important;')),null!==j&&(e.addClass(j),f.addClass(j)),null!==k&&(g=e.attr("style"),(null===g||void 0===g)&&(g=""),e.attr("style",g+'background-image: url("'+k+'") !important;')),null!==l&&this.$(".tbl th, .tbl td, table.tbl, .table-bottom-border").addClass(l),this.$(".body-table").css({"margin-top":-(this.$(".header-table").height()+1)+"px"})},_bindEventListeners:function(){var a=MathInteractives.Common.Components.Theme2.Models.DataTable.Events,b=this.model;this.listenTo(b,a.HIGHLIGHT_ROW_NUMBER,this._highlightRowNumber),this.listenTo(b,a.SCROLL_TO_ROW_NUMBER,this._scrollToRowNumber),this.listenTo(b,a.ADD_ROW,this._addRow),this.listenTo(b,a.SHOW_AUTO_FILLED_VALUES,this._showAutoFilledValues),this.listenTo(b,a.HIDE_AUTO_FILLED_VALUES,this._hideAutoFilledValues),this.listenTo(b,a.ENABLE_DISABLE_HEADER,this._enableDisableHeader),this.listenTo(b,a.ENABLE_DISABLE_COLUMN,this._enableDisableColumn),this.listenTo(b,a.ENABLE_DISABLE_ROW,this._enableDisableRow),this.listenTo(b,a.SORT_COLUMN,this._sortColumn),this.listenTo(b,a.ENABLE_DISABLE_SORT_COLUMN,this._enableDisableSortingOnColumn),this.listenTo(b,a.ENABLE_DISABLE_TABLE_HEADER_CLICK,this._enableDisableTableHeaderClicks),this.listenTo(b,a.SHOW_HIDE_COMPARISON_TICKS_IN_TABLE,this._showHideComparisonTicksInTable),this.listenTo(b,a.SET_NEXT_ACC_ELEMENT,this._setNextAccElement),this.listenTo(b,a.SET_PREV_ACC_ELEMENT,this._setPreviousAccElement),this.listenTo(b,a.MODIFY_TABLE_ROW,this._modifyTableRow),this.listenTo(b,a.MODIFY_HEADER_ROW,this._modifyHeaderRow),this.listenTo(b,a.DELETE_TABLE_ROW,this._deleteTableRow),this.listenTo(b,a.SET_TABLE_TAB_INDEX,this._setTableTabIndex),this.listenTo(b,a.SET_FOCUS_TO_TABLE,this._setFocusToTable),this.listenTo(b,a.ADD_TAB_INDEX_TO_ELEMENTS,this._addTabIndexToElements),this.listenTo(b,a.CLEAR_DATA_FROM_TABLE,this._renderModifiedTable),this.listenTo(b,a.REFRESH_TABLE,this._refreshTable),this.listenTo(b,a.COLUMN_HEADER_CLICK,this._triggerHeaderClick),this.listenTo(b,a.RESET_TABLE_SORT,this._resetTableSort),this.listenTo(b,a.MODIFY_DEFAULT_ROW_COUNT,this._updateTableWithNewRowCount)},_populateSavedState:function(){var a,b,c,d,e,f,g,h,i=this.model,j=i.get("currentHighlightedRow"),k=i.get("disabledHeaders"),l=i.get("disabledColumns"),m=i.get("disabledRows"),n=i.get("lastSortedColumn"),o=i.get("sortDisabledColumns"),p=i.get("enableTableHeaderClick"),q=i.get("columnsWithTicks"),r=i.get("nextElementAccId"),s=i.get("prevElementAccId"),t=i.get("tableTabIndex"),u=i.get("tabIndexElements");if(i.get("showCurrentRowColor")===!0&&null!==j&&i.highlightRowNumber(j),null!==k&&void 0!==k&&k.length>0)for(h=0;h<k.length;h++)i.enableDisableHeader(k[h],!0);if(null!==l&&void 0!==l&&l.length>0)for(h=0;h<l.length;h++)i.enableDisableColumn(l[h],!0);if(null!==m&&void 0!==m)for(h=0;h<m.length;h++)i.enableDisableRow(m[h].rowNumber,!0,m[h].cellList);if(null!==p&&void 0!==p&&i.enableDisableTableHeaderClicks(p),null!==o&&void 0!==o&&o.length>0&&i.enableDisableSortingOnColumn(!1,o),null!==n&&void 0!==n&&(a=n.get("columnNumber"),b=n.get("sortingOrder"),null!==a&&void 0!==a&&(g=0===b?"Asc":"Desc",this.$(".body-table thead .col_"+a).addClass("tablesorter-header"+g),i.sortColumn(a,b))),null!==q&&void 0!==q&&q.length>0&&i.showHideComparisonTicksInTable(!0,q),null!==r&&void 0!==r&&i.setNextAccElement(r),null!==s&&void 0!==s&&i.setPreviousAccElement(s),null!==t&&void 0!==t&&i.setTableTabIndex(t),null!==u&&void 0!==u&&u.models.length>0)for(h=0;h<u.models.length;h++)f=u.models[h],c=f.get("selectorString"),d=f.get("startTabIndex"),e=f.get("tabIndexIncrement"),null!==d&&void 0!==d&&i.addTabIndexToElements(c,d,e)},_initializeTableSorting:function(){var a,b,c,d,e=this.model,f=e.get("columnsForCustomSort"),g=MathInteractives.Common.Components.Theme2.Models.DataTable.Events,h=this,i={};if(e.get("enableTableSorting")===!0){for(a=0;a<this._columnCount;a++)c=function(a,b,c){return d=$(a).find(".table-blank-data"),d.length>0?d.is(":visible")?"":void 0:$(a).text()},i[a]=c;if(null!==f)for(this._setCoordinateSortValues(),b=e.get("classForCustomSort"),c=function(a,c,d){return $(a).find("."+b).text()},a=0;a<f.length;a++)i[f[a]]=c;for(this.$(".body-table").tablesorter({textExtraction:i}),this.$(".body-table .tbl-header").removeAttr("tabindex"),this.$(".body-table").off("sortEnd").on("sortEnd",function(a){h._rearrangeTableData(),h.model.trigger(g.TABLE_SORT_COMPLETE)}),a=0;a<this._columnCount;a++)this.$(".body-table")[0].config.headers[a]={sorter:!0};e.get("enableTableHeaderClick")===!0&&this._enableDisableTableHeaderClicks()}},_highlightRowNumber:function(){var a=this.model.get("currentHighlightedRow");this.$(".currentRowColor").removeClass("currentRowColor"),this.$(".current-row").removeClass("current-row"),$(this.$(".body-table-holder tbody").find("tr").get(a-1)).find("td").addClass("current-row currentRowColor"),this.$(".current-row").position()&&(this.$(".body-table-holder").scrollTop(0),this.$(".body-table-holder").scrollTop(this.$(".current-row").position().top-this.$(".body-table-holder").height()+this.$(".current-row").height()))},_scrollToRowNumber:function(a){var b=this.$(".body-table-holder"),c=this.$(".body-table-holder tbody"),d=$(c.find("tr").get(a-1)),e=null,f=0,g=0;d&&(e=d.parent(),f=d.position().top,g=e.position().top),b.scrollTop(0),b.scrollTop(f-g)},_addRow:function(a){var b=this.$(".body-table-holder"),c=this.$(".complete-table-holder"),d=new MathInteractives.Common.Components.Theme2.Views.DataRow({model:a,defaultColumnCount:this.model.get("defaultColumnCount"),filePath:this.filePath});this._checkDuplicateNAddRow(this,d),this._setCoordinateSortValues(),b[0].scrollHeight>b[0].offsetHeight&&c.css({width:$(this.el).width()+"px"})},_checkDuplicateNAddRow:function(a,b){for(var c,d=1,e=a.$("tbody"),f=0,g=a.model.get("showRedundantValues"),h=a.model.get("showCurrentRowColor"),i=a.model.get("blinkRedundantRow"),j=a.model.get("changeRedundantRowToCurrent"),k=0;d>k;k++){var l,m,n=!1,o=[],p=b.model.get("isSeparatorRow");$(b.el).find("div").each(function(){o.push($(this).text())}),e.find("tr").each(function(){m=[],$(this).find("div").each(function(){m.push($(this).text())});for(var a=!0,b=0;b<o.length;b++)(o[b]!==m[b]||p===!0)&&(a=!1);a===!0&&(l=$(this).find("td"),n=!0,f++)}),n===!0&&i===!0&&l.each(function(){$(this).addClass("blinkRowColor")}),(n===!0&&g===!0||n===!1)&&(a.$(".empty-row").length>0?(a.$(".empty-row:first").before($(b.el)),a.$(".empty-row:last").remove()):a.$(".body-table  tbody").append($(b.el)),c=e.find("tr").length-a.$(".empty-row").length,b.model.set("rowNumber",c),b.model.set("originalRowNumber",c),a.model.get("tableData").add(b.model),$(b.el).find("td,th").addClass("row_"+c),$(b.el).attr("rowNumber",c)),n===!0&&j===!0&&($(l[0]).parents().find("tr.table-row").find("td").removeClass("current-row"),l.each(function(){$(this).addClass("current-row")}),h===!0&&($(l[0]).parents().find("tr.table-row").find("td").removeClass("currentRowColor"),l.each(function(){$(this).addClass("currentRowColor")}),this.model.highlightRowNumber($(l).parent().attr("rownumber")))),k===d-1&&($(b.el).parent().find("td").removeClass("current-row"),$(b.el).find("td").addClass("current-row"),h===!0&&($(b.el).parent().find("td").removeClass("currentRowColor"),$(b.el).find("td").addClass("currentRowColor"),(n===!1||n===!0&&g===!0)&&this.model.highlightRowNumber($(b.el).attr("rownumber")))),null!==this.model.get("tableBorderClass")&&$(b.el).find("td").addClass(this.model.get("tableBorderClass")),null!==this.model.get("dataRowCustomClass")&&($(b.el).find("td").addClass(this.model.get("dataRowCustomClass")),this.$(".tbl-cell .table-blank-data").addClass(this.model.get("dataRowCustomClass")))}g===!0&&(f=0),a.$(".current-row").position()&&(a.$(".body-table-holder").scrollTop(0),a.$(".body-table-holder").scrollTop(a.$(".current-row").position().top))},_disableTableUI:function(){var a,b=this.$(".header-table").height(),c=this.$(".body-table-holder"),d=this.$(".header-table-holder");this.model.get("isTableDisabled")===!0&&(a=$("<div></div>",{"class":"tableMask"}),this._addImportantToStyle(a,{height:c.height()+b+2+"px",width:c.width()+"px"}),c.append(a),d.find("table").addClass("disabled"))},_addTabIndexToElements:function(a){var b,c=a.selectorString,d=a.startTabIndex,e=a.tabIndexIncrement,f=void 0!==e?e:5,g=this.manager.model.get("startTabindex");this.$(c).each(function(a){b=g+d+a*f,$(this).attr("tabindex",b).addClass("hack-div")})},_showAutoFilledValues:function(){this.$(".hide-autofill-data+.table-blank-data").hide(),this.$(".hide-autofill-data").removeClass("hide-autofill-data").addClass("show-autofill-data")},_hideAutoFilledValues:function(){this.$(".show-autofill-data+.table-blank-data").show(),this.$(".show-autofill-data").removeClass("show-autofill-data").addClass("hide-autofill-data")},_enableDisableHeader:function(a){var b=a.headerColumnNumber,c=a.toBeDisabled;b>=0&&b<this._columnCount&&(c?this.$(".header-table-holder thead .col_"+b).addClass("table-header-disabled"):this.$(".header-table-holder thead .col_"+b).removeClass("table-header-disabled"))},_enableDisableColumn:function(a){var b=a.columnNumber,c=a.toBeDisabled;b>=0&&b<this._columnCount&&(c?this.$(".body-table-holder tbody .col_"+b).addClass("table-column-disabled"):this.$(".body-table-holder tbody .col_"+b).removeClass("table-column-disabled"))},_enableDisableRow:function(a){var b=a.rowNumber,c=a.toBeDisabled,d=a.cellList,e=0;if(b>=0&&b<this.model.get("tableData").models.length)if(c)if(null!==d&&void 0!==d)for(;e<d.length;e++)this.$(".body-table-holder tbody .tbl-cell.row_"+b+".col_"+d[e]).addClass("table-row-disabled");else this.$(".body-table-holder tbody .tbl-cell.row_"+b).addClass("table-row-disabled");else if(null!==d&&void 0!==d)for(;e<d.length;e++)this.$(".body-table-holder tbody .tbl-cell.row_"+b+".col_"+d[e]).removeClass("table-row-disabled");else this.$(".body-table-holder tbody .tbl-cell.row_"+b).removeClass("table-row-disabled")},_onTableHeaderClick:function(a){if(this.model.get("enableTableSorting")!==!0)return!1;var b,c,d,e=$(a.currentTarget),f=null;if(e.hasClass("tbl-header")||(e=$(a.currentTarget).parents(".tbl-header")),b=e.attr("class").split(" ")[1],b=Number(b.substr("col_".length)),null!==this.model.get("customSortingOrder")&&(c=this.model.get("customSortingOrder"),void 0!==c[b])){d=c[b],f=[];for(var g=0;g<d.length;g++)f.push([d[g],0])}this.$(".body-table")[0].config.sortForce=f,this.model.sortColumn(b,this._getSortOrderForColumn(b)),this._scrollToRowNumber(1),this._setFocusToTable()},_triggerHeaderClick:function(a){var b=a.columnIndex,c=this.$(".tbl-header.sorting-enabled.row_0.col_"+b);c.length>0&&(c[0].click(),this._setFocusToTable())},_getSortOrderForColumn:function(a){var b=0;return a>=0&&a<this._columnCount&&(b=this.$(".body-table thead .col_"+a).hasClass("tablesorter-headerAsc")?1:0),b},_sortColumn:function(){var a,b=this.model.get("lastSortedColumn"),c=b.get("columnNumber"),d=b.get("sortingOrder"),e=0;c>=0&&c<this._columnCount&&(e=void 0!==d?d:this.$(".body-table thead .col_"+c).hasClass("tablesorter-headerAsc")?1:0,b.set("sortingOrder",e),a=0===e?"asc":"desc",this.$(".body-table")[0].config.headers[c].sorter!==!1&&(this.$(".body-table").trigger("update"),this.$(".body-table").trigger("sorton",[[[c,e]]]),this.$(".header-table thead .tbl-sort-asc").removeClass("tbl-sort-asc"),this.$(".header-table thead .tbl-sort-desc").removeClass("tbl-sort-desc"),this.$(".header-table thead .col_"+c).addClass("tbl-sort-"+a)))},_enableDisableSortingOnColumn:function(a){var b,c=this._columnCount,d={},e=a.enableSorting,f=a.columnList;for(void 0!==f&&(c=f.length),b=0;c>b;b++)void 0!==f&&null!==f?(d[f[b]]={sorter:e},this.$(".body-table")[0].config.headers[f[b]]=d[f[b]],e?$(this.$(".header-table .tbl-header")[f[b]]).addClass("sorting-enabled").removeClass("sorting-disabled"):$(this.$(".header-table .tbl-header")[f[b]]).addClass("sorting-disabled").removeClass("sorting-enabled")):(d[b]={sorter:e},this.$(".body-table")[0].config.headers[b]=d[b],e?$(this.$(".header-table .tbl-header")[b]).addClass("sorting-enabled").removeClass("sorting-disabled"):$(this.$(".header-table .tbl-header")[b]).addClass("sorting-disabled").removeClass("sorting-enabled"));this.$(".body-table").trigger("update")},_enableDisableTableHeaderClicks:function(){var a=this.model.get("enableTableHeaderClick");a?this.$(".header-table .tbl-header").addClass("sorting-enabled").removeClass("sorting-disabled"):this.$(".header-table .tbl-header").addClass("sorting-disabled").removeClass("sorting-enabled")},_resetTableSort:function(){this.$(".body-table thead .tablesorter-headerAsc").removeClass("tablesorter-headerAsc"),this.$(".body-table thead .tablesorter-headerDesc").removeClass("tablesorter-headerDesc"),this.$(".header-table thead .tbl-sort-asc").removeClass("tbl-sort-asc"),this.$(".header-table thead .tbl-sort-desc").removeClass("tbl-sort-desc")},_updateTableWithNewRowCount:function(){var a,b,c,d,e=this.$("tbody"),f=this.$(".body-table .table-row"),g=f.length,h=this.$(".body-table .empty-row"),i=h.length,j=this.model.get("defaultRowCount"),k=[];if(g>j&&i>0)for(a=j>=g-i?g-j:i+1,b=g,c=a;c>0;c--)this.model.deleteTableRow(b),b--;else if(j>=g){for(d=j-(g-1),c=0;c<this.model.get("defaultColumnCount");c++)k.push({text:MathInteractives.Common.Components.Theme2.Views.DataCell.defaultTextString});for(c=0;d>c;c++){var l=new MathInteractives.Common.Components.Theme2.Views.DataRow({model:new MathInteractives.Common.Components.Theme2.Models.DataTable.DataRow({isHeaderRow:!1,rowData:k}),emptyRow:!0});e.append(l.el)}this._refreshDOMElements()}},_rearrangeTableData:function(){var a,b,c=[],d=this.model.get("tableData"),e=[];for(this.$("tbody tr.empty-bottom").each(function(){c.push(Number($(this).attr("rownumber")))}),a=0;a<c.length;a++)for(b=0;b<d.length;b++)if(c[a]==d.models[b].get("rowNumber")){e.push(this.model.get("tableData").models[b]);break}for(a=0;a<e.length;a++)$($(this.$(".body-table tbody")).find("tr")[a]).attr("rownumber",a+1),e[a].set("rowNumber",a+1),d.models[a+1]=e[a];this.model.set("tableData",d),this.model.get("showCurrentRowColor")===!0&&this.model.highlightRowNumber($(this.$(".current-row")[0]).parent().attr("rownumber"))},_showHideComparisonTicksInTable:function(a){var b,c=a.showTicks,d=a.columnList;if(void 0!==d&&d.length>0)for(b=0;b<d.length;b++)c?this.$(".body-table .col_"+d[b]+" .comparison-result").removeClass("hide-autofill-data"):this.$(".body-table .col_"+d[b]+" .comparison-result").addClass("hide-autofill-data");else c?this.$(".body-table .comparison-result").removeClass("hide-autofill-data"):this.$(".body-table .comparison-result").addClass("hide-autofill-data")},_addImportantToStyle:function(a,b){var c,d,e;a.each(function(){c=$(this),d=c.attr("style"),("undefined"==typeof d||null===d)&&(d="");for(e in b)d+=e+":"+b[e]+" !important;";c.attr("style",d)})},_onTableFocusIn:function(){if(!this.player.model.get("isAccessible"))return!1;var a=this,b=MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile;a.player._enableDisableApplicationMode(!1),b||a.$(".complete-table-holder").addClass("on-focus-in")},_onTableFocusOut:function(a){if(!this.player.model.get("isAccessible"))return!1;a.preventDefault(),a.stopImmediatePropagation(),a.stopPropagation();var b=this,c=this.manager._checkElementExistsByAccId(this.idPrefix+this._nextAccElementId),d=this.manager._checkElementExistsByAccId(this.idPrefix+this._previousAccElementId),e=MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile,f=0;this._hasAccDelay===!0&&(f=10),e||(b.$(".complete-table-holder").removeClass("on-focus-in"),b.player._enableDisableApplicationMode(!0)),b.model.get("hasInputBoxInTable")||(b._bShiftKeyPressed?d?b.setFocus(b._previousAccElementId,f):$("#"+b.idPrefix+b._previousAccElementId).focus():c?b.setFocus(b._nextAccElementId,f):$("#"+b.idPrefix+b._nextAccElementId).focus())},_onTableKeyDown:function(a){if(!this.player.model.get("isAccessible")||this.model.get("hasInputBoxInTable"))return!1;a.preventDefault(),a.stopImmediatePropagation(),a.stopPropagation();var b=a.which||a.keyCode,c=this.$(".body-table-holder"),d=this,e=this.manager._checkElementExistsByAccId(this.idPrefix+this._nextAccElementId),f=this.manager._checkElementExistsByAccId(this.idPrefix+this._previousAccElementId),g=0;switch(this._hasAccDelay===!0&&(g=10),d._bShiftKeyPressed=!1,b){case 9:return a.shiftKey?setTimeout(function(){d._bShiftKeyPressed=!0,f?d.setFocus(d._previousAccElementId,g):$("#"+d.idPrefix+d._previousAccElementId).focus()},10):setTimeout(function(){d._bShiftKeyPressed=!1,e?d.setFocus(d._nextAccElementId,g):$("#"+d.idPrefix+d._nextAccElementId).focus()},10),!1;case 38:c.scrollTop(c.scrollTop()-20);break;case 40:c.scrollTop(c.scrollTop()+20);break;case 16:d._bShiftKeyPressed=!0}},_setPreviousAccElement:function(){var a=this;this._previousAccElementId=this.model.get("prevElementAccId"),this.$(".body-table").off("focusout").on("focusout",function(b){a._onTableFocusOut(b)}),this.$el.off("keydown").on("keydown",function(b){a._onTableKeyDown(b)})},_setNextAccElement:function(){var a=this;this._nextAccElementId=this.model.get("nextElementAccId"),this.$(".body-table").off("focusout").on("focusout",function(b){a._onTableFocusOut(b)}),this.$el.off("keydown").on("keydown",function(b){a._onTableKeyDown(b)})},_modifyTableRow:function(a){var b,c,d=this.model,e=a.rowModel,f=a.rowNumber;b=new MathInteractives.Common.Components.Theme2.Views.DataRow({model:e,defaultColumnCount:d.get("defaultColumnCount"),filePath:this.filePath}),$(b.el).attr("rownumber",e.get("rowNumber")),d.get("tableData").remove(d.get("tableData").at(f)),d.get("tableData").add(e,{at:f}),c=$(this.$(".body-table tbody").find("tr")[f-1]),c.before($(b.el)),c.remove(),this.$(".current-row").removeClass("current-row"),$(b.el).find("td").addClass("current-row"),d.get("showCurrentRowColor")===!0&&d.highlightRowNumber(f),this._refreshDOMElements(),this._setCoordinateSortValues()},_modifyHeaderRow:function(a){var b,c,d=this.model,e=a.rowModel,f=a.rowNumber;b=new MathInteractives.Common.Components.Theme2.Views.DataRow({model:e,defaultColumnCount:d.get("defaultColumnCount"),filePath:this.filePath}),$(b.el).attr("rownumber",e.get("rowNumber")),d.get("tableData").remove(d.get("tableData").at(f)),d.get("tableData").add(e,{at:f}),c=$(this.$(".header-table thead").find("tr")[f]),c.before($(b.el)),c.remove(),c=$(this.$(".body-table thead").find("tr")[f]),c.before($(b.el)),c.remove(),this._refreshDOMElements()},_setCoordinateSortValues:function(){var a,b,c,d,e,f=this.model.get("columnsForCustomSort"),g=[],h=[],i=[];if(null!==f&&void 0!==f)for(d=0;d<f.length;d++)if(a=this.$("td.col_"+f[d]+" .tbl-data .coordinate-sort"),b=this.$("td.col_"+f[d]+" ."+this.model.get("classForCustomSort")),g=[],h=[],i=[],a.length>0){for(a.each(function(){c=$(this).text().replace("(","").replace(")","").split(","),g.push(parseInt(c[0],10)),h.push(parseInt(c[1],10))}),e=0;e<g.length;e++)g.indexOf(g[e])===g.lastIndexOf(g[e])?i.push(g[e]):i.push(g[e]+h[e]/100);b.each(function(a){$(this).text(i[a])})}},_loadTableScreen:function(){var a=this.model.get("tableScreenId");null!==a&&void 0!==a&&""!==a&&(this.unloadScreen(a),this.loadScreen(a))},isThisRowVisible:function(a){var b=this.$(".body-table-holder"),c=b.offset().top,d=c+b.height(),e=this.$(this.$(".body-table-holder tr").get(a)),f=e.offset().top,g=f+e.height();return g>=c&&d>=f&&d>=g&&f>=c},_setTableTabIndex:function(){var a=0,b=this.model.get("tableTabIndex");null!==this.manager&&-1!==b&&(a=this.manager.model.get("startTabindex")),this.$(".body-table").attr("tabindex",a+b)},_setFocusToTable:function(){this.$(".body-table").focus()},_deleteTableRow:function(a){var b,c,d,e,f,g,h=this.model,i=a.rowNumber,j=this.$("tbody"),k=[];if(b=$(this.$(".body-table tbody").find("tr")[i-1]),b.remove(),d=this.$("tbody tr:not(.empty-row)"),e=this.$("tbody .table-row"),e.length<h.get("defaultRowCount")){for(c=h.get("defaultRowCount")-e.length,g=0;g<h.get("defaultColumnCount");g++)k.push({text:MathInteractives.Common.Components.Theme2.Views.DataCell.defaultTextString});for(g=0;c>g;g++)f=new MathInteractives.Common.Components.Theme2.Views.DataRow({model:new MathInteractives.Common.Components.Theme2.Models.DataTable.DataRow({isHeaderRow:!1,rowData:k}),emptyRow:!0}),j.append(f.el)}for(g=0;g<d.length;g++)$(d[g]).attr("rownumber",g+1);this._refreshDOMElements(),h.get("showCurrentRowColor")===!0&&d.length>=1&&h.highlightRowNumber(i)},_renderModifiedTable:function(a){this.render(),this._populateSavedState()},_refreshDOMElements:function(){var a,b=MathInteractives.Common.Components.Theme2.Views.DataTable,c=$(this.el).width()-b.SCROLL_BAR_WIDTH,d=this.$(".body-table-holder"),e=this.$(".complete-table-holder"),f=this.$(".tbl-header,.tbl-sub-header,.tbl-section-header"),g=this.$(".header-table").height(),h=this.$(".current-row"),i=b.HEADER_LINE_HEIGHT,j=b.SORT_NOTATION_HEIGHT;this._applyCustomStyles(),this._addImportantToStyle(this.$(".header-table, .body-table"),{width:c+"px"}),this._addImportantToStyle(this.$(".table-bottom-border"),{width:c+"px"}),d[0].scrollHeight>d[0].offsetHeight?e.css({width:$(this.el).width()+"px"}):e.css({width:c+"px"}),this.$(".body-table").css({"margin-top":-(g+1)+"px"}),h.position()?d.scrollTop(Math.abs(h.parents("tbody").position().top)+(h.position().top+h.height())-d.height()):d.scrollTop(0),this.model.get("enableTableSorting")===!0&&f.each(function(){$(this).find(".tbl-header-text").height()>i&&(a=Math.floor($(this).find(".tbl-header-text").height()/2)-j/2,$(this).find(".tbl-header-sort-container").css({"margin-top":a+"px"}))}),this.$(".complete-table-holder").removeClass("on-focus-in")},_refreshTable:function(){this._refreshDOMElements()},changeModel:function(a){return this.model=a,this._initializeTable(),this.model}},{SCROLL_BAR_WIDTH:17,HEADER_LINE_HEIGHT:18,SORT_NOTATION_HEIGHT:14}),MathInteractives.Common.Components.Theme2.Views.DataRow=MathInteractives.Common.Player.Views.Base.extend({tagName:"tr",className:function(){return this.options.emptyRow===!0?"table-row empty-row":"table-row empty-bottom"},initialize:function(){this.render()},render:function(){var a=this,b=this.model.get("rowData").length,c="",d=a.model.get("isSeparatorRow");if(d){var e="tbl-separator",f=new MathInteractives.Common.Components.Theme2.Models.DataTable.DataCell,g=a.model.get("separatorBackgroundImage"),h=a.model.get("separatorBackgroundImagePosition");f.set({colSpan:this.options.defaultColumnCount,text:" ",addBlankData:!1});var i=new MathInteractives.Common.Components.Theme2.Views.DataCell({model:f,tagName:"td",className:e+" col_0",parent:this,cellNumber:j,player:this.options.player});c+=i.el,$(this.el).append(i.el).addClass("tbl-separator-row"),null!==g&&void 0!==g&&($(this.el).css({"background-image":'url("'+this.options.filePath.getImagePath(g)+'")'}),null!==h&&void 0!==h&&$(this.el).css({"background-position":h.x+" "+h.y}))}else for(var j=0;b>j;j++){var k=a.model.get("isHeaderRow"),l=a.model.get("isSubHeaderRow"),m=a.model.get("isTableSectionHeaderRow");if(k||l){var e="tbl-header";l&&(e="tbl-sub-header");var i=new MathInteractives.Common.Components.Theme2.Views.DataCell({model:a.model.get("rowData").models[j],tagName:"th",className:e+" col_"+j,parent:this,cellNumber:j,player:this.options.player,idSuffix:this.options.idSuffix,enableTableSorting:this.options.enableTableSorting,isHeaderAutoWidth:this.options.isHeaderAutoWidth})}else{var e="tbl-cell";m&&(e="tbl-section-header");var i=new MathInteractives.Common.Components.Theme2.Views.DataCell({model:a.model.get("rowData").models[j],tagName:"td",className:e+" col_"+j,parent:this,cellNumber:j,player:this.options.player})}c+=i.el,$(this.el).append(i.el)}return this}}),MathInteractives.Common.Components.Theme2.Views.DataCell=MathInteractives.Common.Player.Views.Base.extend({initialize:function(){this.render()},render:function(){var a,b,c,d=this.model.get("text"),e=d,f=MathInteractives.Common.Components.Theme2.Views.DataCell,g=this.model.get("formulaForCalculation"),h=!1,i="hide-autofill-data",j=this.model.get("compareWithColumns"),k="",l=this.model.get("showTicksInThisCell"),m=l?"":"hide-autofill-data",n=this.model.get("columnNumberForTicks"),o="",p=this.options.parent,q=this.options.cellNumber,r=this.options.player,s=this.options.enableTableSorting,t=this.options.isHeaderAutoWidth,u=""===this.options.idSuffix?"-":this.options.idSuffix+"-",v=MathInteractives.Common.Player.Views.Player;if(null!==this.model.get("colSpan")&&$(this.el).attr("colspan",this.model.get("colSpan")),null!==this.model.get("rowSpan")&&$(this.el).attr("rowspan",this.model.get("rowSpan")),null!==g&&void 0!==g&&(this.model.get("showCalculatedValues")&&(h=!0,i=""),d="<span class="+i+">"+this._getFormulaResult(g,p)+"</span>"),h===!1&&(""!==e&&null!==e||this.model.get("addBlankData")===!1?this.model.get("addBlankData")===!0?d+=f.defaultTextString:null===this.model.get("addBlankData")&&this.isCellDataBlank(e)===!0&&(d+=f.defaultTextString):d+=f.defaultTextString),null!==j&&void 0!==j&&j.length>0)for(b=0;b<j.length;b++)d==p.model.get("rowData").models[j[b]].get("text")?(k+=" equal-to-col-"+j[b],o='<span class="'+m+' comparison-correct comparison-result"></span>'):o='<span class="'+m+' comparison-incorrect comparison-result"></span>';return null!==n&&void 0!==n&&n!==q?($(this.el).html('<div class="tbl-data'+k+'">'+d+"</div>"),p.model.get("rowData").models[n].set("hasTick",!0),p.model.get("rowData").models[n].set("tickHtmlStructure",o)):(this.model.get("hasTick")===!0&&(o=this.model.get("tickHtmlStructure")),void 0!==r&&null!==r&&(a=r.getPlayerThemeType(),"th"===this.options.tagName&&a===v.THEMES.THEME_2&&s===!0&&(c=MathInteractives.Common.Components.templates.tableSortNotation({columnID:r.getIDPrefix()+"tbl-sort-notation"+u+q}).trim(),t===!0&&(k+=" auto-width"),d='<div class="tbl-header-text">'+d+"</div>",d+=c)),$(this.el).html('<div class="tbl-data'+k+'">'+d+o+"</div>")),this.model.get("showTicksInThisCell")&&$(this.el).find(".comparison-result").removeClass("hide-autofill-data"),this.$(".comparison-result").length>0&&(null!==this.filePath&&void 0!==this.filePath?this.$(".comparison-result").css({"background-image":"url("+this.filePath.getImagePath("table-tick-and-cross")+")"}):alert("Please specify filePath for table")),this},isCellDataBlank:function(a){var b=!0;return $("<div></div>",{"class":"data-table-cell-data-container-dummy"}).append(a).appendTo("body"),""!==$(".data-table-cell-data-container-dummy").text().trim()||$(".data-table-cell-data-container-dummy input").length>0?b=!1:$(".data-table-cell-data-container-dummy").children().each(function(){if($(this).hasClass("table-blank-data"))return b=!1,!1;if("img"===$(this).prop("tagName").toLowerCase()){if("none"!==$(this).css("display")&&void 0!==$(this).attr("src"))return b=!1,!1}else{if(""!==$(this).text().trim())return b=!1,!1;if("none"!==$(this).css("display")&&"none"!==$(this).css("background-image"))return b=!1,!1}}),$(".data-table-cell-data-container-dummy").remove(),b},_getFormulaResult:function _getFormulaResult(formulaString,rowView){var result=this._generateFormulaString(formulaString,rowView);try{result=eval(result)}catch(error){}return result},_generateFormulaString:function(a,b){function c(a){return-1!==a.indexOf("col")&&(d=a.indexOf("col")+3,h.push(parseInt(a.charAt(d),10)),a=f._setCharacterAt(a,d,""),a=a.replace("col",g)),a}var d,e=a,f=this,g=MathInteractives.Common.Components.Theme2.Views.DataCell.placeHolderInFormula,h=[];do e=c(e);while(-1!=e.indexOf("col"));return e=this._insertDataIntoFormula(e,h,b,g);
},_setCharacterAt:function(a,b,c){return a.substr(0,b)+c+a.substr(b+1)},_insertDataIntoFormula:function(a,b,c,d){var e,f;for(e=0;e<b.length;e++)f=c.model.get("rowData").models[b[e]].get("text"),a=a.replace(d,f);return a}},{defaultTextString:'<span class="typography-label table-blank-data" >&#8211; &#8211; &#8211;</span>',placeHolderInFormula:"DataPlaceHolder"}),MathInteractives.global.Theme2DataTable.View=MathInteractives.Common.Components.Theme2.Views.DataTable}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.tableSortNotation=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff<div id="',(g=c.columnID)?f=g.call(b,{hash:{},data:e}):(g=b&&b.columnID,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" class="tbl-header-sort-container">\r\n	<div class="tbl-header-up-arrow-container">\r\n		<div class="tbl-header-up-arrrow-image"></div>\r\n	</div>\r\n	<div class="tbl-header-down-arrow-container">\r\n		<div class="tbl-header-down-arrrow-image"></div>\r\n	</div>\r\n</div>'})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.DirectionText=Backbone.Model.extend({defaults:function(){return{id:"",text:null,backgroundColor:null,textColor:null,containerWidth:null,containerHeight:null,borderColor:null,accText:null,elementEl:null,player:null,idPrefix:null,showButton:null,buttonText:null,clickCallback:null,containerId:null,screenId:null,containmentBGcolor:"rgba(34,34,34,.2)",btnColorType:MathInteractives.global.Theme2.Button.COLORTYPE.BLUE,btnBaseClass:void 0,ttsBaseClass:void 0,tabIndex:null,buttonHeight:null,customClass:null,buttonType:null,iconData:null,buttonTextPosition:null}}})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.DirectionText=MathInteractives.Common.Player.Views.Base.extend({player:null,idPrefix:null,baseClass:null,manager:null,filePath:null,text:null,backgroundColor:null,textColor:null,containerWidth:null,containerHeight:null,borderColor:null,accText:null,ttsSize:25,clickCallback:null,containerId:null,screenId:null,btnColorType:null,btnTextColor:null,btnBaseClass:void 0,ttsBaseClass:void 0,tryAnotherView:null,ttsView:null,tabIndex:null,padding:10,fadeDuration:600,bAnimateDirectionText:!0,$dirText:null,directionTextHolderWidth:null,buttonType:null,iconData:null,buttonTextPosition:null,initialize:function(){this.player=this.model.get("player"),this.idPrefix=this.model.get("idPrefix"),this.containerId=this.model.get("containerId"),this.manager=this.model.get("manager"),this.filePath=this.model.get("path"),this.text=this.model.get("text"),this.accText=this.model.get("accText"),this.showButton=this.model.get("showButton"),this.buttonText=this.model.get("buttonText"),this.textColor=this.model.get("textColor"),this.clickCallback=this.model.get("clickCallback"),this.screenId=this.model.get("screenId"),this.containmentBGcolor=this.model.get("containmentBGcolor"),this.btnColorType=this.model.get("btnColorType"),this.btnTextColor=this.model.get("btnTextColor"),this.btnBaseClass=this.model.get("btnBaseClass"),this.ttsBaseClass=this.model.get("ttsBaseClass"),this.ttsColorType=this.model.get("ttsColorType"),this.tabIndex=this.model.get("tabIndex"),this.buttonTabIndex=this.model.get("buttonTabIndex"),this.buttonAccText=this.model.get("buttonAccText"),this.buttonHeight=this.model.get("buttonHeight"),this.buttonType=this.model.get("buttonType")||MathInteractives.global.Theme2.Button.TYPE.TEXT,this.iconData=this.model.get("iconData"),this.buttonTextPosition=this.model.get("buttonTextPosition"),this.render()},render:function(){this.$dirText=this.$el;var a,b=MathInteractives.Common.Components.templates.directionText({idPrefix:this.containerId}).trim(),c=this.containerId.replace(this.idPrefix,""),d=this.model.get("customClass");if(this.$dirText.append(b),this.showButton){var e={idPrefix:this.containerId,player:this.player,manager:this.manager,path:this.filePath,data:{id:this.containerId+"-direction-text-buttonholder",text:this.buttonText,type:this.buttonType,colorType:this.btnColorType,baseClass:this.btnBaseClass,textColor:this.btnTextColor}};null!==this.buttonHeight&&(e.data.height=this.buttonHeight),null!==this.buttonTextPosition&&(e.data.textPosition=this.buttonTextPosition),null!==this.iconData&&(e.data.icon=this.iconData),this.tryAnotherView=new MathInteractives.global.Theme2.Button.generateButton(e),a={elementId:c+"-direction-text-buttonholder",tabIndex:this.buttonTabIndex,uniqueId:this.idPrefix,role:"button",offsetTop:5,offsetLeft:5,acc:this.buttonAccText?this.buttonAccText:this.buttonText},this.manager.createAccDiv(a),this.$el.off("click").on("click",".direction-text-buttonHolder.clickEnabled",null,$.proxy(this.clickCallback.fnc,this.clickCallback.scope))}var f={containerId:this.containerId+"-direction-text-ttsholder",isEnabled:!1,tabIndex:20,manager:this.manager,ttsBaseClass:this.ttsBaseClass,ttsColor:this.ttsColorType,player:this.player,filePath:this.filePath,idPrefix:this.idPrefix,messagesToPlay:[this.containerId+"-direction-text-textholder"]};this.ttsView=MathInteractives.global.Theme2.PlayerTTS.generateTTS(f),a={elementId:c+"-direction-text-text",tabIndex:this.tabIndex,uniqueId:this.idPrefix,loc:this.text,acc:this.accText?this.accText:this.text},this.$(".direction-text-containment").css({"background-color":this.containmentBGcolor}),this.$(".direction-text-textHolder").css({color:this.textColor}),this._adjustMarginsForText(),d||(d="direction-text-textHolder");var g=this.player.getTextHeightWidth(this.text,d,"max-width:"+this.directionTextHolderWidth+"px"),h={height:g.height+"px",width:g.width+"px"},i=this;$.swap(this.$(".direction-text-text")[0],h,function(){i.manager.createAccDiv(a)}),this.renderDirectionTextTTSAccessibility()},disableTTS:function(a){this.ttsView.disableTTS(a)},changeButtonState:function(a){this.tryAnotherView.setButtonState(a)},changeDirectionText:function(a,b,c){var d=this;d.text=a,d.accText=c,void 0===b&&(b=this.bAnimateDirectionText),b?this.$el.fadeOut(d.fadeDuration/2,function(){d.$el.css("visibility","hidden"),d.$el.css("display","block"),d._changeDirectionTextContent(a,c),d.$el.css("display","none"),d.$el.css("visibility","visible"),d.$el.fadeIn(d.fadeDuration/2)}):d._changeDirectionTextContent(a,c)},_changeDirectionTextContent:function(a,b){var c=this;c.$(".direction-text-containment").addClass("zeroHeight");var d=c.containerId+"-direction-text-text";d=d.replace(c.idPrefix,""),c.setMessage(d,a),c.setAccMessage(d,b?b:a),c._adjustMarginsForText(),c.$(".direction-text-containment").removeClass("zeroHeight")},_adjustMarginsForText:function(){var a,b=this,c=MathInteractives.global.Theme2.DirectionText,d=(c.CONTAINER_HEIGHT,c.CONTAINER_WIDTH),e=b.$(".direction-text-ttsHolder"),f=(e.height(),e.width()),g=parseInt(e.css("margin-left").replace("px",""),10)+parseInt(e.css("margin-right").replace("px",""),10),h=0,i=0,j=(parseInt(e.css("margin-left").replace("px","")),this.$(".direction-text-textHolder"),b.model.get("customClass"));j?this.$(".direction-text-textHolder").addClass(j):j="direction-text-textHolder",b.showButton?(h=b.$el.find(".direction-text-buttonHolder").width(),i=parseInt(b.$(".direction-text-buttonHolder").css("margin-left").replace("px",""),10)+parseInt(b.$(".direction-text-buttonHolder").css("margin-right").replace("px",""),10),a=d-h-i-f-g-15):a=d-f-g,this.$(".direction-text-textHolder").css({"max-width":a+"px"}),this.$(".text-tts-cont").css({width:d-h-i,height:78})},renderDirectionTextTTSAccessibility:function(){var a=this.containerId.replace(this.idPrefix,"")+"-direction-text-text";this.containerId.replace(this.idPrefix,"")+"-direction-text-ttsholder";this.ttsView.renderTTSAccessibility(this.getTabIndex(a)+2)}},{generateDirectionText:function(a){var b="#"+a.containerId,c=new MathInteractives.Common.Components.Theme2.Models.DirectionText(a),d=new MathInteractives.Common.Components.Theme2.Views.DirectionText({el:b,model:c});return d},CONTAINER_HEIGHT:78,CONTAINER_WIDTH:908}),MathInteractives.global.Theme2.DirectionText=MathInteractives.Common.Components.Theme2.Views.DirectionText}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.directionText=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff<div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-direction-text-containment" class="direction-text-containment">\r\n  <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-direction-text-text-tts-cont" class="text-tts-cont">\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-direction-text-inner-text-tts-cont" class="inner-text-tts-cont">\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-direction-text-textholder" class="direction-text-textHolder">\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-direction-text-text" class ="direction-text-text"></div>\r\n      </div>\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-direction-text-ttsholder" class="direction-text-ttsHolder"></div>\r\n    </div>\r\n  </div>\r\n  <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-direction-text-buttonholder" class="direction-text-buttonHolder"></div>\r\n</div>'})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.Theme2PopUp=Backbone.Model.extend({defaults:function(){return{title:null,accTitle:null,text:null,accText:null,containsTts:!0,buttons:[],closeCallback:null,showCallback:null,backgroundImage:null,backgroundImageBackgroundPosition:null,foregroundImage:null,foregroundImageBackgroundPosition:null,bodyTextColorClass:null,titleTextColorClass:null,width:null,type:null,score:null,scoreDisplayChild:null,imageOnForegroundId:null,imagePositionOnForeground:{left:null,top:null},imageOnForegroundSpritePosition:{left:null,top:null},textOnForegroundImg:null,imageOnForegroundDimension:{height:null,width:null},tooltipColorType:MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.GENERAL}}})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.Theme2PopUp=MathInteractives.Common.Player.Views.Base.extend({manager:null,player:null,_path:null,_text:null,_title:null,btnViewRef:[],cancelBtnViewRef:null,popupViewRef:null,staticData:null,popUpType:null,_btnWidth:0,scoreDisplayChild:null,imageOnForegroundId:null,imagePositionOnForeground:null,imageOnForegroundSpritePosition:null,initialize:function(){var a=this.model;if(this.manager=a.get("manager"),this.player=a.get("player"),this._path=a.get("path"),this.idPrefix=a.get("idPrefix"),!this.player.getModalPresent()||!this._isSamePopupPresent()){this.unloadScreen("theme2-pop-up-box"),this.loadScreen("theme2-pop-up-box"),this.staticData=MathInteractives.global.Theme2.PopUpBox,this.popUpType=a.get("type"),this.scoreDisplayChild=a.get("scoreDisplayChild"),this.imageOnForegroundId=a.get("imageOnForegroundId"),this.imagePositionOnForeground=a.get("imagePositionOnForeground"),this.imageOnForegroundSpritePosition=a.get("imageOnForegroundSpritePosition"),this.textOnForegroundImg=a.get("textOnForegroundImg"),this.imageOnForegroundDimension=a.get("imageOnForegroundDimension"),this.render(),null===this.popUpType||this.popUpType===this.staticData.SCOREBOARD||this.popUpType===this.staticData.NEWSCOREBOARD?(this.setFocus("theme2-pop-up-title-text-combined-acc"),this.$(".pause-tts-container,.play-tts-container,.sound-tts-container").on("keydown",$.proxy(this._setFocusToPopupTextOnShiftTab,this)),null===this.popUpType?this.$(".theme2-pop-up-title-text-combined-acc-defaultType").on("keydown",$.proxy(this._setFocusOnTTsOnTab,this)):this.popUpType===this.staticData.SCOREBOARD?this.$(".theme2-pop-up-title-text-combined-acc-"+this.popUpType).on("keydown",$.proxy(this._setFocusOnTTsOnTab,this)):this.popUpType===this.staticData.NEWSCOREBOARD&&this.$(".theme2-pop-up-title-text-combined-acc-"+this.popUpType).on("keydown",$.proxy(this._setFocusOnTTsOnTab,this))):(this.setFocus("theme2-pop-up-title-text"),this.$(".theme2-pop-up-title-text").on("keydown",$.proxy(this._setFocusToPopupTextOnTab,this)),this.$(".theme2-pop-up-text").on("keydown",$.proxy(this._setFocusToPopupTitleOnShiftTab,this)));var b=this.model.get("showCallback");b&&b.fnc.apply(b.scope||this)}},_isSamePopupPresent:function(){for(var a,b=this.player.$el.find(".theme2-pop-up-modal"),c=0;c<b.length;c++)if(a=b[0].id,a===this.idPrefix+"theme2-pop-up-modal")return!0;return!1},_setFocusToPopupTextOnShiftTab:function(a){var b=this._isEventTabOrShiftTab(a);b.shiftTabKey===!0&&(a.preventDefault(),this.setFocus("theme2-pop-up-title-text-combined-acc"))},_setFocusOnTTsOnTab:function(a){var b=this._isEventTabOrShiftTab(a);b.tabKey===!0&&(a.preventDefault(),"none"!==this.$(".sound-tts-container").css("display")?this.setFocus("theme2-pop-up-tts-container-sound-btn"):"none"!==this.$(".play-tts-container").css("display")?this.setFocus("theme2-pop-up-tts-container-play-btn"):this.setFocus("theme2-pop-up-tts-container-pause-btn"))},_setFocusToPopupTitleOnShiftTab:function(a){var b=this._isEventTabOrShiftTab(a);b.shiftTabKey===!0&&(a.preventDefault(),this.setFocus("theme2-pop-up-title-text"))},_setFocusToPopupTextOnTab:function(a){var b=this._isEventTabOrShiftTab(a);b.tabKey===!0&&(a.preventDefault(),this.setFocus("theme2-pop-up-text"))},_isEventTabOrShiftTab:function(a){var b=a?a.which:a.keyCode,c={shiftTabKey:!1,tabKey:!1};return 9===b&&("undefined"!=typeof a.shiftKey&&a.shiftKey===!0&&(c.shiftTabKey=!0),a.shiftKey!==!0&&(c.tabKey=!0)),c},render:function(){var a=this.model,b=a.get("accText"),c=a.get("accTitle"),d=a.get("bodyTextColorClass"),e=a.get("titleTextColorClass"),f=a.get("width"),g=a.get("type"),h=this.staticData,i=this,j=null,k=null,l=a.get("score");if(i.keyDown={},this._text=a.get("text"),this._title=a.get("title"),this.generatePopup(),g===h.SCOREBOARD)this.$(".theme2-pop-up-score-display").css({height:"53px",width:"119px"}),this.$(".theme2-pop-up-score-display").addClass("scorecard-display-container"),this.$(".theme2-pop-up-score-display-text").text(l),this.$(".theme2-pop-up-dialogue").addClass("scoreboard-class"),this.$(".theme2-pop-up-title-text").addClass("scoreboard-title-text-class"),this.$(".theme2-pop-up-title").addClass("scoreboard-title"),this.$(".theme2-pop-up-text").addClass("scoreboard-text"),this.$(".theme2-pop-up-body").addClass("scoreboard-body");else if(g===h.NEWSCOREBOARD){this.$(".theme2-pop-up-score-display").css({"margin-left":"3px"}),this.$(".theme2-pop-up-score-display-text").text(l),this.$(".theme2-pop-up-score-display-text").addClass("new-scorecard-score-display-text-size"),this.$(".theme2-pop-up-dialogue").addClass("new-scoreboard-class"),this.$(".theme2-pop-up-title-text").addClass("new-scoreboard-title-text-class"),this.$(".theme2-pop-up-title").addClass("new-scoreboard-title"),this.$(".theme2-pop-up-text").addClass("new-scoreboard-text"),this.$(".theme2-pop-up-body").addClass("new-scoreboard-body"),this.$(".theme2-pop-up-score-display-parent").addClass("theme2-pop-up-new-sorecard"),this.$(".theme2-pop-up-readable-text-region").addClass("new-scorecard-padding");var m=$("<div>",{id:this.idPrefix+"new-scoreboard-high-score-img","class":"new-scoreboard-high-score-img"});if(this.$(".theme2-pop-up-dialogue").append(m),null!==this.imageOnForegroundId&&null!==this.imageOnForegroundDimension&&(this.$("#"+this.idPrefix+"new-scoreboard-high-score-img").css({"background-image":'url("'+this._path.getImagePath(this.imageOnForegroundId)+'")'}),this.$("#"+this.idPrefix+"new-scoreboard-high-score-img").css({height:this.imageOnForegroundDimension.height+"px",width:this.imageOnForegroundDimension.width+"px"})),null!==this.imageOnForegroundSpritePosition&&this.$("#"+this.idPrefix+"new-scoreboard-high-score-img").css({"background-position":this.imageOnForegroundSpritePosition.left+"px "+this.imageOnForegroundSpritePosition.top+"px"}),null!==this.imagePositionOnForeground?this.$("#"+this.idPrefix+"new-scoreboard-high-score-img").css({left:this.imagePositionOnForeground.left+"px",top:this.imagePositionOnForeground.top+"px"}):this.$("#"+this.idPrefix+"new-scoreboard-high-score-img").css({left:"0px",top:"0px"}),null!==this.textOnForegroundImg){var n=$("<div>",{id:this.idPrefix+"text-On-Foreground-Img-format","class":"text-On-Foreground-Img-format"});this.$(".new-scoreboard-high-score-img").append(n),this.$("#"+this.idPrefix+"text-On-Foreground-Img-format").text(this.textOnForegroundImg)}}else g===h.CONFIRM;if(f&&this.$(".theme2-pop-up-dialogue").css("width",f),d&&this.$(".theme2-pop-up-text").addClass(d),e&&this.$(".theme2-pop-up-title-text").addClass(e),this.player.setModalPresent(!0),null!==g&&g!==h.SCOREBOARD&&g!==h.NEWSCOREBOARD){this.loadScreen("theme2-popup-title");var o={elementId:"theme2-pop-up-title-text",tabIndex:5,offsetTop:-4,loc:"",acc:c?c+" "+this.getAccMessage("text-to-append-to-pop-up-title",0):this._title+" "+this.getAccMessage("text-to-append-to-pop-up-title",0)},p={elementId:"theme2-pop-up-text",tabIndex:4910,loc:"",acc:b?b:this._text};this.createAccDiv(o),this.createAccDiv(p)}this.generateButtons(),this.positionSetter(),null===g&&(this._calculateDefaultPopupHackDivHeight(),j=c?c+" ":this._title+" ",j+=b?b:this._text,k={elementId:"theme2-pop-up-title-text-combined-acc",tabIndex:5,offsetLeft:-2,acc:j},this.createAccDiv(k)),g===h.NEWSCOREBOARD&&(this._calculateDefaultPopupHackDivHeightForNewScoreboard(),j=b?b+" ":this._text+" ",j+=c?c:this._title,k={elementId:"theme2-pop-up-title-text-combined-acc",tabIndex:5,acc:j},this.createAccDiv(k)),g===h.SCOREBOARD&&(this._calculateDefaultPopupHackDivHeightForScoreboard(),j=b?b+" ":this._text+" ",j+=c?c:this._title,k={elementId:"theme2-pop-up-title-text-combined-acc",tabIndex:5,acc:j},this.createAccDiv(k))},_calculateDefaultPopupHackDivHeightForNewScoreboard:function(){var a=4,b=this.$(".theme2-pop-up-title-text").outerHeight()+this.$(".theme2-pop-up-text").outerHeight()+this.$(".theme2-pop-up-score-display-parent.theme2-pop-up-new-sorecard").outerHeight()+Number(this.$(".theme2-pop-up-body").css("padding-top").replace("px",""))+Number(this.$(".theme2-pop-up-title").css("margin-bottom").replace("px",""))+a,c=this.$(".theme2-pop-up-title").css("margin-top");this.$(".theme2-pop-up-title-text-combined-acc-new-scoreboard").css({height:b+"px",top:c})},_calculateDefaultPopupHackDivHeightForScoreboard:function(){var a=4,b=this.$(".theme2-pop-up-title-text").outerHeight()+this.$(".theme2-pop-up-text").outerHeight()+this.$(".theme2-pop-up-score-display-parent").outerHeight()+Number(this.$(".theme2-pop-up-body").css("padding-top").replace("px",""))+Number(this.$(".theme2-pop-up-title").css("margin-bottom").replace("px",""))+a,c=this.$(".theme2-pop-up-title").css("margin-top");this.$(".theme2-pop-up-title-text-combined-acc-scoreboard").css({height:b+"px",top:c})},_calculateDefaultPopupHackDivHeight:function(){var a=this.$(".theme2-pop-up-title-text").outerHeight()+this.$(".theme2-pop-up-text").outerHeight()+Number(this.$(".theme2-pop-up-body").css("padding-top").replace("px","")),b=this.$(".theme2-pop-up-title").css("margin-top");this.$(".theme2-pop-up-title-text-combined-acc-defaultType").css({height:a+"px",top:b})},positionSetter:function(){var a=this.$(".theme2-pop-up-dialogue").width();this._btnWidth+100>a&&this.$(".theme2-pop-up-dialogue").width(this._btnWidth+100);var b,c,d,e,f=this.$(".theme2-pop-up-modal").height()+44,g=this.$(".theme2-pop-up-modal").width(),h=this.$(".theme2-pop-up-dialogue").height(),a=this.$(".theme2-pop-up-dialogue").width(),i=this.model.get("backgroundImage"),j=this.model.get("backgroundImageBackgroundPosition"),k=this.model.get("foregroundImage"),l=this.model.get("foregroundImageBackgroundPosition");if(i){var m=i.imageHeight,n=i.imageWidth;this.$("#"+this.idPrefix+"theme2-pop-up-background-image").css({"background-image":'url("'+this._path.getImagePath(i.imageId)+'")'}),(null!==j||void 0!==j)&&this.$("#"+this.idPrefix+"theme2-pop-up-background-image").css({"background-position":j}),b=this.$(".theme2-pop-up-background"),b.height(m),b.width(n),b.css({top:f/2-m/2,left:g/2-n/2})}k&&(d=k.imageHeight,e=k.imageWidth,this.$("#"+this.idPrefix+"theme2-pop-up-foreground-image").css({"background-image":'url("'+this._path.getImagePath(k.imageId)+'")'}),(null!==l||void 0!==l)&&this.$("#"+this.idPrefix+"theme2-pop-up-foreground-image").css({"background-position":l}),c=this.$(".theme2-pop-up-foreground"),c.height(d),c.width(e),c.css({left:-1*(g/2-a/2),top:-1*(f/2-h/2-44)})),this.$(".theme2-pop-up-dialogue").css({top:f/2-h/2,left:g/2-a/2}),this.$(".scoreboard-body").css({"padding-left":a/2-this.$(".scoreboard-body").width()/2}),this.$(".theme2-pop-up-tts-container").css({left:a-34})},adjustBackgroundImgPos:function(a){var b=this.model.get("backgroundImage"),c=this.$(".theme2-pop-up-background"),d=this.$(".theme2-pop-up-dialogue"),e=parseFloat(d.css("top"),10),f=parseFloat(d.css("left"),10),g=d.width(),h=d.height(),i=this.$(".theme2-pop-up-modal"),j=b.imageHeight,k=b.imageWidth,l=i.height(),m=44,n=i.width();null!==a&&("undefined"!=typeof a.left&&(f-a.left>0?c.css("left",f-a.left):c.css("left",0)),"undefined"!=typeof a.top&&(e-a.top>m?c.css("top",e-a.top):c.css("top",m)),"undefined"!=typeof a.right&&(f+g+a.right<n?c.css("left",f+(g-k)+a.right):c.css("left",n-k)),"undefined"!=typeof a.bottom&&(e+h+a.bottom<l+m?c.css("top",e+(h-j)+a.bottom):c.css("top",l+m-j)))},generatePopup:function(){var a={popupTitle:this._title,popupText:this._text,idPrefix:this.idPrefix},b=this.popUpType;null===b?a.type="defaultType":a.type=b,null!==this.scoreDisplayChild?a.scoreDisplayChild=this.scoreDisplayChild:a.scoreDisplayChild="",this.$el.append(MathInteractives.Common.Components.templates.theme2PopUpBox(a).trim());var c=this.player.$el;c.append(this.el);var d=this.model.get("width"),e=null,f=MathInteractives.global.Theme2.PopUpBox,g=this.model.get("height");if(d)this.$(".theme2-pop-up-dialogue").width(parseFloat(d)),null===b&&this.$("#"+this.idPrefix+"theme2-pop-up-text").width(d-f.PADDING);else if(null===b){var h=this.$("#"+this.idPrefix+"theme2-pop-up-text"),i=f.DEFAULTWIDTH;e=h.width(),i>e&&h.width(i)}g&&this.$(".theme2-pop-up-dialogue").height(parseFloat(g))},generateButtons:function(){var a=null,b=10,c=this.getTabIndex("theme2-pop-up-text")+b;if(this.model.get("containsTts")){var d={containerId:this.idPrefix+"theme2-pop-up-tts-container",isEnabled:!1,tabIndex:c,manager:this.manager,idPrefix:this.idPrefix,player:this.player,filePath:this._path,messagesToPlay:[this.idPrefix+"theme2-pop-up-readable-text-region"],tooltipColorType:this.model.get("tooltipColorType")?this.model.get("tooltipColorType"):MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.GENERAL_WHITE};this.popupViewRef=MathInteractives.global.Theme2.PlayerTTS.generateTTS(d),this.popupViewRef.renderTTSAccessibility(c)}var e=this.$("#"+this.idPrefix+"theme2-pop-up-btns-aligner"),f=this.model.get("buttons"),g=f.length;if(b+=20,g>0)for(var h=0;g>h;h++){var i=$("<div>",{id:this.idPrefix+f[h].id,"class":"theme2-pop-up-bottom-btn"});e.append(i),a={elementId:f[h].id,tabIndex:this.getTabIndex("theme2-pop-up-text")+b,role:"button",offsetTop:5,offsetLeft:5,acc:f[h].accText||f[h].text},b+=5;var j={idPrefix:this.idPrefix,player:this.player,manager:this.manager,path:this._path,data:{id:this.idPrefix+f[h].id,type:f[h].type?f[h].type:MathInteractives.global.Theme2.Button.TYPE.TEXT,colorType:f[h].colorType?f[h].colorType:MathInteractives.global.Theme2.Button.COLORTYPE.BLUE,text:f[h].text?f[h].text:this.getMessage(f[h].id+"-text",0),btnWidthGroup:"pop-up-buttons",textColor:f[h].textColor,baseClass:f[h].baseClass,icon:f[h].icon?f[h].icon:null,textPosition:f[h].textPosition?f[h].textPosition:null,width:f[h].width?f[h].width:null}};this.model.get("buttonTextColor")&&(j.data.textColor=this.model.get("buttonTextColor")),null!==f[h].height&&"undefined"!=typeof f[h].height&&(j.data.height=f[h].height);var k=MathInteractives.global.Theme2.Button.generateButton(j);this.btnViewRef[h]=k,this.popUpType===MathInteractives.global.Theme2.PopUpBox.CONFIRM?(this._btnWidth+=$(k.el).width()+22,this.$el.find(".theme2-pop-up-bottom-btn").css({"margin-right":"11px","margin-left":"11px"})):(this._btnWidth+=$(k.el).width()+18,this.$el.find(".theme2-pop-up-bottom-btn").css({"margin-right":"9px","margin-left":"9px"})),this.createAccDiv(a),i.on("click",{currentButton:f[h]},$.proxy(this._bottomBtnClickHandler,this))}else{var i=$("<div>",{id:this.idPrefix+"pop-up-ok-btn","class":"theme2-pop-up-bottom-btn"});e.append(i);var j={idPrefix:this.idPrefix,player:this.player,manager:this.manager,path:this._path,data:{id:this.idPrefix+"pop-up-ok-btn",type:MathInteractives.global.Theme2.Button.TYPE.TEXT,colorType:MathInteractives.global.Theme2.Button.COLORTYPE.BLUE,text:this.getMessage("theme2-pop-up-ok-btn-text",0),btnWidthGroup:"pop-up-buttons"}};this.model.get("buttonTextColor")&&(j.data.textColor=this.model.get("buttonTextColor"));var k=MathInteractives.global.Theme2.Button.generateButton(j);this.btnViewRef[h]=k,this.popUpType===MathInteractives.global.Theme2.PopUpBox.CONFIRM?(this._btnWidth+=$(k.el).width()+22,this.$el.find(".theme2-pop-up-bottom-btn").css({"margin-right":"11px","margin-left":"11px"})):(this._btnWidth+=$(k.el).width()+18,this.$el.find(".theme2-pop-up-bottom-btn").css({"margin-right":"9px","margin-left":"9px"})),a={elementId:"pop-up-ok-btn",tabIndex:this.getTabIndex("theme2-pop-up-text")+b,role:"button",acc:this.getMessage("theme2-pop-up-ok-btn-text",0)},b+=5,this.createAccDiv(a),i.on("click",{currentButton:j.data},$.proxy(this._bottomBtnClickHandler,this))}this.$(e).width(this._btnWidth+"px")},_bottomBtnClickHandler:function(a){var b=a.data.currentButton,c=b.id.replace(this.idPrefix,"");MathInteractives.global.SpeechStream.stopReading(),b.clickCallBack&&b.clickCallBack.fnc.apply(b.clickCallBack.scope||this,[a]);var d={isPositive:!1,buttonClicked:c};b.response&&(d.isPositive=b.response.isPositive,d.buttonClicked=b.response.buttonClicked),this._triggerCallback(d.isPositive,d.buttonClicked)},_triggerCallback:function(a,b){MathInteractives.global.SpeechStream.stopReading(),this._removePopup();var c=this.model.get("closeCallback"),d={};d.isPositive=a,d.buttonClicked=b,c&&c.fnc.apply(c.scope||this,[d])},_hideContainers:function(){var a=this,b=this.idPrefix;a.$el;this.$("#"+b+"theme2-pop-up-header-btns").hide(),this.$("#"+b+"theme2-pop-up-score-display").hide()},_removePopup:function(){this.$el.off("keydown.popupAccessibility"),this.remove(),this.player.setModalPresent(!1)}},{createPopup:function(a){if(a){var b=new MathInteractives.Common.Components.Theme2.Models.Theme2PopUp(a),c=new MathInteractives.Common.Components.Theme2.Views.Theme2PopUp({model:b});return c}},SCOREBOARD:"scoreboard",CONFIRM:"confirm",NEWSCOREBOARD:"new-scoreboard",DEFAULTWIDTH:380,PADDING:40}),MathInteractives.global.Theme2.PopUpBox=MathInteractives.Common.Components.Theme2.Views.Theme2PopUp}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.theme2PopUpBox=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff<div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-modal" class="theme2-pop-up-modal theme2-pop-up-modal-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-background-image" class="theme2-pop-up-background theme2-pop-up-background-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n    </div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-dialogue" class="theme2-pop-up-dialogue theme2-pop-up-dialogue-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-foreground-image" class="theme2-pop-up-foreground theme2-pop-up-foreground-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n        </div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-header-btns" class="theme2-pop-up-header-btns-cont theme2-pop-up-header-btns-cont-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-tts-container" class="theme2-pop-up-tts-container theme2-pop-up-tts-container-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'"></div>\r\n        </div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-readable-text-region" class="theme2-pop-up-readable-text-region">\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-title-bar" class="theme2-pop-up-title-bar theme2-pop-up-title-bar-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n                <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-title" class="theme2-pop-up-title theme2-pop-up-title-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n                    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-title-text" class="theme2-pop-up-title-text theme2-pop-up-title-text-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">',(g=c.popupTitle)?f=g.call(b,{hash:{},data:e}):(g=b&&b.popupTitle,f=typeof g===i?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(h+=f),h+='</div>\r\n                </div>\r\n            </div>\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-score-display-parent" class="theme2-pop-up-score-display-parent">',(g=c.scoreDisplayChild)?f=g.call(b,{hash:{},data:e}):(g=b&&b.scoreDisplayChild,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'\r\n                <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-score-display" class="theme2-pop-up-score-display theme2-pop-up-score-display-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{
hash:{},data:e}):g),h+=j(f)+'">\r\n                    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-score-display-text" class="theme2-pop-up-score-display-text theme2-pop-up-score-display-text-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-body" class="theme2-pop-up-body theme2-pop-up-body-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n                <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-text" class="theme2-pop-up-text theme2-pop-up-text-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n                    ',(g=c.popupText)?f=g.call(b,{hash:{},data:e}):(g=b&&b.popupText,f=typeof g===i?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(h+=f),h+='\r\n                </div>\r\n                <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-text-ie9-focusout-fix" class="theme2-pop-up-text-ie9-focusout-fix theme2-pop-up-text-ie9-focusout-fix-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'"></div>\r\n            </div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-title-text-combined-acc" class="theme2-pop-up-title-text-combined-acc-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'"></div>\r\n        </div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-btns-container" class="theme2-pop-up-btns-container theme2-pop-up-btns-container-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'theme2-pop-up-btns-aligner" class="theme2-pop-up-btns-aligner theme2-pop-up-btns-aligner-',(g=c.type)?f=g.call(b,{hash:{},data:e}):(g=b&&b.type,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n'})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.CheckBox=MathInteractives.Common.Player.Views.Base.extend({events:{"click .check-box-label,.check-box-icon":"_checkBoxClicked"},initialize:function(){this.initializeDefaultProperties(),this._render(),this._attachEvents()},_checkBoxClicked:function(a){this.model;if(this.model.get("enabled")===!0){var b=!this.isChecked();this.setChecked(b)}},_checkBoxHover:function(a){this.model.get("enabled")===!0&&(this.$(".check-box-icon").addClass(this.model.get("hoverClassName")),this.$(".check-box-label").addClass(this.model.get("hoverClassName")))},_checkBoxHoverEnd:function(a){this.model.get("enabled")===!0&&(this.$(".check-box-icon").removeClass(this.model.get("hoverClassName")),this.$(".check-box-label").removeClass(this.model.get("hoverClassName")))},_render:function(){this.$el.append(MathInteractives.Common.Components.templates.theme2CheckBox({containerId:this.model.get("containerId")}).trim()),this._renderIcon(),this._renderLabel(),this._enableCheckBox(this.model,this.model.get("enabled")),this._showHideCheckBox(this.model,this.model.get("visible")),this.loadScreen("checkbox-acc-screen");var a=this.model,b=a.get("accText"),c=a.get("containerId"),d=c.replace(this.idPrefix,"");b=this.isChecked()===!0?b+" "+this.getAccMessage("checkbox-acc-text",1):b+" "+this.getAccMessage("checkbox-acc-text",0),this.createAccDiv({elementId:d,tabIndex:a.get("tabIndex"),acc:b});var e=$("<div>",{id:this.idPrefix+"temp-focus-div",style:"position: absolute; height: 1px; width: 1px; top: 1px; left: 1px;"});return this.$el.append(e),this.loadScreen("temp-focus-div-screen"),this.$("#"+c+"-acc-elem").on("keydown",$.proxy(this.selectBySpace,this)),null},selectBySpace:function(a){var b=a.keyCode?a.keyCode:a.which,c=this.model,d=c.get("containerId"),e=c.get("focusAfterSelection"),f=c.get("focusDelay"),g=d.replace(this.idPrefix,"");32===b&&(this._checkBoxClicked(),null===e?(this.setFocus("temp-focus-div"),this.setFocus(g,f)):this.setFocus(e,f))},_renderIcon:function(){var a=this.$(".check-box-icon");"undefined"!=typeof this.model.get("baseClassName")&&a.addClass(this.model.get("baseClassName")),this.model.get("checked")===!0?a.find(".check-icon").addClass(this.model.get("checkedClassName")+"  fa fa-check"):a.find(".check-icon").removeClass(this.model.get("checkedClassName")+"  fa fa-check")},_renderLabel:function(){this.$(".check-box-label").html(this.model.get("label"))},_triggerLabelChange:function(a,b){var c={id:this.model.get("containerId"),label:b};this.trigger(MathInteractives.Common.Components.Theme2.Models.CheckBox.EVENTS.LABEL_CHANGED,c),this._renderLabel()},setLabel:function(a){("undefined"==typeof a||null===a)&&(a=MathInteractives.Common.Components.Theme2.Models.CheckBox.DEFAULTS.LABEL),this.model.set("label",a)},_triggerValueChange:function(a,b){var c={id:this.model.get("containerId"),value:b};this.trigger(MathInteractives.Common.Components.Theme2.Models.CheckBox.EVENTS.VALUE_CHANGED,c)},setValue:function(a){("undefined"==typeof a||null===a)&&(a=MathInteractives.Common.Components.Theme2.Models.CheckBox.DEFAULTS.VALUE),this.model.set("value",a)},getValue:function(){return this.model.get("value")},_triggerCheckChange:function(a,b){var c={id:this.model.get("containerId"),checked:b};this.trigger(MathInteractives.Common.Components.Theme2.Models.CheckBox.EVENTS.CHECK_CHANGED,c),this._renderIcon()},setChecked:function(a){var b=this.model,c=b.get("accText"),d=b.get("containerId"),e=d.replace(this.idPrefix,"");("undefined"==typeof a||null===a)&&(a=MathInteractives.Common.Components.Theme2.Models.CheckBox.DEFAULTS.CHECKED),this.model.set("checked",a),c=a===!0?c+" "+this.getAccMessage("checkbox-acc-text",1):c+" "+this.getAccMessage("checkbox-acc-text",0),this.setAccMessage(e,c)},isChecked:function(){return this.model.get("checked")},_enableCheckBox:function(a,b){b===!0?this.$(".check-box-container").removeClass(a.get("disabledClassName")):this.$(".check-box-container").addClass(a.get("disabledClassName"))},_triggerEnableChange:function(a,b){var c={id:this.model.get("containerId"),enabled:b};this.trigger(MathInteractives.Common.Components.Theme2.Models.CheckBox.EVENTS.ENABLE_CHANGED,c),this._enableCheckBox(a,b)},setEnabled:function(a){("undefined"==typeof a||null===a)&&(a=MathInteractives.Common.Components.Theme2.Models.CheckBox.DEFAULTS.ENABLED),this.model.set("enabled",a)},isEnabled:function(){return this.model.get("enabled")},_showHideCheckBox:function(a,b){b===!0?this.$el.show():this.$el.hide()},_triggerVisibleChange:function(a,b){var c={id:this.model.get("containerId"),visible:b};this.trigger(MathInteractives.Common.Components.Theme2.Models.CheckBox.EVENTS.VISIBLE_CHANGED,c),this._showHideCheckBox(a,b)},setVisible:function(a){("undefined"==typeof a||null===a)&&(a=MathInteractives.Common.Components.Theme2.Models.CheckBox.DEFAULTS.VISIBLE),this.model.set("visible",a)},isVisible:function(){return this.model.get("visible")},_attachEvents:function(){var a=this.$(".check-box-elements"),b=this.model;a.off("mouseenter").on("mouseenter",$.proxy(this._checkBoxHover,this)),a.off("mouseleave").on("mouseleave",$.proxy(this._checkBoxHoverEnd,this)),MathInteractives.Common.Utilities.Models.Utils.EnableTouch(a),b.on("change:label",$.proxy(this._triggerLabelChange,this)),b.on("change:checked",$.proxy(this._triggerCheckChange,this)),b.on("change:enabled",$.proxy(this._triggerEnableChange,this)),b.on("change:visible",$.proxy(this._triggerVisibleChange,this)),b.on("change:value",$.proxy(this._triggerValueChange,this))}},{createCheckBox:function(a){var b="",c=null,d=null;return a&&(b="#"+a.containerId,c=new MathInteractives.Common.Components.Theme2.Models.CheckBox(a),d=new MathInteractives.Common.Components.Theme2.Views.CheckBox({el:b,model:c})),d}}),MathInteractives.global.Theme2.CheckBox=MathInteractives.Common.Components.Theme2.Views.CheckBox}(window.MathInteractives),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.CheckBox=Backbone.Model.extend({defaults:{player:null,manager:null,filePath:null,idPrefix:null,containerId:null,label:null,value:null,checkBoxType:null,checked:null,enabled:null,visible:null,baseClassName:null,checkedClassName:null,disabledClassName:null,tabIndex:null,accText:null,focusAfterSelection:null,dummyDivId:null,focusDelay:0,hoverClassName:null,offsetParams:{offsetLeft:null,offsetTop:null},isAccOn:!0},initialize:function(){var a=this.get("checkBoxType"),b=MathInteractives.Common.Components.Theme2.Models.CheckBox;null===this.get("label")&&this.set("label",b.DEFAULTS.LABEL),null===this.get("value")&&this.set("value",b.DEFAULTS.VALUE),null===a?(a=b.CHECKBOX_TYPE.GENERAL,this.set("type",a)):a===b.CHECKBOX_TYPE.CUSTOM&&(null===this.get("baseClassName")?(a=b.CHECKBOX_TYPE.GENERAL,this.set("type",a)):(null===this.get("checkedClassName")&&this.set("checkedClassName",a.checkedClassName),null===this.get("disabledClassName")&&this.set("disabledClassName",a.disabledClassName),null===this.get("hoverClassName")&&this.set("hoverClassName",a.hoverClassName))),a===b.CHECKBOX_TYPE.GENERAL&&(this.set("baseClassName",a.baseClassName),this.set("checkedClassName",a.checkedClassName),this.set("disabledClassName",a.disabledClassName),this.set("hoverClassName",a.hoverClassName)),null===this.get("checked")&&this.set("checked",b.DEFAULTS.CHECKED),null===this.get("enabled")&&this.set("enabled",b.DEFAULTS.ENABLED),null===this.get("visible")&&this.set("visible",b.DEFAULTS.VISIBLE)}},{DEFAULTS:{LABEL:"",VALUE:"",CHECKED:!1,ENABLED:!0,VISIBLE:!0},CHECKBOX_TYPE:{GENERAL:{id:"general-checkbox",category:"general-checkbox",baseClassName:"general-checkbox",checkedClassName:"checked",disabledClassName:"disabled",hoverClassName:"hover"},CUSTOM:{id:"custom-checkbox",category:"custom-checkbox",baseClassName:"custom-checkbox",checkedClassName:"checked",disabledClassName:"disabled",hoverClassName:"hover"}},EVENTS:{CHECK_CHANGED:"check-changed",LABEL_CHANGED:"label-changed",VALUE_CHANGED:"value-changed",ENABLE_CHANGED:"enable-changed",VISIBLE_CHANGED:"visible-changed"}})}(window.MathInteractives),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.theme2CheckBox=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff<div id="',(g=c.containerId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.containerId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-check-box-container" class="check-box-container">\r\n    <div id="',(g=c.containerId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.containerId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-check-box-icon-container" class="check-box-icon-container check-box-elements">\r\n        <div id="',(g=c.containerId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.containerId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-check-box-icon" class="check-box-icon">\r\n            <div id="',(g=c.containerId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.containerId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-check-icon" class="check-icon"></div>\r\n        </div>\r\n    </div>\r\n  <div id="',(g=c.containerId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.containerId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-check-box-label-container" class="check-box-label-container">\r\n      <span id="',(g=c.containerId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.containerId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-check-box-label" class="check-box-label check-box-elements"></span>\r\n  </div>\r\n</div>'})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.Combobox=MathInteractives.Common.Player.Views.Base.extend({idPrefix:null,manager:null,player:null,path:null,$comboHolder:null,_timer:null,_currentTarget:null,zIndexArray:[],zIndexSubElemArray:[],zIndexCount:0,isCustomComboBoxTemplate:!1,initialize:function(){var a=this.model,b=a.get("isCustomComboBoxTemplate");this.path=a.get("path"),this.idPrefix=a.get("idPrefix"),this.manager=a.get("manager"),this.player=a.get("player"),this.isCustomComboBoxTemplate=void 0!==b?b:!1,this._intilializeAccTextArrForCustomComboBoxTemplate(),a.on("change:options",this._render,this),a.on("change:bEnabled",this.enableDisableCombobox,this),a.on("change:selectedOptionIndex",this._setOption,this),this._render()},events:{"click .combo-top-box":"comboClick","keydown .combo-top-box":"_onKeyDown","click .optgroup-container":"optgroupClicked"},_render:function(){var a,b,c,d,e,f=this,g=this.model.get("containerId"),h=this.model.get("screenId"),i=this.idPrefix,j=MathInteractives.Common.Components.Theme2.Models.Combobox.DEFAULT_OPTION_TYPES,k=this.model;if(this.$comboHolder=this.$el,this.$el.empty(),a={idPrefix:i,defaultText:"",comboBoxTop:!0,containerId:g},b=MathInteractives.Common.Components.templates.theme2Combobox(a).trim(),this.$el.append(b),this.generateOptionsMarkup(),this.bindEvents(),d=this.$(".combo-top-box").outerHeight(),this.$(".combo-box-list").css("top",d+"px"),this.$(".combo-box-list").hide(),null!==h&&"undefined"!=typeof h&&(this.loadScreen(h),this.loadScreen("theme-2-combobox-screen"),this.focusOut(g+"-combo-top-box",function(){f.setAccMessage(g+"-combo-top-box",f.getAccMessage("theme2ComboboxText",0),[f.getAccMessage(g+"-combo-top-box",k.get("selectedOptionIndex"))])})),e=k.get("selectedOptionIndex"),null===e)switch(c=k.get("defaultOptionType")){case j.FIRST_OPTION:this.selectComboOptionByIndex(0);break;case j.DEFAULT_TEXT:this.selectComboOptionByIndex(-1);break;case j.PASSED_OPTION_TEXT:var e=k.get("options").indexOf(k.get("defaultOptionText"));this.selectComboOptionByIndex(-1===e?0:e);break;case j.PASSED_OPTION_INDEX:var e=k.get("defaultOptionIndex"),l=k.get("options").length;this.selectComboOptionByIndex(e>=0&&l>e?e:0)}else this._setOption(),this.enableDisableCombobox();this.isCustomComboBoxTemplate===!0&&(this._createTabIndexArrayForOption(),this._createHackDivForCustomTemplateCombo(),this._bindFocusOutEventOnLastOption()),this.$(".option-outer-container").off("click").on("click",$.proxy(this.selectOption,this))},enableDisableCombobox:function(){var a=this.model;a.get("bEnabled")?this.$el.find(".combo-container").css({cursor:"pointer"}):this.$el.find(".combo-container").css({cursor:"default"}),this.enableTab(a.get("containerId")+"-combo-top-box",a.get("bEnabled")),this.hideDropDown()},comboClick:function(a){a.stopPropagation();var b=this.model;"0px"===this.player.$el.find(".tabs-container").css("left")&&this.player._hideDrawer(),b.get("bEnabled")&&(MathInteractives.global.SpeechStream.stopReading(),this.hideAllDropdownsInCurrentTab(),this.showHideDropDownList(),this.highlightDownplayCombo(),this.isCustomComboBoxTemplate===!0&&this._setFocusOnFirstOption())},optgroupClicked:function(a){a.stopPropagation()},hideAllDropdownsInCurrentTab:function(){var a=this,b=this.getCurrentTab();b.find(".combo-box-list").each(function(){var b;return b=$(this),0===a.$el.has(b).length&&b.is(":visible")?(b.hide(),a.unbindEventOnDocument(),b.removeClass("combo-list-pull-up").removeClass("combo-list-drop-down").addClass("combo-list-drop-down"),void b.prev().removeClass("combo-top-box-active")):void 0})},hideDropDown:function(){var a=this,b=this.$(".combo-box-list");return b.is(":visible")?(this.unbindEventOnDocument(),this.isCustomComboBoxTemplate===!0?setTimeout(function(){b.hide(),b.removeClass("combo-list-pull-up").removeClass("combo-list-drop-down").addClass("combo-list-drop-down"),a.highlightDownplayCombo()},5):(b.hide(),b.removeClass("combo-list-pull-up").removeClass("combo-list-drop-down").addClass("combo-list-drop-down"),this.highlightDownplayCombo()),this.model.get("hasMultipleSelection")===!0&&this.trigger(MathInteractives.global.Theme2.Combobox.MULTIPLE_SELECTION_COMBO_BOX_CLOSED,this),!0):void 0},showHideDropDownList:function(){var a,b,c,d=(this.idPrefix,this.$(".combo-box-list")),e=this.model;if(e.get("bEnabled")){if(d.is(":visible"))return void this.hideDropDown();d.css("visibility","hidden"),d.show(),b=d.offset().top+d.height(),a=this.getCurrentTab(),c=a.offset().top+a.height(),b>c?d.removeClass("combo-list-drop-down").addClass("combo-list-pull-up"):d.removeClass("combo-list-pull-up").addClass("combo-list-drop-down"),d.show(),this.bindEventOnDocument(),d.css("visibility","visible"),this._updateFocusRects()}},getCurrentTab:function(){return this.player.$('div[class="activity-area theme2-tabs"]:visible')},highlightDownplayCombo:function(){this.$(".combo-box-list").is(":visible")?this.$(".combo-top-box").addClass("combo-top-box-active"):this.$(".combo-top-box").removeClass("combo-top-box-active")},selectOption:function(a){a.preventDefault();var b,c=$(a.currentTarget),d=this._currentTarget,e=a.target,f=($(e).text().trim(),this.model),g=(this.idPrefix,f.get("dropDownDownStateClass"));if(this._timer&&clearTimeout(this._timer),d&&d.removeClass("highlight-option"),MathInteractives.global.SpeechStream.stopReading(),"undefined"!=typeof g&&null!==g){var h=c.find(".option-inner-container");$(h).each(function(){$(this).addClass(g)});var i=$(c.siblings(".option-outer-container")).find(".option-inner-container");$(i).each(function(){$(this).removeClass(g)})}b=$(e).hasClass("option-outer-container")?$(e).attr("index"):$(e).parents(".option-outer-container").attr("index"),this.selectComboOptionByIndex(b),f.get("hasMultipleSelection")!==!0&&(this.showHideDropDownList(),this.highlightDownplayCombo(),this._setFocusOnComboHeader())},_onKeyDown:function(a){var b=null;switch(a.keyCode){case 36:case 33:b=0,null!==b&&(a.preventDefault(),this.selectComboOptionByIndex(b));break;case 35:case 34:b=this.model.get("options").length-1,null!==b&&(a.preventDefault(),this.selectComboOptionByIndex(b));break;case 38:b=this.model.get("selectedOptionIndex"),b>0&&b--,null!==b&&(a.preventDefault(),this.model.get("handleArrowKeys")!==!1&&this.selectComboOptionByIndex(b)),this.trigger(MathInteractives.Common.Components.Theme2.Views.Combobox.SELECTION_CHANGE_UP_ARROW);break;case 40:b=this.model.get("selectedOptionIndex"),b<this.model.get("options").length-1&&b++,null!==b&&(a.preventDefault(),this.model.get("handleArrowKeys")!==!1&&this.selectComboOptionByIndex(b)),this.trigger(MathInteractives.Common.Components.Theme2.Views.Combobox.SELECTION_CHANGE_DOWN_ARROW);break;case 32:case 13:this.model.get("isCustomComboBoxTemplate")!==!0&&a.preventDefault(),null!==b&&this.selectComboOptionByIndex(b)}this.isCustomComboBoxTemplate===!0&&this.$(".combo-top-box").hasClass("combo-top-box-active")===!0&&9===a.keyCode&&a.shiftKey===!0&&this.showHideDropDownList()},selectComboOptionByIndex:function(a){a>=-1&&a<this.model.get("options").length?(MathInteractives.global.SpeechStream.stopReading(),this.model.set("selectedOptionIndex",a)):this.log("Index out of range")},selectComboOptionByData:function(a){var b=this.model.get("options").indexOf(a);this.selectComboOptionByIndex(b)},_setOption:function(){var a=this.model,b=a.get("selectedOptionIndex"),c="",d=a.get("containerId")+"-combo-top-box",e=a.get("screenId");c=-1===b?a.get("defaultText"):a.get("options")[b],this.model.set("selectedOptionData",c),c.isCustomComboBoxTemplate===!0||this.$(".top-box-text-container").html(c),this.trigger(MathInteractives.global.Theme2.Combobox.SELECTION_CHANGED,this),null!==e&&"undefined"!=typeof e&&(this.$("#"+this.idPrefix+d+"-acc-elem").blur(),this.setAccMessage(d,this.getAccMessage(d,this.model.get("selectedOptionIndex"))),this.setFocus(d))},getSelectedOptionIndex:function(){return this.model.get("selectedOptionIndex")},addOptionInComboBox:function(a,b){this.model.addOptions(a,b)},removeAllOptionFromComboBox:function(){this.model.removeAllOptions()},removeOptionFromComboBox:function(a){this.model.removeIndexAt(a)},resetCombo:function(){var a,b=this.model,c=b.get("defaultOptionType"),d=MathInteractives.Common.Components.Theme2.Models.Combobox.DEFAULT_OPTION_TYPES;switch(c){case d.FIRST_OPTION:this.selectComboOptionByIndex(0);break;case d.DEFAULT_TEXT:this.selectComboOptionByIndex(-1);break;case d.PASSED_OPTION_TEXT:var a=b.get("options").indexOf(b.get("defaultOptionText"));this.selectComboOptionByIndex(-1===a?0:a);break;case d.PASSED_OPTION_INDEX:var a=b.get("defaultOptionIndex"),e=b.get("options").length;this.selectComboOptionByIndex(a>=0&&e>a?a:0)}},bindEvents:function(){this.bindOptionsHighlightDownPlayEvents()},bindEventOnDocument:function(){var a=this;this.$(".combo-box-list");$(document).on("click.combobox",function(){a.model.get("hasMultipleSelection")!==!0&&a.hideDropDown()}),$(document).on("mousedown.combobox",function(b){1!=$(b.target).parents("#"+a.el.id).length&&a.hideDropDown()})},unbindEventOnDocument:function(){$(document).off("click.combobox"),$(document).off("mousedown.combobox")},bindOptionsHighlightDownPlayEvents:function(){var a=this.$(".option-outer-container");MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile?(a.off("touchstart").on("touchstart",$.proxy(this._onOptionMouseOver,this)),a.off("touchend").on("touchend",$.proxy(this._onOptionMouseLeave,this))):(a.off("mouseenter").on("mouseenter",$.proxy(this._onOptionMouseOver,this)),a.off("mouseleave").on("mouseleave",$.proxy(this._onOptionMouseLeave,this)),MathInteractives.Common.Utilities.Models.Utils.EnableTouch(a))},_onOptionMouseOver:function(a){if(this.model.get("bEnabled")){var b=$(a.currentTarget).find(".option-inner-container"),c=a.originalEvent&&a.originalEvent.data&&a.originalEvent.data.simulatedEvent;c?(this._currentTarget=b,this._timer&&clearTimeout(this._timer),this._timer=setTimeout(function(){b.addClass("highlight-option")},200)):b.addClass("highlight-option")}},_onOptionMouseLeave:function(a){if(this.model.get("bEnabled")){var b=a.originalEvent&&a.originalEvent.data&&a.originalEvent.data.simulatedEvent;this._timer&&clearTimeout(this._timer),b?setTimeout(function(){$(a.currentTarget).find(".option-inner-container").removeClass("highlight-option")},200):$(a.currentTarget).find(".option-inner-container").removeClass("highlight-option")}},generateOptionsMarkup:function(){var a,b,c,d=this.model.get("options"),e=this.model.get("containerId"),f=d.length,g=this.idPrefix;for(a=0;f>a;a++)c={idPrefix:g,value:d[a],index:a,containerId:e+"-"+a+"-"},d[a].isClickable===!1?b=d[a].optgroupTemplate:(d[a].isCustomComboBoxTemplate===!0&&(c.value=d[a].customComboBoxTemplate),b=MathInteractives.Common.Components.templates.theme2Combobox(c).trim()),this.$(".combo-box-list").append(b),0==a&&this.$(".option-outer-container").addClass("first-option-outer-container")},_createHackDivForCustomTemplateCombo:function(){this.createAccDiv({elementId:this.$el.find(".combo-top-box").attr("id").replace(this.model.get("idPrefix"),"").trim(),tabIndex:this.model.get("tabIndex"),acc:void 0!==this.accTextArray?this.accTextArray.unSelectedDropDownHeaderAccText:""}),this._createHackDivForOptions()},_createHackDivForOptions:function(){var a=this,b=this.model.get("options"),c=this.$el.find(".combo-box-list").children();c.each(function(c){a.createAccDiv({elementId:$(this).attr("id").replace(a.model.get("idPrefix"),"").trim(),tabIndex:a.zIndexArray[a.zIndexCount],acc:void 0!==a.accTextArray?a.accTextArray.optionsAccText[c]:""}),a.zIndexCount++,b[c].subElements===!0&&a._generateHackDivsForCurrentOptionSubElement(a.$("."+b[c].subElementsCommonClass))})},_updateFocusRects:function(){var a=this;if(this.isCustomComboBoxTemplate===!0){var b=this.$el.find(".combo-box-list").children();b.each(function(b){a.updateFocusRect($(this).attr("id").replace(a.model.get("idPrefix"),""))})}},_setFocusOnFirstOption:function(){var a=this.$el.find(".combo-box-list").children().first();this.setFocus(a.attr("id").replace(this.model.get("idPrefix"),""))},_createTabIndexArrayForOption:function(){for(var a=this.model,b=a.get("options"),c=b.length+this._getNumberOfSubElems(),d=a.get("tabIndex"),e=0;c>e;e++)this.zIndexArray[e]=d+1},_setFocusOnComboHeader:function(){this.isCustomComboBoxTemplate===!0&&this.setFocus(this.$el.find(".combo-top-box").attr("id").replace(this.model.get("idPrefix"),"").trim())},_bindFocusOutEventOnLastOption:function(){var a=this.$el.find(".combo-box-list").children().last().attr("id");this.$("#"+a).on("keydown",$.proxy(this._onlastOptionFocusOut,this))},_onlastOptionFocusOut:function(a){9===a.keyCode&&a.shiftKey===!1&&this.showHideDropDownList()},_intilializeAccTextArrForCustomComboBoxTemplate:function(){this.isCustomComboBoxTemplate===!0&&(this.accTextArray=this.model.get("accText"))},_generateHackDivsForCurrentOptionSubElement:function(a){var b=a.children(),c=this;b.each(function(a){c.createAccDiv({elementId:$(this).attr("id").replace(c.model.get("idPrefix"),"").trim(),tabIndex:c.zIndexArray[c.zIndexCount],acc:void 0!==c.accTextArray?c.accTextArray.quantityArrayText[a]:""}),c.zIndexCount++})},_getNumberOfSubElems:function(){for(var a=this.model.get("options"),b=a.length,c=0,d=0;b>d;d++)a[d].subElements===!0&&(c+=this.$("."+a[d].subElementsCommonClass).children().length);return c},setAccTextForDropDownHeader:function(a){this.setAccMessage(this.$el.find(".combo-top-box").attr("id").replace(this.model.get("idPrefix"),"").trim(),a)},setAccTextForDropDownOption:function(a,b){var c=$(this.$el.find(".combo-box-list").children()[a]);this.setAccMessage(c.attr("id").replace(this.model.get("idPrefix"),"").trim(),b)},setFocusOnComboHeader:function(){this._setFocusOnComboHeader()}},{SELECTION_CHANGED:"selection-changed",MULTIPLE_SELECTION_COMBO_BOX_CLOSED:"multiple-selection-combo-box-closed",SELECTION_CHANGE_UP_ARROW:"selection-change-up-arrow",SELECTION_CHANGE_DOWN_ARROW:"selection-change-down-arrow",generateCombo:function(a){var b,c;return b=new MathInteractives.Common.Components.Theme2.Models.Combobox(a),c=new MathInteractives.Common.Components.Theme2.Views.Combobox({el:"#"+a.idPrefix+a.containerId,model:b})}}),MathInteractives.global.Theme2.Combobox=MathInteractives.Common.Components.Theme2.Views.Combobox}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.Combobox=Backbone.Model.extend({defaults:{idPrefix:null,player:null,manager:null,path:null,bEnabled:!0,screenId:null,containerId:null,borderColor:"#aaa",options:["JavaScript","jQuery","Backbone","Angular"],selectedOptionData:null,selectedOptionIndex:null,defaultOptionType:null,defaultText:"",defaultOptionText:null,defaultOptionIndex:0,customComboBoxTemplate:null,isCustomComboBoxTemplate:null,dropDownDownStateClass:null,hasMultipleSelection:null,handleArrowKeys:!0},initialize:function(){null===this.get("defaultOptionType")&&this.set("defaultOptionType",MathInteractives.Common.Components.Theme2.Models.Combobox.DEFAULT_OPTION_TYPES.FIRST_OPTION)},addOptions:function(a,b){var c,d;c=[],d=this.get("options"),$.merge(c,d),b?c.splice(b,0,a):c.push(a),this.set("options",c)},removeAllOptions:function(){this.set("options",[])},removeIndexAt:function(a){var b,c;b=[],c=this.get("options"),$.merge(b,c),b.splice(a,1),this.set("options",b)}},{DEFAULT_OPTION_TYPES:{FIRST_OPTION:1,DEFAULT_TEXT:2,PASSED_OPTION_TEXT:3,PASSED_OPTION_INDEX:4}})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.theme2Combobox=a(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\r\n <div id="',(e=c.idPrefix)?d=e.call(a,{hash:{},data:b}):(e=a&&a.idPrefix,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d),(e=c.containerId)?d=e.call(a,{hash:{},data:b}):(e=a&&a.containerId,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'-combo-container" class="combo-container">\r\n  <div id="',(e=c.idPrefix)?d=e.call(a,{hash:{},data:b}):(e=a&&a.idPrefix,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d),(e=c.containerId)?d=e.call(a,{hash:{},data:b}):(e=a&&a.containerId,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'-combo-top-box" class="combo-top-box">\r\n    <div class="top-box-text-container">',(e=c.defaultText)?d=e.call(a,{hash:{},data:b}):(e=a&&a.defaultText,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'</div>\r\n    <div class="top-box-down-arrow-parent">\r\n		<div class="top-box-down-arrow"></div>\r\n	</div>\r\n  </div>\r\n  <div class="combo-box-list">\r\n  </div>\r\n</div>\r\n'}function g(a,b){var d,e,f="";return f+='\r\n<div id="',(e=c.idPrefix)?d=e.call(a,{hash:{},data:b}):(e=a&&a.idPrefix,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d),(e=c.containerId)?d=e.call(a,{hash:{},data:b}):(e=a&&a.containerId,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'-option-outer-container" class="option-outer-container" index="',(e=c.index)?d=e.call(a,{hash:{},data:b}):(e=a&&a.index,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'">\r\n        <div class="option-inner-container combo-box-text">\r\n            ',(e=c.value)?d=e.call(a,{hash:{},data:b}):(e=a&&a.value,d=typeof e===j?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="\r\n        </div>\r\n</div>\r\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i="",j="function",k=this.escapeExpression,l=this;return i+="\ufeff",h=c["if"].call(b,b&&b.comboBoxTop,{hash:{},inverse:l.program(3,g,e),fn:l.program(1,f,e),data:e}),(h||0===h)&&(i+=h),i})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.RadioButton=MathInteractives.Common.Player.Views.Base.extend({idPrefix:null,manager:null,filePath:null,screenID:null,tabIndex:null,initialize:function(){this.manager=this.model.get("manager"),this.filePath=this.model.get("filePath"),this.screenID=this.model.get("screenID"),this.idPrefix=this.model.get("idPrefix"),this.render(),this.bindTouchEvents()},render:function(){var a=this.model.get("radioButtonCollection"),b=null,c=null,d=[];for(c=0;c<a.length;c++)b=a.models[c],d.push({radioID:this.idPrefix+b.get("elementID"),text:b.get("text")});this.$el.html(MathInteractives.Common.Components.templates.theme2RadioButton({radioButtonLabel:d}).trim()),this.setWidthOfGivenLabels(),this.loadScreen("radio-button-acc-screen"),this.alignRadioButton(this.model.get("direction"),this.model.get("gapBetweenRadioButtonContainers")),this.checkDefaultCheckedRadioButtons(),this.setInitialStateOfRadioButtons(),this.createDynamicHackDiv(),this.setTextForRadioBtnHack()},createDynamicHackDiv:function(){var a=this.model.get("radioButtonCollection"),b=this.model.get("tabIndex"),c=null,d=null,e=null;for(e=0;e<a.length;e++)c=a.models[e],d={elementId:c.get("elementID"),tabIndex:b,acc:""},this.createAccDiv(d)},setTextForRadioBtnHack:function(){var a=this.model.get("radioButtonCollection"),b=(this.model.get("tabIndex"),null),c=null,d=null,e=null,f=null;for(f=0;f<a.length;f++)b=a.models[f],e=b.get("elementID"),c=this.$("#"+this.idPrefix+e),d=b.get("accText")?b.get("accText"):b.get("text"),d+=" "+this.getAccMessage("radio-button-acc-text",0)+" ",d+=$(c).find(".theme2-radio-button-selceted-dot").hasClass("selected-state")===!0?this.getAccMessage("radio-button-acc-text",2)+" ":this.getAccMessage("radio-button-acc-text",1)+" ",d+=this.getAccMessage("radio-button-acc-text",3),this.setAccMessage(e,d)},changeRadioButtonAccText:function(a,b){var c,d=this.$("#"+this.idPrefix+a),e=b,f=this.model.get("radioButtonCollection");c=f.where({elementID:a}),f.where({elementID:a
}).length>0&&(c=f.where({elementID:a})[0],c.set("accText",b),e+=" "+this.getAccMessage("radio-button-acc-text",0)+" ",e+=$(d).find(".theme2-radio-button-selceted-dot").hasClass("selected-state")===!0?this.getAccMessage("radio-button-acc-text",2)+" ":this.getAccMessage("radio-button-acc-text",1)+" ",e+=this.getAccMessage("radio-button-acc-text",3),this.setAccMessage(a,e))},events:{"click .radio-elements":"radioButtonClicked","mouseenter .radio-elements":"radioButtonEntered","mouseleave .radio-elements":"radioButtonLeft","keydown .radio-button-div-container":"processKeyEvents","focus .radio-button-div-container":"adjustTabIndex","focusout .radio-button-div-container":"readjustTabIndex"},bindTouchEvents:function(){MathInteractives.Common.Utilities.Models.Utils.EnableTouch(this.$(".radio-elements"))},radioButtonClicked:function(a){var b=null;if(this.model.get("enabled")){this.stopReading();var c=this.$(a.currentTarget),d=this.getImageContainer(c),e=this.$(d).find(".theme2-radio-button-selceted-dot");0==e.hasClass("selected-state")&&(this.resetRadioButtons(),e.addClass("selected-state"),this.addSelectedState(e),this.triggerOnChangeEvent()),b=this.getAccIDByReplacingIdPrefix(this.$(d).attr("id")),this.setTextForRadioBtnHack(),this.setFocus(b)}},adjustTabIndex:function(a){if(this.model.get("enabled")){var b=this.$(a.currentTarget),c=null,d=this.getAllImageContainers();for(c=0;c<d.length;c++)b.attr("id")===$(d[c]).attr("id")?this.enableTab(this.getAccIDByReplacingIdPrefix($(d[c]).attr("id")),!0):this.enableTab(this.getAccIDByReplacingIdPrefix($(d[c]).attr("id")),!1)}},readjustTabIndex:function(){if(this.model.get("enabled")){var a=null,b=null,c=this.getAllImageContainers();for(b=0;b<c.length;b++)if(a=c[b],$(a).find(".theme2-radio-button-selceted-dot").hasClass("selected-state")===!0)return;for(b=0;b<c.length;b++)this.enableTab(this.getAccIDByReplacingIdPrefix($(c[b]).attr("id")),!0)}},addSelectedState:function(a){var b=null;b=this.model.get("enabled")?this.model.get("dotBackgroundColor"):this.model.get("disabledDotBackgroundColor"),a.css({"background-color":b})},radioButtonEntered:function(a){var b=this.$(a.currentTarget);this.getImageContainer(b);this.$(".de-mathematics-interactive-theme2-radio-button .text-container").hasClass("disable-text")===!1&&(this.$(b).find(".theme2-radio-button-selceted-dot").hasClass("selected-state")&&this.$(b).find(".theme2-radio-button-selceted-dot").css({"background-color":this.model.get("hoverDotBackgroundColor")}),this.$(b).hasClass("theme2-radio-button-selceted-dot-container")&&(b.css({"border-color":this.model.get("hoverDotContainerBorderColor"),"box-shadow":"0 0 4px 0px rgba(0, 0, 0, .3) inset"}),this.$(b.parent()).css({"background-color":this.model.get("hoverEntireContainerBackgroundColor")})),this.$(b).addClass("cursor-pointer"))},radioButtonLeft:function(a){var b=this.$(a.currentTarget),c=this.getImageContainer(b);this.$(".de-mathematics-interactive-theme2-radio-button .text-container").hasClass("disable-text")===!1&&(this.$(c).find(".theme2-radio-button-selceted-dot").hasClass("selected-state")&&this.$(c).find(".theme2-radio-button-selceted-dot").css({"background-color":this.model.get("dotBackgroundColor")}),this.$(b).hasClass("theme2-radio-button-selceted-dot-container")&&(b.css({"border-color":this.model.get("dotContainerBorderColor"),"box-shadow":"none"}),this.$(b.parent()).css({"background-color":this.model.get("entireContainerBackgroundColor")})),this.$(b).removeClass("cursor-pointer"))},getImageContainer:function(a){var b=null;return b=a.hasClass("text-container")?a.prev():a.parent()},getDotContainer:function(a){var b=null;return b=a.hasClass("text-container")?a.prev():$(a).find(".theme2-radio-button-selceted-dot")},alignRadioButton:function(a,b){var c=this.$(".de-mathematics-interactive-theme2-radio-button.single-theme2-radio-container"),d=c.find(".text-container");"vertical"==a?(this.$(c).removeClass("float-left"),this.$(d).removeClass("float-left")):(this.$(c).addClass("float-left"),this.$(d).addClass("float-left"),null==b&&(b=10),this.$(c).css({"margin-right":b+"px"}))},checkDefaultCheckedRadioButtons:function(){var a=this.model.get("radioButtonCollection"),b=this.getAllImageContainers(),c=null,d=null,e=null,f=null;for(e=0;e<a.length;e++)c=a.models[e],d=b[e],f=this.getAccIDByReplacingIdPrefix(this.$(d).attr("id")),f==c.get("elementID")&&1==c.get("selected")?(this.resetRadioButtons(),this.$(d).find(".theme2-radio-button-selceted-dot").addClass("selected-state"),this.enableTab(f,!0)):this.enableTab(f,!1)},setInitialStateOfRadioButtons:function(){this.model.get("enabled")?this.enableRadioButtons():this.disableRadioButtons()},enableRadioButtons:function(){this.model.set({enabled:!0}),this.$(".theme2-radio-button-selceted-dot-container").css("border-color",this.model.get("dotContainerBorderColor")),this.$(".de-mathematics-interactive-theme2-radio-button .text-container").removeClass("disable-text"),this.$(".radio-button-div-container").css({"background-color":this.model.get("entireContainerBackgroundColor")});var a=this.getAllImageContainers(),b=null,c=null;for(c=0;c<a.length;c++)if(b=a[c],$(b).find(".theme2-radio-button-selceted-dot").hasClass("selected-state")===!0){$(b).find(".theme2-radio-button-selceted-dot").css({"background-color":this.model.get("dotBackgroundColor")});break}this.enableTabIndices()},disableRadioButtons:function(){this.model.set({enabled:!1});var a=this.getAllImageContainers(),b=null,c=null;for(b=0;b<a.length;b++)if(c=a[b],$(c).find(".theme2-radio-button-selceted-dot").hasClass("selected-state")===!0){$(c).find(".theme2-radio-button-selceted-dot").css({"background-color":this.model.get("disabledDotBackgroundColor")});break}this.$(".radio-button-div-container").css({"background-color":this.model.get("disabledEntireContainerBackgroundColor")}),this.$(".theme2-radio-button-selceted-dot-container").css("border-color",this.model.get("disabledDotContainerBorderColor")),this.$(".de-mathematics-interactive-theme2-radio-button .text-container").addClass("disable-text"),this.resetTabIndices()},resetRadioButtons:function(){this.$(".de-mathematics-interactive-theme2-radio-button .radio-button-div-container .theme2-radio-button-selceted-dot-container .theme2-radio-button-selceted-dot.selected-state").css({"background-color":"transparent"}),this.$(".de-mathematics-interactive-theme2-radio-button .radio-button-div-container .theme2-radio-button-selceted-dot-container .theme2-radio-button-selceted-dot").removeClass("selected-state"),this.enableTabIndices(),this.setTextForRadioBtnHack()},getAllImageContainers:function(){return $(this.$el).find("div.de-mathematics-interactive-theme2-radio-button.radio-button-div-container")},getAllTextContainers:function(){return $(this.$el).find("div.de-mathematics-interactive-theme2-radio-button .text-container")},selectRadioButton:function(a){this.stopReading();var b=this.$("#"+this.idPrefix+a),c=this.$(b).find(".theme2-radio-button-selceted-dot");void 0!=b&&0==c.hasClass("selected-state")&&(this.resetRadioButtons(),c.addClass("selected-state"),this.addSelectedState(c),this.resetTabIndices(),this.enableTab(a,!0),this.triggerOnChangeEvent(),this.setTextForRadioBtnHack()),this.setFocus(a)},deselectRadioButton:function(a){var b=this.getCurrentRadioButtonAndModel(a,!0);void 0!=b&&null!=b.curChild&&(this.$(b.curChild).find(".theme2-radio-button-selceted-dot").removeClass("selected-state"),this.readjustTabIndex(),this.setTextForRadioBtnHack())},getCurrentRadioButtonAndModel:function(a,b){var c=this.model.get("radioButtonCollection"),d=this.getAllImageContainers(),e=null,f=null,g=null,h={curChild:null,curModel:null},i=!1;for(null==a&&(i=!0),f=0;f<c.length;f++)if(e=c.models[f],g=d[f],i&&(a=this.$(g).attr("id")),a=this.getAccIDByReplacingIdPrefix(a),a==e.get("elementID")&&this.$(g).find(".theme2-radio-button-selceted-dot").hasClass("selected-state")==b)return h.curChild=g,h.curModel=e,h},getSelectedRadioButtonValue:function(){var a=this.getCurrentRadioButtonAndModel(null,!0);return void 0!=a&&null!=a.curModel?a.curModel.get("value"):void 0},getSelectedRadioButtonID:function(){var a=this.getCurrentRadioButtonAndModel(null,!0);return void 0!=a&&null!=a.curModel?a.curModel.get("elementID"):void 0},processKeyEvents:function(a){if(this.model.get("enabled"))switch(a.keyCode){case $.ui.keyCode.LEFT:this.selectPrevRadioButton(a),a.preventDefault();break;case $.ui.keyCode.RIGHT:this.selectNextRadioButton(a),a.preventDefault();break;case $.ui.keyCode.UP:this.selectPrevRadioButton(a),a.preventDefault();break;case $.ui.keyCode.DOWN:this.selectNextRadioButton(a),a.preventDefault();break;case $.ui.keyCode.SPACE:this.selectRadioButton(this.$(a.currentTarget).attr("id").replace(this.idPrefix,"")),a.preventDefault()}},selectNextRadioButton:function(a){this.stopReading();var b=this.model.get("radioButtonCollection"),c=this.getAllImageContainers(),d=!1,e=null,f=null;for(e=0;e<c.length;e++)if(f=c[e],this.$(f).find(".theme2-radio-button-selceted-dot").hasClass("selected-state")){d=!0;break}d===!1?this.selectAppropriateRadioButton(a.currentTarget,!1,1,b.length-1,0):this.selectAppropriateRadioButton(null,!0,1,b.length-1,0),this.triggerOnChangeEvent()},selectPrevRadioButton:function(a){this.stopReading();var b=this.model.get("radioButtonCollection"),c=this.getAllImageContainers(),d=!1,e=null,f=null;for(e=0;e<c.length;e++)if(f=c[e],this.$(f).find(".theme2-radio-button-selceted-dot").hasClass("selected-state")){d=!0;break}d===!1?this.selectAppropriateRadioButton(a.currentTarget,!1,-1,0,b.length-1):this.selectAppropriateRadioButton(null,!0,-1,0,b.length-1),this.triggerOnChangeEvent()},selectAppropriateRadioButton:function(a,b,c,d,e){var f=this.model.get("radioButtonCollection"),g=this.getAllImageContainers(),h=null,i=null,j=null,k=!1;for(null==a&&(k=!0),i=0;i<f.length;i++)if(h=f.models[i],j=g[i],k&&(a=j),this.getAccIDByReplacingIdPrefix(this.$(a).attr("id"))===h.get("elementID")&&this.$(j).find(".theme2-radio-button-selceted-dot").hasClass("selected-state")===b){this.$(j).find(".theme2-radio-button-selceted-dot").removeClass("selected-state"),i==d?(j=g[e],h=f.models[e]):(j=g[i+c],h=f.models[i+c]),this.$(j).find(".theme2-radio-button-selceted-dot").addClass("selected-state"),this.addSelectedState(this.$(j).find(".theme2-radio-button-selceted-dot")),this.setTextForRadioBtnHack(),this.setFocus(h.get("elementID"));break}},resetTabIndices:function(){var a=this.model.get("radioButtonCollection"),b=null,c=null;for(b=0;b<a.length;b++)c=a.models[b],this.enableTab(c.get("elementID"),!1)},enableTabIndices:function(){var a=this.model.get("radioButtonCollection"),b=this.getAllImageContainers(),c=null,d=null,e=null;for(d=0;d<a.length;d++)e=b[d],c=a.models[d],this.$(e).find(".theme2-radio-button-selceted-dot").hasClass("selected-state")?this.enableTab(c.get("elementID"),!0):"undefined"!=typeof this.getSelectedRadioButtonID()?this.enableTab(c.get("elementID"),!1):this.enableTab(c.get("elementID"),!0)},triggerOnChangeEvent:function(){this.trigger(MathInteractives.Common.Components.Theme2.Views.RadioButton.SELECTION_CHANGED,this.getSelectedRadioButtonValue())},setWidthOfGivenLabels:function(){var a=this.model.get("radioButtonCollection"),b=null,c=null,d=this.getAllTextContainers(),e=null;for(c=0;c<a.length;c++)b=a.models[c],e=d[c],null!=b.get("labelWidth")&&this.$(e).css({width:b.get("labelWidth")+"px"})},getAccIDByReplacingIdPrefix:function(a){return a.replace(this.idPrefix,"")}},{generateRadioButton:function(a){var b;if(a){b="#"+a.id;var c=new MathInteractives.Common.Components.Theme2.Models.RadioButton(a),d=new MathInteractives.Common.Components.Theme2.Views.RadioButton({el:b,model:c});return d}},SELECTION_CHANGED:"selection-changed"}),MathInteractives.global.Theme2.RadioButton=MathInteractives.Common.Components.Theme2.Views.RadioButton}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.RadioButton=Backbone.Model.extend({defaults:{filePath:null,screenID:null,id:null,idPrefix:null,manager:null,direction:"vertical",gapBetweenRadioButtonContainers:null,enabled:!0,radioButtonCollection:null,entireContainerBackgroundColor:"transparent",disabledEntireContainerBackgroundColor:"transparent",hoverEntireContainerBackgroundColor:"transparent",dotContainerBorderColor:"#A3A4A6",disabledDotContainerBorderColor:"#C4C5C6",hoverDotContainerBorderColor:"#949595",dotBackgroundColor:"#4C1787",tabIndex:null,disabledDotBackgroundColor:"#B3B3B3",hoverDotBackgroundColor:"#4C1787"},initialize:function(a){var b=MathInteractives.Common.Components.Theme2.Models.RadioButton,c=null;this.set({radioButtonCollection:new b.RadioButtonCollectionData}),c=this.get("radioButtonCollection");for(var d=0;d<a.elementData.length;d++)c.add(a.elementData[d])}},{RadioButtonData:Backbone.Model.extend({defaults:{elementID:null,text:null,value:null,selected:!1,labelWidth:null}}),RadioButtonCollectionData:Backbone.Collection.extend({initialize:function(){this.model=MathInteractives.Common.Components.Theme2.Models.RadioButton.RadioButtonData}})})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.theme2RadioButton=a(function(a,b,c,d,e){function f(a,b){var d,e,f,h="";return h+="\r\n",f={hash:{},inverse:l.noop,fn:l.program(2,g,b),data:b},(e=c.radioButtonLabel)?d=e.call(a,f):(e=a&&a.radioButtonLabel,d=typeof e===j?e.call(a,f):e),c.radioButtonLabel||(d=m.call(a,d,{hash:{},inverse:l.noop,fn:l.program(2,g,b),data:b})),(d||0===d)&&(h+=d),h+="\r\n"}function g(a,b){var d,e,f="";return f+='\r\n<div class="de-mathematics-interactive-theme2-radio-button single-theme2-radio-container">\r\n    <div id="',(e=c.radioID)?d=e.call(a,{hash:{},data:b}):(e=a&&a.radioID,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'" class="de-mathematics-interactive-theme2-radio-button radio-button-div-container float-left normal">\r\n	 <div class="theme2-radio-button-selceted-dot-container radio-elements">\r\n		<div class="theme2-radio-button-selceted-dot"></div>\r\n	 </div>\r\n	</div>\r\n    <div class="de-mathematics-interactive-radio-button text-container radio-elements typography-body-text">',(e=c.text)?d=e.call(a,{hash:{},data:b}):(e=a&&a.text,d=typeof e===j?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</div>\r\n</div>\r\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i="",j="function",k=this.escapeExpression,l=this,m=c.blockHelperMissing;return i+="\ufeff",h=c["if"].call(b,(h=b&&b.radioButtonLabel,null==h||h===!1?h:h.length),{hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e}),(h||0===h)&&(i+=h),i})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.Slider=MathInteractives.Common.Player.Views.Base.extend({utils:MathInteractives.Common.Utilities.Models.Utils,isIncDecMsgSame:!1,_$sliderContainer:null,_$slider:null,_$sliderHandle:null,_isLabelClicked:!1,handleTooltipView:null,isScreenIdPresent:null,topOffset:null,leftOffset:null,labelOffset:null,initialLabelOffset:null,_prevAccText:"",sliderElemCursor:null,sliderHandleElemCursor:null,initialize:function(){var a=this.model;this.initializeDefaultProperties();var b=a.get("screenId");this.isScreenIdPresent="undefined"!=typeof b&&null!==b,this.isScreenIdPresent&&this.loadScreen(b),this.render(),this._attachEvents()},render:function(){var a,b=this.model,c=this.idPrefix+b.get("sliderId"),d=b.get("step"),e=b.get("selectedValue"),f=MathInteractives.Common.Utilities.Models.Utils,g=MathInteractives.Common.Utilities.Models.BrowserCheck;b.get("smoothSliding")===!0&&(d/=MathInteractives.Common.Components.Theme2.Models.Slider.SLIDER_INTERVAL_DIVIDER),this._$slider=this.$("#"+c).CustomSlider({min:b.get("minValue"),max:b.get("maxValue"),step:d,value:e,animate:b.get("animate"),orientation:b.get("orientation")}),this.$(".ui-slider-handle").attr({id:c+"-handle"}).addClass("slider-handle"),this._$sliderHandle=this.$(".slider-handle"),null!==b.get("sliderBackgroundImageId")?(this._$slider.css({"background-image":'url("'+this.filePath.getImagePath(b.get("sliderBackgroundImageId"))+'")'}),this._$sliderHandle.addClass(b.get("colorType").classPrefix+"-handle")):this._addColor(),b.get("themeType")===MathInteractives.Common.Components.Theme2.Models.Slider.TYPE.TYPE2&&this._addType2SliderColor(),this._setSliderHandlePattern(),this._generateTooltip(),null!==b.get("labelType")&&this._appendLabels(b.get("labelType")),b.get("showSliderValue")===!0&&this._generateSliderValueContainer(),this.loadScreen("theme-2-slider-acc-text");var h=this.isScreenIdPresent?this.getAccMessage(b.get("sliderId")+"-slider-handle",0,[e]):"",i=null,j=b.get("customAccCallback");i=null!==j&&"undefined"!=typeof j.fnc&&null!==j.fnc?j.fnc.apply(j.scope||this,[{navigation:MathInteractives.Common.Components.Theme2.Models.Slider.NAVIGATION.DEFAULT,prevValue:e,nextValue:e}]):this.isScreenIdPresent?this.getAccMessage(b.get("sliderId")+"-slider-handle",1,[e]):"",this.isIncDecMsgSame=this.isScreenIdPresent&&this.getAccMessage(b.get("sliderId")+"-slider-handle",3)?!1:!0,this.createAccDiv({elementId:b.get("containerId"),tabIndex:b.get("tabIndex"),acc:h});var k=(b.get("containerId"),null);this.$el.on("keydown",$.proxy(this.accessSlider,this)),k=parseInt(b.get("tabIndex"),10)+3,this.createAccDiv({elementId:b.get("sliderId")+"-handle",acc:i,tabIndex:k}),this.restrictAccDivSize(b.get("containerId")),a=this.$(".ui-slider-handle"),f.EnableTouch(this.$(".ui-slider-handle"),{specificEvents:f.SpecificEvents.DRAGGABLE}),g.isMobile||a.css({cursor:"url('"+this.filePath.getImagePath("open-hand")+"'), move"}),this.$el.addClass("touch-action-none")},setSliderTabIndex:function(a){var b=this.model;b.set("tabIndex",a),this.setTabIndex(b.get("containerId"),a),this.setTabIndex(this._getAccId(),a+3)},accessSlider:function(a){var b=this.model,c=b.get("selectedValue"),d=b.get("sliderId"),e=a.keyCode?a.keyCode:a.which;if(9===e){var f,g=b.get("customAccCallback");f=null!==g&&"undefined"!=typeof g.fnc&&null!==g.fnc?g.fnc.apply(g.scope||this,[{navigation:MathInteractives.Common.Components.Theme2.Models.Slider.NAVIGATION.DEFAULT,prevValue:c,nextValue:c}]):this.isScreenIdPresent?this.getAccMessage(d+"-slider-handle",1,[c]):"",""!==f.trim()&&this.setAccMessage(d+"-handle",f),this.player._refreshDOM()}},_generateTooltip:function(){var a=this.model;if(a.get("showHandleTooltip")===!0){this.handleTooltipView&&this.handleTooltipView.removeTooltip();var b=this.idPrefix+a.get("sliderId"),c=a.get("selectedValue"),d=this.updateMinusSign(c,a.get("handleTooltipTextPrecision")),e=a.get("handleTooltipText"),f=a.get("customTooltipCallback"),g={path:this.filePath,manager:this.manager,_player:this.player,idPrefix:this.idPrefix,id:b+"-handle-tooltip",elementEl:b+"-handle"};$.extend(g,a.get("tooltipProp")),e=null!==f&&"undefined"!=typeof f.fnc&&null!==f.fnc?f.fnc.apply(f.scope||this,[{exactValue:c,nearestValue:c}]):null===e?d:e.replace("%@$%",d),g.text=e,g.type=g.type||MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.GENERAL,g.arrowType=g.arrowType||a.get("toolTipArrowType"),g.baseClass=g.baseClass||a.get("handleTooltipCustomClass"),this.handleTooltipView=MathInteractives.global.Theme2.Tooltip.generateTooltip(g)}},_generateSliderValueContainer:function(){var a,b,c=this.model,d=c.get("orientation"),e=(c.get("labelType"),c.get("valuePosition"));switch(a=$("<div>",{"class":"slider-value-container"}),b=$("<div>",{"class":"slider-value"}),a.empty().append(b),d===MathInteractives.Common.Components.Theme2.Models.Slider.ORIENTATION.HORIZONTAL?(b.addClass("horizontal"),a.addClass("horizontal"),e===MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_POSITION.ABOVE?(a.insertBefore(this._$slider),a.addClass("above")):e===MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_POSITION.BELOW&&(a.insertAfter(this._$slider),a.addClass("below"))):d===MathInteractives.Common.Components.Theme2.Models.Slider.ORIENTATION.VERTICAL&&(b.addClass("vertical"),a.addClass("vertical"),e===MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_POSITION.LEFT?(a.insertBefore(this._$slider),a.addClass("left")):e===MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_POSITION.RIGHT&&(a.insertAfter(this._$slider),a.addClass("right"))),c.get("valueType")){case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.EXACT_VALUE:case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.NEAREST_VALUE:this._setSliderValueInContainer(c.get("selectedValue"),!0,!0);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.TEXT_WITH_EXACT_VALUE:case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.TEXT_WITH_NEAREST_VALUE:this._setSliderTextInContainer(c.get("selectedValue"),!0,!0),this._setSliderValuePosition(c.get("selectedValue"),!0);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.ARBITRARY_TEXT:this._setSliderTextInContainer(c.get("selectedValue")),this._setSliderValuePosition(c.get("selectedValue"),!0)}},_setSliderValueInContainer:function(a,b,c){if(this.model.get("showSliderValue")!==!1){var d=this;this.$(".slider-value-container .slider-value").html(this.updateMinusSign(a,this.model.get("valuePrecision"))),("undefined"==typeof b||null===b||b===!0)&&d._setSliderValuePosition(a,c)}},_setSliderTextInContainer:function(a,b,c){if(this.model.get("showSliderValue")!==!1){var d=this.model.get("valueText");if("undefined"!=typeof c&&null!==c&&c===!0){var e=this.updateMinusSign(a,this.model.get("valuePrecision"));d=d.replace("%@$%",e)}this.$(".slider-value-container .slider-value").html(d),("undefined"==typeof b||null===b||b===!0)&&this._setSliderValuePosition(a)}},_setSliderValuePosition:function(a,b){var c=this.model;if(c.get("showSliderValue")===!0){var d=c.get("orientation"),e=c.get("minValue"),f=c.get("maxValue"),g=this.$(".slider-value-container");this.$(".slider-value-container .slider-value");if(b&&this._setInitialValueDivOffsetValues(),d===MathInteractives.Common.Components.Theme2.Models.Slider.ORIENTATION.HORIZONTAL){var h;h=b?this._$slider.width()/(f-e)*(a-e)+this.handleOffset+this.leftOffset+c.get("initialLeftAdjustment")+this.labelOffset:this.$(".slider-handle").position().left+this.handleOffset+this.leftOffset+this.labelOffset,g.css("left",h)}else if(d===MathInteractives.Common.Components.Theme2.Models.Slider.ORIENTATION.VERTICAL){var i;if(b){var j=c.get("initialTopAdjustment")+this.initialLabelOffset+MathInteractives.Common.Components.Theme2.Models.Slider.INITIAL_LABEL_OFFSET;i=this._$slider.height()/(f-e)*(f-a)-this.handleOffset+j+this.labelOffset}else i=this.$(".slider-handle").position().top+this.handleOffset+this.topOffset+this.labelOffset+this.initialLabelOffset;g.css("top",i)}}},_setInitialValueDivOffsetValues:function(){var a=this.model,b=a.get("orientation"),c=(a.get("minValue"),a.get("maxValue"),this.$(".slider-value-container"));this.$(".slider-value-container .slider-value");if(this.labelOffset=-10,this.initialLabelOffset=0,b===MathInteractives.Common.Components.Theme2.Models.Slider.ORIENTATION.HORIZONTAL){if(a.get("labelType")===MathInteractives.Common.Components.Theme2.Models.Slider.LABEL_TYPE.MIN_MAX_BESIDE_SLIDER){var d=$("#"+a.get("idPrefix")+"slider-label-1");d.css({visibility:"hidden",display:"block"}),this.labelOffset=parseInt(d.css("margin-right").replace("px",""))+d.width(),d.css({visibility:"",display:""})}this.handleOffset=this.$(".slider-handle").width()/2,this.leftOffset=a.get("sliderValueLeftOffset")+MathInteractives.Common.Components.Theme2.Models.Slider.INITIAL_LEFT_OFFSET}else if(b===MathInteractives.Common.Components.Theme2.Models.Slider.ORIENTATION.VERTICAL){if(a.get("labelType")===MathInteractives.Common.Components.Theme2.Models.Slider.LABEL_TYPE.MIN_MAX_BESIDE_SLIDER){var d=$("#"+a.get("idPrefix")+"slider-label-2");d.css({visibility:"hidden",display:"block"}),this.labelOffset=parseFloat(d.css("margin-bottom").replace("px",""))+d.height(),d.css({visibility:"",display:""}),this.initialLabelOffset=c.height()-d.height()}this.handleOffset=this.$(".slider-handle").height()/2,this.topOffset=a.get("sliderValueTopOffset")+MathInteractives.Common.Components.Theme2.Models.Slider.INITIAL_TOP_OFFSET}},_setDelayedSliderValuePosition:function(a){if(this.model.get("showSliderValue"))var b=this,c=setTimeout(function(){b._setSliderValuePosition(a),clearTimeout(c)},MathInteractives.Common.Components.Theme2.Models.Slider.SLIDER_TRIGGER_TIMER)},_addColor:function(){var a=this.model.get("colorType").classPrefix;this._$slider.addClass(a+"-slider "+a+"-box-shadow"),this._$sliderHandle.addClass(a+"-handle")},_addType2SliderColor:function(){$("<div/>",{"class":"slider-variable-mid"}).prependTo(this._$slider),this._setType2SliderSize(this.getSelectedValue())},_setType2SliderSize:function(a){var b,c,d,e,f=this.model,g=f.get("minValue"),h=f.get("maxValue"),i=this._$slider.width(),j=this._$slider.height();f.get("orientation")===MathInteractives.Common.Components.Theme2.Models.Slider.ORIENTATION.HORIZONTAL?(b=i/(h-g)*(a-g),b=this.utils.roundUpValue(b,2),d=i-b,this.$(".slider-variable-mid").css({width:d+"px"})):f.get("orientation")===MathInteractives.Common.Components.Theme2.Models.Slider.ORIENTATION.VERTICAL&&(c=j/(h-g)*(a-g),c=this.utils.roundUpValue(c,2),e=j-c,this.$(".slider-variable-mid").css({height:e+"px"}))},_setSliderHandlePattern:function(){var a=this.model,b=a.get("numberOfDots"),c=this._$slider,d=this._$sliderHandle,e=c.width(),f=c.height(),g=d.width(),h=d.height();if(d.html(MathInteractives.Common.Components.templates.sliderHandle({data:_.range(b),idPrefix:this.idPrefix,sliderId:a.get("sliderId")}).trim()),a.get("orientation")===MathInteractives.Common.Components.Theme2.Models.Slider.ORIENTATION.HORIZONTAL){var i=(f-h)/2,j=g/2;d.css({top:i+"px","margin-left":-j+"px"}),d.find(".box").addClass("horizontal")}else if(a.get("orientation")===MathInteractives.Common.Components.Theme2.Models.Slider.ORIENTATION.VERTICAL){var k=(e-g)/2,l=h/2;d.css({left:k+"px","margin-bottom":-l+"px"}),d.find(".box").addClass("vertical")}},_appendLabels:function(a){var b,c,d=this.model,e=d.get("minValue"),f=d.get("maxValue"),g=null,h=d.get("labelTexts");switch(a){case MathInteractives.Common.Components.Theme2.Models.Slider.LABEL_TYPE.MIN_MAX:case MathInteractives.Common.Components.Theme2.Models.Slider.LABEL_TYPE.MIN_MAX_BESIDE_SLIDER:g=[e,f],d.set("labelValues",g);break;case MathInteractives.Common.Components.Theme2.Models.Slider.LABEL_TYPE.MIN_MID_MAX:var i=Math.floor((e+f)/2);g=[e,i,f],d.set("labelValues",g);break;case MathInteractives.Common.Components.Theme2.Models.Slider.LABEL_TYPE.CUSTOM:g=d.get("labelValues")}if(b=g.length,null!==g&&null===h){h=[];for(var j=0;b>j;j++)h[j]=this.updateMinusSign(g[j]);d.set("labelTexts",h)}if(null!==g&&"undefined"!=typeof g&&b>0)if(d.get("orientation")===MathInteractives.Common.Components.Theme2.Models.Slider.ORIENTATION.HORIZONTAL)if(a===MathInteractives.Common.Components.Theme2.Models.Slider.LABEL_TYPE.MIN_MAX_BESIDE_SLIDER){var k,l,m=this._$sliderHandle.css("margin-left"),n=Math.abs(Number(m.replace("px",""))),o=(this._$slider.height()-this._$sliderHandle.height())/2;k=$("<div>",{id:this.idPrefix+"slider-label-1",style:"margin-right:"+n+"px;margin-top:"+o+"px;","class":"slider-labels-beside-slider typography-label",labelIndex:0}).html(h[0]),k.insertBefore(this._$slider),this._$slider.css("float","left"),l=$("<div>",{id:this.idPrefix+"slider-label-2",style:"margin-left:"+n+"px;margin-top:"+o+"px;","class":"slider-labels-beside-slider typography-label",labelIndex:1}).html(h[1]),l.insertAfter(this._$slider),d.get("allowLabelNavigation")===!1&&(k.addClass("slider-labels-without-navigation"),l.addClass("slider-labels-without-navigation"))}else{var p,q,r=d.get("allowLabelNavigation"),s=this._$slider.width(),t=f-e;c=$("<div>",{"class":"slider-labels-container"});for(var j=0;b>j;j++)p=(g[j]-e)/t*100,q=$("<div>",{id:this.idPrefix+"slider-label-"+(j+1),style:"left:"+p+"%","class":"slider-labels typography-label",labelIndex:j}).html(h[j]),r===!1&&q.addClass("slider-labels-without-navigation"),c.append(q);this.$el.append(c),this.$(".slider-labels-container").css("width",s+"px")}else if(d.get("orientation")===MathInteractives.Common.Components.Theme2.Models.Slider.ORIENTATION.VERTICAL&&a===MathInteractives.Common.Components.Theme2.Models.Slider.LABEL_TYPE.MIN_MAX_BESIDE_SLIDER){var k,l,u=this._$sliderHandle.css("margin-bottom"),v=Math.abs(Number(u.replace("px",""))),w=((this._$slider.width()-this._$sliderHandle.width())/2,this._$slider.parent().width());k=$("<div>",{id:this.idPrefix+"slider-label-1",style:"margin-top:"+v+"px;width:"+w+"px;text-align:center;","class":"slider-labels-beside-slider typography-label",labelIndex:0}).html(h[0]),this._$slider.css("float","left"),k.insertAfter(this._$slider),this._$slider.css("margin-left",(w-this._$slider.width())/2),l=$("<div>",{id:this.idPrefix+"slider-label-2",style:"margin-bottom:"+v+"px;width:"+w+"px;text-align:center;","class":"slider-labels-beside-slider typography-label",labelIndex:1}).html(h[1]),l.insertBefore(this._$slider),d.get("allowLabelNavigation")===!1&&(k.addClass("slider-labels-without-navigation"),l.addClass("slider-labels-without-navigation"))}},events:{"click .slider-labels:not(.slider-labels-without-navigation)":"_labelClicked","click .slider-labels-beside-slider:not(.slider-labels-without-navigation)":"_labelClicked"},_attachEvents:function(){var a=this.model,b=this._$slider,c=this._$sliderHandle;b.off("slidestart slidestop slide").on({slidestart:$.proxy(this._slideStart,this),slidestop:$.proxy(this._snapToNearestPoint,this),slide:$.proxy(this._updateOnSlide,this),click:$.proxy(this._updateOnClick,this)}),c.off("click.slider").on({"click.slider":$.proxy(this._sliderHandleClicked,this)}),"ontouchstart"in window&&c.off("mouseenter.slider mouseleave.slider"),c.off("mouseenter.slider touchstart.slider mouseleave.slider touchend.slider touchcancel.slider").on({"mouseenter.slider touchstart.slider":$.proxy(this._mouseEnter,this),"mouseleave.slider touchend.slider touchcancel.slider":$.proxy(this._mouseLeave,this)}),c.off("keydown.slider keyup.slider"),this.isAccessible()===!0&&c.on({"keydown.slider":$.proxy(this._moveUsingKeyboard,this),"keyup.slider":$.proxy(this._keyUpOnHandle,this)}),a.off("change:nearestValue").on("change:nearestValue",this._triggerNearestValueChange,this),a.off("change:selectedValue").on("change:selectedValue",this._changeValue,this)},_mouseEnter:function(){var a=this._$sliderHandle,b=MathInteractives.Common.Utilities.Models.BrowserCheck;a.addClass("slider-handle-hover ui-state-hover"),b.isMobile||this.isSliderDisabled()!==!1?b.isMobile||a.removeClass("slider-mouse-over-out"):a.addClass("slider-mouse-over-out")},_mouseLeave:function(){this._$sliderHandle.removeClass("slider-handle-hover ui-state-hover slider-mouse-over-out")},_slideStart:function(a,b){var c=b.value,d=null,e=this.model.get("points"),f=MathInteractives.Common.Utilities.Models.BrowserCheck;if(this._isKeyBoardEvent(a)!==!0){switch(f.isMobile||(this.sliderElemCursor=this.$el.find(".ui-slider").css("cursor"),this.$el.find(".ui-slider").css({cursor:"url('"+this.filePath.getImagePath("closed-hand")+"'), move"}),$(b.handle).css({cursor:"url('"+this.filePath.getImagePath("closed-hand")+"'), move"})),this.hideTabDrawer(),this.model.get("stopReadingOnInteraction")&&this.stopReading(),d=null!==e&&"undefined"!=typeof e&&e.length>0?this._getNearestPointFromArray(c):this._getNearestPoint(c),this.model.get("valueType")){case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.EXACT_VALUE:this._setSliderValueInContainer(b.value);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.NEAREST_VALUE:this._setSliderValueInContainer(d,!1);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.TEXT_WITH_EXACT_VALUE:this._setSliderTextInContainer(b.value,!0,!0);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.TEXT_WITH_NEAREST_VALUE:this._setSliderTextInContainer(d,!1,!0);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.ARBITRARY_TEXT:}
this._setDelayedSliderValuePosition(b.value),this.model.set("nearestValue",d),this.trigger(MathInteractives.Common.Components.Theme2.Models.Slider.EVENTS.SLIDE_START,a,b,d)}},_snapToNearestPoint:function(a,b){var c=MathInteractives.Common.Utilities.Models.BrowserCheck;if(this._isKeyBoardEvent(a)!==!0){c.isMobile||(this.$el.find(".ui-slider").css({cursor:this.sliderElemCursor}),$(b.handle).css({cursor:"url('"+this.filePath.getImagePath("open-hand")+"'), move"}));var d=this.model,e=this,f=d.get("points"),g=b.value,h=null,i=null;switch(h=null!==f&&"undefined"!=typeof f&&f.length>0?this._getNearestPointFromArray(g):this._getNearestPoint(g),this.trigger(MathInteractives.Common.Components.Theme2.Models.Slider.EVENTS.SLIDE_STOP,a,b,h),d.get("valueType")){case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.EXACT_VALUE:this._setSliderValueInContainer(b.value);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.NEAREST_VALUE:this._setSliderValueInContainer(h,!1);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.TEXT_WITH_EXACT_VALUE:this._setSliderTextInContainer(b.value,!0,!0);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.TEXT_WITH_NEAREST_VALUE:this._setSliderTextInContainer(h,!1,!0);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.ARBITRARY_TEXT:}d.get("selectedValue")===h?this._changeSliderValue(d,h):this.setSelectedValue(h),d.get("showHandleTooltip")===!0&&e.handleTooltipView.showTooltip(),i=setTimeout(function(){c.isMobile!==!0&&e._$sliderHandle.hasClass("slider-handle-hover")||d.get("showHandleTooltip")!==!0||d.isSliderTooltipPermanent()===!0||(clearTimeout(i),e.handleTooltipView.hideTooltip())},10),this.trigger(MathInteractives.Common.Components.Theme2.Models.Slider.EVENTS.FINAL_SLIDE_STOP,a,b,h)}},_updateOnSlide:function(a,b){if(this._isKeyBoardEvent(a)!==!0){var c=this.model,d=null,e=b.value,f=this.model.get("points");switch(c.get("themeType")===MathInteractives.Common.Components.Theme2.Models.Slider.TYPE.TYPE2&&this._setType2SliderSize(e),d=null!==f&&"undefined"!=typeof f&&f.length>0?this._getNearestPointFromArray(e):this._getNearestPoint(e),c.get("valueType")){case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.EXACT_VALUE:this._setSliderValueInContainer(e);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.NEAREST_VALUE:this._setSliderValueInContainer(d,!1);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.TEXT_WITH_EXACT_VALUE:this._setSliderTextInContainer(e,!0,!0);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.TEXT_WITH_NEAREST_VALUE:this._setSliderTextInContainer(d,!1,!0);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.ARBITRARY_TEXT:}this._setDelayedSliderValuePosition(e),this._showHandleTooltip(e,d,!0),c.set("nearestValue",d),this.trigger(MathInteractives.Common.Components.Theme2.Models.Slider.EVENTS.SLIDE,a,b,d)}},_updateOnClick:function(a){this.trigger(MathInteractives.Common.Components.Theme2.Models.Slider.EVENTS.SLIDER_CLICK,a)},_changeValue:function(a,b){this.hideTabDrawer(),this.model.get("stopReadingOnInteraction")&&this.stopReading(),this._changeSliderValue(a,b),this.trigger(MathInteractives.Common.Components.Theme2.Models.Slider.EVENTS.VALUE_CHANGE,b,this._isLabelClicked),this._isLabelClicked=!1},_triggerNearestValueChange:function(){this.trigger(MathInteractives.Common.Components.Theme2.Models.Slider.EVENTS.NEAREST_VALUE_CHANGE)},_changeSliderValue:function(a,b){switch(this._showHandleTooltip(b,b),this._$slider.CustomSlider("value",b),a.get("themeType")===MathInteractives.Common.Components.Theme2.Models.Slider.TYPE.TYPE2&&this._setType2SliderSize(b),a.get("valueType")){case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.EXACT_VALUE:case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.NEAREST_VALUE:this._setSliderValueInContainer(b);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.TEXT_WITH_EXACT_VALUE:this._setSliderTextInContainer(b,!0,!0);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.TEXT_WITH_NEAREST_VALUE:this._setSliderTextInContainer(b,!0,!0);break;case MathInteractives.Common.Components.Theme2.Models.Slider.VALUE_TYPE.ARBITRARY_TEXT:}this._setDelayedSliderValuePosition(b),a.get("setDefaultMsgOnValueChange")===!0&&this.setDefaultAccMessage()},setDefaultAccMessage:function(){var a,b=this.model,c=b.get("customAccCallback"),d=b.get("selectedValue"),e=this.isScreenIdPresent?this.getAccMessage(b.get("sliderId")+"-slider-handle",0,[d]):"";a=null!==c&&"undefined"!=typeof c.fnc&&null!==c.fnc?c.fnc.apply(c.scope||this,[{navigation:MathInteractives.Common.Components.Theme2.Models.Slider.NAVIGATION.DEFAULT,prevValue:d,nextValue:d}]):this.isScreenIdPresent?this.getAccMessage(b.get("sliderId")+"-slider-handle",1,[d]):"",""!==a.trim()&&this.setAccMessage(b.get("sliderId")+"-handle",a),""!==e.trim()&&this.setAccMessage(b.get("containerId"),e)},_moveUsingKeyboard:function(a){if(this.isSliderDisabled()!==!0){var b,c,d,e=MathInteractives.Common.Components.Theme2.Models.Slider,f=this.model,g=f.get("sliderId"),h=(this._getAccId(),f.get("points")),i=f.get("selectedValue"),j=f.get("step"),k=f.get("minValue"),l=f.get("maxValue"),m=!1,n=null,o=f.get("customAccCallback");switch(a.keyCode){case 38:case 39:case 33:null!==h&&"undefined"!=typeof h&&h.length>0?c=this._getNextPoint():(d=this.getUpperNearestPoint(i),c=d>i?d:this.utils.addDecimalNumber(d,j)),b=e.NAVIGATION.INCREASE,n=2,(m=l>=c)||(c=i,b=e.NAVIGATION.MAX,n=5);break;case 40:case 37:case 34:null!==h&&"undefined"!=typeof h&&h.length>0?c=this._getPreviousPoint():(d=this.getLowerNearestPoint(i),c=i>d?d:this.utils.subtractDecimalNumber(d,j)),b=e.NAVIGATION.DECREASE,n=this.isIncDecMsgSame?2:3,(m=c>=k)||(c=i,b=e.NAVIGATION.MIN,n=4);break;case 36:c=null!==h&&"undefined"!=typeof h&&h.length>0?h[0]:k,b=e.NAVIGATION.MIN,n=4,m=c!==i;break;case 35:c=null!==h&&"undefined"!=typeof h&&h.length>0?h[h.length-1]:l,b=e.NAVIGATION.MAX,n=5,m=c!==i}if(null!==n){var p=this.isScreenIdPresent?this.getAccMessage(g+"-slider-handle",0,[c]):"",q="";q=null!==o&&"undefined"!=typeof o.fnc&&null!==o.fnc?o.fnc.apply(o.scope||this,[{navigation:b,prevValue:i,nextValue:c}]):this.isScreenIdPresent?this.getAccMessage(g+"-slider-handle",n,[c]):"",this._prevAccText=this._prevAccText===q?q+" ":q,""!==this._prevAccText.trim()&&this.setAccMessage(g+"-handle",this._prevAccText),a.preventDefault(),this._setSelfFocus(),this._keyDownOnHandle(a),""!==p.trim()&&this.setAccMessage(f.get("containerId"),p),m===!0&&this.setSelectedValue(c)}}},_sliderHandleClicked:function(a){this.trigger(MathInteractives.Common.Components.Theme2.Models.Slider.EVENTS.SLIDER_HANDLE_CLICK,a)},_keyUpOnHandle:function(a){this.trigger(MathInteractives.Common.Components.Theme2.Models.Slider.EVENTS.SLIDER_HANDLE_KEY_UP,a)},_keyDownOnHandle:function(a){this.trigger(MathInteractives.Common.Components.Theme2.Models.Slider.EVENTS.SLIDER_HANDLE_KEY_DOWN,a)},_labelClicked:function(a){if(this.isSliderDisabled()!==!0){var b=this.model,c=b.get("labelValues"),d=c[Number(this.$(a.currentTarget).attr("labelIndex"))],e=b.get("points");d=null!==e&&"undefined"!=typeof e?this._getNearestPointFromArray(d):this._getNearestPoint(d),this._isLabelClicked=!0,this.setSelectedValue(d)}},setMinValue:function(a){this.model.set("minValue",a),this._$slider.CustomSlider("option","min",a),this.getSelectedValue()<a&&this.setSelectedValue(a)},getMinValue:function(){return this.model.get("minValue")},setMaxValue:function(a){this.model.set("maxValue",a),this._$slider.CustomSlider("option","max",a),this.getSelectedValue()>a&&this.setSelectedValue(a)},getMaxValue:function(){return this.model.get("maxValue")},setStep:function(a){this.model.set("step",a),this.model.get("smoothSliding")===!0&&(a/=MathInteractives.Common.Components.Theme2.Models.Slider.SLIDER_INTERVAL_DIVIDER),this._$slider.CustomSlider("option","step",a)},getStep:function(){return this.model.get("step")},setSelectedValue:function(a){var b=this.model.get("minValue"),c=this.model.get("maxValue");b>a?a=b:a>c&&(a=c),this.model.set("nearestValue",a),this.model.set("selectedValue",a)},getSelectedValue:function(){return this.model.get("selectedValue")},getNearestValue:function(){return this.model.get("nearestValue")},disableSlider:function(){var a,b,c,d=this.model,e=MathInteractives.Common.Utilities.Models.BrowserCheck;a=this.$el.find(".ui-slider"),b=this.$el.find(".ui-slider-handle"),this.sliderElemCursor=a.css("cursor"),this.sliderHandleElemCursor=b.css("cursor"),this._$slider.CustomSlider("disable"),this.$el.addClass("disabled"),this._$slider.addClass("disabled"),this._$sliderHandle.addClass("disabled"),d.get("showHandleTooltip")===!0&&this.handleTooltipView.removeTooltip(),c=d.get("labelType")===MathInteractives.Common.Components.Theme2.Models.Slider.LABEL_TYPE.MIN_MAX_BESIDE_SLIDER?"slider-labels-beside-slider":"slider-labels",this.$("."+c).addClass("disabled"),this.enableTab(d.get("containerId"),!1),this.enableTab(this._getAccId(),!1),e.isMobile||(a.css({cursor:"default"}),b.css({cursor:"default"}))},enableSlider:function(){var a,b,c,d=this.model,e=MathInteractives.Common.Utilities.Models.BrowserCheck;this._$slider.CustomSlider("enable"),this.$el.removeClass("disabled"),this._generateTooltip(),this._$slider.removeClass("disabled"),this._$sliderHandle.removeClass("disabled"),c=d.get("labelType")===MathInteractives.Common.Components.Theme2.Models.Slider.LABEL_TYPE.MIN_MAX_BESIDE_SLIDER?"slider-labels-beside-slider":"slider-labels",this.$("."+c).removeClass("disabled"),this.enableTab(d.get("containerId"),!0),this.enableTab(this._getAccId(),!0),e.isMobile||(a=this.$el.find(".ui-slider"),b=this.$el.find(".ui-slider-handle"),a.css({cursor:this.sliderElemCursor}),b.css({cursor:"url('"+this.filePath.getImagePath("open-hand")+"'), move"}))},hideSlider:function(){this.$el.hide()},showSlider:function(){this.$el.show()},isSliderDisabled:function(){return this._$slider.CustomSlider("option","disabled")},_showHandleTooltip:function(a,b,c){var d=this.model;if(d.get("showHandleTooltip")===!0){var e,f=d.get("customTooltipCallback");if(null!==f&&"undefined"!=typeof f.fnc&&null!==f.fnc)e=f.fnc.apply(f.scope||this,[{exactValue:a,nearestValue:b}]);else{var g,h;switch(d.get("handleTooltipValueType")){case MathInteractives.Common.Components.Theme2.Models.Slider.TOOLTIP_VALUE_TYPE.EXACT_VALUE:g=a;break;case MathInteractives.Common.Components.Theme2.Models.Slider.TOOLTIP_VALUE_TYPE.NEAREST_VALUE:g=b}h=this.updateMinusSign(g,d.get("handleTooltipTextPrecision")),e=d.get("handleTooltipText"),e=null===e?h:e.replace("%@$%",h)}if(this.handleTooltipView.changeText(e),this._$sliderHandle.hasClass("slider-handle-hover")||c||d.isSliderTooltipPermanent()===!0)var i=this,j=setTimeout(function(){i.handleTooltipView.showTooltip(),clearTimeout(j)},1)}},showHideTooltip:function(a){null!==this.handleTooltipView&&(a===!0?this.handleTooltipView.showTooltip():this.handleTooltipView.hideTooltip())},_numberPrecision:function(a,b){return b?(a=Number(a),b=Number(b),Number(a.toFixed(b))):a},changeHandleTooltipText:function(a){this.model.setTooltipText(a)},changeSliderAccMessage:function(a){var b=this._getAccId();this.setAccMessage(b,a),this._setSelfFocus()},_setSelfFocus:function(){var a=this._getAccId();this.$(".dummy-slider-focus-div").focus(),this.setFocus(a,0)},_getAccId:function(){var a=this.model.get("sliderId")+"-handle";return a},_getNearestPoint:function(a){var b=(this.model.get("step"),this.getLowerNearestPoint(a)),c=this.getUpperNearestPoint(a),d=a-b,e=c-a,f=e>=d?b:c;return 0==f&&(f=Math.abs(f)),f},getUpperNearestPoint:function(a){var b=this.model.get("step"),c=this.getLowerNearestPoint(a),d=c===a?a:this.utils.addDecimalNumber(c,b);return d},getLowerNearestPoint:function(a){var b=this.model.get("step"),c=this.model.get("minValue"),d=parseInt(this.utils.subtractDecimalNumber(a,c)/b),e=this.utils.addDecimalNumber(c,this.utils.multiplyDecimalNumber(d,b));return e},getNearestPoint:function(a){return this._getNearestPoint(a)},_getNearestPointFromArray:function(a){for(var b=this.model.get("points"),c=b.length,d=b[0],e=0;c>e;e++)Math.abs(a-b[e])<Math.abs(a-d)&&(d=b[e]);return d},_isKeyBoardEvent:function(a){var b=33,c=34,d=35,e=36,f=37,g=38,h=39,i=40,j=a.which===b||a.which===c||a.which===d||a.which===e||a.which===f||a.which===g||a.which===h||a.which===i;return j},_getNextPoint:function(){var a=this.model,b=a.get("points"),c=a.get("selectedValue"),d=b.indexOf(c),e=null;switch(d){case b.length-1:e=b[b.length-1];break;case-1:e=this._getNearestPointFromArray(c);break;default:e=b[d+1]}return e},_getPreviousPoint:function(){var a=this.model,b=a.get("points"),c=a.get("selectedValue"),d=b.indexOf(c),e=null;switch(d){case 0:e=b[0];break;case-1:e=this._getNearestPointFromArray(c);break;default:e=b[d-1]}return e},updateMinusSign:function(a,b){var c,d=MathInteractives.Common.Utilities.Models.Utils,e="";return c="undefined"==typeof b||null===b||"number"!=typeof b?Math.abs(a):Math.abs(a).toFixed(b),0>a&&(e+=d.getOperatorHtml(d.OPERATOR.MINUS)),e+='<span class="text">'+c+"</span>"}},{generateSlider:function(a){if(null!==a&&"undefined"!=typeof a){var b,c,d;return b="#"+a.player.getIDPrefix()+a.containerId,c=new MathInteractives.Common.Components.Theme2.Models.Slider(a),d=new MathInteractives.Common.Components.Theme2.Views.Slider({el:b,model:c})}}}),MathInteractives.global.Theme2.Slider=MathInteractives.Common.Components.Theme2.Views.Slider}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.Slider=Backbone.Model.extend({defaults:function(){return{containerId:null,sliderId:null,screenId:null,minValue:1,maxValue:10,selectedValue:null,nearestValue:null,step:1,smoothSliding:!0,animate:!1,orientation:null,tabIndex:null,sliderBackgroundImageId:null,labelType:null,labelValues:null,labelTexts:null,allowLabelNavigation:!0,points:null,themeType:null,colorType:null,numberOfDots:6,showHandleTooltip:!1,handleTooltipText:null,handleTooltipTextPrecision:null,handleTooltipValueType:null,handleTooltipCustomClass:"",toolTipArrowType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE,customTooltipCallback:null,showSliderValue:!1,valuePosition:null,tooltipProp:{},valueType:null,valueText:"",valuePrecision:0,sliderValueLeftOffset:0,sliderValueTopOffset:0,initialLeftAdjustment:0,initialTopAdjustment:0,customAccCallback:null,setDefaultMsgOnValueChange:!1,stopReadingOnInteraction:!0}},initialize:function(){var a=null,b=this.get("minValue"),c=this.get("maxValue"),d=this.get("selectedValue"),e=this.get("points"),f=MathInteractives.Common.Components.Theme2.Models.Slider;if(null!==e&&(b=e[0],c=e[e.length-1],this.set("minValue",b),this.set("maxValue",c)),null===d&&(d=this.get("minValue"),this.set("selectedValue",d)),this.set("nearestValue",d),null===this.get("orientation")&&this.set("orientation",f.ORIENTATION.HORIZONTAL),null===this.get("themeType")&&this.set("themeType",f.TYPE.TYPE1),null===this.get("colorType")&&this.set("colorType",f.COLOR_TYPE.PURPLE),a=this.get("colorType").sliderBackgroundImageId,null!==a&&"undefined"!=typeof a&&this.set("sliderBackgroundImageId",a),this.get("showHandleTooltip")===!0){var g=this.get("handleTooltipValueType");null===g&&(g=f.TOOLTIP_VALUE_TYPE.NEAREST_VALUE,this.set("handleTooltipValueType",g))}if(this.get("showSliderValue")===!0){var h=this.get("valuePosition"),i=this.get("valueType");null===h&&(this.get("orientation")===f.ORIENTATION.HORIZONTAL?h=f.VALUE_POSITION.ABOVE:this.get("orientation")===f.ORIENTATION.VERTICAL&&(h=f.VALUE_POSITION.LEFT),this.set("valuePosition",h)),null===i&&(i=f.VALUE_TYPE.NEAREST_VALUE,this.set("valueType",i))}},setTooltipText:function(a){this.get("showHandleTooltip")===!0&&this.set("handleTooltipText",a)},getTooltipText:function(){var a="";return this.get("showHandleTooltip")===!0&&(a=this.get("handleTooltipText"),null===a&&(a=this.get("selectedValue"))),a},isSliderTooltipPermanent:function(){return this.get("tooltipProp").isTooltipPermanent}},{ORIENTATION:{HORIZONTAL:"horizontal",VERTICAL:"vertical"},TYPE:{TYPE1:"type1",TYPE2:"type2"},COLOR_TYPE:{PURPLE:{classPrefix:"color-type-purple"},GREEN:{classPrefix:"color-type-green"},GRAY:{classPrefix:"color-type-gray"},LIGHT_GREEN:{classPrefix:"color-type-light-green"},BLUE:{classPrefix:"color-type-blue"},PINK:{classPrefix:"color-type-pink"},PINK_WITH_IMAGE:{classPrefix:"color-type-pink",sliderBackgroundImageId:"slider_texture_1"},CUSTOM:{classPrefix:"color-type-custom"}},LABEL_TYPE:{MIN_MAX:"min-max",MIN_MAX_BESIDE_SLIDER:"min-max-beside-slider",MIN_MID_MAX:"min-mid-max",CUSTOM:"custom"},TOOLTIP_VALUE_TYPE:{EXACT_VALUE:"exact-value",NEAREST_VALUE:"nearest-value"},VALUE_POSITION:{ABOVE:"above",BELOW:"below",LEFT:"left",RIGHT:"right"},VALUE_TYPE:{EXACT_VALUE:"exact-value",NEAREST_VALUE:"nearest-value",ARBITRARY_TEXT:"arbitrary-text",TEXT_WITH_EXACT_VALUE:"text-with-exact-value",TEXT_WITH_NEAREST_VALUE:"text-with-nearest-value"},EVENTS:{SLIDE_START:"slide-start",SLIDE:"slide",SLIDE_STOP:"slide-stop",VALUE_CHANGE:"value-change",SLIDER_CLICK:"slider-click",SLIDER_HANDLE_CLICK:"slider-handle-click",SLIDER_HANDLE_KEY_UP:"slider-handle-key-up",SLIDER_HANDLE_KEY_DOWN:"slider-handle-key-down",FINAL_SLIDE_STOP:"final_slide_stop",NEAREST_VALUE_CHANGE:"change-nearest-value"},INITIAL_LEFT_OFFSET:-53,INITIAL_TOP_OFFSET:-8.5,INITIAL_LABEL_OFFSET:4,SLIDER_INTERVAL_DIVIDER:30,SLIDER_TRIGGER_TIMER:1,NAVIGATION:{DEFAULT:"default",DECREASE:"decrease",INCREASE:"increase",MIN:"min",MAX:"max"}})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.sliderHandle=a(function(a,b,c,d,e){function f(a,b){return'\r\n       <div class="inside-divs" ></div>\r\n    '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i="",j=this,k="function",l=this.escapeExpression;return i+='<div class="box">\r\n    ',g=c.each.call(b,b&&b.data,{hash:{},inverse:j.noop,fn:j.program(1,f,e),data:e}),(g||0===g)&&(i+=g),i+='\r\n</div>\r\n<div id="',(h=c.idPrefix)?g=h.call(b,{hash:{},data:e}):(h=b&&b.idPrefix,g=typeof h===k?h.call(b,{hash:{},data:e}):h),i+=l(g),(h=c.sliderId)?g=h.call(b,{hash:{},data:e}):(h=b&&b.sliderId,g=typeof h===k?h.call(b,{hash:{},data:e}):h),i+=l(g)+'-dummy-slider-focus-div" class="dummy-slider-focus-div"></div>'})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.Feedback=Backbone.Model.extend({defaults:function(){return{player:null,manager:null,filePath:null,idPrefix:null,feedbackContainerID:null,headerText:null,accHeaderText:null,text:null,accText:null,tabIndex:null,buttonAccText:null,ttsColorType:null,buttonPropertiesArray:[]}},initialize:function(){},getPlayer:function(){return this.get("player")},getManager:function(){return this.get("manager")},getFilePath:function(){return this.get("filePath")},getIdPrefix:function(){return this.get("idPrefix")},getFeedbackContainerID:function(){return this.get("feedbackContainerID")}})}(window.MathInteractives),function(){"use strict";if(!MathInteractives.Common.Components.Theme2.Views.Feedback){var a=null;MathInteractives.Common.Components.Theme2.Views.Feedback=MathInteractives.Common.Player.Views.Base.extend({player:null,idPrefix:null,manager:null,filePath:null,buttonViews:null,ttsView:null,initialize:function(){this.player=this.model.get("player"),this.idPrefix=this.model.get("idPrefix"),this.manager=this.model.get("manager"),this.filePath=this.model.get("filePath"),this.render()},render:function(){this.renderTemplate(),this.renderTTS(),this.renderText(),this.renderButtons()},renderTemplate:function(){var a={idPrefix:this.idPrefix,buttonPropertiesArray:this.model.get("buttonPropertiesArray")},b=MathInteractives.Common.Components.templates.theme2Feedback(a).trim();this.$el.append(b)},renderTTS:function(){this.log("tts");var a=this.model.get("tabIndex"),b={containerId:this.idPrefix+"feedback-tts-container",manager:this.manager,player:this.player,filePath:this.filePath,ttsColor:this.model.get("ttsColorType"),idPrefix:this.idPrefix,messagesToPlay:[this.idPrefix+"feedback-text-container"]};this.ttsView=MathInteractives.global.Theme2.PlayerTTS.generateTTS(b),a&&(a+=2,this.ttsView.renderTTSAccessibility(a))},renderText:function(){this.changeFeedbackText(),this.changeHeaderText()},renderButtons:function(){var a=null,b=this.model.get("buttonPropertiesArray"),c=this.model.get("buttonAccText"),d=b.length,e=null,f=null,g=null,h=this.model.get("tabIndex");for(this.buttonViews=[],a=this.buttonViews,e=0;d>e;e++)if(g=null,f=b[e],f.id=this.idPrefix+"feedback-button-"+e+"-container",f.type=f.type?f.type:MathInteractives.global.Theme2.Button.TYPE.TEXT,g=MathInteractives.global.Theme2.Button.generateButton({data:b[e],path:this.filePath,player:this.player}),a.push(g),this.attachClickHandlerForButtons(e),h){h=this.getTabIndex("feedback-text-wrapper")+5*(e+1);var i={elementId:"feedback-button-"+e+"-container",role:"button",tabIndex:h,acc:c?c[e]:f.text};this.createAccDiv(i)}},attachClickHandlerForButtons:function(b){var c=this,d=this.buttonViews[b];d.$el.on("click",function(){c.trigger(a.FEEDBACK_BUTTON_CLICK,{buttonView:d,index:b})})},hideFeedback:function(){this.$("."+a.FEEDBACK_WRAPPER_SELECTOR).hide()},showFeedback:function(){this.$("."+a.FEEDBACK_WRAPPER_SELECTOR).show(),this.updateFocusRect(a.FEEDBACK_TEXT_CONTAINER_SELECTOR)},changeHeaderText:function(b,c){b&&this.model.set("headerText",b);var d=this.$("."+a.FEEDBACK_HEADER_TEXT_CONTAINER_SELECTOR),b=this.model.get("headerText");d.html(b)},changeFeedbackText:function(b,c,d){b&&this.model.set("text",b),c&&this.model.set("accText",c);var e=this.$("."+a.FEEDBACK_TEXT_CONTAINER_SELECTOR),b=this.model.get("text"),f=this.model.get("tabIndex"),c=this.model.get("accText");if(void 0!==d&&null!==d)d.tabIndex=f,this.createAccDiv(d);else{var g={elementId:a.FEEDBACK_TEXT_WRAPPER,tabIndex:f,loc:"",acc:c?c:b};this.createAccDiv(g)}e.html(b)},hideTTS:function(){this.ttsView.$el.hide()},showTTS:function(){this.ttsView.$el.show()}},{generateFeedback:function(a){var b=null,c=null;return a?(b=new MathInteractives.Common.Components.Theme2.Models.Feedback(a),c=new MathInteractives.Common.Components.Theme2.Views.Feedback({model:b,el:"#"+a.idPrefix+a.feedbackContainerID})):void 0},FEEDBACK_WRAPPER_SELECTOR:"feedback-wrapper",FEEDBACK_TEXT_CONTAINER_SELECTOR:"feedback-text-container",FEEDBACK_HEADER_TEXT_CONTAINER_SELECTOR:"feedback-header-text-container",FEEDBACK_BUTTONS_CONTAINER:"feedback-buttons-container",FEEDBACK_BUTTON_CLICK:"feedback-button-click",FEEDBACK_TEXT_WRAPPER:"feedback-text-wrapper"}),MathInteractives.global.Theme2.Feedback=a=MathInteractives.Common.Components.Theme2.Views.Feedback}}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.theme2Feedback=a(function(a,b,c,d,e){function f(a,b,c){var d,e="";return e+='\r\n        <div id="'+k((d=c&&c.idPrefix,typeof d===j?d.apply(a):d))+"feedback-button-"+k((d=null==b||b===!1?b:b.index,typeof d===j?d.apply(a):d))+'-container" class="feedback-button-container">\r\n        </div>\r\n        '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i="",j="function",k=this.escapeExpression,l=this;return i+='\ufeff<div class="feedback-wrapper">\r\n    <div id="',(h=c.idPrefix)?g=h.call(b,{hash:{},data:e}):(h=b&&b.idPrefix,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+'feedback-text-wrapper" class="feedback-text-wrapper">\r\n        <div id="',(h=c.idPrefix)?g=h.call(b,{hash:{},data:e}):(h=b&&b.idPrefix,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+'feedback-header-text-container" class="feedback-header-text-container">\r\n        </div>\r\n        <div id="',(h=c.idPrefix)?g=h.call(b,{hash:{},data:e}):(h=b&&b.idPrefix,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+'feedback-text-container" class="feedback-text-container">\r\n        </div>\r\n        <div id="',(h=c.idPrefix)?g=h.call(b,{hash:{},data:e}):(h=b&&b.idPrefix,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+'feedback-tts-container"  class="feedback-tts-container">\r\n        </div>\r\n    </div>\r\n    <div class="feedback-buttons-container">\r\n\r\n        ',g=c.each.call(b,b&&b.buttonPropertiesArray,{hash:{},inverse:l.noop,fn:l.programWithDepth(1,f,e,b),data:e}),(g||0===g)&&(i+=g),i+="\r\n\r\n    </div>\r\n\r\n</div>"})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.ToggleButton||(MathInteractives.Common.Components.Theme2.Views.ToggleButton=MathInteractives.Common.Player.Views.Base.extend({player:null,idPrefix:null,baseClass:null,manager:null,btnTooltipView:null,filePath:null,text:null,_btnType:null,margin:null,width:null,handleWidth:null,customEvent:"changeState",initialize:function(){var a;this.player=this.model.get("player"),this.baseClass=this.model.get("baseClass"),this.idPrefix=this.model.get("idPrefix"),this.manager=this.model.get("manager"),this.filePath=this.model.get("path"),this.margin=this.model.get("margin"),this.width=this.model.get("width"),a=this.model.get("handleWidth"),a<this.width?this.handleWidth=a:this.handleWidth=this.Width,this.render(),this._attachEvents()},render:function(){this._generateButton()},_generateButton:function(){var a,b=this.model,c=b.get("height"),d=b.get("handleHeight"),e=null,f=null,g=null,h=(b.get("hoverClass"),b.get("type")),i=b.get("cssCustomClass"),j=b.get("toggleImagePath"),k=b.get("handleImagePath"),l=b.get("toggleBackground"),m=b.get("handleBackground"),n=b.get("toggleBoxShadowColor"),o=b.get("tabIndex"),p=this.$el,q=this.width,r=this.handleWidth,s=this.margin,t=MathInteractives.Common.Components.templates.theme2ToggleSlider({idPrefix:this.$el.attr("id")}).trim();null===b.get("text")||void 0===b.get("text")?(e=this.manager.getMessage("toggle-button-txt",0),g=this.manager.getMessage("toggle-button-txt",1)):(f=b.get("text"),e=f[0],g=f[1]),this.text=[e,g],this.model.set("text",this.text),d=c>d?d:c,a=(c-d)/2,p.append(t),this.$(".on-text").text(e),this.$(".off-text").text(g),h===MathInteractives.Common.Components.Theme2.Views.ToggleButton.TYPE.CUSTOM?(p.addClass("toggle-button-general-container").addClass(i),null===l?p.css({background:"url("+j+")"}):p.css({background:l}),null===m?p.find(".handle").css({background:"url("+k+")"}):p.find(".handle").addClass(m),p.css({width:q+"px",height:c+"px",cursor:"pointer","box-shadow":"inset 2px 3px"+n}),p.find(".toggle-button-containment").css({"margin-left":s+"px","margin-right":s+"px",width:q-2*s+"px",height:c+"px"}),p.find(".on-text").css({width:q-r-2*s+"px",height:c+"px","line-height":c+s+"px"}),p.find(".off-text").css({width:q-r-2*s+"px",height:c+"px","line-height":c+s+"px"}),p.find(".handle").css({width:r+"px",height:d+"px","margin-top":a+"px"})):(p.addClass("toggle-button-"+h.category+"-container"),null!==j?p.css({background:"url("+j+")"}):null!==l&&p.css({background:l}),null!==k?p.find(".handle").css({background:"url("+k+")"}):null!==m&&p.find(".handle").css({background:m})),p.find(".off-text").hide();var u=this.$el.attr("id"),v={elementId:u+"-toggle-button-containment",tabIndex:o,acc:""};this.manager.createAccDiv(v)},_attachEvents:function(){var a,b=this.$el,c=this,d=(this.player.getTextHeightWidth(c.text[0]),this.player.getTextHeightWidth(c.text[1]),this.width),e=this.handleWidth,f=this.margin,g=MathInteractives.Common.Components.Theme2.Views.ToggleButton,h=this.model.get("isDraggable");b.off("click.togglebtn").on("click.togglebtn",$.proxy(this._clicked,this)),h===!0&&(MathInteractives.Common.Utilities.Models.Utils.EnableTouch(this.$(".handle")),b.find(".handle").draggable({start:function(a,b){c._dragStart()},drag:function(a,b){b.position.left+e/2<=d/2?c._dropHandle(".on-text",".off-text",g.TOGGLEBUTTON_STATE_OFF):b.position.left+e/2>=d/2&&c._dropHandle(".off-text",".on-text",g.TOGGLEBUTTON_STATE_ON)},stop:function(h,i){c._dragStop(),a=c.getButtonState(),a===g.TOGGLEBUTTON_STATE_ON?(c._dropHandle(".off-text",".on-text",g.TOGGLEBUTTON_STATE_ON),b.find(".handle").css("left",d-e-2*f+"px"),c.trigger(g.ACTION_COMPLETE_EVENT,a)):a===g.TOGGLEBUTTON_STATE_OFF&&(c._dropHandle(".on-text",".off-text",g.TOGGLEBUTTON_STATE_OFF),b.find(".handle").css("left","0px"),c.trigger(g.ACTION_COMPLETE_EVENT,a))},containment:b.find(".toggle-button-containment"),axis:"x",scroll:!1})),b.find(".handle").off("mouseover.togglebtn").on("mouseover.togglebtn",$.proxy(this._mouseEnterHandle,this)),b.find(".handle").off("mouseout.togglebtn").on("mouseout.togglebtn",$.proxy(this._mouseLeaveHandle,this))},_mouseEnterHandle:function(){var a=this.model.get("hoverClass"),b=this.$el;b.find(".handle").addClass(a)},_mouseLeaveHandle:function(){var a=this.model.get("hoverClass"),b=this.$el;b.find(".handle").removeClass(a)},_dragStart:function(){this.$el.off("click.togglebtn")},_dragStop:function(){this.$el.off("click.togglebtn").on("click.togglebtn",$.proxy(this._clicked,this))},_draggedHandleStart:function(a){var b=this.getButtonState(),c=this,d=MathInteractives.Common.Components.Theme2.Views.ToggleButton,e=this.$el;return b===d.TOGGLEBUTTON_STATE_DISABLED?void e.css("cursor","default"):void(b===d.TOGGLEBUTTON_STATE_ON?e.find(".on-text").droppable({accept:".handle",drop:function(a,b){c._dropHandle(".off-text",".on-text",d.TOGGLEBUTTON_STATE_ON)}}):b===d.TOGGLEBUTTON_STATE_OFF&&e.find(".off-text").droppable({accept:".handle",drop:function(a,b){c._dropHandle(".on-text",".off-text",d.TOGGLEBUTTON_STATE_OFF)}}))},_dropHandle:function(a,b,c){var d=this.$el;d.find(a).hide(),d.find(b).show(),this.setButtonState(c,!0)},_clicked:function(a,b){var c=this.getButtonState(),d=this,e=this.width-this.handleWidth-2*this.margin,f=this.$el,g=this.model.get("prevState"),h=MathInteractives.Common.Components.Theme2.Views.ToggleButton;if(("undefined"==typeof b||null===b)&&(b=200),c===h.TOGGLEBUTTON_STATE_DISABLED)d._enableDraggable("disable"),f.off("click.togglebtn"),f.find(".handle").off("mouseover.togglebtn"),f.find(".handle").off("mouseout.togglebtn"),f.css({cursor:"default"});else if(c===h.TOGGLEBUTTON_STATE_ENABLED)f.css({cursor:"pointer"}),this._enableDraggable("enable"),f.find(".handle").on("mouseover.togglebtn",$.proxy(this._mouseEnterHandle,this)),f.find(".handle").on("mouseout.togglebtn",$.proxy(this._mouseLeaveHandle,this)),this.setButtonState(g,!0);else if(c===h.TOGGLEBUTTON_STATE_ON){f.off("click.togglebtn"),d._enableDraggable("disable"),f.find(".on-text").hide(),f.find(".handle").css("left",e+"px");var i=this.model.get("hoverClass"),f=this.$el;f.find(".handle").removeClass(i),f.find(".handle").animate({left:"0px"},b).promise().done(function(){f.find(".off-text").show(),d.setButtonState(h.TOGGLEBUTTON_STATE_OFF,!0),d._enableDraggable("enable"),f.on("click.togglebtn",$.proxy(d._clicked,d)),d.trigger(h.ACTION_COMPLETE_EVENT,h.TOGGLEBUTTON_STATE_OFF)})}else if(c===h.TOGGLEBUTTON_STATE_OFF){e+="px",f.off("click.togglebtn"),d._enableDraggable("disable"),f.find(".off-text").hide();var i=this.model.get("hoverClass"),f=this.$el;f.find(".handle").removeClass(i),f.find(".handle").animate({left:e},b).promise().done(function(){f.find(".on-text").show(),d.setButtonState(h.TOGGLEBUTTON_STATE_ON,!0),d._enableDraggable("enable"),f.on("click.togglebtn",$.proxy(d._clicked,d)),d.trigger(h.ACTION_COMPLETE_EVENT,h.TOGGLEBUTTON_STATE_ON)})}},_enableDraggable:function(a){var b=this.$el,c=this.model.get("isDraggable");c===!0&&b.find(".handle").draggable(a)},setButtonState:function(a,b){var c=this.model,d=c.get("prevState"),e=MathInteractives.Common.Components.Theme2.Views.ToggleButton,f=null,g="disabled",h="on",i="off",j=this.$el,k=this.manager,l=this.getButtonState();if(l===e.TOGGLEBUTTON_STATE_ENABLED||a!==d){switch(j.removeClass(h).removeClass(i).removeClass(g),a){case e.TOGGLEBUTTON_STATE_ON:f=e.TOGGLEBUTTON_STATE_ON,j.addClass(h);break;case e.TOGGLEBUTTON_STATE_OFF:f=e.TOGGLEBUTTON_STATE_OFF,j.addClass(i);
break;case e.TOGGLEBUTTON_STATE_DISABLED:f=e.TOGGLEBUTTON_STATE_DISABLED,j.addClass(g),k&&this.enableTab(this.$(".toggle-button-containment").attr("id").replace(this.idPrefix,""),!1);break;case e.TOGGLEBUTTON_STATE_ENABLED:f=e.TOGGLEBUTTON_STATE_ENABLED,k&&this.enableTab(this.$(".toggle-button-containment").attr("id").replace(this.idPrefix,""),!0)}this.model.currentState=f,(a===e.TOGGLEBUTTON_STATE_ON||a===e.TOGGLEBUTTON_STATE_OFF)&&this.model.set("prevState",a),b===!0&&this.trigger(this.customEvent,[this.getButtonState()])}},getButtonState:function(){return this.model.currentState},showButtonDiv:function(){this.$el.show()},hideButton:function(){this.$el.hide()},changeText:function(a){this.$(".on-text").text(a[0]),this.$(".off-text").text(a[1]),this.text=a,this.model.set("text",a)},changeBaseClass:function(a){this.model.set("baseClass",a)},getBaseClass:function(){var a=this.model.get("baseClass");return a},changeStateOfToggleButton:function(a){var b=this.$el,c=this.model,d=(c.get("prevState"),MathInteractives.Common.Components.Theme2.Views.ToggleButton);switch(a){case d.TOGGLEBUTTON_STATE_ON:this.setButtonState(d.TOGGLEBUTTON_STATE_OFF,!1),c.set("prevState",d.TOGGLEBUTTON_STATE_OFF);break;case d.TOGGLEBUTTON_STATE_OFF:this.setButtonState(d.TOGGLEBUTTON_STATE_ON,!1),c.set("prevState",d.TOGGLEBUTTON_STATE_ON);break;case d.TOGGLEBUTTON_STATE_DISABLED:this.setButtonState(d.TOGGLEBUTTON_STATE_DISABLED,!0);break;case d.TOGGLEBUTTON_STATE_ENABLED:b.on("click.togglebtn",$.proxy(this._clicked,this)),this.setButtonState(d.TOGGLEBUTTON_STATE_ENABLED,!0)}this.$el.trigger("click.togglebtn",0)}},{TOGGLEBUTTON_STATE_ON:"on",TOGGLEBUTTON_STATE_OFF:"off",TOGGLEBUTTON_STATE_DISABLED:"disabled",TOGGLEBUTTON_STATE_ENABLED:"enabled",ACTION_COMPLETE_EVENT:"action-completed",TYPE:{CUSTOM:{id:"custom",category:"custom"},GENERAL:{id:"general",category:"general","class":"toggle-button-general-container"},GREEN:{id:"green",category:"green","class":"toggle-button-green-container"},VIOLET:{id:"violet",category:"violet","class":"toggle-button-violet-container"}},generateToggleButton:function(a){var b,c,d;return a?(b="#"+a.id,c=new MathInteractives.Common.Components.Theme2.Models.ToggleButton(a),d=new MathInteractives.Common.Components.Theme2.Views.ToggleButton({el:b,model:c})):void 0}}),MathInteractives.global.Theme2.ToggleButton=MathInteractives.Common.Components.Theme2.Views.ToggleButton)}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.ToggleButton=Backbone.Model.extend({defaults:function(){return{id:"",baseClass:"",text:[],icon:null,tooltipText:"",tooltipPosition:null,width:65,handleWidth:25,height:28,handleHeight:25,toggleImagePath:null,handleImagePath:null,toggleBackground:null,tabIndex:500,handleBackground:null,toggleBoxShadowColor:null,type:MathInteractives.Common.Components.Theme2.Views.ToggleButton.TYPE.GENERAL,isDraggable:!1,cssCustomClass:null,margin:2,hoverClass:"",prevState:MathInteractives.Common.Components.Theme2.Views.ToggleButton.TOGGLEBUTTON_STATE_ON}},currentState:MathInteractives.Common.Components.Theme2.Views.ToggleButton.TOGGLEBUTTON_STATE_ON})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.theme2ToggleSlider=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff<div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-toggle-button-containment" class="toggle-button-containment">\r\n    <div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-on-text" class ="on-text"></div>\r\n    </div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-handle" class="handle"></div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-off-text" class="off-text"></div>\r\n</div>'})}(),function(){"use strict";MathInteractives.Common.Player.Models.CanvasItem=Backbone.Model.extend({defaults:function(){return{tabindex:null,paperItem:null}},initialize:function(a){this.set("canvasAccId",a)}})}(),function(){"use strict";MathInteractives.Common.Player.Collections.CanvasItems=Backbone.Collection.extend({model:MathInteractives.Common.Player.Models.CanvasItem,currentItem:null,initialize:function(){},getCurrentItem:function(){return this.currentItem},getCurrentItemIndex:function(){return this.indexOf(this.getCurrentItem("currentItem"))},setCurrentItem:function(a){"undefined"==typeof a&&(a=null),this.currentItem=a},next:function(){var a=null;return a=this.at(this.indexOf(this.getCurrentItem("currentItem"))+1),this.setCurrentItem(a),a},prev:function(){var a=null;return a=this.at(this.indexOf(this.getCurrentItem("currentItem"))-1),this.setCurrentItem(a),a},hasNext:function(){var a=!1,b=this.indexOf(this.getCurrentItem("currentItem"))+1;return b>0&&b<this.length&&(a=!0),a},hasPrev:function(){var a=!1;return this.indexOf(this.getCurrentItem("currentItem"))-1>=0&&(a=!0),a}})}(),function(){"use strict";MathInteractives.Common.Player.Models.CanvasAcc=Backbone.Model.extend({defaults:function(){return{type:MathInteractives.Common.Player.Models.CanvasAcc.TYPE.NAVIGATE_ITEM,collectionCanvasItems:null,isToolLineDrawingOn:!1,paperItems:[],paperScope:null,gridCell:{size:{width:null,height:null},origin:{x:0,y:0}},gridContainment:{minX:null,maxX:null,minY:null,maxY:null},focusRectSize:null,focusRectColor:"#000000",focusRectBorderWidth:1,focusCurrentPosition:null,selfFocusDisableEvents:null,detailsForFocusRect:{size:{width:0,height:0},gridCellSize:50,canvasBounds:{minX:0,maxX:600,minY:0,maxY:400}},setAccMessageObject:{elementId:null,strMessage:null},disableSelfFocusOnSpace:!1}},initialize:function(){var a=new MathInteractives.Common.Player.Collections.CanvasItems;this.set("collectionCanvasItems",a),this._lineDrawingBoolchange()},_attchEvents:function(){this.on("change:isToolLineDrawingOn",this._lineDrawingBoolchange)},_lineDrawingBoolchange:function(){this.get("isToolLineDrawingOn")===!0&&this.set("paperItems",[]),this.setCollectionCanvasItems(this.get("paperItems"))},setCollectionCanvasItems:function(a,b){var c,d=this.get("collectionCanvasItems"),e=!1,f=MathInteractives.Common.Player.Models.CanvasItem,g=this.get("paperScope");d.reset();for(var h in a)c=new f({paperItem:a[h],paperScope:g}),d.add(c),b||0!==Number(h)||(d.setCurrentItem(c),e=!0);if(!e&&d.getCurrentItem()){var i=d.length>0?d.getCurrentItem().get("paperItem"):null;i?this.setCollectionCurrentItem(i):d.setCurrentItem(i)}this.set("collectionCanvasItems",d)},setCollectionCurrentItem:function(a){var b=this.get("collectionCanvasItems"),c=b.where({paperItem:a});return c[0]?(b.setCurrentItem(c[0]),!0):!1},getCollectionCurrentItemIndex:function(){return this.get("collectionCanvasItems").getCurrentItemIndex()},getCollectionCurrentItem:function(){return this.get("collectionCanvasItems").getCurrentItem().get("paperItem")}},{TYPE:{DRAW_LINE:"canvas-type-draw-line",NAVIGATE_ITEM:"canvas-type-navigate-item",NAVIGATE_LINE:"canvas-type-navigate-line",DRAW_AND_EXPAND:"canvas-type-draw-and-expand",DRAG_AND_DROP:"canvas-type-drag-and-drop"},CANVAS_EVENTS:{FOCUS_OUT:"focus-out"},ITEM_EVENTS:{ITEM_FOCUS_OUT:"item-focus-out"},CANVAS_KEY_EVENTS:{TAB:"canvas-tab-key",SPACE:"canvas-space-key",ARROW:"canvas-arrow-key",ESCAPE:"canvas-escape-key",DELETE:"canvas-delete-key",ROTATE_CLOCKWISE:"canvas-rotate-clockwise-key",ROTATE_ANTI_CLOCKWISE:"canvas-rotate-anti-clockwise-key"},DRAW_LINE_EVENTS:{SPACE:"canvas-draw-line-events-space",ARROW:"canvas-draw-line-events-arrow",FOCUS_OUT:"canvas-draw-line-events-focus-out",ESCAPE:"canvas-draw-line-events-escape"},DRAW_AND_EXPAND_EVENTS:{SPACE:"canvas-draw-and-expand-events-space",ARROW:"canvas-draw-and-expand-events-arrow",FOCUS_OUT:"canvas-draw-and-expand-events-focus-out",ESCAPE:"canvas-draw-and-expand-events-escape"},DRAG_AND_DROP_EVENTS:{TAB:"canvas-drag-and-drop-events-tab",SPACE:"canvas-drag-and-drop-events-space",ARROW:"canvas-drag-and-drop-events-arrow",FOCUS_OUT:"canvas-drag-and-drop-events-focus-out",ESCAPE:"canvas-drag-and-drop-events-escape",ROTATE_CLOCKWISE:"canvas-drag-and-drop-events-rotate-clockwise",ROTATE_ANTI_CLOCKWISE:"canvas-drag-and-drop-events-rotate-anti-clockwise",DELETE:"canvas-drag-and-drop-events-delete"},CANVAS_KEYUP_EVENTS:{ANY_KEYUP:"canvas-any-key-up",SPACE_KEYUP:"canvas-space-key-up",ENTER_KEYUP:"canvas-enter-key-up",ARROW_KEYUP:"canvas-arrow-key-up",DELETE_KEYUP:"canvas-delete-key-up",ROTATION_KEYUP:"canvas-rotation-key-up",CLOCKWISE_ROTATION_KEYUP:"canvas-clockwise-rotation-key-up",ANTI_CLOCKWISE_ROTATION_KEYUP:"canvas-anti-clockwise-rotation-key-up",LEFT_ARROW_KEYUP:"canvas-left-arrow-key-up",RIGHT_ARROW_KEYUP:"canvas-right-arrow-key-up",UP_ARROW_KEYUP:"canvas-up-arrow-key-up",DOWN_ARROW_KEYUP:"canvas-down-arrow-key-up"},KEYUP_TIMER:300})}(),function(){MathInteractives.Common.Player.Views.CanvasAcc||(MathInteractives.Common.Player.Views.CanvasAcc=MathInteractives.Common.Player.Views.Base.extend({_paperScope:null,_detailsForFocusRect:null,manager:null,player:null,idPrefix:null,_isStart:!0,isExpand:!1,isDrag:!1,_isShifDown:!1,_currentFocusRect:null,prevText:"",lastTriggeredEvent:null,_lastArrowKeyUpEvent:null,_lastArrowKeyUpItem:null,_previousArrowKeyDownCount:0,_currentArrowKeyDownCount:0,_keyUpInterval:null,initialize:function(){this._paperScope=this.model.get("paperScope"),this.player=this.model.get("player"),this.idPrefix=this.player.getIDPrefix(),this.manager=this.model.get("manager"),this.render(),this._bindEvents();var a=this.model.get("type");(a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAW_LINE||a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAW_AND_EXPAND||a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP)&&this.initGridFocusRectDetails()},render:function(){var a=this.model.get("canvasHolderID"),b=this.$el.find(".acc-read-elem"),c={height:"1px",width:"1px",top:"1px",left:"1px"};b&&(c.height=b.height()+"px",c.width=b.width()+"px",c.top=b.css("top"),c.left=b.css("left"));var d="position: absolute; height: "+c.height+"; width: "+c.width+"; top: "+c.top+"; left: "+c.left+"; outline: none",e=$("<div>",{id:a+"temp-focus-div",style:d});this.$el.prepend(e);var f={elementId:a.replace(this.idPrefix,"")+"temp-focus-div"};this.createAccDiv(f);var g=e.find(".acc-read-elem");g&&g.css("outline","none")},initGridFocusRectDetails:function(){var a=this.model.get("gridCell").origin,b=this.model.get("gridCell").size,c={x:a.x,y:a.y},d={width:b.width,height:b.height};this.model.get("focusCurrentPosition")||this.model.set("focusCurrentPosition",c),this.model.get("focusRectSize")||this.model.set("focusRectSize",d)},_bindEvents:function(){var a=this.model,b=this;this.$el.on("keydown",$.proxy(this._handleKeyDownEvent,this)),this.$el.on("keyup",$.proxy(this._handleKeyUpEvent,this)),a.on("change:paperItems",$.proxy(function(){var a=this.model.get("isKeepCurrentItem")?!0:!1;this.model.setCollectionCanvasItems(this.model.get("paperItems"),a)},this)),a.on("change:setAccMessageObject",function(){b._updateHolderAccMessage()})},_updateHolderAccMessage:function(){var a=this.model.get("setAccMessageObject"),b=a.elementId;this.setAccMessage(b,a.strMessage),this._setSelfFocus(),this.setFocus(b)},changeCanvasAccType:function(a){this.model.set("type",a)},_handleKeyDownEvent:function(a){a.shiftKey?this._isShifDown=!0:this._isShifDown=!1;var b=a.keyCode,c=this.model.get("type"),d=!1;if(b===MathInteractives.global.CanvasAcc.KEYS.SPACE&&this._isStart&&(this._isStart=!1,d=!0),!this._isStart)if(c===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.NAVIGATE_ITEM||c===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.NAVIGATE_LINE||c===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP){var e=this.model.get("collectionCanvasItems"),f=e.getCurrentItem();if(null!==f){if(a.keyCode==MathInteractives.global.CanvasAcc.KEYS.ESCAPE)return void this._handleEscape(c,f);if(e.hasNext()&&!this._isShifDown||e.hasPrev()&&this._isShifDown||b!==MathInteractives.global.CanvasAcc.KEYS.TAB){switch(b){case MathInteractives.global.CanvasAcc.KEYS.TAB:a.preventDefault(),a.shiftKey?a.shiftKey&&e.prev():e.next(),this._triggerCurrentItemFocusOutEvent(a,f),f=e.getCurrentItem(),this._handleTab(c,f,a);break;case MathInteractives.global.CanvasAcc.KEYS.SPACE:case MathInteractives.global.CanvasAcc.KEYS.ENTER:d?this._handleTab(c,f,a):this._handleSpace(c,f,a);break;case MathInteractives.global.CanvasAcc.KEYS.LEFTARROW:case MathInteractives.global.CanvasAcc.KEYS.RIGHTARROW:case MathInteractives.global.CanvasAcc.KEYS.UPARROW:case MathInteractives.global.CanvasAcc.KEYS.DOWNARROW:a.preventDefault(),c===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP?this._hadleGridNavigation(c,b,d,f):this._handleArrows(f,b),this._handleArrowUpTrigger();break;case MathInteractives.global.CanvasAcc.KEYS.DELETE:this._handleDelete(c,f);break;case MathInteractives.global.CanvasAcc.KEYS.ROTATE_CLOCKWISE:case MathInteractives.global.CanvasAcc.KEYS.ROTATE_ANTI_CLOCKWISE:this._handleRotate(c,f,b)}this._paperScope&&this._paperScope.view.draw()}else this._handleFocusOut(c,f)}else this._isStart=!0}else if(c===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAW_LINE)switch(b){case MathInteractives.global.CanvasAcc.KEYS.SPACE:case MathInteractives.global.CanvasAcc.KEYS.ENTER:d?this._hadleGridNavigation(c,b,d):this._handleDrawLineSpace();break;case MathInteractives.global.CanvasAcc.KEYS.LEFTARROW:case MathInteractives.global.CanvasAcc.KEYS.RIGHTARROW:case MathInteractives.global.CanvasAcc.KEYS.UPARROW:case MathInteractives.global.CanvasAcc.KEYS.DOWNARROW:a.preventDefault(),this._hadleGridNavigation(c,b,d);break;case MathInteractives.global.CanvasAcc.KEYS.TAB:this._handleGridNavigationFocusOut(c);break;case MathInteractives.global.CanvasAcc.KEYS.ESCAPE:this._handleEscape(c)}else if(c===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAW_AND_EXPAND)switch(b){case MathInteractives.global.CanvasAcc.KEYS.SPACE:case MathInteractives.global.CanvasAcc.KEYS.ENTER:d?this._hadleGridNavigation(c,b,d):this._handleDrawAndExpandSpace(b,d);break;case MathInteractives.global.CanvasAcc.KEYS.LEFTARROW:case MathInteractives.global.CanvasAcc.KEYS.RIGHTARROW:case MathInteractives.global.CanvasAcc.KEYS.UPARROW:case MathInteractives.global.CanvasAcc.KEYS.DOWNARROW:a.preventDefault(),this._hadleGridNavigation(c,b,d);break;case MathInteractives.global.CanvasAcc.KEYS.TAB:this._handleGridNavigationFocusOut(c);break;case MathInteractives.global.CanvasAcc.KEYS.ESCAPE:this._handleEscape(c)}},_triggerCurrentItemFocusOutEvent:function(a,b){var c={item:b.get("paperItem"),event:{which:1,shiftKey:a.shiftKey},isAccessibility:!0,isArrowKey:!1};this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.ITEM_EVENTS.ITEM_FOCUS_OUT,c)},_handleKeyUpEvent:function(a){if(a.keyCode!==MathInteractives.global.CanvasAcc.KEYS.TAB){var b=a.keyCode,c=this.model.get("type"),d=this.model.get("collectionCanvasItems"),e=d.getCurrentItem(),f=null;if(null!==e){switch(f=e.get("paperItem"),b){case MathInteractives.global.CanvasAcc.KEYS.SPACE:this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEYUP_EVENTS.SPACE_KEYUP,[a,b,f]);break;case MathInteractives.global.CanvasAcc.KEYS.ENTER:this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEYUP_EVENTS.ENTER_KEYUP,[a,b,f]);break;case MathInteractives.global.CanvasAcc.KEYS.LEFTARROW:case MathInteractives.global.CanvasAcc.KEYS.RIGHTARROW:case MathInteractives.global.CanvasAcc.KEYS.UPARROW:case MathInteractives.global.CanvasAcc.KEYS.DOWNARROW:a.preventDefault(),this._lastArrowKeyUpEvent=a,this._lastArrowKeyUpItem=f;break;case MathInteractives.global.CanvasAcc.KEYS.DELETE:this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEYUP_EVENTS.DELETE_KEYUP,[a,b,f]);break;case MathInteractives.global.CanvasAcc.KEYS.ROTATE_CLOCKWISE:case MathInteractives.global.CanvasAcc.KEYS.ROTATE_ANTI_CLOCKWISE:this._handleRotationKeyUp(a,b,f),this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEYUP_EVENTS.ROTATION_KEYUP,[a,b,f]);break;default:return}this._handleAnyKeyUp(c,f,a,b)}}},_handleAnyKeyUp:function(a,b,c,d){this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEYUP_EVENTS.ANY_KEYUP,[c,d,b])},_handleRotationKeyUp:function(a,b,c){switch(b){case MathInteractives.global.CanvasAcc.KEYS.ROTATE_CLOCKWISE:this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEYUP_EVENTS.CLOCKWISE_ROTATION_KEYUP,[a,b,c]);break;case MathInteractives.global.CanvasAcc.KEYS.ROTATE_ANTI_CLOCKWISE:this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEYUP_EVENTS.ANTI_CLOCKWISE_ROTATION_KEYUP,[a,b,c])}},_handleArrowUpTrigger:function(){var a=this,b=MathInteractives.Common.Player.Models.CanvasAcc.KEYUP_TIMER;a._previousArrowKeyDownCount=a._currentArrowKeyDownCount,a._currentArrowKeyDownCount++,0===a._previousArrowKeyDownCount&&(a._keyUpInterval&&window.clearInterval(a._keyUpInterval),a._keyUpInterval=window.setInterval(function(){a._previousArrowKeyDownCount===a._currentArrowKeyDownCount?(window.clearInterval(a._keyUpInterval),a._keyUpInterval=null,a._previousArrowKeyDownCount=0,a._currentArrowKeyDownCount=0,a._handleArrowKeyUp(),a._lastArrowKeyUpEvent=null):a._lastArrowKeyUpEvent&&(a._previousArrowKeyDownCount=a._currentArrowKeyDownCount)},b))},_handleArrowKeyUp:function(){if(this._lastArrowKeyUpEvent){var a=this._lastArrowKeyUpItem,b=this._lastArrowKeyUpEvent,c=b.keyCode,d=MathInteractives.global.CanvasAcc.KEYS;switch(c){case d.LEFTARROW:this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEYUP_EVENTS.LEFT_ARROW_KEYUP,[b,c,a]);break;case d.RIGHTARROW:this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEYUP_EVENTS.RIGHT_ARROW_KEYUP,[b,c,a]);break;case d.UPARROW:this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEYUP_EVENTS.UP_ARROW_KEYUP,[b,c,a]);break;case d.DOWNARROW:this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEYUP_EVENTS.DOWN_ARROW_KEYUP,[b,c,a])}this.$el.trigger(MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEYUP_EVENTS.ARROW_KEYUP,[b,c,a])}},_handleTab:function(a,b,c){var d={item:b.get("paperItem"),event:{which:1,shiftKey:c.shiftKey},isAccessibility:!0,isArrowKey:!1};a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP?(this.isDrag=!1,this.hideFocusRect(),this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAG_AND_DROP_EVENTS.TAB,this.$el.trigger(this.lastTriggeredEvent,d)):(this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEY_EVENTS.TAB,this.$el.trigger(this.lastTriggeredEvent,d)),this._setSelfFocus()},_handleSpace:function(a,b){var c={item:b.get("paperItem"),event:{which:1},isAccessibility:!0,isArrowKey:!1};if(a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP){if(this.isDrag=!this.isDrag,c.isDrag=this.isDrag,this.hideFocusRect(),this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAG_AND_DROP_EVENTS.SPACE,this.$el.trigger(this.lastTriggeredEvent,c),this.isDrag){var d=this.model.get("gridCell").origin,e={x:d.x,y:d.y};this.model.set("focusCurrentPosition",e),this._hadleGridNavigation(a,null,!1,b,!0)}}else this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEY_EVENTS.SPACE,this.$el.trigger(this.lastTriggeredEvent,c);this.model.get("disableSelfFocusOnSpace")!==!0&&this._setSelfFocus()},_handleRotate:function(a,b,c){var d={item:b.get("paperItem"),event:{which:1},isAccessibility:!0,isArrowKey:!1};c===MathInteractives.global.CanvasAcc.KEYS.ROTATE_CLOCKWISE?(a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP?this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAG_AND_DROP_EVENTS.ROTATE_CLOCKWISE:this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEY_EVENTS.ROTATE_CLOCKWISE,this.$el.trigger(this.lastTriggeredEvent,d)):c===MathInteractives.global.CanvasAcc.KEYS.ROTATE_ANTI_CLOCKWISE&&(a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP?this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAG_AND_DROP_EVENTS.ROTATE_ANTI_CLOCKWISE:this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEY_EVENTS.ROTATE_ANTI_CLOCKWISE,this.$el.trigger(this.lastTriggeredEvent,d)),this._setSelfFocus()},_handleDelete:function(a,b){var c=this.model.get("collectionCanvasItems"),d={item:b.get("paperItem"),nextItem:null,event:{which:1},isAccessibility:!0,isArrowKey:!1};if(b.get("paperItem").allowDelete){if(a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.NAVIGATE_ITEM)c.hasNext()&&(d.nextItem=c.next().get("paperItem")),this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEY_EVENTS.DELETE;else if(a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.NAVIGATE_LINE){var e=!1,f=this.getCurrentPaperItemIndex();null!==f&&f+3<c.length&&(e=!0),e&&(c.next(),c.next(),d.nextItem=c.next().get("paperItem")),this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEY_EVENTS.DELETE}else a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP&&(c.hasNext()&&(d.nextItem=c.next().get("paperItem")),this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAG_AND_DROP_EVENTS.DELETE);this.$el.trigger(this.lastTriggeredEvent,d),d.nextItem||(this._isStart=!0,this.model.setCollectionCanvasItems(this.model.get("paperItems"))),this._setSelfFocus()}},_handleArrows:function(a,b){var c=a.get("paperItem"),d={item:c,point:c.position,event:{which:1},isAccessibility:!0,isArrowKey:!0,directionX:0,directionY:0};switch(b){case MathInteractives.global.CanvasAcc.KEYS.LEFTARROW:d.directionX=-1,d.directionY=0;break;case MathInteractives.global.CanvasAcc.KEYS.UPARROW:d.directionX=0,d.directionY=-1;break;case MathInteractives.global.CanvasAcc.KEYS.RIGHTARROW:d.directionX=1,d.directionY=0;break;case MathInteractives.global.CanvasAcc.KEYS.DOWNARROW:d.directionX=0,d.directionY=1}this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEY_EVENTS.ARROW,this.$el.trigger(this.lastTriggeredEvent,d),this._setSelfFocus()},_handleFocusOut:function(a,b){var c={item:b?b.get("paperItem"):null,event:{which:1},isAccessibility:!0,isArrowKey:!1};if(this._isStart=!0,this.model.setCollectionCanvasItems(this.model.get("paperItems")),a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP){var d=this.model.get("gridCell").origin,e={x:d.x,y:d.y};this.model.set("focusCurrentPosition",e),this.hideFocusRect(),this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAG_AND_DROP_EVENTS.FOCUS_OUT,this.$el.trigger(this.lastTriggeredEvent,c)}else this.isDrag=!1,this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_EVENTS.FOCUS_OUT,this.$el.trigger(this.lastTriggeredEvent,c)},_handleEscape:function(a,b){var c=b?b.get("paperItem"):null,d={item:c,event:{which:1},isAccessibility:!0,isArrowKey:!1};this._isStart=!0,this.canvasFocusOut(a,b),a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAW_LINE?(this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAW_LINE_EVENTS.ESCAPE,this.$el.trigger(this.lastTriggeredEvent,d)):a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAW_AND_EXPAND?(this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAW_AND_EXPAND_EVENTS.ESCAPE,this.$el.trigger(this.lastTriggeredEvent,d)):a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP?(this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAG_AND_DROP_EVENTS.ESCAPE,this.$el.trigger(this.lastTriggeredEvent,d)):(this.model.setCollectionCanvasItems(this.model.get("paperItems")),this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.CANVAS_KEY_EVENTS.ESCAPE,this.$el.trigger(this.lastTriggeredEvent,d)),this._paperScope&&this._paperScope.view.draw(),this._setSelfFocus()},setSelfFocus:function(){this._setSelfFocus()},_setSelfFocus:function(){if(!this.player.getModalPresent()){var a=this.model.get("selfFocusDisableEvents");if(a&&this.lastTriggeredEvent)for(var b=a.length,c=0;b>c;c++)if(this.lastTriggeredEvent===a[c])return void(this.lastTriggeredEvent=null);this.lastTriggeredEvent=null;var d=this.el.id,e=this.model.get("canvasHolderID"),f=this.$("#"+d+"-acc-elem");if(f.length>0){var g=f.text(),h=d.replace(this.idPrefix,"");g===this.prevText&&""!==g?(this.prevText=g+" ",this.setAccMessage(h,this.prevText)):this.prevText=g}this.setFocus(e.replace(this.idPrefix,"")+"temp-focus-div"),this.manager.setFocus(d,0)}},canvasFocusOut:function(a,b){a=a?a:this.model.get("type"),b=b?b:this.model.get("collectionCanvasItems").getCurrentItem(),a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.NAVIGATE_ITEM||a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.NAVIGATE_LINE||a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP?this._handleFocusOut(a,b):(a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAW_LINE||a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAW_AND_EXPAND)&&this._handleGridNavigationFocusOut(a)},addPaperItem:function(a){var b=this.model.get("collectionCanvasItems"),c=new MathInteractives.Common.Player.Models.CanvasItem({paperItem:a,paperScope:this._paperScope});this.model.get("paperItems").push(a),b.add(c)},removePaperItem:function(a){var b=this.model.get("collectionCanvasItems"),c=b.where({paperItem:a}),d=this.model.get("paperItems"),e=d.indexOf(a);e>-1&&(d.splice(e,1),b.remove(c))},updatePaperItems:function(a,b){this.model.set({paperItems:a,isKeepCurrentItem:b}),b||(this._isStart=!0)},setCurrentPaperItem:function(a,b){return b&&(this._isStart=!1),this.model.setCollectionCurrentItem(a)},updateSelfFocusDisableEvents:function(a){this.model.set("selfFocusDisableEvents",a)},getCurrentPaperItem:function(){return this.model.getCollectionCurrentItem()},getCurrentPaperItemIndex:function(){return this.model.getCollectionCurrentItemIndex()},_handleDrawLineSpace:function(){var a=this.model.get("focusCurrentPosition"),b={point:{x:a.x,y:a.y},event:{which:1},isAccessibility:!0,isArrowKey:!1};this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAW_LINE_EVENTS.SPACE,this.$el.trigger(this.lastTriggeredEvent,b),this._setSelfFocus()},_handleDrawAndExpandSpace:function(a,b){var c=this.model.get("focusCurrentPosition"),d={point:{x:c.x,y:c.y},event:{which:1},isAccessibility:!0,isArrowKey:!1};b||a!==MathInteractives.global.CanvasAcc.KEYS.SPACE&&a!==MathInteractives.global.CanvasAcc.KEYS.ENTER||(this.isExpand=!this.isExpand),d.isExpand=this.isExpand,this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAW_AND_EXPAND_EVENTS.SPACE,this.$el.trigger(this.lastTriggeredEvent,d),this._setSelfFocus()},_hadleGridNavigation:function(a,b,c,d,e){var f=this.model.get("focusCurrentPosition"),g=this.model.get("gridCell").size,h=this.model.get("gridContainment"),i={point:{x:f.x,y:f.y},event:{which:1},isAccessibility:!0,isArrowKey:!0,directionX:0,directionY:0,isFirstSpace:c};if(a!==MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP||this.isDrag){switch(b){case MathInteractives.global.CanvasAcc.KEYS.LEFTARROW:i.directionX=-1,i.directionY=0;break;case MathInteractives.global.CanvasAcc.KEYS.UPARROW:i.directionX=0,i.directionY=-1;break;case MathInteractives.global.CanvasAcc.KEYS.RIGHTARROW:i.directionX=1,i.directionY=0;break;case MathInteractives.global.CanvasAcc.KEYS.DOWNARROW:i.directionX=0,i.directionY=1}var j={x:i.point.x+g.width*i.directionX,y:i.point.y+g.height*i.directionY};j.x>=h.minX&&j.x<=h.maxX&&(i.point.x=j.x),j.y>=h.minY&&j.y<=h.maxY&&(i.point.y=j.y),this.model.set("focusCurrentPosition",i.point),this._drawFocusRect(),a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAW_LINE?(this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAW_LINE_EVENTS.ARROW,this.$el.trigger(this.lastTriggeredEvent,i)):a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAW_AND_EXPAND?(i.isExpand=this.isExpand,this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAW_AND_EXPAND_EVENTS.ARROW,this.$el.trigger(this.lastTriggeredEvent,i)):a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAG_AND_DROP&&(i.item=d.get("paperItem"),this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAG_AND_DROP_EVENTS.ARROW,this.$el.trigger(this.lastTriggeredEvent,i)),e||this._setSelfFocus()}},_handleGridNavigationFocusOut:function(a){this._isStart=!0;var b=this.model.get("focusCurrentPosition"),c={point:{x:b.x,y:b.y},event:{which:1},isAccessibility:!0,isArrowKey:!1},d=this.model.get("gridCell").origin,e={x:d.x,y:d.y};this.model.set("focusCurrentPosition",e),this.hideFocusRect(),a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAW_LINE?(this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAW_LINE_EVENTS.FOCUS_OUT,this.$el.trigger(this.lastTriggeredEvent,c)):a===MathInteractives.Common.Player.Models.CanvasAcc.TYPE.DRAW_AND_EXPAND&&(this.isExpand=!1,this.lastTriggeredEvent=MathInteractives.Common.Player.Models.CanvasAcc.DRAW_AND_EXPAND_EVENTS.FOCUS_OUT,this.$el.trigger(this.lastTriggeredEvent,c))},_drawFocusRect:function(a){var b=a?a:this.model.get("focusCurrentPosition"),c=this._paperScope,d=this.model.get("focusRectSize");this.hideFocusRect();var e=new c.Path.Rectangle([b.x-d.width/2,b.y-d.height/2],[d.width,d.height]);e.strokeColor=this.model.get("focusRectColor"),e.strokeWidth=this.model.get("focusRectBorderWidth"),e.dashArray=[2,2],this._currentFocusRect=e,c.view.draw()},getFocusRect:function(){return this._currentFocusRect},hideFocusRect:function(){null!==this._currentFocusRect&&(this._currentFocusRect.remove(),this._paperScope.view.draw())},_currrentPosition:{x:36,y:36},_getNextPosition:function(a){var b=this._detailsForFocusRect,c=b.canvasBounds,d=b.gridCellSize,e=d;null===this._currrentPosition&&(this._currrentPosition={x:d,y:d}),a.shiftKey&&(e*=-1),this._currrentPosition.x+=e,this._currrentPosition.x>c.maxX-d&&(this._currrentPosition.x=d,this._currrentPosition.y+=e),this._currrentPosition.x<d&&(this._currrentPosition.x=c.maxX-d,this._currrentPosition.y-=d),(this._currrentPosition.y<d||this._currrentPosition.y>c.maxY)&&(this._currrentPosition=null)},_mouseDownTriggered:!1,_toolMouseEvents:function(){var a={x:this._currentFocusRect.position.x,y:this._currentFocusRect.position.y},b=this._paperScope.tool;this._mouseDownTriggered===!1?(b.fire("mousedown",{point:a,event:{which:1}}),this._mouseDownTriggered=!0):(b.fire("mousedrag",{point:a,event:{which:1}}),b.fire("mouseup",{point:a,event:{which:1}}),this._mouseDownTriggered=!1),this._paperScope.view.draw()}},{KEYS:{TAB:9,SPACE:32,ENTER:13,ESCAPE:27,LEFTARROW:37,UPARROW:38,RIGHTARROW:39,DOWNARROW:40,DELETE:68,ROTATE_CLOCKWISE:82,ROTATE_ANTI_CLOCKWISE:69},intializeCanvasAcc:function(a){var b=a.model||null,c=null,d="#"+a.canvasHolderID;return null===b&&(b=new MathInteractives.Common.Player.Models.CanvasAcc(a)),c=new MathInteractives.Common.Player.Views.CanvasAcc({model:b,el:d})}}),MathInteractives.global.CanvasAcc=MathInteractives.Common.Player.Views.CanvasAcc)}();