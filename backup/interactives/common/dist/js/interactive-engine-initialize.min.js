function $rw_userParameters(){MathInteractives.Common.Components.Models.SpeechStream.initializeTextHelp("blue","transparent","orange","transparent")}function RGBColor(a){this.ok=!1,"#"==a.charAt(0)&&(a=a.substr(1,6)),a=a.replace(/ /g,""),a=a.toLowerCase();var b={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var c in b)a==c&&(a=b[c]);for(var d=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],e=0;e<d.length;e++){var f=d[e].re,g=d[e].process,h=f.exec(a);h&&(channels=g(h),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),b=this.g.toString(16),c=this.b.toString(16);return 1==a.length&&(a="0"+a),1==b.length&&(b="0"+b),1==c.length&&(c="0"+c),"#"+a+b+c},this.getHelpXML=function(){for(var a=new Array,c=0;c<d.length;c++)for(var e=d[c].example,f=0;f<e.length;f++)a[a.length]=e[f];for(var g in b)a[a.length]=g;var h=document.createElement("ul");h.setAttribute("id","rgbcolor-examples");for(var c=0;c<a.length;c++)try{var i=document.createElement("li"),j=new RGBColor(a[c]),k=document.createElement("div");k.style.cssText="margin: 3px; border: 1px solid black; background:"+j.toHex()+"; color:"+j.toHex(),k.appendChild(document.createTextNode("test"));var l=document.createTextNode(" "+a[c]+" -> "+j.toRGB()+" -> "+j.toHex());i.appendChild(k),i.appendChild(l),h.appendChild(i)}catch(m){}return h}}function stackBlurImage(a,b,c,d){var e=document.getElementById(a),f=e.naturalWidth,g=e.naturalHeight,h=document.getElementById(b);h.style.width=f+"px",h.style.height=g+"px",h.width=f,h.height=g;var i=h.getContext("2d");i.clearRect(0,0,f,g),i.drawImage(e,0,0),isNaN(c)||1>c||(d?stackBlurCanvasRGBA(b,0,0,f,g,c):stackBlurCanvasRGB(b,0,0,f,g,c))}function stackBlurCanvasRGBA(a,b,c,d,e,f){if(!(isNaN(f)||1>f)){f|=0;var g,h=document.getElementById(a),i=h.getContext("2d");try{try{g=i.getImageData(b,c,d,e)}catch(j){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),g=i.getImageData(b,c,d,e)}catch(j){throw alert("Cannot access local image"),new Error("unable to access local image data: "+j)}}}catch(j){throw alert("Cannot access image"),new Error("unable to access image data: "+j)}var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=g.data,J=f+f+1,K=d-1,L=e-1,M=f+1,N=M*(M+1)/2,O=new BlurStack,P=O;for(m=1;J>m;m++)if(P=P.next=new BlurStack,m==M)var Q=P;P.next=O;var R=null,S=null;q=p=0;var T=mul_table[f],U=shg_table[f];for(l=0;e>l;l++){for(z=A=B=C=r=s=t=u=0,v=M*(D=I[p]),w=M*(E=I[p+1]),x=M*(F=I[p+2]),y=M*(G=I[p+3]),r+=N*D,s+=N*E,t+=N*F,u+=N*G,P=O,m=0;M>m;m++)P.r=D,P.g=E,P.b=F,P.a=G,P=P.next;for(m=1;M>m;m++)n=p+((m>K?K:m)<<2),r+=(P.r=D=I[n])*(H=M-m),s+=(P.g=E=I[n+1])*H,t+=(P.b=F=I[n+2])*H,u+=(P.a=G=I[n+3])*H,z+=D,A+=E,B+=F,C+=G,P=P.next;for(R=O,S=Q,k=0;d>k;k++)I[p+3]=G=u*T>>U,0!=G?(G=255/G,I[p]=(r*T>>U)*G,I[p+1]=(s*T>>U)*G,I[p+2]=(t*T>>U)*G):I[p]=I[p+1]=I[p+2]=0,r-=v,s-=w,t-=x,u-=y,v-=R.r,w-=R.g,x-=R.b,y-=R.a,n=q+((n=k+f+1)<K?n:K)<<2,z+=R.r=I[n],A+=R.g=I[n+1],B+=R.b=I[n+2],C+=R.a=I[n+3],r+=z,s+=A,t+=B,u+=C,R=R.next,v+=D=S.r,w+=E=S.g,x+=F=S.b,y+=G=S.a,z-=D,A-=E,B-=F,C-=G,S=S.next,p+=4;q+=d}for(k=0;d>k;k++){for(A=B=C=z=s=t=u=r=0,p=k<<2,v=M*(D=I[p]),w=M*(E=I[p+1]),x=M*(F=I[p+2]),y=M*(G=I[p+3]),r+=N*D,s+=N*E,t+=N*F,u+=N*G,P=O,m=0;M>m;m++)P.r=D,P.g=E,P.b=F,P.a=G,P=P.next;for(o=d,m=1;f>=m;m++)p=o+k<<2,r+=(P.r=D=I[p])*(H=M-m),s+=(P.g=E=I[p+1])*H,t+=(P.b=F=I[p+2])*H,u+=(P.a=G=I[p+3])*H,z+=D,A+=E,B+=F,C+=G,P=P.next,L>m&&(o+=d);for(p=k,R=O,S=Q,l=0;e>l;l++)n=p<<2,I[n+3]=G=u*T>>U,G>0?(G=255/G,I[n]=(r*T>>U)*G,I[n+1]=(s*T>>U)*G,I[n+2]=(t*T>>U)*G):I[n]=I[n+1]=I[n+2]=0,r-=v,s-=w,t-=x,u-=y,v-=R.r,w-=R.g,x-=R.b,y-=R.a,n=k+((n=l+M)<L?n:L)*d<<2,r+=z+=R.r=I[n],s+=A+=R.g=I[n+1],t+=B+=R.b=I[n+2],u+=C+=R.a=I[n+3],R=R.next,v+=D=S.r,w+=E=S.g,x+=F=S.b,y+=G=S.a,z-=D,A-=E,B-=F,C-=G,S=S.next,p+=d}i.putImageData(g,b,c)}}function stackBlurCanvasRGB(a,b,c,d,e,f){if(!(isNaN(f)||1>f)){f|=0;var g,h=document.getElementById(a),i=h.getContext("2d");try{try{g=i.getImageData(b,c,d,e)}catch(j){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),g=i.getImageData(b,c,d,e)}catch(j){throw alert("Cannot access local image"),new Error("unable to access local image data: "+j)}}}catch(j){throw alert("Cannot access image"),new Error("unable to access image data: "+j)}var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=g.data,F=f+f+1,G=d-1,H=e-1,I=f+1,J=I*(I+1)/2,K=new BlurStack,L=K;for(m=1;F>m;m++)if(L=L.next=new BlurStack,m==I)var M=L;L.next=K;var N=null,O=null;q=p=0;var P=mul_table[f],Q=shg_table[f];for(l=0;e>l;l++){for(x=y=z=r=s=t=0,u=I*(A=E[p]),v=I*(B=E[p+1]),w=I*(C=E[p+2]),r+=J*A,s+=J*B,t+=J*C,L=K,m=0;I>m;m++)L.r=A,L.g=B,L.b=C,L=L.next;for(m=1;I>m;m++)n=p+((m>G?G:m)<<2),r+=(L.r=A=E[n])*(D=I-m),s+=(L.g=B=E[n+1])*D,t+=(L.b=C=E[n+2])*D,x+=A,y+=B,z+=C,L=L.next;for(N=K,O=M,k=0;d>k;k++)E[p]=r*P>>Q,E[p+1]=s*P>>Q,E[p+2]=t*P>>Q,r-=u,s-=v,t-=w,u-=N.r,v-=N.g,w-=N.b,n=q+((n=k+f+1)<G?n:G)<<2,x+=N.r=E[n],y+=N.g=E[n+1],z+=N.b=E[n+2],r+=x,s+=y,t+=z,N=N.next,u+=A=O.r,v+=B=O.g,w+=C=O.b,x-=A,y-=B,z-=C,O=O.next,p+=4;q+=d}for(k=0;d>k;k++){for(y=z=x=s=t=r=0,p=k<<2,u=I*(A=E[p]),v=I*(B=E[p+1]),w=I*(C=E[p+2]),r+=J*A,s+=J*B,t+=J*C,L=K,m=0;I>m;m++)L.r=A,L.g=B,L.b=C,L=L.next;for(o=d,m=1;f>=m;m++)p=o+k<<2,r+=(L.r=A=E[p])*(D=I-m),s+=(L.g=B=E[p+1])*D,t+=(L.b=C=E[p+2])*D,x+=A,y+=B,z+=C,L=L.next,H>m&&(o+=d);for(p=k,N=K,O=M,l=0;e>l;l++)n=p<<2,E[n]=r*P>>Q,E[n+1]=s*P>>Q,E[n+2]=t*P>>Q,r-=u,s-=v,t-=w,u-=N.r,v-=N.g,w-=N.b,n=k+((n=l+I)<H?n:H)*d<<2,r+=x+=N.r=E[n],s+=y+=N.g=E[n+1],t+=z+=N.b=E[n+2],N=N.next,u+=A=O.r,v+=B=O.g,w+=C=O.b,x-=A,y-=B,z-=C,O=O.next,p+=d}i.putImageData(g,b,c)}}function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}!function(){"use strict";!function(){function a(a,c){this._superCallObjects||(this._superCallObjects={});var d=this._superCallObjects[a]||this,e=b(a,d);this._superCallObjects[a]=e;var f=e[a].apply(this,c||[]);return delete this._superCallObjects[a],f}function b(a,b){for(var c=b;c[a]===b[a];)c=c.constructor.__super__;return c}_.each(["Model","Collection","View","Router"],function(b){Backbone[b].prototype._superwrapper=a})}(),$.extend($.support,{touch:"ontouchend"in document}),$.fn.getTextWidth=function(a){a&&$("body").append($(this));var b=$(this).html(),c=$('<span class="width-height-span">'+b+"</span>",{style:"float:initial;  min-height: initial;margin-left: initial;line-height:normal;"});$(this).html(c);var d=$(this).find("span:first").width();return $(this).html(b),a&&$(this).detach(),d},$.fn.getTextHeight=function(a){a&&$("body").append($(this));var b=$(this).html(),c=$('<span class="width-height-span">'+b+"</span>",{style:"float:initial;  min-height: initial;margin-left: initial; line-height:normal;"});$(this).html(c);var d=$(this).find("span:first").height();return $(this).html(b),a&&$(this).detach(),d};var a="undefined"!=typeof window.MathInteractives?window.MathInteractives:{};a.Common="undefined"!=typeof a.Common?a.Common:{},a.Common.Player={},a.Common.Player.Models={},a.Common.Player.Views={},a.Common.Player.Collections={},a.Interactivities={},a.Common.Utilities={},a.Common.Utilities.Models={},a.Common.Utilities.Views={},a.Common.Components={},a.Common.Components.Models={},a.Common.Components.Views={},a.Common.Interactivities={},a.Common.Components.Theme2={},a.Common.Components.Theme2.Models={},a.Common.Components.Theme2.Views={},a.Common.Components.Theme2.Collections={},a.Common.Components.Models.MathUtilitiesGraph={},a.Common.Components.Models.MathUtilitiesGraph.EquationEngine={},a.Common.Components.Views.MathUtilitiesGraph={},a.Common.Components.Models.MathUtilitiesGraphNew={},a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine={},a.Common.Components.Views.MathUtilitiesGraphNew={},a.Common.Components.Models.EquationManager={},a.Common.Components.Views.EquationManager={},a.global={},a.global.Theme2={},window.MathInteractives=a}(),function(a){"use strict";var b={dist:"dist/",common:"common/",theme:["theme-1/","theme-2/"],interactivities:"/",data:"data/",css:"css/",animate:"animate/",fonts:"fonts/",js:"js/",vendor:"vendor/",plugin:"plugin/",backbone:"backbone/",bootstrap:"bootstrap/",canvg:"canvg/",elrte:"elrte-1.3/",handlebars:"handlebars/",highcharts:"highcharts/",html2canvas:"html2canvas",jquery:"jquery/",loader:"loader/",mathjax:"mathjax/",mathquill:"mathquill/",paperJs:"paper/",requireJs:"requirejs/",threeJs:"threejs/",tts:"tts/",underscore:"underscore/",languages:{en:"lang/en/",es:"lang/es/"},image:"media/image/",audio:"media/audio/",video:"media/video/",templates:"templates/",math_utilities_css:"css/",math_utilities_js:"js/math-utilities/",math_utilities_templates:"templates/core/math-utilities/",math_utilities_data:"data/math-utilities/",interactive:"interactive/"},c={"fixed-next":"fa fa-chevron-right font-size-14","fixed-back":"fa fa-chevron-left font-size-14","fixed-reset":"fa fa-undo font-size-20","fixed-undo":"fa fa-reply font-size-18","fixed-redo":"fa fa-mail-forward font-size-18","fixed-zoom-in":"fa fa-search-minus font-size-18","fixed-zoom-out":"fa fa-search-plus font-size-18","fixed-copy":"fa fa-copy font-size-20","fixed-cut":"fa fa-scissors font-size-20","fixed-trash":"fa fa-trash-o font-size-20","fixed-delete":"fa fa-trash-o font-size-20","fixed-skip-animation":"fa fa-fast-forward font-size-18","fixed-view":"fa fa-eye font-size-20","fixed-rotate":"fa fa-de-rotate font-size-20","fixed-reflect-x":"fa fa-de-reflect-x font-size-18","fixed-reflect-y":"fa fa-de-reflect-y font-size-18","fixed-translate":"fa fa-arrows font-size-20","fixed-view-data":"fa fa-table font-size-20","fixed-edit-pencil":"fa fa-pencil font-size-20",help:"fa fa-question-circle",save:"fa fa-folder",camera:"fa fa-camera","tts-play":"fa fa-play","tts-pause":"fa fa-pause","tts-sound":"fa fa-volume-up",drawer:"fa fa-bars","pop-out":"",mute:"fa fa-volume-off",unmute:"fa fa-volume-up",back:"fa fa-chevron-left",next:"fa fa-chevron-right","back-circle":"fa fa-chevron-circle-left","next-circle":"fa fa-chevron-circle-right",reset:"fa fa-undo",plus:"fa fa-plus",minus:"fa fa-minus","zoom-in":"fa fa-search-plus","zoom-out":"fa fa-search-minus","arrow-left":"fa fa-arrow-left","arrow-right":"fa fa-arrow-right",trash:"fa fa-trash-o","delete":"fa fa-trash-o",eye:"fa fa-eye",trophy:"fa fa-trophy",close:"fa fa-times","sort-up":"fa fa-sort-up","sort-down":"fa fa-sort-down","caret-left":"fa fa-caret-left",lock:"fa fa-lock","caret-right":"fa fa-caret-right","plus-square":"fa fa-plus-square","edit-pencil":"fa fa-pencil","chevron-up":"fa fa-chevron-up","chevron-down":"fa fa-chevron-down",search:"fa fa-search","play-circle-o":"fa fa-play-circle-o","check-circle":"fa fa-check-circle","arrow-circle-left":"fa fa-arrow-circle-left","arrow-circle-right":"fa fa-arrow-circle-right",reply:"fa fa-reply","slide-down":"fa fa-chevron-down","slide-up":"fa fa-chevron-up",dot:"fa fa-circle","degree-sign":"fa fa-circle-o","angle-double-left":"fa fa-angle-double-left","angle-double-right":"fa fa-angle-double-right",star:"fa fa-star","skip-animation":"fa fa-fast-forward",gallery:"fa fa-th"};return a.Common.Player.Models.Path=Backbone.Model.extend({_pathData:null,_interactivitiesPath:null,_commonPath:"",_basePath:"",_ttsPath:"",_appName:"",_cssPath:"",_animateCSSPath:"",_dataPath:"",_scriptPath:"",_vendorPath:"",_jqueryPath:"",_paperJsPath:"",_threeJsPath:"",_language:"",_imagePath:"",_highchartsPath:"",_mathquillPath:"",_videoPath:"",_audioPath:"",_fontsPath:"",_templatePath:"",imageFiles:null,_coreStaticPath:null,_mathUtilitiesCssPath:null,_mathUtilitiesJsPath:null,_mathUtilitiesTemplatePath:null,_mathUtilitiesDataPath:null,_interactivePath:null,_minify:!1,_dist:null,_audioFilesDataMap:null,initialize:function(){this._loadPathInformation(),this._loadFontAwesomeIconData()},_loadPathInformation:function(){this._pathData=b},_loadFontAwesomeIconData:function(){this._fontAwesomeIconData=c},initializeAppPath:function(a){var b,c,d,e=a.folder,f=a.lang,g=a.basePath,h=a.coreStaticPath||g+"/temporary-static/";switch(this._minify=a.minify,e&&(b=e.trim().length),b>0&&(this._appName=e),g&&(c=g.trim().length),c>0&&(this._basePath=g),h&&(d=h.trim().length),d>0&&(this._coreStaticPath=h),f){case"en":this._language=this._pathData.languages.en;break;case"es":this._language=this._pathData.languages.es;break;default:this._language=this._pathData.languages.en}this._setPathInformation()},_setPathInformation:function(){this._commonPath=this._pathData.common,this._interactivitiesPath=this._pathData.interactivities,this._cssPath=this._pathData.css,this._dataPath=this._pathData.data,this._scriptPath=this._pathData.js,this._jqueryPath=this._pathData.jquery,this._paperJsPath=this._pathData.paperJs,this._threeJsPath=this._pathData.threeJs,this._highchartsPath=this._pathData.highcharts,this._mathquillPath=this._pathData.mathquill,this._imagePath=this._pathData.image,this._videoPath=this._pathData.video,this._audioPath=this._pathData.audio,this._templatePath=this._pathData.templates,this._vendorPath=this._pathData.vendor,this._pluginPath=this._pathData.plugin,this._ttsPath=this._pathData.tts,this._fontsPath=this._pathData.fonts,this._theme=this._pathData.theme[0],this._mathUtilitiesCssPath=this._pathData.math_utilities_css,this._mathUtilitiesJsPath=this._pathData.math_utilities_js,this._mathUtilitiesTemplatePath=this._pathData.math_utilities_templates,this._mathUtilitiesDataPath=this._pathData.math_utilities_data,this._dist=this._pathData.dist,this._interactivePath=this._pathData.interactive,this._animateCSSPath=this._pathData.animate},setCSSThemeFolder:function(a){this._theme=this._pathData.theme[a-1]||this._pathData.theme[0]},setImageBase64Map:function(a){this.set("_imageBase64Map",a)},_getImageBase64Map:function(){return this.get("_imageBase64Map")},getImagePath:function(a){var b=this.imageFiles;return b[a].path},getFontAwesomeClass:function(a){var b=this._fontAwesomeIconData;return b[a]},getImageElement:function(a){var b=this.imageFiles[a]||{};return b.element},getImageBase64:function(a,b,c){return this.getImagePath(a)},getPath:function(b){var c,d=a.Common.Player.Models.Path.FOLDERS,e=this._basePath,f=this._appName,g="",h=this._coreStaticPath,i=e+this._commonPath,j=i+this._cssPath+this._vendorPath,k=i+this._scriptPath+this._vendorPath,l=i;switch(e&&(e+="/"),f&&(g+=e+this._interactivitiesPath+f+"/",c=g),h&&(h+="/"),i=this._minify?i+this._dist:i,g=this._minify?g+this._dist:g,b){case d.CSS:return g+this._cssPath;case d.DATA:return g+this._dataPath;case d.LANG_JSON:return g+this._language+this._dataPath;case d.SCRIPT:return g+this._scriptPath;case d.IMAGE:return c+this._imagePath;case d.AUDIO:return c+this._audioPath;case d.VIDEO:return c+this._videoPath;case d.TEMPLATE:return g+this._templatePath;case d.JQUERY_JS:return k+this._jqueryPath+this._scriptPath;case d.THREE_JS:return k+this._threeJsPath;case d.PAPER_JS:return k+this._paperJsPath;case d.COMMON_CSS:return i+this._cssPath+this._theme;case d.COMMON_DATA:return i+this._dataPath;case d.COMMON_LANG_JSON:return i+this._language+this._dataPath;case d.COMMON_LANG_IMAGE:return i+this._language+this._imagePath;case d.INTERACTIVE_LANG_IMAGE:return c+this._language+this._imagePath;case d.COMMON_SCRIPT:return i+this._scriptPath;case d.COMMON_TEMPLATE:return i+this._templatePath;case d.COMMON_IMAGE:return l+this._imagePath;case d.COMMON_AUDIO:return l+this._audioPath;case d.TTS:return h+this._vendorPath+this._ttsPath;case d.FONTS:return l+this._fontsPath;case d.HIGHCHARTS:return h+this._vendorPath+this._highchartsPath;case d.JQUERY_CSS:return k+this._jqueryPath+this._cssPath;case d.PLUGIN:return i+this._scriptPath+this._pluginPath;case d.MATHQUILL:return h+this._vendorPath+this._mathquillPath;case d.MATH_UTILITIES_CORE:return h;case d.MATH_UTILITIES_CSS:return h+this._mathUtilitiesCssPath;case d.MATH_UTILITIES_JS:return h+this._mathUtilitiesJsPath;case d.MATH_UTILITIES_TEMPLATES:return h+this._mathUtilitiesTemplatePath;case d.MATH_UTILITIES_DATA:return h+this._mathUtilitiesDataPath;case d.COMMON_INTERACTIVE_CSS:return i+this._cssPath+this._interactivePath;case d.COMMON_SCRIPT_FONTS:return l+this._scriptPath+this._fontsPath;case d.COMMON_INTERACTIVE_IMAGE:return l+this._imagePath+this._interactivePath;case d.COMMON_VENDOR:return k;case d.COMMON_VENDOR_CSS:return j;case d.ANIMATE_CSS:return h+this._cssPath+this._animateCSSPath;case d.VENDOR_DIST:return i+this._scriptPath+this._vendorPath;default:return""}},updateAudioDataMap:function(a){this._audioFilesDataMap=a},getAudioPath:function(a){var b=this._audioFilesDataMap[a]||null;return null!==b?b.url:""},getAudioData:function(a){var b=this._audioFilesDataMap[a]||null;return null!==b?b.data:{}}},{FOLDERS:{CSS:"CSS",DATA:"DATA",SCRIPT:"SCRIPT",LANGUAGE:"LANGUAGE",LANG_JSON:"LANG_JSON",IMAGE:"IMAGE",AUDIO:"AUDIO",VIDEO:"VIDEO",TEMPLATE:"TEMPLATE",JQUERY_JS:"JQUERY_JS",HIGHCHARTS:"HIGHCHARTS",THREE_JS:"THREE_JS",PAPER_JS:"PAPER_JS",MATHQUILL:"MATHQUILL",COMMON_CSS:"COMMON_CSS",COMMON_DATA:"COMMON_DATA",COMMON_LANG_JSON:"COMMON_LANG_JSON",COMMON_LANG_IMAGE:"COMMON_LANG_IMAGE",INTERACTIVE_LANG_IMAGE:"INTERACTIVE_LANG_IMAGE",COMMON_SCRIPT:"COMMON_SCRIPT",COMMON_TEMPLATE:"COMMON_TEMPLATE",COMMON_IMAGE:"COMMON_IMAGE",COMMON_AUDIO:"COMMON_AUDIO",TTS:"TTS",FONTS:"FONTS",JQUERY_CSS:"JQUERY_CSS",PLUGIN:"PLUGIN",MATH_UTILITIES_CORE:"MATH_UTILITIES_CORE",MATH_UTILITIES_CSS:"MATH_UTILITIES_CSS",MATH_UTILITIES_JS:"MATH_UTILITIES_JS",MATH_UTILITIES_TEMPLATES:"MATH_UTILITIES_TEMPLATES",MATH_UTILITIES_DATA:"MATH_UTILITIES_DATA",COMMON_VENDOR:"COMMON_VENDOR",COMMON_INTERACTIVE_CSS:"COMMON_INTERACTIVE_CSS",COMMON_VENDOR_CSS:"COMMON_VENDOR_CSS",COMMON_INTERACTIVE_IMAGE:"COMMON_INTERACTIVE_IMAGE",ANIMATE_CSS:"ANIMATE_CSS",VENDOR_DIST:"VENDOR_DIST"},THEME:{THEME_1:0,THEME_2:1}}),a.global.Path=a.Common.Player.Models.Path,a.global.Path}(window.MathInteractives),function(a){"use strict";return a.Common.Player.Models.InteractivityPreloader=Backbone.Model.extend({defaults:function(){return{interactivityConfig:{},containerId:null,playerView:null,_filesToLoad:null,componentResourceList:null,requireModules:null,preloaderData:null,audioFileDataMap:null}},pathIndex:0,path:null,paths:null,imageFiles:null,_interactiveOptions:null,_isTwoStepLoad:!1,_playerTheme:1,initiatePreload:function(){var a;this._interactiveOptions=this.get("interactiveOptions"),this.set("containerId",this._interactiveOptions.containerId),a=this._interactiveOptions.containerId+"_"+this._interactiveOptions.folder+"_config",this._initiatePath(),this._loadConfigs(a)},_initiatePath:function(b){var c=this,d={folder:c._interactiveOptions.folder,lang:c._interactiveOptions.lang,basePath:c._interactiveOptions.basePath,coreStaticPath:c._interactiveOptions.coreStaticPath,minify:c._interactiveOptions.minify};c.path=new a.global.Path,c.path.initializeAppPath(d)},_loadConfigs:function(b){var c,d,e=[],f=this._interactiveOptions;e.push($.extend(!0,{},f.playerConfig.resources)),Preloader=a.Common.Preloader,c=Preloader.Event.Types,d=new Preloader({resourceList:[{type:"json",path:this.path.getPath(a.global.Path.FOLDERS.DATA)+"interactivity-config.json",id:b}]}),d.off().on(c.PRELOAD_SUCCESS,$.proxy(function(a){var c,d=a.preloader.getPreloadData()[b].data,f=this;e.push($.extend(!0,{},d.resources)),d.hasOwnProperty("config")&&(f.set("interactivityConfig",d.config),f._isTwoStepLoad=d.config.isTwoStepLoad||!1,c=d.config.playerTheme,"undefined"!=typeof c&&null!==c&&(f.path.setCSSThemeFolder(c),f._playerTheme=c)),f.preload(Preloader,e)},this)).on(c.PRELOAD_ERROR,$.proxy(this._onError,this)),d.preload()},preload:function(a,b){var c=this,d={step1:[],step2:[]};this.get("path"),c.paths;d.step1=c._loadLocAccJson(d.step1),c._generatePreloadFileList(d,b)},_loadLocAccJson:function(b){return b.push({id:"common-loc-acc",path:this.path.getPath(a.global.Path.FOLDERS.COMMON_LANG_JSON)+"loc-acc.json",type:"json"}),b.push({id:"interactive-loc-acc",path:this.path.getPath(a.global.Path.FOLDERS.LANG_JSON)+"loc-acc.json",type:"json"}),b},_generatePreloadFileList:function(a,b){var c=this,d=null;this.set("componentResourceList",b[0].components||{}),b[0]=b[0]["theme"+this._playerTheme],b=c._checkForSoundManagerDependency(b);for(var e in b){d=c._getResourcesListToPreload(c._updateResourceListOnComponentDependency(b[e]),Number(e));for(var f in d)c._isTwoStepLoad&&d[f].isNextStepLoad?a.step2.push(d[f]):a.step1.push(d[f])}c.set("_filesToLoad",a);var g=this.get("requireModules"),h=this.get("componentResourceList");g.step1=g.step1||[],g.step1=g.step1.concat(h["tts-help-main"].requireModules[0].module),this.set("requireModules",g),c._preloadResources(a.step1)},_checkForSoundManagerDependency:function(a){for(var b,c,d,e=0;e<a.length;e++)if(b=a[e],c=b.media||{},d=c.audio||[],d.length>0){a[0].components.push("sound-manager");break}return a},_updateResourceListOnComponentDependency:function(a){var b,c=a.components||[],d=this.get("componentResourceList"),e=0;for(e=0;e<c.length;e++)b=d[c[e]]||{},a.js=a.js||[],b.js&&(a.js=a.js.concat(b.js)),a.css=a.css||[],b.css&&(a.css=a.css.concat(b.css)),a.templates=a.templates||[],b.templates&&(a.templates=a.templates.concat(b.templates)),a.media=a.media||{},a.media.image=a.media.image||[],b.media&&b.media.image&&(a.media.image=a.media.image.concat(b.media.image)),a.media.cur=a.media.cur||[],b.media&&b.media.cur&&(a.media.cur=a.media.cur.concat(b.media.cur)),a.requireModules=a.requireModules||[],b.requireModules&&(a.requireModules=a.requireModules.concat(b.requireModules)),a.json=a.json||[],b.json&&(a.json=a.json.concat(b.json));return a},_getResourcesListToPreload:function(b,c){var d,e,f,g,h,i,j,k,l=[],m=null,n=this,o=0,p=a.Common.Player.Models.InteractivityPreloader.FileTypes;if(b.media){d="",m=b.media;for(h in m)switch(h){case p.CUR:case p.IMAGE:for(o in m[h])e=m[h][o],j=!1,k=1===c&&"undefined"==typeof e.isNextStepLoad?!0:e.isNextStepLoad,d=e.hasOwnProperty("basePath")?this.path.getPath(a.global.Path.FOLDERS[e.basePath])+e.url:this.path.getPath(a.global.Path.FOLDERS.IMAGE)+e.url,"cur"===h?l.push({id:e.id,path:d,type:"cur",isNextStepLoad:k}):("undefined"!=typeof e.isBase64&&(j=e.isBase64),l.push({id:e.id,path:d,type:"image",isNextStepLoad:k,forceLoad:e.forceLoad||!1}));break;case p.AUDIO:var q=this.get("audioFileDataMap")||{};for(o in m[h])e=m[h][o],e.hasOwnProperty("data")&&(e.hasOwnProperty("basePath")?e.url=this.path.getPath(a.global.Path.FOLDERS[e.basePath])+e.url:e.url=this.path.getPath(a.global.Path.FOLDERS.AUDIO)+e.url,e.url=Preloader.normalizeURL(e.url).replace(".mp3",""),e.audioFilePath=e.url,e.audioData=e.data,q[e.id]=e,delete e.basePath,delete e.url,delete e.data,delete e.id);this.set("audioFileDataMap",q),this.path.updateAudioDataMap(q);break;case p.VIDEO:}}for(i in b)switch(m=b[i],i){case p.JS:case p.REQUIRE_JS:case p.TEMPLATES:if(g=i,b.isNewJsonType===!0){l=this._getJSResourcesListToPreloadForNewJSON(g,m,l,c);break}for(i in m){d="";for(o in m[i])e=m[i][o],k=1===c&&"undefined"==typeof e.isNextStepLoad?!0:e.isNextStepLoad,e.hasOwnProperty("basePath")?d=this.path.getPath(a.global.Path.FOLDERS[e.basePath])+e.url:"js"===g?d=this.path.getPath(a.global.Path.FOLDERS.SCRIPT)+e.url:"templates"===g&&(d=this.path.getPath(a.global.Path.FOLDERS.TEMPLATE)+e.url),l.push({path:d,type:"javascript",isNextStepLoad:k,forceLoad:e.forceLoad||!1})}break;case p.CSS:d="";for(o in m)e=m[o],k=1===c&&"undefined"==typeof e.isNextStepLoad?!0:e.isNextStepLoad,d=e.hasOwnProperty("basePath")?this.path.getPath(a.global.Path.FOLDERS[e.basePath])+e.url:this.path.getPath(a.global.Path.FOLDERS.CSS)+e.url,l.push({path:d,type:"css",isNextStepLoad:k,forceLoad:e.forceLoad||!1});break;case p.REQUIRE_JSON:case p.JSON:d="";var g,r;g=i;for(o in m)e=m[o],k=1===c&&"undefined"==typeof e.isNextStepLoad?!0:e.isNextStepLoad,e.url.indexOf("loc-acc")>-1||(d=e.hasOwnProperty("basePath")?this.path.getPath(a.global.Path.FOLDERS[e.basePath])+e.url:this.path.getPath(a.global.Path.FOLDERS.DATA)+e.url,r="json","requirejson"===g&&(d+="?callback=define",r="requirejs"),l.push({id:e.id||"json-"+o,path:d,type:r,isNextStepLoad:k,forceLoad:e.forceLoad||!1}));break;case p.FONT:d=null;var f,s,t;for(o in m)e=m[o],k=1===c&&"undefined"==typeof e.isNextStepLoad?!0:e.isNextStepLoad,s=this.path.getPath("FONTS"),f=e.name,e.hasOwnProperty("basePath")&&(s=this.path.getPath(a.global.Path.FOLDERS[e.basePath])),d=e.url,t={type:"font",fontFamily:f,fontFormat:e.type||"",isNextStepLoad:k,forceLoad:e.forceLoad||!1},$.isArray(d)?(d.forEach(function(a){a.path=s+a.path,a.fontFormat=a.type,delete a.type}),t.fontPaths=d,t.path=d[0].path):t.path=s+d,l.push(t);break;case p.REQUIRE_MODULES:var u=this.get("requireModules")||{};u.step1=u.step1||[],u.step2=u.step2||[],m.forEach(function(a){n._isTwoStepLoad?(k=1===c&&"undefined"==typeof a.isNextStepLoad?!0:a.isNextStepLoad,k?u.step2.push(a.module):u.step1.push(a.module)):u.step1.push(a.module)}),this.set("requireModules",u)}return l},_getJSResourcesListToPreloadForNewJSON:function(b,c,d,e){var f,g,h,i,j,k=0;h=b;for(k in c)f="",g=c[k],i=1===e&&"undefined"==typeof g.isNextStepLoad?!0:g.isNextStepLoad,g.hasOwnProperty("basePath")?f=this.path.getPath(a.global.Path.FOLDERS[g.basePath])+g.url:"js"===h?f=this.path.getPath(a.global.Path.FOLDERS.SCRIPT)+g.url:"templates"===h&&(f=this.path.getPath(a.global.Path.FOLDERS.TEMPLATE)+g.url),j="javascript","requirejs"===h&&(j="requirejs"),this._isVendorFile(g)||d.push({path:f,type:j,isNextStepLoad:i,forceLoad:g.forceLoad||!1});return d},_isVendorFile:function(b){var c,d,e=a.Common.Player.Models.InteractivityPreloader,f=e.VendorFiles,g=this.get("requireModules")||{},h=this.get("componentResourceList");switch(g.step1=g.step1||[],g.step2=g.step2||[],b.url){case f.PaperJs.url:c=f.PaperJs.require;break;case f.JqueryUI.url:c=f.JqueryUI.require;break;case f.JqueryUITouch.url:c=f.JqueryUITouch.require;break;case f.JqueryMouseWheel.url:c=f.JqueryMouseWheel.require;break;case f.CustomSlider.url:case f.CustomSlider1.url:c=f.CustomSlider.require;break;case f.HighCharts.url:c=f.HighCharts.require;break;case f.HighChartsMore.url:c=f.HighChartsMore.require}return c?(d=h[c].requireModules,g.step1=g.step1.concat(Object.keys(d).map(function(a){return d[a].module})),this.set("requireModules",g),!0):!1},_isRequireLoadNeededForStep1:function(){var a=this.get("requireModules")||{};return a.step1=a.step1||[],a.step1.length>0?!0:!1},_isRequireLoadNeededForStep2:function(){var a=this.get("requireModules")||{};return a.step2=a.step2||[],a.step2.length>0?!0:!1},_preloadResources:function(b){var c,d,e,f=this;c=a.Common.Preloader,d=c.Event.Types,e=new c({resourceList:b}),f._beforeStart(),e.off().on(d.PRELOAD_RESOURCE_PROGRESS,$.proxy(f._onProgress,f)).on(d.PRELOAD_RESOURCE_SUCCESS,$.proxy(f._onPreloadComplete,f)).on(d.PRELOAD_RESOURCE_ERROR,$.proxy(function(){this._onError()},f)),e.preload(),this._preloader=e},startStep2Preload:function(){if(this._isTwoStepLoad){var b,c,d,e=this,f=e.get("_filesToLoad").step2;b=a.Common.Preloader,c=b.Event.Types,d=new b({resourceList:f}),e._step2BeforeStart(),d.off().on(c.PRELOAD_RESOURCE_PROGRESS,$.proxy(e._step2ProgressCallback,e)).on(c.PRELOAD_RESOURCE_SUCCESS,$.proxy(e._step2CompleteCallback,e)).on(c.PRELOAD_RESOURCE_ERROR,$.proxy(e._step2ErrorCallback,e)),d.preload(),this._step2preloader=d}},_beforeStart:function(){this.trigger("preloader-before-start",{basePath:this._interactiveOptions.basePath}),this.off("interactive-load-complete").on("interactive-load-complete",this._triggersCompleteCallback)},_onPreloadComplete:function(a){var b,c=a.preloader,d={},e={},f=this.get("preloaderData")||{};b=c.getPreloadData(),this.path.imageFiles=c.getImages(),d.common=b["common-loc-acc"].data.locAccData,d.interactive=b["interactive-loc-acc"].data.locAccData,e.common=e.interactive={},this._interactiveOptions.bAllowAccessibility&&(e.common=b["common-loc-acc"].data.pronunciationData||{},e.interactive=b["interactive-loc-acc"].data.pronunciationData||{}),delete b["common-loc-acc"],delete b["interactive-loc-acc"],f.step1={jsonData:b,managerData:d,startTabindex:this._interactiveOptions.initialTabIndex,allowAccessibility:this._interactiveOptions.bAllowAccessibility,isNoTextMode:this._interactiveOptions.isNoTextMode,path:this.path,initialState:this._interactiveOptions.initialState,pronunciationData:e},this.set("preloaderData",f),this._loadInteractiveStep1()},_loadInteractiveStep1:function(){var a=null;this._isRequireLoadNeededForStep1()&&"undefined"!=typeof require?(a=this.get("requireModules").step1,require(a,$.proxy(this._completeInteractiveStep1,this),$.proxy(this._onError,this))):this._completeInteractiveStep1()},_completeInteractiveStep1:function(){this.trigger("preloader-complete",this.get("preloaderData").step1),this._initializeTouchSimulator()},_initializeTouchSimulator:function(){a.Common.Utilities.Models.Utils.DisableTouch=MathUtilities.Components.Utils.TouchSimulator.disableTouch,
a.Common.Utilities.Models.Utils.EnableTouch=MathUtilities.Components.Utils.TouchSimulator.enableTouch,a.Common.Utilities.Models.Utils.SPECIFIC_EVENTS=a.Common.Utilities.Models.Utils.SpecificEvents=MathUtilities.Components.Utils.TouchSimulator.SPECIFIC_EVENTS},_triggersCompleteCallback:function(a){var b=this._interactiveOptions.callbackData;b.loadedStepNumber=a.loadedStepNumber,b.isTwoStepLoad=this._isTwoStepLoad,this._isTwoStepLoad&&2===b.loadedStepNumber&&(b.isTwoStepLoad=!1),this._interactiveOptions.success&&this._interactiveOptions.success.apply(this._interactiveOptions.scope||this,[b,this.get("playerView"),this._interactiveOptions.interactiveGuid]),this._interactiveOptions.complete&&this._interactiveOptions.complete.apply(this._interactiveOptions.scope||this,[b])},_onError:function(a){var b=this._interactiveOptions.callbackData;b.loadedStepNumber=a?a.loadedStepNumber:1,this.trigger("preloader-error"),this._interactiveOptions.error&&this._interactiveOptions.error.apply(this._interactiveOptions.scope||this,[this._interactiveOptions,b]),this._interactiveOptions.complete&&this._interactiveOptions.complete.apply(this._interactiveOptions.scope||this,[b])},_onProgress:function(a){this.trigger("preloader-progress",{percentComplete:a.progressPercent})},_step2BeforeStart:function(){this.trigger("step-2-preloader-before-start",{basePath:this._interactiveOptions.basePath})},_step2ProgressCallback:function(a){this.trigger("step-2-preloader-progress",{percentComplete:a.progressPercent})},_step2CompleteCallback:function(a){var b,c=a.preloader,d=this._preloader,e=d.getPreloadData(),f=c.getPreloadData(),g=this.get("preloaderData")||{};$.extend(this.path.imageFiles,c.getImages()),b=$.extend({},e,f),g.step2={jsonData:b},this.set("preloaderData",g),this._loadInteractiveStep2()},_loadInteractiveStep2:function(){var a=null;this._isRequireLoadNeededForStep2()&&"undefined"!=typeof require?(a=this.get("requireModules").step2,require(a,$.proxy(this._completeInteractiveStep2,this),$.proxy(this._onError,this))):this._completeInteractiveStep2()},_completeInteractiveStep2:function(){this.trigger("step-2-preloader-complete",this.get("preloaderData").step2)},_step2ErrorCallback:function(a){this._onError({loadedStepNumber:2})},getQueryStringData:function(){var a=decodeURIComponent(location.search.substring(1,location.search.length)),b={},c=a.split("&");for(var d in c){var e=c[d].split("=");b[e[0]]=e[1]}return b},_isMSIE9:function(){return navigator.userAgent.toLowerCase().indexOf("msie 9")>-1?!0:!1}},{PRELOADER_TYPE1:1,PRELOADER_TYPE2:2,FileTypes:{JS:"js",CSS:"css",IMAGE:"image",AUDIO:"audio",VIDEO:"video",JSON:"json",CUR:"cur",TEMPLATES:"templates",FONT:"fonts",REQUIRE_JS:"requirejs",REQUIRE_JSON:"requirejson",REQUIRE_MODULES:"requireModules"},VendorFiles:{PaperJs:{url:"paper-full.js",basePath:"PAPER_JS",require:"paper-js"},JqueryUI:{url:"jquery.ui.js",basePath:"JQUERY_JS",require:"jquery-ui"},JqueryUITouch:{url:"jquery.ui.touch.js",basePath:"JQUERY_JS",require:"jquery-ui-touch"},JqueryMouseWheel:{url:"jquery.mousewheel.min.js",basePath:"JQUERY_JS",require:"jquery-mousewheel"},JqueryTableSorter:{url:"jquery.tablesorter.js",basePath:"JQUERY_JS",require:"jquery-table-sorter"},CustomSlider:{url:"custom-slider.js",basePath:"PLUGIN",require:"custom-slider"},CustomSlider1:{url:"plugin/custom-slider.js",basePath:"COMMON_SCRIPT",require:"custom-slider"},HighCharts:{url:"highcharts.js",basePath:"HIGHCHARTS",require:"highcharts"},HighChartsMore:{url:"highcharts-more.js",basePath:"HIGHCHARTS",require:"highcharts-more"}}}),a.Common.Player.Models.InteractivityPreloader}(window.MathInteractives),function(a){return a.Common.Player.Views.InteractivityPreloader?void 0:(a.Common.Player.Views.InteractivityPreloader=Backbone.View.extend({el:".preloader",throbTimer:null,initialize:function(){this.model.on("preloader-complete",$.proxy(this._completeCallback,this)),this.model.on("preloader-progress",$.proxy(this._progressCallback,this)),this.model.on("preloader-error",$.proxy(this._errorCallback,this)),this.model.on("preloader-before-start",$.proxy(this._beforeStart,this)),this.model.on("step-2-preloader-complete",$.proxy(this._step2CompleteCallback,this)),this.model.on("step-2-preloader-progress",$.proxy(this._step2ProgressCallback,this)),this.model.on("step-2-preloader-error",$.proxy(this._step2ErrorCallback,this)),this.model.on("step-2-preloader-before-start",$.proxy(this._step2BeforeStart,this))},_beforeStart:function(b){var c,d=this.model.get("interactivityConfig"),e=d.themeType,f=d.tabsData.length,g=this.model.get("containerId"),h=d.idPrefix,i=this.$(".throbber-container"),j=this.$(".in-progress-text");switch(c=$("#"+g+" div:first"),c.addClass(d.cssClass||"").addClass(d.idPrefix).addClass("math-utilities-manager").attr("id",h+"-player"),"undefined"!=typeof d.playerTheme&&null!==d.playerTheme&&d.playerTheme>1&&c.addClass("player-theme-"+d.playerTheme),2>f&&this.$el.parent().find(".tabs-container").hide(),e){case a.Common.Player.Models.InteractivityPreloader.PRELOADER_TYPE1:f>1?this.$el.css("height","585px"):this.$el.css("height","550px");break;case a.Common.Player.Models.InteractivityPreloader.PRELOADER_TYPE2:this.$el.css("height","644px");break;default:f>1?this.$el.css("height","585px"):this.$el.css("height","550px")}this.$el.show();var k=this.$(".progress-box-container");k.css("top",(this.$el.height()-k.height())/2).show(),this.throbTimer=a.Common.Player.Views.InteractivityPreloader.SHOW_THROBBER(i,j)},_completeCallback:function(b){var c,d,e,f,g,h,i=this,j=a.Common.Player.Views.Player;f=setInterval(function(){if(c=i.model.get("interactivityConfig"),h=i.model.get("containerId"),g=c.idPrefix,"undefined"==typeof g&&(g=""),$("#"+h+" .player").is(":visible")){clearInterval(f),d=new a.global.PlayerModel({noOfTabs:c.tabsData.length,config:c,jsonData:b.jsonData,managerData:b.managerData,startTabindex:b.startTabindex,isAccessible:b.allowAccessibility,isNoTextMode:b.isNoTextMode,prefix:g+"-",interactiveId:i.model._interactiveOptions.interactiveGuid,path:b.path,initialState:b.initialState,containerId:h,modalPresent:!0,pronunciationData:b.pronunciationData,audioFileDataMap:i.model.get("audioFileDataMap"),isPoppedOut:i.model._interactiveOptions.popout}),e=new j({model:d,el:$("#"+h+" .player")}),i.model.set("playerView",e),i.$el.fadeOut(1e3,function(){e.setModalPresent(!1)});var k=SpeechStream.tools.getPageControl();k.addAllow(e.$el.parent()[0].id),d.off(j.Events.SECOND_STEP_START).on(j.Events.SECOND_STEP_START,$.proxy(i._startStep2Preload,i)),i.model.trigger("interactive-load-complete",{loadedStepNumber:1}),a.Common.Player.Views.InteractivityPreloader.STOP_THROBBER(i.throbTimer,i.$(".in-progress-text"))}},17)},_progressCallback:function(a){var b=this.$el.find(".in-progress-text").html();b||this.$el.find(".in-progress-text").html("Loading"),this.$el.find(".progress-bar").css("width",a.percentComplete+"%")},_errorCallback:function(){a.Debugger.log("interactivity-preloader :: Error!!"),this.$el.find(".in-progress-text").html("Loading Failed!!"),a.Common.Player.Views.InteractivityPreloader.STOP_THROBBER(this.throbTimer,this.$(".in-progress-text"))},_startStep2Preload:function(a){this.model.startStep2Preload()},_step2BeforeStart:function(a){},_step2ProgressCallback:function(b){var c=this.model.get("playerView"),d=a.Common.Player.Views.Player.Events;c.model.trigger(d.SECOND_STEP_PROGRESS,b)},_step2CompleteCallback:function(b){var c=this.model.get("playerView"),d=a.Common.Player.Views.Player.Events;c.model.set("jsonData",b.jsonData),c.model.trigger(d.SECOND_STEP_COMPLETE,b),this.model.trigger("interactive-load-complete",{loadedStepNumber:2})},_step2ErrorCallback:function(b){a.Debugger.log("interactivity-preloader :: Error!!");var c=this.model.get("playerView"),d=a.Common.Player.Views.Player.Events;c.model.trigger(d.SECOND_STEP_ERROR,b)}},{SHOW_THROBBER:function(b,c){var d=a.Common.Player.Views.InteractivityPreloader,e=d.MAX_THROBBER_SEQUENCE,f=0,g=null;return c&&d.ANIMATE_PRELOADER_TEXT(c),g=setInterval(function(){b.removeClass(d.THROBBER_CLASS).addClass("throb-"+f++%e)},d.THROBBER_FRAME_INTERVAL)},ANIMATE_PRELOADER_TEXT:function(b){var c=a.Common.Player.Views.InteractivityPreloader,d="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";b.removeClass("animated fadeIn").addClass("animated fadeOut").one(d,function(){$(this).removeClass("animated fadeOut").addClass("animated fadeIn").one(d,function(){c.ANIMATE_PRELOADER_TEXT(b)})})},STOP_THROBBER:function(a,b){b&&b.off(),clearInterval(a)},THROBBER_CLASS:"throb-0 throb-1 throb-2 throb-3 throb-4 throb-5 throb-6",MAX_THROBBER_SEQUENCE:7,THROBBER_FRAME_INTERVAL:100}),a.Common.Player.Views.InteractivityPreloader)}(window.MathInteractives),function(){var a=Handlebars.template,b=MathInteractives.Common.Player.templates=MathInteractives.Common.Player.templates||{};b.player=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+='\ufeff<div class="preloader" align="center">\r\n    <div class="progress-box-container">\r\n        <div class="progress-box">\r\n            <div class="progress-bar-container">\r\n                <div class="throbber-wrapper">\r\n                    <div class="throbber-container">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="in-progress-text" style="color:white"></div>\r\n    </div>\r\n</div>\r\n<div class="player" texthelpcmd="list" texthelpcmd1="bookid:',(f=c.bookId)?f=f.call(b,{hash:{},data:e}):(f=b.bookId,f=typeof f===h?f.apply(b):f),g+=i(f)+'"  texthelpcmd2="pageid:',(f=c.pageId)?f=f.call(b,{hash:{},data:e}):(f=b.pageId,f=typeof f===h?f.apply(b):f),g+=i(f)+'">\r\n    <div class="header-container font-montserrat-regular">\r\n        <div class="header-background">\r\n            <div class="header-left"></div>\r\n            <div class="header-middle"></div>\r\n            <div class="header-right"></div>\r\n        </div>\r\n\r\n        <div class="header-content">\r\n        </div>\r\n    </div>\r\n    <div class="tabs-container"></div>\r\n    <div class="activity-area-container">\r\n    </div>\r\n    <div id="text-dimentions-hack" style="float:initial;  min-height: initial;margin-left: initial;line-height:normal;"></div>\r\n</div>\r\n'})}(),function(){MathInteractives.Common.Utilities.Models.Debugger=Backbone.Model.extend({},{DEBUG:!0,log:function(a){this.DEBUG&&"undefined"!=typeof console&&"undefined"!=typeof console.log}}),MathInteractives.Debugger=MathInteractives.Common.Utilities.Models.Debugger}(),function(){"use strict";var a={"popblocks-2":function(a){return{waitSeconds:15,paths:{"mathInteractive-equationData":a+"data/math-utilities/components/math-editor/equation","mathInteractive-keyboardData":a+"data/math-utilities/components/math-editor/keyboard","mathInteractive-application":a+"js/math-utilities/components/math-editor/models/application","mathInteractive-mathFunction":a+"js/math-utilities/components/equation-engine/scripts/models/math-functions","mathInteractive-functionPanel":a+"js/math-utilities/components/math-editor/models/function-panel","mathInteractive-basePanel":a+"js/math-utilities/components/math-editor/models/base-panel","mathInteractive-keyMatrix":a+"js/math-utilities/components/math-editor/models/key-matrix","mathInteractive-expressionPanel":a+"js/math-utilities/components/math-editor/models/expression-panel","mathInteractive-browserCheck":a+"js/math-utilities/components/utils/models/browser-check","mathInteractive-expressionPanelView":a+"js/math-utilities/components/math-editor/views/expression-panel","mathInteractive-functionPanelView":a+"js/math-utilities/components/math-editor/views/function-panel","mathInteractive-basePanelView":a+"js/math-utilities/components/math-editor/views/base-panel","mathInteractive-keyMatrixView":a+"js/math-utilities/components/math-editor/views/key-matrix","mathInteractive-alphabetPanel":a+"templates/core/math-utilities/components/math-editor/alphabetPanel","mathInteractive-expressionPanelTempalte":a+"templates/core/math-utilities/components/math-editor/expressionPanel","mathInteractive-closeButton":a+"templates/core/math-utilities/components/math-editor/closeButton","mathInteractive-editableTextbox":a+"templates/core/math-utilities/components/math-editor/editableTextbox","mathInteractive-functionPanelTemplate":a+"templates/core/math-utilities/components/math-editor/functionPanel","mathInteractive-header":a+"templates/core/math-utilities/components/math-editor/header","mathInteractive-key":a+"templates/core/math-utilities/components/math-editor/key","mathInteractive-keyboardTemplate":a+"templates/core/math-utilities/components/math-editor/keyboard","mathInteractive-keyboardHolder":a+"templates/core/math-utilities/components/math-editor/keyboardHolder","mathInteractive-keyboardTitleHolder":a+"templates/core/math-utilities/components/math-editor/keyboardTitleHolder","mathInteractive-numberPanel":a+"templates/core/math-utilities/components/math-editor/numberPanel","mathInteractive-undoRedo":a+"templates/core/math-utilities/components/math-editor/undoRedo","mathInteractive-keyboardContainer":a+"templates/core/math-utilities/components/math-editor/keyboardContainer","mathInteractive-sectionFocusRect":a+"templates/core/math-utilities/components/math-editor/sectionFocusRect","mathInteractive-keyboard":a+"js/math-utilities/components/math-editor/models/keyboard","mathInteractive-keyboardView":a+"js/math-utilities/components/math-editor/views/keyboard","mathInteractive-equationEditor":a+"js/math-utilities/components/math-editor/models/equation-editor","mathInteractive-equationEditorView":a+"js/math-utilities/components/math-editor/views/equation-editor","mathInteractive-equationParser":a+"js/math-utilities/components/equation-engine/scripts/models/equation-parser","mathInteractive-mathEditor":a+"js/math-utilities/components/math-editor/models/math-editor","mathInteractive-mathEditorView":a+"js/math-utilities/components/math-editor/views/math-editor"},shim:{"mathInteractive-functionPanel":["mathInteractive-application"],"mathInteractive-basePanel":["mathInteractive-application"],"mathInteractive-keyMatrix":["mathInteractive-application"],"mathInteractive-expressionPanel":["mathInteractive-application"],"mathInteractive-browserCheck":["mathInteractive-application"],"mathInteractive-expressionPanelView":["mathInteractive-application"],"mathInteractive-functionPanelView":["mathInteractive-application"],"mathInteractive-basePanelView":["mathInteractive-application"],"mathInteractive-keyMatrixView":["mathInteractive-application"],"mathInteractive-alphabetPanel":["mathInteractive-application"],"mathInteractive-expressionPanelTempalte":["mathInteractive-application"],"mathInteractive-closeButton":["mathInteractive-application"],"mathInteractive-editableTextbox":["mathInteractive-application"],"mathInteractive-functionPanelTemplate":["mathInteractive-application"],"mathInteractive-header":["mathInteractive-application"],"mathInteractive-key":["mathInteractive-application"],"mathInteractive-keyboardTemplate":["mathInteractive-application"],"mathInteractive-keyboardHolder":["mathInteractive-application"],"mathInteractive-keyboardTitleHolder":["mathInteractive-application"],"mathInteractive-numberPanel":["mathInteractive-application"],"mathInteractive-undoRedo":["mathInteractive-application"],"mathInteractive-keyboardContainer":["mathInteractive-application"],"mathInteractive-sectionFocusRect":["mathInteractive-application"],"mathInteractive-keyboard":["mathInteractive-application"],"mathInteractive-keyboardView":["mathInteractive-application"],"mathInteractive-equationEditor":["mathInteractive-application"],"mathInteractive-equationEditorView":["mathInteractive-application"],"mathInteractive-equationParser":["mathInteractive-mathFunction"],"mathInteractive-mathEditor":["mathInteractive-application"],"mathInteractive-mathEditorView":["mathInteractive-application"]}}}};MathInteractives.Common.Utilities.Models.RequireConfig=Backbone.Model.extend({},{setConfig:function(b,c){var d=a[b],e=null;d&&(e=d(c)),e&&requirejs&&requirejs.config(e)}})}(),function(a){a.Common.Player._configData={resources:{theme1:{isNewJsonType:!0,fonts:[{url:[{path:"webfonts/Montserrat/montserrat-regular.woff",type:"woff"},{path:"webfonts/Montserrat/montserrat-regular.woff2",type:"woff2"}],name:"Montserrat",basePath:"MATH_UTILITIES_CSS"},{url:[{path:"webfonts/Montserrat/montserrat-bold.woff",type:"woff"},{path:"webfonts/Montserrat/montserrat-bold.woff2",type:"woff2"}],name:"Montserrat-Bold",basePath:"MATH_UTILITIES_CSS"}],css:[{url:"common.min.css",basePath:"COMMON_CSS"}],js:[{url:"jquery.tablesorter.min.js",basePath:"JQUERY_JS"},{url:"jquery.ui.touch.js",basePath:"JQUERY_JS"}],components:["manager","drag-drop","theme1-input-box","context-menu","hint-feedback","theme1-custom-combo-box","local-instruction","theme1-custom-spinner","theme1-data-table","tooltip","counter-label","canvas-acc","intro-box","feedback-badge","theme1-slider","theme1-check-box","theme1-radio-button","theme1-data-table","drag-select","animate-css","utils-autoload","theme1-components"],templates:[],media:{image:[{id:"player-lr",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"player-m",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"buttons-icons",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"header-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"hint-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"tts-play-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"tts-pause-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"tts-sound-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"action-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"action-button-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"general-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"general-button-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"save-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"save-button-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"multi-toggle-black-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"multi-toggle-black-button-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"delete-bin-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"close-orange-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"close-orange-cross-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"close-purple-cross-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"on-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"on-button-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"off-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"off-button-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"draggable-blue-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"draggable-blue-button-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"draggable-green-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"draggable-green-button-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"draggable-red-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"draggable-red-button-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"draggable-blue-small-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"draggable-blue-small-button-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"purple-button-definition-box",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"purple-button-definition-box-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"dot-helper",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"purple-left-arrow-head",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"purple-right-arrow-head",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"purple-dot",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"purple-dot-outline",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"arrow-line",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"dot-helper-pan",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"purple-left-arrow-head-pan",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"purple-right-arrow-head-pan",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"purple-dot-pan",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"purple-dot-outline-pan",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"arrow-line-pan",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"users-graph-line",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"feedback-graph-line",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"tooltip-left",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"tooltip-middle",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"tooltip-right",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"sound-mgr-button",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"red-tile-left-right",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"red-tile-middle",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"green-tile-left-right",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"green-tile-middle",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"shadow-left",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"shadow-middle",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"shadow-right",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"left-arrow",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"right-arrow",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"}],audio:[],video:[]}},theme2:{isNewJsonType:!0,fonts:[{url:[{path:"webfonts/Montserrat/montserrat-regular.woff2",type:"woff2"},{path:"webfonts/Montserrat/montserrat-regular.woff",type:"woff"}],name:"Montserrat",basePath:"MATH_UTILITIES_CSS"},{url:[{path:"webfonts/Montserrat/montserrat-bold.woff2",type:"woff2"},{path:"webfonts/Montserrat/montserrat-bold.woff",type:"woff"}],name:"Montserrat-Bold",basePath:"MATH_UTILITIES_CSS"}],css:[{url:"common.min.css",basePath:"COMMON_CSS"}],js:[{url:"jquery.ui.touch.js",basePath:"JQUERY_JS"},{url:"jquery.tablesorter.min.js",basePath:"JQUERY_JS"},{url:"plugin/custom-slider.js",basePath:"COMMON_SCRIPT"}],components:["manager","drag-drop","theme2-help","theme2-drag-drop","theme2-input-box","theme2-custom-spinner","theme2-empty-modal","theme2-overview-tab","theme2-data-table","theme2-direction-text","theme2-pop-up-box","context-menu","theme2-check-box","theme2-combobox","theme2-radio-button","theme2-slider","theme2-canvas-acc","theme2-feedback","theme2-toggle-button","animate-css","theme2-tooltip","utils-autoload","theme2-components"],templates:[],media:{image:[{id:"buttons-icons",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"}],audio:[],video:[]}},components:{manager:{componentType:0,themeType:0,stepNumber:1,css:[],js:[],templates:[],requireModules:[{module:"accessibilityAutoload"}]},button:{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"legend-button":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"pan-balance":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[],media:{image:[{id:"pan-balance",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"temporary-bin",url:"player/temporary-bin.png",basePath:"COMMON_IMAGE"},{id:"pan-balance-green-left-right",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"pan-balance-green-draggable-left-right",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"pan-balance-green-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"pan-balance-green-draggable-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"pan-balance-red-left-right",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"pan-balance-red-draggable-left-right",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"pan-balance-red-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"},{id:"pan-balance-red-draggable-mid",url:"sprites/sprite-vertical.png",basePath:"COMMON_IMAGE"}]}},"theme1-input-box":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"context-menu":{componentType:0,themeType:0,stepNumber:1,js:[],templates:[]},"hint-feedback":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"grid-area":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"local-instruction":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"theme1-custom-spinner":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"theme1-number-line":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"advance-number-line":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"drag-drop-numberline":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"drag-drop-panbalance":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"theme1-custom-combo-box":{componentType:0,themeType:1,stepNumber:1,js:[],media:{image:[{id:"customCombo",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"}]},templates:[]},"intro-box":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"feedback-badge":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"theme1-slider":{componentType:0,themeType:1,stepNumber:1,js:[],media:{image:[{id:"slider-pink-handler",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"}]},templates:[]},"theme1-check-box":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[],media:{image:[{id:"check-box-states",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"}]}},"theme1-radio-button":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[],media:{image:[{id:"radio-button-states",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"}]}},"counter-label":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"motion-graph":{componentType:0,themeType:1,stepNumber:1,js:[],media:{image:[{id:"trashcan-up",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"trashcan-disabled",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"},{id:"trashcan-hover",url:"sprites/sprite.png",basePath:"COMMON_IMAGE"}]},templates:[]},"theme1-data-table":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},graph:{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"drag-select":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"drag-drop":{componentType:0,themeType:0,stepNumber:1,js:[],templates:[]},ruler:{componentType:1,themeType:1,stepNumber:1,js:[{url:"components/ruler.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!1}],templates:[]},"sound-manager":{componentType:0,themeType:0,stepNumber:1,js:[],media:{image:[{id:"sound-preloder",url:"sound-manager/preloader.gif",basePath:"COMMON_IMAGE"}]},templates:[]},tooltip:{componentType:0,themeType:0,stepNumber:1,js:[],templates:[]},"virtual-keyboard":{componentType:4,themeType:0,stepNumber:1,css:[{url:"tools/common/common.css",basePath:"MATH_UTILITIES_CSS"},{url:"css/mathquill.css",basePath:"MATHQUILL"}],js:[{url:"components/zeus-mathquill/js/mathquill.js",basePath:"MATH_UTILITIES_JS"}],requireModules:[{module:"ttiBasicsAutoload"}]},"tools-graph":{componentType:1,themeType:0,stepNumber:2,js:[{url:"components/tools-graph.min.js",basePath:"COMMON_SCRIPT"}],requireModules:[{module:"ttiBasicsAutoload"},{module:"equationPlotterAutoload"}],templates:[]},"tools-graph-accessibility":{componentType:1,themeType:0,stepNumber:1,js:[{url:"components/tools-graph-accessibility.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!1}],requireModules:[{module:"ttiBasicsAutoload"},{module:"accessibilityAutoload"}],templates:[]},"theme2-button":{componentType:0,themeType:0,stepNumber:1,js:[],templates:[]},"theme2-help":{componentType:0,themeType:0,stepNumber:1,js:[],templates:[]},"theme2-drag-drop":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-input-box":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-custom-spinner":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-custom-spinner-extended":{componentType:1,themeType:2,stepNumber:2,js:[{url:"components/theme2-custom-spinner-extended.min.js",basePath:"COMMON_SCRIPT"}],templates:[]},"theme2-empty-modal":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-accordion":{componentType:1,themeType:2,stepNumber:1,js:[{url:"components/theme2-accordion.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!1}],templates:[]},"theme2-overview-tab":{componentType:0,themeType:0,stepNumber:1,js:[],templates:[]},"theme2-explorer-graph":{componentType:1,themeType:2,stepNumber:2,js:[{url:"components/theme2-explorer-graph.min.js",basePath:"COMMON_SCRIPT"}],templates:[]},"theme2-explore-shape":{componentType:1,themeType:2,stepNumber:2,js:[{url:"components/theme2-explore-shape.min.js",basePath:"COMMON_SCRIPT"}],templates:[]},"theme2-curve-graph":{componentType:1,themeType:2,stepNumber:1,js:[{url:"paper-full.js",basePath:"PAPER_JS",isNextStepLoad:!0},{url:"components/theme2-curve-graph.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!1}],templates:[]},"theme2-data-table":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-direction-text":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-pop-up-box":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-check-box":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-combobox":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-radio-button":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-slider":{componentType:0,themeType:2,stepNumber:2,media:{cur:[{id:"closed-hand",url:"cursor/closedhand.cur",basePath:"COMMON_IMAGE"},{id:"open-hand",url:"cursor/openhand.cur",basePath:"COMMON_IMAGE"}]},js:[],templates:[]},"theme2-feedback":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-toggle-button":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-tooltip":{componentType:0,themeType:0,stepNumber:1,js:[],templates:[]},"paper-js":{componentType:4,themeType:0,stepNumber:1,js:[],requireModules:[{module:"paperJS"}]},"jquery-ui":{componentType:4,themeType:0,stepNumber:1,js:[],requireModules:[{module:"jqueryUICustom"}]},"jquery-ui-touch":{componentType:4,themeType:0,stepNumber:1,js:[],requireModules:[{module:"jqueryUITouch"}]},"jquery-mousewheel":{componentType:4,themeType:0,stepNumber:1,js:[],requireModules:[{module:"jqueryMouseWheel"}]},"jquery-table-sorter":{componentType:4,themeType:0,stepNumber:1,js:[],requireModules:[{module:"jqueryTableSorter"}]},"tts-help-main":{componentType:4,themeType:0,stepNumber:1,js:[],requireModules:[{module:"ttsHelpMain"}]},"custom-slider":{componentType:4,themeType:0,stepNumber:1,js:[],requireModules:[{module:"customSlider"}]},highcharts:{componentType:4,themeType:0,stepNumber:1,js:[],requireModules:[{module:"highCharts"}]},"highcharts-more":{componentType:4,themeType:0,stepNumber:1,js:[],requireModules:[{module:"highChartsMore"}]},"utils-autoload":{componentType:4,themeType:0,stepNumber:1,js:[],requireModules:[{module:"ttiBasicsAutoload"}]},"canvas-acc":{componentType:0,themeType:1,stepNumber:1,js:[],templates:[]},"theme2-canvas-acc":{componentType:0,themeType:2,stepNumber:2,js:[],templates:[]},"theme2-number-line":{componentType:1,themeType:2,stepNumber:2,js:[{url:"components/theme2-number-line.min.js",basePath:"COMMON_SCRIPT"}],templates:[]},"theme2-checkbox-extended":{componentType:1,themeType:2,stepNumber:2,js:[{url:"components/theme2-checkbox-extended.min.js",basePath:"COMMON_SCRIPT"}],templates:[]},"theme2-number-line-extended":{componentType:1,themeType:2,stepNumber:2,js:[{url:"components/theme2-number-line-extended.min.js",basePath:"COMMON_SCRIPT"}],templates:[]
},"theme2-custom-image-spinner":{componentType:1,themeType:2,stepNumber:2,js:[{url:"components/theme2-custom-image-spinner.min.js",basePath:"COMMON_SCRIPT"}],templates:[]},"animate-css":{componentType:4,themeType:0,stepNumber:1,css:[{url:"animate.css",basePath:"ANIMATE_CSS"}]},"cango-3d":{componentType:1,themeType:2,stepNumber:2,js:[{url:"components/cango-3d.min.js",basePath:"COMMON_SCRIPT"}],templates:[]},"theme2-3d-shape":{componentType:1,themeType:2,stepNumber:2,js:[{url:"components/theme2-3d-shape.min.js",basePath:"COMMON_SCRIPT"}],templates:[]},"theme2-tutorial-player":{componentType:1,themeType:2,stepNumber:1,js:[{url:"components/theme2-tutorial-player.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!1}],templates:[]},"equation-manager":{componentType:1,themeType:2,stepNumber:1,js:[{url:"components/equation-manager.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!1}],templates:[]},"equation-manager-pro-step-1":{componentType:1,themeType:2,stepNumber:1,js:[{url:"components/equation-manager-pro-step-1.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!1}],templates:[]},"equation-manager-pro-step-2":{componentType:1,themeType:2,stepNumber:2,js:[{url:"components/equation-manager-pro-step-2.min.js",basePath:"COMMON_SCRIPT"}],templates:[]},"virus-zapper":{componentType:2,themeType:2,stepNumber:2,css:[{url:"virus-zapper/virus-zapper.min.css",basePath:"COMMON_INTERACTIVE_CSS"}],json:[],js:[{url:"interactive/virus-zapper/virus-zapper.min.js",basePath:"COMMON_SCRIPT"}],templates:[],media:{image:[{id:"Overview_image",url:"virus-zapper/Overview_image.jpg",basePath:"COMMON_INTERACTIVE_IMAGE",isNextStepLoad:!1},{id:"virus-zapper-sprite-1",url:"virus-zapper/sprite-1.png",basePath:"COMMON_INTERACTIVE_IMAGE"},{id:"virus-zapper-sprite-2",url:"virus-zapper/sprite-2.png",basePath:"COMMON_INTERACTIVE_IMAGE"}]}},"trignometric-graph":{componentType:2,themeType:2,stepNumber:2,css:[{url:"trignometric-graph/trignometric-graph.min.css",basePath:"COMMON_INTERACTIVE_CSS"}],json:[],js:[{url:"interactive/trignometric-graph/trignometric-graph.min.js",basePath:"COMMON_SCRIPT"}],templates:[],media:{image:[]}},"line-stretcher":{componentType:2,themeType:2,stepNumber:2,css:[{url:"line-stretcher/line-stretcher.min.css",basePath:"COMMON_INTERACTIVE_CSS"}],json:[],js:[{url:"interactive/line-stretcher/line-stretcher.min.js",basePath:"COMMON_SCRIPT"}],templates:[],media:{image:[{id:"line-stretcher-overview",url:"line-stretcher/Overview_image.jpg",basePath:"COMMON_INTERACTIVE_IMAGE",isNextStepLoad:!1},{id:"explore-grid",basePath:"COMMON_INTERACTIVE_IMAGE",url:"line-stretcher/Grid_L.png"},{id:"horizontal-sequence-sprite",basePath:"COMMON_INTERACTIVE_IMAGE",url:"line-stretcher/horizontal_sequence_sprite.png"},{id:"vertical-sequence-sprite",basePath:"COMMON_INTERACTIVE_IMAGE",url:"line-stretcher/vertical_sequence_sprite.png"},{id:"diagonal-sequence-sprite",basePath:"COMMON_INTERACTIVE_IMAGE",url:"line-stretcher/diagonal_sequence_sprite.png"},{id:"raster-sprite",basePath:"COMMON_INTERACTIVE_IMAGE",url:"line-stretcher/raster_sprite.png",forceLoad:!0},{id:"book-group",basePath:"COMMON_INTERACTIVE_IMAGE",url:"line-stretcher/Book_grp_2.png",forceLoad:!0}]}},"data-set-selector":{componentType:1,themeType:2,stepNumber:2,js:[{url:"components/data-set-selector.min.js",basePath:"COMMON_SCRIPT"}],templates:[],media:{image:[]}},"conic-explorer":{componentType:2,themeType:2,stepNumber:2,css:[{url:"conic-explorer/conic-explorer.min.css",basePath:"COMMON_INTERACTIVE_CSS"}],js:[{url:"interactive/conic-explorer/conic-explorer.min.js",basePath:"COMMON_SCRIPT"}],templates:[],media:{image:[{id:"explore-shapes",url:"ellipse-explorer/shape_images.png",basePath:"COMMON_IMAGE",forceLoad:!0}]}},"interactives-math-utilities-graph":{componentType:0,themeType:1,stepNumber:1,css:[],js:[],templates:[]},"google-mapper-math-utilities-graph":{componentType:1,themeType:1,stepNumber:1,css:[{url:"common.min.css",basePath:"COMMON_CSS"}],js:[{url:"components/google-mapper-math-utilities-graph.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!1}],templates:[]},"archaeological-dig-step-2":{componentType:2,themeType:2,stepNumber:2,css:[{url:"archaeological-dig-step-2/archaeological-dig-step-2.min.css",basePath:"COMMON_INTERACTIVE_CSS"}],js:[{url:"interactive/archaeological-dig-step-2/archaeological-dig-step-2.min.js",basePath:"COMMON_SCRIPT"}],templates:[],media:{image:[{id:"archaeological-dig-background",url:"archaeological-dig/background.png",basePath:"COMMON_INTERACTIVE_IMAGE"},{id:"archaeological-dig-icons",url:"archaeological-dig/icons.png",basePath:"COMMON_INTERACTIVE_IMAGE"},{id:"archaeological-dig-images",url:"archaeological-dig/images.png",basePath:"COMMON_INTERACTIVE_IMAGE"},{id:"men-animation",url:"archaeological-dig/animation.png",basePath:"COMMON_INTERACTIVE_IMAGE"},{id:"pop-up",url:"archaeological-dig/popup.png",basePath:"COMMON_INTERACTIVE_IMAGE"}]}},"archaeological-dig-step-1":{componentType:2,themeType:2,stepNumber:1,js:[{url:"interactive/archaeological-dig-step-1/archaeological-dig-step-1.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!1}],templates:[],media:{image:[{id:"archaeological-dig-overview",url:"archaeological-dig/overview.jpg",basePath:"COMMON_INTERACTIVE_IMAGE",isNextStepLoad:!1}]}},"shape-decomposition-step-1":{componentType:2,themeType:2,stepNumber:1,js:[{url:"paper-full.js",basePath:"PAPER_JS",isNextStepLoad:!1},{url:"interactive/shape-decomposition-step-1/shape-decomposition-step-1.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!1}],templates:[],media:{image:[{id:"overview-bg-1",url:"shape-decomposition/overview-bg-1.jpg",basePath:"COMMON_INTERACTIVE_IMAGE",isNextStepLoad:!1},{id:"overview-bg-2",url:"shape-decomposition/overview-bg-2.jpg",basePath:"COMMON_INTERACTIVE_IMAGE",isNextStepLoad:!1}]}},"shape-decomposition-step-2":{componentType:2,themeType:2,stepNumber:2,css:[{url:"shape-decomposition-step-2/shape-decomposition-step-2.min.css",basePath:"COMMON_INTERACTIVE_CSS"}],js:[{url:"interactive/shape-decomposition-step-2/shape-decomposition-step-2.min.js",basePath:"COMMON_SCRIPT"}],templates:[],media:{image:[{id:"bg-image",url:"shape-decomposition/bg-image.jpg",basePath:"COMMON_INTERACTIVE_IMAGE",isNextStepLoad:!1},{id:"reflect",url:"shape-decomposition/icon-reflect.png",basePath:"COMMON_INTERACTIVE_IMAGE",isNextStepLoad:!1},{id:"rotate",url:"shape-decomposition/icon-rotate.png",basePath:"COMMON_INTERACTIVE_IMAGE",isNextStepLoad:!1}],cur:[{id:"closed-hand",url:"cursor/closedhand.cur",basePath:"COMMON_IMAGE"},{id:"open-hand",url:"cursor/openhand.cur",basePath:"COMMON_IMAGE"}]}},"exponent-accordion-step-1":{componentType:2,themeType:2,stepNumber:1,js:[{url:"interactive/exponent-accordion-step-1/exponent-accordion-step-1.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!1}],templates:[],media:{image:[]}},"exponent-accordion-step-2":{componentType:2,themeType:2,stepNumber:2,css:[{url:"exponent-accordion-step-2/exponent-accordion-step-2.min.css",basePath:"COMMON_INTERACTIVE_CSS"}],js:[{url:"interactive/exponent-accordion-step-2/exponent-accordion-step-2.min.js",basePath:"COMMON_SCRIPT"}],templates:[],media:{image:[{id:"sprites",url:"exponent-accordion/sprites.png",basePath:"COMMON_INTERACTIVE_IMAGE"}]}},"theme2-carousel":{componentType:1,themeType:2,stepNumber:2,js:[{url:"components/theme2-carousel.min.js",basePath:"COMMON_SCRIPT"}],templates:[]},"shape-slicer-step-1":{componentType:2,themeType:2,stepNumber:1,js:[{url:"interactive/shape-slicer-step-1/shape-slicer-step-1.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!1}],templates:[],media:{image:[]}},"shape-slicer-step-2":{componentType:2,themeType:2,stepNumber:2,css:[{url:"shape-slicer-step-2/shape-slicer-step-2.min.css",basePath:"COMMON_INTERACTIVE_CSS"}],js:[{url:"interactive/shape-slicer-step-2/shape-slicer-step-2.min.js",basePath:"COMMON_SCRIPT"}],templates:[],media:{image:[{id:"sprites",url:"shape-slicer/sprites.png",basePath:"COMMON_INTERACTIVE_IMAGE"},{id:"color-picker",url:"shape-slicer/color-picker-sprite.png",basePath:"COMMON_INTERACTIVE_IMAGE"}]}},"shape-slicer-shapes":{componentType:2,themeType:2,stepNumber:2,js:[{url:"interactive/shape-slicer-shapes/shape-slicer-shapes.min.js",basePath:"COMMON_SCRIPT"}],templates:[]},"prism-pyramid-slicer-shapes":{componentType:2,themeType:2,stepNumber:2,js:[{url:"interactive/prism-pyramid-slicer-shapes/prism-pyramid-slicer-shapes.min.js",basePath:"COMMON_SCRIPT"}],templates:[]},"theme1-components":{js:[{url:"common-theme-1.min.js",basePath:"COMMON_SCRIPT"}]},"theme2-components":{js:[{url:"common-theme-2-step-2.min.js",basePath:"COMMON_SCRIPT",isNextStepLoad:!0}]}}}}}(MathInteractives),!function(){"use strict";MathInteractives.Common.Components.Models.SpeechStream=Backbone.Model.extend({},{voiceEnglishMaleTom:"ScanSoft Tom_Full_22kHz",voiceSpanishFemalePenelope:"IVONA 2 Penelope - Spanish (US) female voice [22kHz]",speechId:null,defaultTTSVoice:"",currentIdIndex:0,speechPaused:!0,pauseTimeout:null,playSpeaker:!1,readingStarted:!1,inBetweenSentence:!0,divID:"",divText:"",initializeTextHelp:function(a,b,c,d){try{eba_use_html5=!0,eba_icons=no_bar,eba_login_name="discoveryeducation",eba_server="discoveryeducationtoolbar.speechstream.net",eba_speech_server="discoveryeducation.speechstream.net",eba_cust_id="1740",eba_book_id="4",eba_page_id="asterisk",eba_speech_range_style="color:"+a+"; background:"+b,eba_speech_word_style="color:"+c+"; background:"+d,eba_page_complete_callback="MathInteractives.Common.Components.Models.SpeechStream.readNext",eba_speech_complete_callback="MathInteractives.Common.Components.Models.SpeechStream.newLineComplete",eba_rendering_speech_callback="MathInteractives.Common.Components.Models.SpeechStream.newLineStarted",eba_ignore_frames=!0,eba_ssl_flag="https:"==location.protocol;var e="en";switch(e){case"es":eba_language=SPANISH,eba_voice=this.voiceSpanishFemalePenelope;break;default:eba_voice=this.voiceEnglishMaleTom}this.defaultTTSVoice=eba_voice,this.setupIgnoreSections()}catch(f){alert("Init Error")}},setupIgnoreSections:function(){var a=SpeechStream.tools.getPageControl();a.setIgnorePageDefault(!0),"function"==typeof discoveryLoadedCallback&&discoveryLoadedCallback(a)},speakElementsById:function(a){this.speechId=a,0!=this.speechId.length&&(this.currentIdIndex=0,this.divID=this.speechId[this.currentIdIndex],$rw_speakById(this.speechId[this.currentIdIndex]))},readNext:function(){var a;this.currentIdIndex++,this.currentIdIndex<this.speechId.length?(setHackDivData(),null!=a&&a(this.speechId[this.currentIdIndex-1],this.speechId[this.currentIdIndex]),$rw_speakById(this.speechId[this.currentIdIndex])):(null!=a&&a(this.speechId[this.currentIdIndex-1],null),this.playSpeaker=!0,this.inBetweenSentence=!0,this.resetTTSIconState(),$("#"+MathInteractives.global.SpeechStream.currentTTSId).trigger("focusOnCompletion"))},resetTTSIconState:function(){MathInteractives.global.PlayerTTS.resetTooltipText()},newLineStarted:function(){this.readingStarted=!0,this.speechPaused&&$rw_event_pause(),this.inBetweenSentence=!1},newLineComplete:function(){this.readingStarted=!1,this.inBetweenSentence=!0},startSpeaking:function(a,b){if(this.speechPaused=!1,this.inBetweenSentence=!0,this.readingStarted=!1,clearTimeout(this.pauseTimeout),$rw_stopSpeech(!0),$rw_event_stop(),void 0!=b&&null!=b&&""!=b){var c=$("#"+b+" .scroll-pane-arrows");c.length>0&&c.each(function(){var a=$(this).data("jsp");a&&a.scrollToY(0,!1)})}this.speakElementsById(a)},stopReading:function(a){var b=MathInteractives.global.PlayerTTS;"undefined"!=typeof b.ttsView&&("undefined"!=typeof a&&(b.ttsView.model.setFocusStatusOnComplete(a),b.ttsView.hideTTSTooltip()),this.speechPaused=!1,this.inBetweenSentence=!0,this.readingStarted=!1,clearTimeout(this.pauseTimeout),$rw_stopSpeech(!0),$rw_event_stop(),$rw_setVoice(this.defaultTTSVoice),MathInteractives.global.PlayerTTS.resetTooltipText(),b.ttsView&&(b.ttsView.model.setFocusStatusOnComplete(!0),b.ttsView.hideTTSTooltip()))},pauseReading:function(){var a=this;this.speechPaused=!0,this.inBetweenSentence?this.pauseTimeout=setTimeout($.proxy(this.pauseReading,a),10):(clearTimeout(this.pauseTimeout),$rw_isPaused()&&$rw_event_pause(),$rw_event_pause())},playTTSSpeaker:function(a){this.speechPaused=!1,this.inBetweenSentence?this.startSpeaking(a):(clearTimeout(this.pauseTimeout),$rw_event_play())}}),MathInteractives.global.SpeechStream=MathInteractives.Common.Components.Models.SpeechStream}(),function(){"use strict";var a=Backbone.Model.extend({},{_nID:0,_oSelectors:{},_oBgSequences:{},_oTimers:{},_oStopWatches:{},_oIntervals:{},_arrAnimates:[],_TIMEOUT:"timeout",_BG_SEQUENCE:"bg_sequence",_ANIMATE:"animate",_FADE_IN:"fade_in",_FADE_OUT:"fade_out",setTimeout:function(b,c){return a.setInterval(b,c,0)},setInterval:function(b,c,d,e){if(c=void 0!=c?c:400,c>150)for(var f=1,g=c;a._oTimers[c];)c=g+f,f=0>f?-f+1:-f;var h=new Object;h.iCurrentFrame=0,h.iMaxFrame=d,h.iTimeoutDuration=c,h.fOnProgress=b;var i=new Object;if(i.strType=a._TIMEOUT,i.oConfig=h,i.strID=e?e:"animation"+a._nID++,a._oIntervals[i.strID])throw new Error("Invalid Input Received");return a._oIntervals[i.strID]=c,a._runAnimation(i),i.strID},clearTimeout:function(b,c){a.clearInterval(b,c)},clearInterval:function(b,c){var d=a._oIntervals,e=d[b],f=a._oBgSequences[e];if(null!=e){for(var g,h=f.length-1;h>=0&&(g=f[h],g.strID!==b);h--);delete d[b],a._stopAnimation(g);var i=g.fOnProgress;c&&i&&(0==g.oConfig.iMaxFrame?i():a.setInterval(i,0,g.oConfig.iMaxFrame,b))}},animate:function(b){var c=[].splice.call(arguments,0);a._setAnimationParams(c,a._ANIMATE)},fadeIn:function(b){var c=[].splice.call(arguments,0);a._setAnimationParams(c,a._FADE_IN)},fadeOut:function(b){var c=[].splice.call(arguments,0);a._setAnimationParams(c,a._FADE_OUT)},runBgSequence:function(b,c){if(!c)var c=new Object;if(c.bReverse=c.bReverse?c.bReverse:!1,c.iMinFrame=c.iMinFrame?c.iMinFrame:0,c.iCurrentFrame=c.iCurrentFrame?c.iCurrentFrame:0,c.iMaxFrame=c.iMaxFrame?c.iMaxFrame:parseInt($(b).attr("data-numFrames"))-1,c.bHorizontal=c.bHorizontal?c.bHorizontal:!1,c.bRepeat=c.bRepeat?c.bRepeat:!1,c.iPixelGap=c.iPixelGap?c.iPixelGap:5,c.iTimeoutDuration=c.iTimeoutDuration?c.iTimeoutDuration:parseInt($(b).attr("data-durationPerFrame")),!c.iTimeoutDuration)throw new Error("No Timeout Duration Provided for "+b);var d=new Object;d.oConfig=c;var e=d._oVisualElement=$(b);d.strSelector=b,d.strID="animation"+a._nID++;var f=e.width()+parseInt(e.css("padding-left"))+parseInt(e.css("padding-right")),g=e.height()+parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom")),h=MathInteractives.Common.Utilities.Models.BrowserCheck,i=parseInt(h.browserVersion),j=[];if(h.isIE&&9===i){var k=document.defaultView,l=k.getComputedStyle(e[0]);j[0]=l.getPropertyValue("background-position-x"),j[1]=l.getPropertyValue("background-position-y")}else{var m=e.css("background-position");(null===m||void 0===m)&&(m=e.css("background-position-x")+" "+e.css("background-position-y")),j=m.split(" ")}c.bHorizontal?(f+=c.iPixelGap,g=parseFloat(j[1])):(f=parseFloat(j[0]),g+=c.iPixelGap),d.nX=[],d.nY=[];for(var n=c.iMinFrame;n<=c.iMaxFrame;n++)c.bHorizontal?(d.nX[n]=-(n*f),d.nY[n]=g):(d.nX[n]=f,d.nY[n]=-(n*g));d.strType=a._BG_SEQUENCE,a._runAnimation(d)},pause:function(){var b,c=a._oTimers,d=a._oStopWatches;for(var e in c)b=c[e],clearInterval(b),d[e].stop();for(var f,g,h,i,j,k=a._arrAnimates,l=k.length-1;l>=0;l--){switch(f=k[l],j=f.oStopWatch,j.stop(),g=j.nElapsedMilliseconds,h=f.arrOptions,f.strType){case a._FADE_IN:case a._FADE_OUT:case a.SHOW:case a.HIDE:i=h[0]=h[0]-g;break;case a._ANIMATE:var m=h[1];i="object"==typeof m?m.duration=m.duration-g:h[1]=h[1]-g}0>=i?k.splice(l,1):$(f.strSelector).stop()}a.isPaused=!0},stop:function(){var b,c=a._oTimers,d=a._oStopWatches,e=a._oBgSequences;for(var f in c)b=c[f],clearInterval(b),delete d[f],delete c[f],delete e[f];a._oSelectors={};for(var g,h=a._arrAnimates,i=h.length-1;i>=0;i--)g=h[i],$(g.strSelector).stop(),h.splice(i,1)},resume:function(){var b=a._oTimers;for(var c in b){var d=function(){var d=c;return function(){a._updateBgPosition(d),null!=b[d]&&(clearInterval(b[d]),b[d]=setInterval(function(){a._updateBgPosition(d)},d))}}(),e=a._oStopWatches[c];b[c]=setInterval(d,c-e.nElapsedMilliseconds)}for(var f,g=a._arrAnimates,h=g.length-1;h>=0;h--)f=g[h],a._applyAnimation(f);a.isPaused=!1},stopBgSequence:function(b){var c=a._oSelectors[b];if(null!=c){for(var d,e=a._oBgSequences[c],f=e.length-1;f>=0&&(d=e[f],d.strSelector!=b);f--);delete a._oSelectors[b],a._stopAnimation(d)}},_setAnimationParams:function(b,c){var d=b.splice(0,1)[0];switch(c){case a._FADE_IN:case a._FADE_OUT:case a.SHOW:case a.HIDE:if(b[0]&&"function"!=typeof b[0]){if("string"==typeof b[0])switch(b[0]){case"slow":b[0]=600;break;case"fast":b[0]=200;break;default:b[0]=400}}else b[0]=400;break;case a._ANIMATE:var e=b[1];if("object"==typeof e)if(e.duration){if("string"==typeof e.duration)switch(e.duration){case"slow":e.duration=600;break;case"fast":e.duration=200;break;default:e.duration=400}}else e.duration=400;else if(e&&"function"!=typeof e){if("string"==typeof e)switch(e){case"slow":b[1]=600;break;case"fast":b[1]=200;break;default:b[1]=400}}else b[1]=400}var f=new Object;f.strSelector=d,f.arrOptions=b,f.strType=c,a._arrAnimates.push(f),a._applyAnimation(f)},_applyAnimation:function(b){var c=b.strSelector,d=b.strType,e=b.arrOptions,f=new MathInteractives.Common.Utilities.Models.StopWatch;switch(b.oStopWatch=f,f.start(),d){case a._FADE_IN:$(c).fadeIn.apply($(c),e);break;case a._FADE_OUT:$(c).fadeOut.apply($(c),e);break;case a._ANIMATE:$(c).animate.apply($(c),e);break;case a.SHOW:$(c).show.apply($(c),e);break;case a.HIDE:$(c).hide.apply($(c),e)}},_runAnimation:function(b){var c=b.oConfig,d=b.strSelector;switch(b.strType){case a._TIMEOUT:break;case a._BG_SEQUENCE:if(0==$(d).length)throw new Error("No Such Element exists "+d);var e=a._oSelectors;e[d],e[b.strSelector]=c.iTimeoutDuration}var f=a._oBgSequences,g=f[c.iTimeoutDuration];g||(g=f[c.iTimeoutDuration]=[]),g.push(b);var h=a._oTimers;if(!h[c.iTimeoutDuration]){var i=new MathInteractives.Common.Utilities.Models.StopWatch;i.start(),a._oStopWatches[c.iTimeoutDuration]=i,h[c.iTimeoutDuration]=setInterval(function(){a._updateBgPosition(c.iTimeoutDuration)},c.iTimeoutDuration)}},_stopAnimation:function(b){var c=a._oBgSequences,d=b.oConfig.iTimeoutDuration,e=c[d];e.splice(e.indexOf(b),1),0==e.length&&(clearInterval(a._oTimers[d]),delete a._oTimers[d],delete c[d])},_updateBgPosition:function(b){a._oStopWatches[b].start();var c=a._oBgSequences[b];if(c&&0!==c.length)for(var d,e,f,g=c.length-1;g>=0;g--)if(d=c[g]){switch(f=d.oConfig,d.strType){case a._TIMEOUT:break;case a._BG_SEQUENCE:e=d._oVisualElement,!e.is(":visible");var h=f.bReverse?f.iMaxFrame-f.iCurrentFrame:f.iCurrentFrame,i=d.nX[h]+"px "+d.nY[h]+"px";e.css("background-position",i)}if("function"==typeof f.fOnProgress&&f.fOnProgress(f.iCurrentFrame),f.iCurrentFrame==f.iMaxFrame)if(f.bRepeat)f.iCurrentFrame=f.iMinFrame;else{switch(c.splice(g,1),d.strType){case a._TIMEOUT:delete a._oIntervals[d.strID];break;case a._BG_SEQUENCE:delete a._oSelectors[d.strSelector]}0==c.length&&(clearInterval(a._oTimers[b]),delete a._oTimers[b]),"function"==typeof f.fOnComplete&&f.fOnComplete(f.iCurrentFrame)}f.iCurrentFrame++}}});MathInteractives.Common.Utilities.Models.AnimationUtils=a}(),function(){"use strict";var a=Backbone.Model.extend({defaults:{_nStartOffset:null,_nStartMilliSeconds:0,nElapsedMilliseconds:0},initialize:function(){this.set("_nStartOffset",0)},start:function(){this.set("_nStartMilliSeconds",(new Date).getTime())},stop:function(){this.set("_nElapsedMilliseconds",(new Date).getTime()-this.get("_nStartMilliSeconds")+this.get("_nStartOffset"))}});MathInteractives.Common.Utilities.Models.StopWatch=a}(),function(){"use strict";MathInteractives.Common.Utilities.Models.ScreenUtils=Backbone.Model.extend({},{_transformCSSStrings:["transform","-webkit-transform","-o-transform","-moz-transform","-ms-transform"],_transformOriginCSSStrings:["transform-origin","-ms-transform-origin","-webkit-transform-origin"],types:{DOWNLOAD:"download",URL:"url",BASE64:"base64"},formats:{PNG:"image/png",JPG:"image/jpeg"},defaults:{complete:$.noop,format:"image/png",strFileName:"screenshot",type:"url",strPdfPath:"http://app.discoveryeducation.com/posttopdf/?postType=postashtml/",strImagePath:"http://discovery.zeuslearning.com/CreateFile.aspx"},regex:{SVG_NAMESPACE:/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,RGB_COLOR:/^.*(rgba?\([^)]+\)).*$/},init:function(){var a,b,c,d,e,f;for($(document.body),a=document.createElement("div"),a.id="PdfContent",$("body").append(a),b=document.createElement("form"),b.name="ImageForm",b.id="ImageForm",b.method="post",b.target="_blank",$("body").append(b),d=["ext","data","filename","isBase64","download"],c=0,f=d.length;f>c;c++)e=document.createElement("input"),e.type="hidden",e.name=d[c],b.appendChild(e);$(a).css("display","none"),$(b).css("display","none")},uploadImage:function(a){var b={},c=$("#ImageForm");switch(c[0].action=a.path,c.find("input").each(function(){this.value=a[this.name],b[this.name]=this.value}),a.type){case"submit":c.submit(),a.complete();break;case"ajax":$.ajax({data:b,type:"POST",dataType:"text",url:c[0].action,success:function(b){a.complete()}})}},_parseVideo:function(){var a,b,c=$(this);if(c.is(":visible")){a=document.createElement("canvas"),b=$(a);var d=a.getContext("2d"),e=c.offset();a.style.position="absolute",a.className="ScreenShotTempCanvas",a.width=c.width(),a.height=c.height(),d.drawImage(this,0,0),$(a).insertAfter(this),b.offset(e)}},_parseSVG:function(){var a,b,c=$(this);c.parent().is(":visible")&&(a=document.createElement("canvas"),a.className="ScreenShotTempCanvas",b=(new XMLSerializer).serializeToString(this),b=b.replace(MathInteractives.Common.Utilities.Models.ScreenUtils.regex.SVG_NAMESPACE,""),canvg(a,b),$(a).insertAfter(this),this.className.baseVal="ForceDisplayNone")},_parseTransformDiv:function(a,b){var c,d,e,f,g,h,i,j,k=$(this),l=document.createElement("canvas"),m=$(l),n=l.getContext("2d"),o=this.getBoundingClientRect(),p=b.replace(/^\w+\(/,"[").replace(/\)$/,"]"),q=JSON.parse(p),r=[1,0,0,1,0,0],s=!0,t=MathInteractives.Common.Utilities.Models.ScreenUtils._transformOriginCSSStrings,u=t.length;for(j=0;j<q.length&&(s=s&&q[j]==r[j]);j++);if(s)return void a();for(j=0;u>j&&!(f=k.css(t[j]));j++);return f&&"none"!==f?(g=f.split(" "),h=parseInt(g[0],10),i=parseInt(g[1],10),k.addClass("transform-none"),e=k.offset(),c=e.left-o.left,d=e.top-o.top,h+=c,i+=d,m.css("position","absolute"),m.insertAfter(this),l.className="ScreenShotTempCanvas",l.width=o.width,l.height=o.height,m.offset({top:o.top,left:o.left}),n.translate(h,i),n.transform.apply(n,q),n.translate(-h,-i),void window.html2canvas(this,{background:"rgba(0, 0, 0, 0)",onrendered:function(b){if(0!==n.canvas.height&&0!==n.canvas.width)try{n.drawImage(b,c,d)}catch(e){}k.removeClass("transform-none"),k.addClass("opacity-transperant"),a()},useCORS:!0})):void a()},_applyBoxShadowFix:function(){var a,b,c,d,e,f,g,h,i,j,k=$(this);return a=k.css("box-shadow"),a&&"none"!==a&&(b=a.replace(MathInteractives.Common.Utilities.Models.ScreenUtils.regex.RGB_COLOR,"$1"),b===a?(b=a.substring(a.lastIndexOf(" "),a.length),a=a.replace(" "+b,"")):a=a.replace(b+" ",""),c=k.css("borderLeftStyle"),d=k.css("background-color"),e=k.css("background-image"),f=k.css("outlineStyle"),g=!c||"none"===c,j=!f||"none"===f,h="transparent"===d||!d,i=!e||"none"===e,g&&h&&i&&j)?"#"+this.id+"{outline:1px solid "+b+";}":""},getScreenShot:function(a){var b,c,d,e,f,g,h,i,j=0,k=MathInteractives.Common.Utilities.Models.ScreenUtils._transformCSSStrings,l=MathInteractives.Common.Utilities.Models.BrowserCheck,m=k.length;window.scroll(0,0),b=$.extend({},MathInteractives.Common.Utilities.Models.ScreenUtils.defaults),a=$.extend(b,a),d=a.container,e=$(d),c="<style id='ScreenShotFixes'>",g=e.find("*:visible").not("svg *"),h=function(){j++,j>=g.length&&MathInteractives.Common.Utilities.Models.ScreenUtils._proceedWithScreenShot(a)},g.each(function(){var a,b,d=$(this);for(a=this.id,i=0;m>i&&!(f=d.css(k[i]));i++);switch(f&&"none"!==f?MathInteractives.Common.Utilities.Models.ScreenUtils._parseTransformDiv.call(this,h,f):j++,c+=MathInteractives.Common.Utilities.Models.ScreenUtils._applyBoxShadowFix.call(this),this.tagName.toLowerCase()){case"video":MathInteractives.Common.Utilities.Models.ScreenUtils._parseVideo.call(this);break;case"svg":MathInteractives.Common.Utilities.Models.ScreenUtils._parseSVG.call(this);break;case"table":b=d.css("border-top-right-radius")||d.css("border-top-left-radius"),b&&(c+="#"+a+" { border-top-right-radius: 0px !important; border-top-left-radius: 0px !important;}",c+="#"+a+" th { border-top-right-radius: 0px !important; border-top-left-radius: 0px !important;}"),l.isIE&&(c+="#"+a+" { border-collapse:collapse !important; border:none !important;}",c+="#"+a+" th {border-right-width:1px !important}",c+="#"+a+" td {border-right-width:1px !important}")}}),c+="</style>",$("head").append(c),j>=g.length&&MathInteractives.Common.Utilities.Models.ScreenUtils._proceedWithScreenShot(a)},_proceedWithScreenShot:function(a){var b=$(a.container);window.html2canvas([b[0]],{onrendered:function(c){var d,e;b.find(".ScreenShotTempCanvas").remove(),b.find(".opacity-transperant").removeClass("opacity-transperant"),b.find("svg.ForceDisplayNone").each(function(){this.className.baseVal=""}),$("#ScreenShotFixes").remove();var f=a.format;if(d=c.toDataURL(f),d=d.replace("data:"+f+";base64,",""),a.type===MathInteractives.Common.Utilities.Models.ScreenUtils.types.BASE64)return void(a.complete&&a.complete(d));switch(e={ext:f.substring(f.indexOf("/")+1,f.length),data:d,filename:a.strFileName,path:a.strImagePath,isBase64:!0,complete:a.complete},a.type){case MathInteractives.Common.Utilities.Models.ScreenUtils.types.URL:e=$.extend(e,{download:!1,type:"ajax"});break;case MathInteractives.Common.Utilities.Models.ScreenUtils.types.DOWNLOAD:e=$.extend(e,{download:!0,type:"submit"})}MathInteractives.Common.Utilities.Models.ScreenUtils.uploadImage(e)},background:a.background,useCORS:a.useCORS})}})}(),function(){"use strict";MathInteractives.Common.Utilities.Models.Utils=Backbone.Model.extend({},{significantNumberMode:{MIXED:"Mixed",DECIMAL:"false",SCIENTIFIC:"true",bIsNegative:!1},_touchStartTimerObject:{},_throbberTimer:null,renderThrobber:function(a,b,c,d,e,f,g,h){var i;1===arguments.length&&(h=a.closeCallback,g=a.throbberFrameInterval,f=a.closeIfAnyConditionTrue,e=a.throbberRemoveTime,d=a.throbberRemoveCondition,c=a.type,b=a.scope,i=a.startCallback,a=a.containerId);var j=MathInteractives.Common.Utilities.Models.Utils,k=!1,l=7,m=100,n=!0,o="throb-0 throb-1 throb-2 throb-3 throb-4 throb-5 throb-6",f="undefined"==typeof f?!1:f,g="default"===g||null===g||"undefined"==typeof g?m:g,p=!1,q=0,r=0,s=b.$("#"+a);s.addClass("throbber-container throbber-active "+c),null!==d&&"undefined"!=typeof d||null!==e&&"undefined"!=typeof e?null===d||"undefined"==typeof d?(k=!0,f=!1):(null===e||"undefined"==typeof e)&&(e=-1,f=!1):p=!0,b._throbberTimer=setInterval(function(){n&&(i&&$.proxy(i,b)(),n=!1),r=q*g,s.removeClass(o).addClass("throb-"+q++%l),p!==!0&&(f?(r>e||$.proxy(d,b)()===!0)&&j.removeThrobber(a,b,c,h):r>e&&(k||$.proxy(d,b)()===!0)&&j.removeThrobber(a,b,c,h))},g)},removeThrobber:function(a,b,c,d){var e="throb-0 throb-1 throb-2 throb-3 throb-4 throb-5 throb-6";clearInterval(b._throbberTimer),b.$("#"+a).removeClass("throbber-active "+e+" "+c),"undefined"!=typeof d&&null!==d&&$.proxy(d,b)()},getRandomNumber:function(a,b){var c=null,d=null;return a>b&&(d=a,a=b,b=d),c=Math.random()*(b-a)+a,(a>c||c>b)&&(c=this.getRandomNumber(a,b)),c},getRandomIntegerNumber:function a(b,c,d){var e=null,f=null,g="undefined"==typeof d||d===!0;return b>c&&(f=b,b=c,c=f),e=g?Math.floor(Math.random()*(c-b+1)+b):Math.floor(Math.random()*(c-b)+b),g?(b>e||e>c)&&(e=a(b,c)):(b>e||e>=c)&&(e=a(b,c)),e},roundUpValue:function(a,b){var b=b||0,c=Math.pow(10,b);return Math.round(a*c)/c},commaSeparateNumber:function(a){var b=null,c=null,d=null,e=null,f=null,g=new RegExp(/^[-]?[\d,]*[\.]?[\d,]+$/),h={success:!1,result:a};if(a=a.toString(),g.test(a)){var i=parseFloat(this.removeCommaFromString(a)).toString();return e=i.indexOf("."),d=-1===e?i.substr(e+1+i.length).length:i.substr(i.indexOf(".")+1).length,-1!==e?(b=i.substring(0,e),c=parseFloat(i.substring(e)).toString().substring(1)):(b=i,c=""),0===b.length&&(b=0),f=Number(c)>0?this._insertCommaIntoNumber(b).toString()+c:this._insertCommaIntoNumber(b),h.success=!0,h.result=f,h}return h},convertIntoScientificNotaion:function(a){var b={number:"",numberPart:"",power:""},c=null,d=a.number.toString(),e=d.length;if(b.number=a.number.toString(),d.indexOf("e")>-1)b=this.replaceExponentialWithDecimal(d);else{var f=d.indexOf(".");d>1||-1>d?-1===f?e>a.numberOfDigits&&(b=this.replaceExponentialWithDecimal(Number(d).toExponential())):f>=a.numberOfDigits?b=this.replaceExponentialWithDecimal(Number(d).toExponential()):b.number=Number(d).toFixed(2).replace(/\.?0+$/,""):f>-1&&(c=d.split(".")[1],c.length>a.numberOfDigits?b=this.replaceExponentialWithDecimal(Number(d).toExponential()):b.number=Number(d).toFixed(2).replace(/\.?0+$/,""))}return b},getSpritePartBase64URL:function(a,b,c,d,e){var f,g,h=null;return f=document.createElement("canvas"),g=f.getContext("2d"),f.width=d,f.height=e,g.drawImage(a,b,c,d,e,0,0,d,e),h=f.toDataURL("image/png")},replaceExponentialWithDecimal:function(a){var b={number:"",numberPart:"",power:""},c=null,d=null,e=null,f=null,g=null;return b.number=a.toString(),a=a.toString(),f=a.split("e"),c=Number(f[0]).toFixed(2).replace(/\.?0+$/,""),d=" &times; 10",g=f[1].replace("+",""),e=g.sup(),b.numberPart=c.trim(),b.power=g,b.number=c+d+e,b},_insertCommaIntoNumber:function(a){for(;/(\d+)(\d{3})/.test(a.toString());)a=a.toString().replace(/(\d+)(\d{3})/,"$1,$2");return a},removeCommaFromString:function(a){return a.toString().replace(/,/g,"")},shuffleArray:function(a){for(var b,c,d=a.length;0!==d;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a},distanceBetweenPoints:function(a,b,c,d){return Math.sqrt(Math.pow(a-c,2)+Math.pow(b-d,2))},getBaseRatio:function(a,b){var c=function d(a,b){return b?d(b,a%b):a};return c=c(a,b),c=Math.abs(c),[a/c,b/c]},unionOfArraysOfObjects:function(a,b,c){for(var d,e=a.length,f=b.length,g=a.slice(),h=0;f>h;h++){d=!1;for(var i=0;e>i;i++)if(a[i][c]===b[h][c]){d=!0;break}d||g.push(b[h])}return g},addTouchAndHoldHandler:function(a,b,c,d,e,f,g){var h=this,i=null;null==g&&(g="touchAndHoldHandler"),b.off("touchstart."+g).on("touchstart."+g,function(e){i=e,b.one("touchmove."+g,function(a){a.preventDefault(),f?h._touchStartTimerObject[f]&&window.clearTimeout(h._touchStartTimerObject[f]):null!==h._touchStartTimer&&window.clearTimeout(h._touchStartTimer)}),f?h._touchStartTimerObject[f]=window.setTimeout(function(b){$.proxy(d,a,i)()},c):h._touchStartTimer=window.setTimeout(function(b){$.proxy(d,a,i)()},c)}),b.off("touchend."+g+" touchcancel."+g).on("touchend."+g+" touchcancel."+g,function(b){f?h._touchStartTimerObject[f]&&(window.clearTimeout(h._touchStartTimerObject[f]),$.proxy(e,a,b)(),delete h._touchStartTimerObject[f]):null!==h._touchStartTimer&&(window.clearTimeout(h._touchStartTimer),$.proxy(e,a,b)())})},convertUnit:function(a,b){return a*b},getPointOnLine:function(a,b,c,d,e){var f,g=this.getPointDistance(a,b),h=c/g;return e||(h=1-h),f=this.getPointUsing_U(a,b,h),this.getRotatedPoint(f,e?a:b,d)},getPointUsing_U:function(a,b,c){var d=a.x,e=a.y,f=b.x,g=b.y,h=f-d,i=g-e;if(0==h&&0==i)return null;var j=d+c*h,k=e+c*i;return{x:j,y:k}},getRotatedPoint:function(a,b,c){var d={x:0,y:0};if(0===c)return a;var e=c*Math.PI/180,f=a.x-b.x,g=a.y-b.y;return d.x=Math.cos(e)*f-Math.sin(e)*g+b.x,d.y=Math.sin(e)*f+Math.cos(e)*g+b.y,d},getPointDistance:function(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))},getMidPoint:function(a,b){return{x:(a.x+b.x)/2,y:(a.y+b.y)/2}},countDigitsAfterDecimalPoint:function(a){var b=a.toString().split(".");return 2===b.length?b[1].length:b.length<2?0:-1},addDecimalNumber:function(a,b){var c=this.countDigitsAfterDecimalPoint(a),d=this.countDigitsAfterDecimalPoint(b),e=a+b;
return e=this.roundUpValue(e,Math.max(c,d))},subtractDecimalNumber:function(a,b){var c=this.countDigitsAfterDecimalPoint(a),d=this.countDigitsAfterDecimalPoint(b),e=a-b;return e=this.roundUpValue(e,Math.max(c,d))},multiplyDecimalNumber:function(a,b){var c=this.countDigitsAfterDecimalPoint(a),d=this.countDigitsAfterDecimalPoint(b),e=a*b;return e=this.roundUpValue(e,c+d)},findGcd:function(a,b){var c,d,e=a,f=b;for(a>b&&(e=b,f=a),c=e,d=f%e;0!==d;)f=c,c=d,d=f%c;return c},findLcm:function(a,b){return a*b/this.findGcd(a,b)},getDevicePixelRatio:function(){return window.devicePixelRatio||Math.round(window.screen.availWidth/document.documentElement.clientWidth)},getAsHtmlSignificant:function(a){var b,c=document.createElement("span");return b=2==a.length&&0!=a[1]?String(a[0]+" x "+String(10)+"<sup>"+a[1]+"</sup>"):String(a[0]),c.innerHTML=b,c},handleMixedCase:function(a,b){var c=Number(b),d=[],e=this.calculateSignificantNumber(a,b,!1);0==String(a).indexOf("-")&&(this.bIsNegative=!0,a=String(-1*Number(a)));var f=this.calculateSignificantDigit(e[0]);return d=f==c?[e[0]]:this.calculateSignificantNumber(a,c,!0),this.handleNegative(d),d},getNumberSignificantNumber:function(a){var b=Number(a[0]);return 2==a.length&&(b*=Math.pow(10,Number(a[1]))),b},shiftNumberSignificantNumber:function(a,b,c){var d=String(a),e=(String(b),String(c),""),f=Number(b)-Number(c);-1==d.indexOf(".")&&(d+=".");var g=d.split("."),h=g[0].split(""),i=g[1].split(""),j=Math.abs(f);if(0>f){if(h.length<j)for(var k=j-h.length,l=0;k>l;l++)h.unshift("0");for(l=0;j>l;l++)i.unshift(h.pop())}else{if(i.length<j)for(var k=j-h.length,l=0;k>l;l++)i.push("0");for(l=0;j>l;l++)h.push(i.shift())}return e=this.getNumberFromArraySignificantNumber(h,i)},getNumberFromArraySignificantNumber:function(a,b){var c="",d=b.toString().replace(/,/g,""),e=a.toString().replace(/,/g,"");return c=0==a.length?this.getZeroesSignificantNumber(1,!0)+d:0==b.length?e:e+"."+d},getZeroesSignificantNumber:function(a,b){a=Math.abs(a);var c="";return 1==b?(a--,c=String(Math.pow(10,a)).replace("1","0.")):c=String(Math.pow(10,a)).replace("1",""),c},calculateSignificantNumber:function(a,b,c,d){if(null==c||void 0==c||c==this.significantNumberMode.MIXED)return e=this.handleMixedCase(a,b);0==String(a).indexOf("-")&&(this.bIsNegative=!0,a=String(-1*Number(a)));var e=new Array;1==c||"true"==c?c=this.significantNumberMode.SCIENTIFIC:(0==c||"false"==c)&&(c=this.significantNumberMode.DECIMAL);var f="";f=a.toString();var g,h,i=b,j=0,k=!1,l=f.length;for(g=0;g<f.length;g++)if("."==f.charAt(g)){k=!0,h=g;break}if(0==f)return e=this.convert(k,j,f,i,h,l,c),0==Number(e[0])&&(e=["0"]),e;if(j=f.length,1==k){for(g=0;g<f.length&&(0==f[g]||"."==f[g]);g++)0==f[g]&&(j-=1);return j--,e=this.convert(k,j,f,i,h,l,c)}for(g=0;g<f.length&&(0==f[g]||"."==f[g]);g++)0==f[g]&&(j-=1);for(g=f.length-1;g>=0&&(0==f[g]||"."==f[g]);g--)0==f[g]&&(j-=1);return e=this.convert(k,j,f,i,h,l,c)},handleNegative:function(a){return 1==this.bIsNegative&&(a[0]="-"+String(a[0])),this.bIsNegative=!1,a},convert:function(a,b,c,d,e,f,g){var h,i,j,k=new Array,l=(new Array,!1);if(1>c&&(l=!0),0==c){for(c="0.",h=0;d-1>h;h++)c+="0";return k=g==this.significantNumberMode.DECIMAL||g==this.significantNumberMode.DECIMAL?[c]:[c,0]}for(c=Number(c),c=c.toExponential(d-1),c=c.toString(),h=0;h<c.length&&"e"!=c.charAt(h);h++);if(j=h,i=parseInt(c.substring(j+1,c.length)),g==this.significantNumberMode.SCIENTIFIC)return k[0]=k[0]=c.substring(0,j),k[1]=i,k=this.handleNegative(k);var m=!1;0>i&&(m=!0),k[0]=c.substring(0,j);var n=String(k[0]).split(".");if(m){var o=Number(0).toFixed(Math.abs(i));return o=o.substring(0,o.length-1),c=o+n[0]+n[1],k[0]=c,k=this.handleNegative(k)}if(n[0]+=String(n[1]).substring(0,Math.abs(i)),n[1].length>Math.abs(i)&&(n[0]+=".",n[0]+=String(n[1]).substr(Math.abs(i))),n[1].length<Math.abs(i)){var o=Math.abs(i)-n[1].length;o=String(Math.pow(10,o)),n[0]+=o.substr(1)}return k[0]=String(n[0]),k=this.handleNegative(k)},calculateSignificantDigit:function(a){var b,c,d=0,e=!1;for(a.length,b=0;b<a.length;b++)if("."==a.charAt(b)){e=!0,c=b;break}if(d=a.length,1==e){for(b=0;b<a.length&&(0==a[b]||"."==a[b]);b++)0==a[b]&&(d-=1);return d--,d}for(b=0;b<a.length&&(0==a[b]||"."==a[b]);b++)0==a[b]&&(d-=1);for(b=a.length-1;b>=0&&(0==a[b]||"."==a[b]);b--)0==a[b]&&(d-=1);return d},getOperatorHtml:function(a,b){var c="",d="",e="";switch(a){case this.OPERATOR.PLUS:c="&#043;",d="operator-plus-text";break;case this.OPERATOR.MINUS:c="&#8722;",d="operator-minus-text";break;case this.OPERATOR.MULTIPLY:c="&#215;",d="operator-multiply-text";break;case this.OPERATOR.DIVIDE:c="&#247;",d="operator-divide-text"}return e="<span"+(b?' pron="'+b+'"':"")+' class="operator-text '+d+'">'+c+"</span>"},OPERATOR:{PLUS:"plus",MINUS:"minus",MULTIPLY:"multiply",DIVIDE:"divide"}})}(),function(a,b,c){"use strict";function d(b){j.logging&&a.console&&a.console.log&&a.console.log(b)}function e(a,b,c,d,e,f){var g,h,i,k,l=j.Util.getCSS(b,a,e);if(1===l.length&&(k=l[0],l=[],l[0]=k,l[1]=k),-1!==l[0].toString().indexOf("%"))i=parseFloat(l[0])/100,h=c.width*i,"backgroundSize"!==a&&(h-=(f||d).width*i);else if("backgroundSize"===a)if("auto"===l[0])h=d.width;else if(l[0].match(/contain|cover/)){var m=j.Util.resizeBounds(d.width,d.height,c.width,c.height,l[0]);h=m.width,g=m.height}else h=parseInt(l[0],10);else h=parseInt(l[0],10);return"auto"===l[1]?g=h/d.width*d.height:-1!==l[1].toString().indexOf("%")?(i=parseFloat(l[1])/100,g=c.height*i,"backgroundSize"!==a&&(g-=(f||d).height*i)):g=parseInt(l[1],10),[h,g]}function f(a,b){var c=[];return{storage:c,width:a,height:b,clip:function(){c.push({type:"function",name:"clip",arguments:arguments})},translate:function(){c.push({type:"function",name:"translate",arguments:arguments})},fill:function(){c.push({type:"function",name:"fill",arguments:arguments})},save:function(){c.push({type:"function",name:"save",arguments:arguments})},restore:function(){c.push({type:"function",name:"restore",arguments:arguments})},fillRect:function(){c.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){c.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var a=[];return c.push({type:"function",name:"drawShape",arguments:a}),{moveTo:function(){a.push({name:"moveTo",arguments:arguments})},lineTo:function(){a.push({name:"lineTo",arguments:arguments})},arcTo:function(){a.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){a.push({name:"bezierCurveTo",arguments:arguments})},quadraticCurveTo:function(){a.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){c.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){c.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(a,b){c.push({type:"variable",name:a,arguments:b})}}}function g(a){return{zindex:a,children:[]}}var h,i,j={};j.Util={},j.Util.trimText=function(a){return function(b){return a?a.apply(b):((b||"")+"").replace(/^\s+|\s+$/g,"")}}(String.prototype.trim),j.Util.parseBackgroundImage=function(a){var b,c,d,e,f,g,h,i,j=" \r\n	",k=[],l=0,m=0,n=function(){b&&('"'===c.substr(0,1)&&(c=c.substr(1,c.length-2)),c&&i.push(c),"-"===b.substr(0,1)&&(e=b.indexOf("-",1)+1)>0&&(d=b.substr(0,e),b=b.substr(e)),k.push({prefix:d,method:b.toLowerCase(),value:f,args:i})),i=[],b=d=c=f=""};n();for(var o=0,p=a.length;p>o;o++)if(g=a[o],!(0===l&&j.indexOf(g)>-1)){switch(g){case'"':h?h===g&&(h=null):h=g;break;case"(":if(h)break;if(0===l){l=1,f+=g;continue}m++;break;case")":if(h)break;if(1===l){if(0===m){l=0,f+=g,n();continue}m--}break;case",":if(h)break;if(0===l){n();continue}if(1===l&&0===m&&!b.match(/^url$/i)){i.push(c),c="",f+=g;continue}}f+=g,0===l?b+=g:c+=g}return n(),k},j.Util.Bounds=function(a){var b,c={};return a.getBoundingClientRect?(b=a.getBoundingClientRect(),c.top=b.top,c.bottom=b.bottom||b.top+b.height,c.left=b.left,c.width=b.width||b.right-b.left,c.height=b.height||b.bottom-b.top,c):void 0},j.Util.getCSS=function(a,d,e){function f(b,c){var d,e=a.runtimeStyle&&a.runtimeStyle[b],f=a.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(c)&&/^-?\d/.test(c)&&(d=f.left,e&&(a.runtimeStyle.left=a.currentStyle.left),f.left="fontSize"===b?"1em":c||0,c=f.pixelLeft+"px",f.left=d,e&&(a.runtimeStyle.left=e)),/^(thin|medium|thick)$/i.test(c)?c:Math.round(parseFloat(c))+"px"}var g,k=d.match(/^background(Size|Position)$/),l=MathInteractives.Common.Utilities.Models.BrowserCheck;if(h!==a&&(i=b.defaultView.getComputedStyle(a,null)),g=i[d],l.isIE&&parseInt(l.browserVersion)<10&&"backgroundPosition"===d?g=a.currentStyle.backgroundPosition:l.isIE&&d.indexOf("border")>-1&&d.indexOf("Width")>-1&&("TD"===a.tagName||"TH"===a.tagName)&&(g=Math.ceil(parseFloat(g))+"px"),k){if(g=(g||"").split(","),g=g[e||0]||g[0]||"auto",g=j.Util.trimText(g).split(" "),"backgroundSize"!==d||g[0]&&!g[0].match(/cover|contain|auto/)){if(g[0]=-1===g[0].indexOf("%")?f(d+"X",g[0]):g[0],g[1]===c||"auto"===g[1]){if("backgroundSize"===d)return g[1]="auto",g;g[1]=g[0]}g[1]=-1===g[1].indexOf("%")?f(d+"Y",g[1]):g[1]}}else if(/border(Top|Bottom)(Left|Right)Radius/.test(d)){var m=g.split(" ");m.length<=1&&(m[1]=m[0]),m[0]=parseInt(m[0],10),m[1]=parseInt(m[1],10),g=m}return g},j.Util.resizeBounds=function(a,b,c,d,e){var f,g,h=c/d,i=a/b;return e&&"auto"!==e?i>h^"contain"===e?(g=d,f=d*i):(f=c,g=c/i):(f=c,g=d),{width:f,height:g}},j.Util.BackgroundPosition=function(a,b,c,d,f){var g=e("backgroundPosition",a,b,c,d,f);return{left:g[0]-(b.left-$(a).offset().left),top:g[1]-(b.top-$(a).offset().top)}},j.Util.BackgroundSize=function(a,b,c,d){var f=e("backgroundSize",a,b,c,d);return{width:f[0],height:f[1]}},j.Util.Extend=function(a,b){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},j.Util.Children=function(a){var b;try{b=a.nodeName&&"IFRAME"===a.nodeName.toUpperCase()?a.contentDocument||a.contentWindow.document:function(a){var b=[];return null!==a&&!function(a,b){var d=a.length,e=0;if("number"==typeof b.length)for(var f=b.length;f>e;e++)a[d++]=b[e];else for(;b[e]!==c;)a[d++]=b[e++];return a.length=d,a}(b,a),b}(a.childNodes)}catch(e){d("html2canvas.Util.Children failed with exception: "+e.message),b=[]}return b},j.Util.Font=function(){var a={};return function(b,d,e){if(a[b+"-"+d]!==c)return a[b+"-"+d];var f,g,h,i=e.createElement("div"),j=e.createElement("img"),k=e.createElement("span"),l="Hidden Text";return i.style.visibility="hidden",i.style.fontFamily=b,i.style.fontSize=d,i.style.margin=0,i.style.padding=0,e.body.appendChild(i),j.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",j.width=1,j.height=1,j.style.margin=0,j.style.padding=0,j.style.verticalAlign="baseline",k.style.fontFamily=b,k.style.fontSize=d,k.style.margin=0,k.style.padding=0,k.appendChild(e.createTextNode(l)),i.appendChild(k),i.appendChild(j),f=j.offsetTop-k.offsetTop+1,i.removeChild(k),i.appendChild(e.createTextNode(l)),i.style.lineHeight="normal",j.style.verticalAlign="super",g=j.offsetTop-i.offsetTop+1,h={baseline:f,lineWidth:1,middle:g},a[b+"-"+d]=h,e.body.removeChild(i),h}}(),function(){j.Generate={};var a=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(linear-gradient)\(([a-z\s]+,)*([\w\d\.\s,%\(\)]+)\)$/];j.Generate.parseGradient=function(b,d){var e,f,g,h,i,j,k,l,m,n,o,p,q=a.length;for(f=0;q>f&&!(g=b.match(a[f]));f+=1);if(g)switch(g[1]){case"linear-gradient":if(e={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},null===g[2]||g[2]===c)e.y0=0,e.y1=d.height;else if(i=g[2].match(/\w+/g))for(j=i.length,f=0;j>f;f+=1)switch(i[f]){case"to top":e.y0=0,e.y1=d.height;break;case"to right":e.x0=d.width,e.x1=0;break;case"to bottom":e.y0=d.height,e.y1=0;break;case"to left":e.x0=0,e.x1=d.width}if(null===e.x0&&null===e.x1&&(e.x0=e.x1=d.width/2),null===e.y0&&null===e.y1&&(e.y0=e.y1=d.height/2),i=g[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(j=i.length,k=1/Math.max(j-1,1),f=0;j>f;f+=1)l=i[f].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),l[2]?(h=parseFloat(l[2]),h/="%"===l[3]?100:d.width):h=f*k,e.colorStops.push({color:l[1],stop:h});break;case"-webkit-linear-gradient":case"-o-linear-gradient":if(e={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},i=g[2].match(/\w+/g))for(j=i.length,f=0;j>f;f+=1)switch(i[f]){case"top":e.y0=0,e.y1=d.height;break;case"right":e.x0=d.width,e.x1=0;break;case"bottom":e.y0=d.height,e.y1=0;break;case"left":e.x0=0,e.x1=d.width}if(null===e.x0&&null===e.x1&&(e.x0=e.x1=d.width/2),null===e.y0&&null===e.y1&&(e.y0=e.y1=d.height/2),i=g[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(j=i.length,k=1/Math.max(j-1,1),f=0;j>f;f+=1)l=i[f].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),l[2]?(h=parseFloat(l[2]),h/="%"===l[3]?100:d.width):h=f*k,e.colorStops.push({color:l[1],stop:h});break;case"-webkit-gradient":if(e={type:"radial"===g[2]?"circle":g[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},i=g[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/),i&&(e.x0=i[1]*d.width/100,e.y0=i[2]*d.height/100,e.x1=i[3]*d.width/100,e.y1=i[4]*d.height/100),i=g[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g))for(j=i.length,f=0;j>f;f+=1)l=i[f].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),h=parseFloat(l[2]),"from"===l[1]&&(h=0),"to"===l[1]&&(h=1),e.colorStops.push({color:l[3],stop:h});break;case"-moz-linear-gradient":if(e={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},i=g[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),i&&(e.x0=i[1]*d.width/100,e.y0=i[2]*d.height/100,e.x1=d.width-e.x0,e.y1=d.height-e.y0),i=g[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g))for(j=i.length,k=1/Math.max(j-1,1),f=0;j>f;f+=1)l=i[f].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),l[2]?(h=parseFloat(l[2]),l[3]&&(h/=100)):h=f*k,e.colorStops.push({color:l[1],stop:h});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":if(e={type:"circle",x0:0,y0:0,x1:d.width,y1:d.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},i=g[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),i&&(e.cx=i[1]*d.width/100,e.cy=i[2]*d.height/100),i=g[3].match(/\w+/),l=g[4].match(/[a-z\-]*/),i&&l)switch(l[0]){case"farthest-corner":case"cover":case"":m=Math.sqrt(Math.pow(e.cx,2)+Math.pow(e.cy,2)),n=Math.sqrt(Math.pow(e.cx,2)+Math.pow(e.y1-e.cy,2)),o=Math.sqrt(Math.pow(e.x1-e.cx,2)+Math.pow(e.y1-e.cy,2)),p=Math.sqrt(Math.pow(e.x1-e.cx,2)+Math.pow(e.cy,2)),e.rx=e.ry=Math.max(m,n,o,p);break;case"closest-corner":m=Math.sqrt(Math.pow(e.cx,2)+Math.pow(e.cy,2)),n=Math.sqrt(Math.pow(e.cx,2)+Math.pow(e.y1-e.cy,2)),o=Math.sqrt(Math.pow(e.x1-e.cx,2)+Math.pow(e.y1-e.cy,2)),p=Math.sqrt(Math.pow(e.x1-e.cx,2)+Math.pow(e.cy,2)),e.rx=e.ry=Math.min(m,n,o,p);break;case"farthest-side":"circle"===i[0]?e.rx=e.ry=Math.max(e.cx,e.cy,e.x1-e.cx,e.y1-e.cy):(e.type=i[0],e.rx=Math.max(e.cx,e.x1-e.cx),e.ry=Math.max(e.cy,e.y1-e.cy));break;case"closest-side":case"contain":"circle"===i[0]?e.rx=e.ry=Math.min(e.cx,e.cy,e.x1-e.cx,e.y1-e.cy):(e.type=i[0],e.rx=Math.min(e.cx,e.x1-e.cx),e.ry=Math.min(e.cy,e.y1-e.cy))}if(i=g[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(j=i.length,k=1/Math.max(j-1,1),f=0;j>f;f+=1)l=i[f].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),l[2]?(h=parseFloat(l[2]),h/="%"===l[3]?100:d.width):h=f*k,e.colorStops.push({color:l[1],stop:h})}return e},j.Generate.Gradient=function(a,c){if(0!==c.width&&0!==c.height){var e,f,g,h,i=b.createElement("canvas"),k=i.getContext("2d");if(i.width=c.width,i.height=c.height,e=j.Generate.parseGradient(a,c))if("linear"===e.type){for(f=k.createLinearGradient(e.x0,e.y0,e.x1,e.y1),g=0,h=e.colorStops.length;h>g;g+=1)try{f.addColorStop(e.colorStops[g].stop,e.colorStops[g].color)}catch(l){d(["failed to add color stop: ",l,"; tried to add: ",e.colorStops[g],"; stop: ",g,"; in: ",a])}k.fillStyle=f,k.fillRect(0,0,c.width,c.height)}else if("circle"===e.type){for(f=k.createRadialGradient(e.cx,e.cy,0,e.cx,e.cy,e.rx),g=0,h=e.colorStops.length;h>g;g+=1)try{f.addColorStop(e.colorStops[g].stop,e.colorStops[g].color)}catch(l){d(["failed to add color stop: ",l,"; tried to add: ",e.colorStops[g],"; stop: ",g,"; in: ",a])}k.fillStyle=f,k.fillRect(0,0,c.width,c.height)}else if("ellipse"===e.type){var m=b.createElement("canvas"),n=m.getContext("2d"),o=Math.max(e.rx,e.ry),p=2*o;for(m.width=m.height=p,f=n.createRadialGradient(e.rx,e.ry,0,e.rx,e.ry,o),g=0,h=e.colorStops.length;h>g;g+=1)try{f.addColorStop(e.colorStops[g].stop,e.colorStops[g].color)}catch(l){d(["failed to add color stop: ",l,"; tried to add: ",e.colorStops[g],"; stop: ",g,"; in: ",a])}n.fillStyle=f,n.fillRect(0,0,p,p),k.fillStyle=e.colorStops[g-1].color,k.fillRect(0,0,i.width,i.height),k.drawImage(m,e.cx-e.rx,e.cy-e.ry,2*e.rx,2*e.ry)}return i}},j.Generate.ListAlpha=function(a){var b,c="";do b=a%26,c=String.fromCharCode(b+64)+c,a/=26;while(26*a>26);return c},j.Generate.listGreekAlpha=function e(a){var b,c=["Α","Β","Γ","Δ","Ε","Ζ","Η","Θ","Ι","Κ","Λ","Μ","Ν","Ξ","Ο","Π","Ρ","Σ","Τ","Υ","Φ","Χ","Ψ","Ω"],d=c.length;return a=Math.floor(a),d>=a?c[a-1]:b=a%d===0?e(Math.floor(a/d)-1)+c[d-1]:e(Math.floor(a/d))+c[a%d-1]},j.Generate.ListRoman=function(a){var b,c=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],d=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],e="",f=c.length;if(0>=a||a>=4e3)return a;for(b=0;f>b;b+=1)for(;a>=d[b];)a-=d[b],e+=c[b];return e}}(),j.Parse=function(e,h){function i(){return Math.max(Math.max(ia.body.scrollWidth,ia.documentElement.scrollWidth),Math.max(ia.body.offsetWidth,ia.documentElement.offsetWidth),Math.max(ia.body.clientWidth,ia.documentElement.clientWidth))}function k(){return Math.max(Math.max(ia.body.scrollHeight,ia.documentElement.scrollHeight),Math.max(ia.body.offsetHeight,ia.documentElement.offsetHeight),Math.max(ia.body.clientHeight,ia.documentElement.clientHeight))}function l(a,b){var c=parseInt(ma(a,b),10);return isNaN(c)?0:c}function m(a,b,c,d,e,f){"transparent"!==f&&(a.setVariable("fillStyle",f),a.fillRect(b,c,d,e),ha+=1)}function n(a,b){switch(b){case"lowercase":return a.toLowerCase();case"capitalize":return a.replace(/(^|\s|:|-|\(|\))([a-z])/g,function(a,b,c){return a.length>0?b+c.toUpperCase():void 0});case"uppercase":return a.toUpperCase();default:return a}}function o(a){return/^(normal|none|0px)$/.test(a)}function p(a,b,c,d){null!==a&&j.Util.trimText(a).length>0&&(d.fillText(a,b,c),ha+=1)}function q(a,b,c,d){var e=!1,f=ma(b,"fontWeight"),g=ma(b,"fontFamily"),h=ma(b,"fontSize");switch(parseInt(f,10)){case 401:f="bold";break;case 400:f="normal"}return a.setVariable("fillStyle",d),a.setVariable("font",[ma(b,"fontStyle"),ma(b,"fontVariant"),f,h,g].join(" ")),a.setVariable("textAlign",e?"right":"left"),"none"!==c?j.Util.Font(g,h,ia):void 0}function r(a,b,c,d,e){switch(b){case"underline":m(a,c.left,Math.round(c.top+d.baseline+d.lineWidth),c.width,1,e);break;case"overline":m(a,c.left,Math.round(c.top),c.width,1,e);break;case"line-through":m(a,c.left,Math.ceil(c.top+d.middle+d.lineWidth),c.width,1,e)}}function s(a,b,c,d){var e;if(ja.rangeBounds)("none"!==c||0!==j.Util.trimText(b).length)&&(e=t(b,a.node,a.textOffset)),a.textOffset+=b.length;else if(a.node&&"string"==typeof a.node.nodeValue){var f=d?a.node.splitText(b.length):null;e=u(a.node),a.node=f}return e}function t(a,b,c){var d=ia.createRange();return d.setStart(b,c),d.setEnd(b,c+a.length),d.getBoundingClientRect()}function u(a){var b=a.parentNode,c=ia.createElement("wrapper"),d=a.cloneNode(!0);c.appendChild(a.cloneNode(!0)),b.replaceChild(c,a);var e=j.Util.Bounds(c);return b.replaceChild(d,c),e}function v(a,b,c){var d,e,f=c.ctx,g=ma(a,"color"),i=ma(a,"textDecoration"),k=ma(a,"textAlign"),l={node:b,textOffset:0};j.Util.trimText(b.nodeValue).length>0&&(b.nodeValue=n(b.nodeValue,ma(a,"textTransform")),k=k.replace(["-webkit-auto"],["auto"]),e=!h.letterRendering&&/^(left|right|justify|auto)$/.test(k)&&o(ma(a,"letterSpacing"))?b.nodeValue.split(/(\b| )/):b.nodeValue.split(""),d=q(f,a,i,g),h.chinese&&e.forEach(function(a,b){/.*[\u4E00-\u9FA5].*$/.test(a)&&(a=a.split(""),a.unshift(b,1),e.splice.apply(e,a))}),e.forEach(function(a,b){var c=s(l,a,i,b<e.length-1);c&&(p(a,c.left,c.bottom,f),r(f,i,c,d,g))}))}function w(a,b){var c,d,e=ia.createElement("boundelement");return e.style.display="inline",c=a.style.listStyleType,a.style.listStyleType="none",e.appendChild(ia.createTextNode(b)),a.insertBefore(e,a.firstChild),d=j.Util.Bounds(e),a.removeChild(e),a.style.listStyleType=c,d}function x(a){var b=-1,c=1,d=a.parentNode.childNodes;if(a.parentNode){for(;d[++b]!==a;)1===d[b].nodeType&&c++;return c}return-1}function y(a,b){var c,d=x(a);switch(b){case"decimal":c=d,c+=". ";break;case"decimal-leading-zero":c=1===d.toString().length?d="0"+d.toString():d.toString(),c+=". ";break;case"upper-roman":c=j.Generate.ListRoman(d),c+=". ";break;case"lower-roman":c=j.Generate.ListRoman(d).toLowerCase(),c+=". ";break;case"lower-alpha":c=j.Generate.ListAlpha(d).toLowerCase(),c+=". ";break;case"upper-alpha":c=j.Generate.ListAlpha(d),c+=". ";break;case"upper-greek":c=j.Generate.listGreekAlpha(d),c+=". ";break;case"lower-greek":c=j.Generate.listGreekAlpha(d).toLowerCase(),c+=". ";break;case"square":c="■";break;case"circle":c="○";break;case"disc":default:c="●"}return c}function z(a,c,d){var e,f,g,h=c.ctx,i=ma(a,"listStyleType");if(f=y(a,i),g=w(a,f),q(h,a,"none",ma(a,"color")),"inside"===ma(a,"listStylePosition"))h.setVariable("textAlign","left"),e=d.left;else{var j=b.createElement("span");j.innerText=f,a.appendChild(j);var k=$(j).width();a.removeChild(j),h.setVariable("textAlign","left"),e=d.left-k-10}p(f,e,g.bottom,h)}function A(a){var b=e[a];return b&&b.succeeded===!0?b.img:!1}function B(a,b){var c=Math.max(a.left,b.left),d=Math.max(a.top,b.top),e=Math.min(a.left+a.width,b.left+b.width),f=Math.min(a.top+a.height,b.top+b.height);return{left:c,top:d,width:e-c,height:f-d}}function C(a,b){var c;return b?"auto"!==a?(c=g(a),b.children.push(c),c):b:c=g(0)}function D(a,b,c,d,e){var f=l(b,"paddingLeft"),g=l(b,"paddingTop"),h=l(b,"paddingRight"),i=l(b,"paddingBottom");P(a,c,0,0,c.width,c.height,d.left+f+e[3].width,d.top+g+e[0].width,d.width-(e[1].width+e[3].width+f+h),d.height-(e[0].width+e[2].width+g+i))}function E(a){var b=$(a),c=b.css("borderLeftStyle"),d=b.css("outlineStyle");if((!c||"none"===c)&&d&&"none"!==d){var e={width:parseInt($(a).css("outlineWidth"),10),color:$(a).css("outlineColor")};return[e,e,e,e]}return["Top","Right","Bottom","Left"].map(function(b){return{width:l(a,"border"+b+"Width"),color:ma(a,"border"+b+"Color")}})}function F(a){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(b){return ma(a,"border"+b+"Radius")})}function G(a,b,c,d){var e=function(a,b,c){return{x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}};return{start:a,startControl:b,endControl:c,end:d,subdivide:function(f){var g=e(a,b,f),h=e(b,c,f),i=e(c,d,f),j=e(g,h,f),k=e(h,i,f),l=e(j,k,f);return[G(a,g,j,l),G(l,k,i,d)]},curveTo:function(a){a.push(["bezierCurve",b.x,b.y,c.x,c.y,d.x,d.y])},curveToReversed:function(d){d.push(["bezierCurve",c.x,c.y,b.x,b.y,a.x,a.y])}}}function H(a,b,c,d,e,f,g){b[0]>0||b[1]>0?(a.push(["line",d[0].start.x,d[0].start.y]),d[0].curveTo(a),d[1].curveTo(a)):a.push(["line",f,g]),(c[0]>0||c[1]>0)&&a.push(["line",e[0].start.x,e[0].start.y])}function I(a,b,c,d,e,f,g){var h=[];return b[0]>0||b[1]>0?(h.push(["line",d[1].start.x,d[1].start.y]),d[1].curveTo(h)):h.push(["line",a.c1[0],a.c1[1]]),c[0]>0||c[1]>0?(h.push(["line",f[0].start.x,f[0].start.y]),f[0].curveTo(h),h.push(["line",g[0].end.x,g[0].end.y]),g[0].curveToReversed(h)):(h.push(["line",a.c2[0],a.c2[1]]),h.push(["line",a.c3[0],a.c3[1]])),b[0]>0||b[1]>0?(h.push(["line",e[1].end.x,e[1].end.y]),e[1].curveToReversed(h)):h.push(["line",a.c4[0],a.c4[1]]),h}function J(a,b,c){var d=a.left,e=a.top,f=a.width,g=a.height,h=b[0][0],i=b[0][1],j=b[1][0],k=b[1][1],l=b[2][0],m=b[2][1],n=b[3][0],o=b[3][1],p=f-j,q=g-l,r=f-m,s=g-o;return{topLeftOuter:pa(d,e,h,i).topLeft.subdivide(.5),topLeftInner:pa(d+c[3].width,e+c[0].width,Math.max(0,h-c[3].width),Math.max(0,i-c[0].width)).topLeft.subdivide(.5),topRightOuter:pa(d+p,e,j,k).topRight.subdivide(.5),topRightInner:pa(d+Math.min(p,f+c[3].width),e+c[0].width,p>f+c[3].width?0:j-c[3].width,k-c[0].width).topRight.subdivide(.5),bottomRightOuter:pa(d+r,e+q,m,l).bottomRight.subdivide(.5),bottomRightInner:pa(d+Math.min(r,f+c[3].width),e+Math.min(q,g+c[0].width),Math.max(0,m-c[1].width),Math.max(0,l-c[2].width)).bottomRight.subdivide(.5),bottomLeftOuter:pa(d,e+s,n,o).bottomLeft.subdivide(.5),bottomLeftInner:pa(d+c[3].width,e+s,Math.max(0,n-c[3].width),Math.max(0,o-c[2].width)).bottomLeft.subdivide(.5)}}function K(a,b,c,d,e){var f=ma(a,"backgroundClip"),g=[];switch(f){case"content-box":case"padding-box":H(g,d[0],d[1],b.topLeftInner,b.topRightInner,e.left+c[3].width,e.top+c[0].width),H(g,d[1],d[2],b.topRightInner,b.bottomRightInner,e.left+e.width-c[1].width,e.top+c[0].width),H(g,d[2],d[3],b.bottomRightInner,b.bottomLeftInner,e.left+e.width-c[1].width,e.top+e.height-c[2].width),H(g,d[3],d[0],b.bottomLeftInner,b.topLeftInner,e.left+c[3].width,e.top+e.height-c[2].width);break;default:H(g,d[0],d[1],b.topLeftOuter,b.topRightOuter,e.left,e.top),H(g,d[1],d[2],b.topRightOuter,b.bottomRightOuter,e.left+e.width,e.top),H(g,d[2],d[3],b.bottomRightOuter,b.bottomLeftOuter,e.left+e.width,e.top+e.height),H(g,d[3],d[0],b.bottomLeftOuter,b.topLeftOuter,e.left,e.top+e.height)}return g}function L(a,b,c){var d,e,f,g,h,i,j=b.left,k=b.top,l=b.width,m=b.height,n=F(a),o=J(b,n,c),p={clip:K(a,o,c,n,b),borders:[]};for(d=0;4>d;d++)if(c[d].width>0){switch(e=j,f=k,g=l,h=m-c[2].width,d){case 0:h=c[0].width,i=I({c1:[e,f],c2:[e+g,f],c3:[e+g-c[1].width,f+h],c4:[e+c[3].width,f+h]},n[0],n[1],o.topLeftOuter,o.topLeftInner,o.topRightOuter,o.topRightInner);break;case 1:e=j+l-c[1].width,g=c[1].width,i=I({c1:[e+g,f],c2:[e+g,f+h+c[2].width],c3:[e,f+h],c4:[e,f+c[0].width]},n[1],n[2],o.topRightOuter,o.topRightInner,o.bottomRightOuter,o.bottomRightInner);break;case 2:f=f+m-c[2].width,h=c[2].width,i=I({c1:[e+g,f+h],c2:[e,f+h],c3:[e+c[3].width,f],c4:[e+g-c[2].width,f]},n[2],n[3],o.bottomRightOuter,o.bottomRightInner,o.bottomLeftOuter,o.bottomLeftInner);break;case 3:g=c[3].width,i=I({c1:[e,f+h+c[2].width],c2:[e,f],c3:[e+g,f+c[0].width],c4:[e+g,f+h]},n[3],n[0],o.bottomLeftOuter,o.bottomLeftInner,o.topLeftOuter,o.topLeftInner)}p.borders.push({args:i,color:c[d].color})}return p}function M(a,b){var c=a.drawShape();return b.forEach(function(a,b){c[0===b?"moveTo":a[0]+"To"].apply(null,a.slice(1))}),c}function N(a,b,c){"transparent"!==c&&(a.setVariable("fillStyle",c),M(a,b),a.fill(),ha+=1)}function O(a,b,c){var e,f,g=ia.createElement("valuewrap"),h=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"];h.forEach(function(b){try{g.style[b]=ma(a,b)}catch(c){d("html2canvas: Parse: Exception caught in renderFormValue: "+c.message)}}),g.style.borderColor="black",g.style.borderStyle="solid",g.style.display="block",g.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(a.type)||"SELECT"===a.nodeName)&&(g.style.lineHeight=ma(a,"height")),g.style.top=b.top+"px",g.style.left=b.left+"px",e="SELECT"===a.nodeName?(a.options[a.selectedIndex]||0).text:a.value,e||(e=a.placeholder),f=ia.createTextNode(e),g.appendChild(f),la.appendChild(g),v(a,f,c),la.removeChild(g)}function P(a){a.drawImage.apply(a,Array.prototype.slice.call(arguments,1)),ha+=1}function Q(c,e){var f=a.getComputedStyle(c,e);if(f&&f.content&&"none"!==f.content&&"-moz-alt-content"!==f.content){var g=f.content+"",h=g.substr(0,1);h===g.substr(g.length-1)&&h.match(/'|"/)&&(g=g.substr(1,g.length-2));var i="url"===g.substr(0,3),k=b.createElement(i?"img":"span");k.className=na+"-before "+na+"-after";for(var l in f)if(R(l)&&"cssText"!==l)try{k.style[l]=f[l]}catch(m){d(["Tried to assign readonly property ",l,"Error:",m])}return i?k.src=j.Util.parseBackgroundImage(g)[0].args[0]:k.innerHTML=g,k}}function R(b){return isNaN(a.parseInt(b,10))}function S(a,b){var c=Q(a,":before"),d=Q(a,":after");(c||d)&&(c&&(a.className+=" "+na+"-before",a.parentNode.insertBefore(c,a),da(c,b,!0),a.parentNode.removeChild(c),a.className=a.className.replace(na+"-before","").trim()),d&&(a.className+=" "+na+"-after",a.appendChild(d),da(d,b,!0),a.removeChild(d),a.className=a.className.replace(na+"-after","").trim()))}function T(a,b,c,d){var e=Math.round(d.left+c.left),f=Math.round(d.top+c.top);a.createPattern(b),a.translate(e,f),a.fill(),a.translate(-e,-f)}function U(a,b,c,d,e,f,g,h){var i=[];i.push(["line",Math.round(e),Math.round(f)]),i.push(["line",Math.round(e+g),Math.round(f)]),i.push(["line",Math.round(e+g),Math.round(h+f)]),i.push(["line",Math.round(e),Math.round(h+f)]),M(a,i),a.save(),a.clip(),T(a,b,c,d),a.restore()}function V(a,b,c){m(a,b.left,b.top,b.width,b.height,c)}function W(a,b,c,d,e){var f=j.Util.BackgroundSize(a,b,d,e),g=j.Util.BackgroundPosition(a,b,d,e,f),h=ma(a,"backgroundRepeat").split(",").map(function(a){return a.trim()});switch(d=Y(d,f),h=h[e]||h[0]){case"repeat-x":U(c,d,g,b,b.left,b.top+g.top,99999,d.height);break;case"repeat-y":U(c,d,g,b,b.left+g.left,b.top,d.width,99999);break;case"no-repeat":U(c,d,g,b,b.left+g.left,b.top+g.top,d.width,d.height);break;default:T(c,d,g,{top:b.top,left:b.left,width:d.width,height:d.height})}}function X(a,b,c){for(var e,f=ma(a,"backgroundImage"),g=j.Util.parseBackgroundImage(f),h=g.length;h--;)if(f=g[h],f.args&&0!==f.args.length){var i="url"===f.method?f.args[0]:f.value;e=A(i),e?W(a,b,c,e,h):d("html2canvas: Error loading background:",f)}}function Y(a,b){if(a.width===b.width&&a.height===b.height)return a;var c,d=ia.createElement("canvas");return d.width=b.width,d.height=b.height,c=d.getContext("2d"),P(c,a,0,0,a.width,a.height,0,0,b.width,b.height),d}function Z(a,b,c){var d=ma(b,"opacity")*(c?c.opacity:1);return a.setVariable("globalAlpha",d),d}function _(a,b,c){var d=f(b?c.width:i(),b?c.height:k()),e={ctx:d,zIndex:C(ma(a,"zIndex"),b?b.zIndex:null),opacity:Z(d,a,b),cssPosition:ma(a,"position"),borders:E(a),clip:b&&b.clip?j.Util.Extend({},b.clip):null},g=/(hidden|scroll|auto)/,l=g.test(ma(a,"overflow"))===!0||g.test(ma(a,"overflowX"))===!0||g.test(ma(a,"overflowY"))===!0;return h.useOverflow===!0&&l&&/(BODY)/i.test(a.nodeName)===!1&&(e.clip=e.clip?B(e.clip,c):c),e.zIndex.children.push(e),e}function aa(a,b,c){var d={left:b.left+a[3].width,top:b.top+a[0].width,width:b.width-(a[1].width+a[3].width),height:b.height-(a[0].width+a[2].width)};return c&&(d=B(d,c)),d}function ba(a,b,e){var f,g=j.Util.Bounds(a),h=ka.test(a.nodeName)?"#efefef":ma(a,"backgroundColor"),i=_(a,b,g),k=i.borders,l=i.ctx,m=aa(k,g,i.clip),n=L(a,g,k);switch(M(l,n.clip),l.save(),l.clip(),m.height>0&&m.width>0&&(V(l,g,h),X(a,m,l)),l.restore(),n.borders.forEach(function(a){N(l,a.args,a.color)}),e||S(a,i),a.nodeName){case"IMG":(f=A(a.getAttribute("src")))?D(l,a,f,g,k):d("html2canvas: Error loading <img>:"+a.getAttribute("src"));break;case"INPUT":var o="";o=a.placeholder===c?a.value:a.value?a.value:a.placeholder,/^(text|url|email|submit|button|reset)$/.test(a.type)&&o.length>0&&O(a,g,i);break;case"TEXTAREA":(a.value||a.placeholder||"").length>0&&O(a,g,i);break;
case"SELECT":(a.options||a.placeholder||"").length>0&&O(a,g,i);break;case"LI":z(a,i,m);break;case"CANVAS":D(l,a,a,g,k)}return i}function ca(a){return"none"!==ma(a,"display")&&"hidden"!==ma(a,"visibility")&&!a.hasAttribute("data-html2canvas-ignore")}function da(a,b,c){ca(a)&&(b=ba(a,b,c)||b,ka.test(a.nodeName)||j.Util.Children(a).forEach(function(d){1===d.nodeType?da(d,b,c):3===d.nodeType&&v(a,d,b)}))}function ea(a,b){function c(a){var b,d,e,f,h,i=j.Util.Children(a),k=i.length;for(h=0;k>h;h+=1)if(f=i[h],3===f.nodeType)g+=f.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");else if(1===f.nodeType&&!/^(script|meta|title)$/.test(f.nodeName.toLowerCase())){if(g+="<"+f.nodeName.toLowerCase(),f.hasAttributes())for(b=f.attributes,e=b.length,d=0;e>d;d+=1)g+=" "+b[d].name+'="'+b[d].value+'"';g+=">",c(f),g+="</"+f.nodeName.toLowerCase()+">"}}var d=new Image,e=i(),f=k(),g="";c(a),d.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='"+e+"' height='"+f+"'>","<foreignObject width='"+e+"' height='"+f+"'>","<html xmlns='http://www.w3.org/1999/xhtml' style='margin:0;'>",g.replace(/\#/g,"%23"),"</html>","</foreignObject>","</svg>"].join(""),d.onload=function(){b.svgRender=d}}function fa(){var a=ba(ga,null);return ja.svgRendering&&ea(b.documentElement,a),ga.children&&Array.prototype.slice.call(ga.children,0).forEach(function(b){da(b,a)}),a.backgroundColor=ma(b.documentElement,"backgroundColor"),la.removeChild(oa),a}a.scroll(0,0);var ga=h.elements===c?b.body:h.elements[0],ha=0,ia=ga.ownerDocument,ja=j.Util.Support(h,ia),ka=new RegExp("("+h.ignoreElements+")"),la=ia.body,ma=j.Util.getCSS,na="___html2canvas___pseudoelement",oa=ia.createElement("style");oa.innerHTML="."+na+'-before:before { content: "" !important; display: none !important; }.'+na+'-after:after { content: "" !important; display: none !important; }',la.appendChild(oa),e=e||{};var pa=function(a){return function(b,c,d,e){var f=d*a,g=e*a,h=b+d,i=c+e;return{topLeft:G({x:b,y:i},{x:b,y:i-g},{x:h-f,y:c},{x:h,y:c}),topRight:G({x:b,y:c},{x:b+f,y:c},{x:h,y:i-g},{x:h,y:i}),bottomRight:G({x:h,y:c},{x:h,y:c+g},{x:b+f,y:i},{x:b,y:i}),bottomLeft:G({x:h,y:i},{x:h-f,y:i},{x:b,y:c+g},{x:b,y:c})}}}(4*((Math.sqrt(2)-1)/3));return fa()},j.Preload=function(e){function f(a){A.href=a,A.href=A.href;var b=A.protocol+A.host;return b===q}function g(){d("html2canvas: start: images: "+u.numLoaded+" / "+u.numTotal+" (failed: "+u.numFailed+")"),!u.firstRun&&u.numLoaded>=u.numTotal&&(d("Finished loading images: # "+u.numTotal+" (failed: "+u.numFailed+")"),"function"==typeof e.complete&&e.complete(u))}function h(b,d,f){var h,i,j=e.proxy;A.href=b,b=A.href,h="html2canvas_"+v++,f.callbackname=h,j+=j.indexOf("?")>-1?"&":"?",j+="url="+encodeURIComponent(b)+"&callback="+h,i=x.createElement("script"),a[h]=function(b){"error:"===b.substring(0,6)?(f.succeeded=!1,u.numLoaded++,u.numFailed++,g()):(p(d,f),d.src=b),a[h]=c;try{delete a[h]}catch(e){}i.parentNode.removeChild(i),i=null,delete f.script,delete f.callbackname},i.setAttribute("type","text/javascript"),i.setAttribute("src",j),f.script=i,a.document.body.appendChild(i)}function i(b,c){var d=a.getComputedStyle(b,c),e=d.content;"url"===e.substr(0,3)&&r.loadImage(j.Util.parseBackgroundImage(e)[0].args[0]),n(d.backgroundImage,b)}function k(a){i(a,":before"),i(a,":after")}function l(a,b){var d=j.Generate.Gradient(a,b);d!==c&&(u[a]={img:d,succeeded:!0},u.numTotal++,u.numLoaded++,g())}function m(a){return a&&a.method&&a.args&&a.args.length>0}function n(a,b){var d;j.Util.parseBackgroundImage(a).filter(m).forEach(function(a){"url"===a.method?r.loadImage(a.args[0]):a.method.match(/\-?gradient$/)&&(d===c&&(d=j.Util.Bounds(b)),l(a.value,d))})}function o(a){var b=!1;try{j.Util.Children(a).forEach(function(a){o(a)})}catch(e){}try{b=a.nodeType}catch(f){b=!1,d("html2canvas: failed to access some element's nodeType - Exception: "+f.message)}if(1===b||b===c){k(a);try{n(j.Util.getCSS(a,"backgroundImage"),a)}catch(e){d("html2canvas: failed to get background-image - Exception: "+e.message)}n(a)}}function p(b,d,f,i){var j=function(){d.timer!==c&&a.clearTimeout(d.timer),u.numLoaded++,d.succeeded=!0,b.onerror=b.onload=null,g()},k=function(){if("anonymous"===b.crossOrigin&&(a.clearTimeout(d.timer),e.proxy)){var c=b.src;return b=new Image,d.img=b,b.src=c,void h(b.src,b,d)}u.numLoaded++,u.numFailed++,d.succeeded=!1,b.onerror=b.onload=null,g()};f&&i?MathInteractives.Common.Utilities.getBase64FromImageURL(i,function(c){b.src="data:image/png;base64,"+c,a.setTimeout(j,200)},function l(){l()}):(b.onload=j,b.onerror=k)}var q,r,s,t,u={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},v=0,w=e.elements[0]||b.body,x=w.ownerDocument,y=[],z=0,A=x.createElement("a");if(function(a){return a.crossOrigin!==c}(new Image),e.elements){for(s=0;s<e.elements.length;s++)"img"===e.elements[s].nodeName.toLowerCase()&&y.push(e.elements[s]);$(e.element).find("img").each(function(){y.push(this)})}for(z=y.length,A.href=a.location.href,q=A.protocol+A.host,r={loadImage:function(a){var b,d;a&&u[a]===c&&(b=new Image,a.match(/data:image\/.*;base64,/i)?(b.src=a.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),d=u[a]={img:b},u.numTotal++,p(b,d)):f(a)||e.allowTaint===!0?(d=u[a]={img:b},u.numTotal++,p(b,d),b.src=a):e.useCORS?(d=u[a]={img:b},u.numTotal++,p(b,d,!0,a)):e.proxy&&(d=u[a]={img:b},u.numTotal++,h(a,b,d)))},cleanupDOM:function(f){var h,i;if(!u.cleanupDone){d(f&&"string"==typeof f?"html2canvas: Cleanup because: "+f:"html2canvas: Cleanup after timeout: "+e.timeout+" ms.");for(i in u)if(u.hasOwnProperty(i)&&(h=u[i],"object"==typeof h&&h.callbackname&&h.succeeded===c)){a[h.callbackname]=c;try{delete a[h.callbackname]}catch(j){}h.script&&h.script.parentNode&&(h.script.setAttribute("src","about:blank"),h.script.parentNode.removeChild(h.script)),u.numLoaded++,u.numFailed++,d("html2canvas: Cleaned up failed img: '"+i+"' Steps: "+u.numLoaded+" / "+u.numTotal)}a.stop!==c?a.stop():b.execCommand!==c&&b.execCommand("Stop",!1),b.close!==c&&b.close(),u.cleanupDone=!0,f&&"string"==typeof f||g()}},renderingDone:function(){t&&a.clearTimeout(t)}},e.timeout>0&&(t=a.setTimeout(r.cleanupDOM,e.timeout)),d("html2canvas: Preload starts: finding background-images"),u.firstRun=!0,o(w),d("html2canvas: Preload: Finding images"),s=0;z>s;s+=1)r.loadImage(y[s].getAttribute("src"));return u.firstRun=!1,d("html2canvas: Preload: Done."),u.numTotal===u.numLoaded&&g(),r},j.Renderer=function(a,d){function e(a){var b=[],c=function(a){var d=[],e=[];a.children.forEach(function(a){a.children&&a.children.length>0?(d.push(a),e.push(a.zindex)):b.push(a)}),e.sort(function(a,b){return a-b}),e.forEach(function(a){var b;d.some(function(c,d){return b=d,c.zindex===a}),c(d.splice(b,1)[0])})};return c(a.zIndex),b}function f(a){var b;if("string"==typeof d.renderer&&j.Renderer[a]!==c)b=j.Renderer[a](d);else{if("function"!=typeof a)throw new Error("Unknown renderer");b=a(d)}if("function"!=typeof b)throw new Error("Invalid renderer defined");return b}return f(d.renderer)(a,d,b,e(a),j)},j.Util.Support=function(a,b){function e(){var a=new Image,e=b.createElement("canvas"),f=e.getContext===c?!1:e.getContext("2d");if(f===!1)return!1;e.width=e.height=10,a.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{f.drawImage(a,0,0),e.toDataURL()}catch(g){return!1}return d("html2canvas: Parse: SVG powered rendering available"),!0}function f(){var a,c,d,e,f=!1;return b.createRange&&(a=b.createRange(),a.getBoundingClientRect&&(c=b.createElement("boundtest"),c.style.height="123px",c.style.display="block",b.body.appendChild(c),a.selectNode(c),d=a.getBoundingClientRect(),e=d.height,123===e&&(f=!0),b.body.removeChild(c))),f}return{rangeBounds:f(),svgRendering:a.svgRendering&&e()}},a.html2canvas=function(b,c){b=b.length?b:[b];var e,f,g={logging:!1,elements:b,background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"};return g=j.Util.Extend(c,g),j.logging=g.logging,g.complete=function(a){("function"!=typeof g.onpreloaded||g.onpreloaded(a)!==!1)&&(e=j.Parse(a,g),("function"!=typeof g.onparsed||g.onparsed(e)!==!1)&&(f=j.Renderer(e,g),"function"==typeof g.onrendered&&g.onrendered(f)))},a.setTimeout(function(){j.Preload(g)},0),{render:function(a,b){return j.Renderer(a,j.Util.Extend(b,g))},parse:function(a,b){return j.Parse(a,j.Util.Extend(b,g))},preload:function(a){return j.Preload(j.Util.Extend(a,g))},log:d}},a.html2canvas.log=d,a.html2canvas.Renderer={Canvas:c},j.Renderer.Canvas=function(a){function e(a,b){a.beginPath(),b.forEach(function(b){a[b.name].apply(a,b.arguments)}),a.closePath()}function f(a){if(-1===j.indexOf(a.arguments[0].src)){l.drawImage(a.arguments[0],0,0);try{l.drawImage(a.arguments[0],0,0),l.getImageData(0,0,1,1)}catch(b){return k=i.createElement("canvas"),l=k.getContext("2d"),!1}j.push(a.arguments[0].src)}return!0}function g(a){return"transparent"===a||"rgba(0, 0, 0, 0)"===a}function h(b,c){switch(c.type){case"variable":b[c.name]=c.arguments;break;case"function":if("createPattern"===c.name){if(c.arguments[0].width>0&&c.arguments[0].height>0)try{b.fillStyle=b.createPattern(c.arguments[0],"repeat")}catch(g){d("html2canvas: Renderer: Error creating pattern",g.message)}}else"drawShape"===c.name?e(b,c.arguments):"drawImage"===c.name?c.arguments[8]>0&&c.arguments[7]>0&&(!a.taintTest||a.taintTest&&f(c))&&b.drawImage.apply(b,c.arguments):b[c.name].apply(b,c.arguments)}}a=a||{};var i=b,j=[],k=b.createElement("canvas"),l=k.getContext("2d"),m=a.canvas||i.createElement("canvas");return function(a,b,e,f,i){var j,k,l,n,o,p,q=m.getContext("2d");if(m.width=m.style.width=b.width||a.ctx.width,m.height=m.style.height=b.height||a.ctx.height,p=q.fillStyle,q.fillStyle=g(a.backgroundColor)&&b.background!==c?b.background:a.backgroundColor,q.fillRect(0,0,m.width,m.height),q.fillStyle=p,b.svgRendering&&a.svgRender!==c)q.drawImage(a.svgRender,0,0);else for(k=0,l=f.length;l>k;k+=1)j=f.splice(0,1)[0],j.canvasPosition=j.canvasPosition||{},q.textBaseline="bottom",j.clip&&(q.save(),q.beginPath(),q.rect(j.clip.left,j.clip.top,j.clip.width,j.clip.height),q.clip()),j.ctx.storage&&j.ctx.storage.forEach(h.bind(null,q)),j.clip&&q.restore();if(d("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),l=b.elements.length,1===l&&"object"==typeof b.elements[0]&&"BODY"!==b.elements[0].nodeName){if(o=i.Util.Bounds(b.elements[0]),n=e.createElement("canvas"),n.width=o.width,n.height=o.height,q=n.getContext("2d"),0!==o.width&&0!==o.height)try{q.drawImage(m,o.left,o.top,o.width,o.height,0,0,o.width,o.height)}catch(r){}return m=null,n}return m}}}(window,document),function(){function a(){var a={};return a.FRAMERATE=30,a.MAX_VIRTUAL_PIXELS=3e4,a.init=function(b){var c=0;a.UniqueId=function(){return c++,"canvg"+c},a.Definitions={},a.Styles={},a.Animations=[],a.Images=[],a.ctx=b,a.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(a,b){this.viewPorts.push({width:a,height:b})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(a){return null!=a&&"number"==typeof a?a:"x"==a?this.width():"y"==a?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},a.init(),a.ImagesLoaded=function(){for(var b=0;b<a.Images.length;b++)if(!a.Images[b].loaded)return!1;return!0},a.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},a.compressSpaces=function(a){return a.replace(/[\s\r\t\n]+/gm," ")},a.ajax=function(a){var b;return b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),b?(b.open("GET",a,!1),b.send(null),b.responseText):null},a.parseXml=function(a){if(window.DOMParser){var b=new DOMParser,c=document.implementation.createDocument("","",document.implementation.createDocumentType("html","",""));try{c.appendChild(b.parseFromString(a,"text/html").getElementsByTagName("svg")[0])}catch(d){c.appendChild($(a)[0])}return c}a=a.replace(/<!DOCTYPE svg[^>]*>/,"");var e=new ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(a),e},a.Property=function(a,b){this.name=a,this.value=b},a.Property.prototype.getValue=function(){return this.value},a.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},a.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var a=parseFloat(this.value);return(this.value+"").match(/%$/)&&(a/=100),a},a.Property.prototype.valueOrDefault=function(a){return this.hasValue()?this.value:a},a.Property.prototype.numValueOrDefault=function(a){return this.hasValue()?this.numValue():a},a.Property.prototype.addOpacity=function(b){var c=this.value;if(null!=b&&""!=b&&"string"==typeof this.value){var d=new RGBColor(this.value);d.ok&&(c="rgba("+d.r+", "+d.g+", "+d.b+", "+b+")")}return new a.Property(this.name,c)},a.Property.prototype.getDefinition=function(){var b=this.value.match(/#([^\)']+)/);return b&&(b=b[1]),b||(b=this.value),a.Definitions[b]},a.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},a.Property.prototype.getFillStyleDefinition=function(b,c){var d=this.getDefinition();if(null!=d&&d.createGradient)return d.createGradient(a.ctx,b,c);if(null!=d&&d.createPattern){if(d.getHrefAttribute().hasValue()){var e=d.attribute("patternTransform");d=d.getHrefAttribute().getDefinition(),e.hasValue()&&(d.attribute("patternTransform",!0).value=e.value)}return d.createPattern(a.ctx,b)}return null},a.Property.prototype.getDPI=function(a){return 96},a.Property.prototype.getEM=function(b){var c=12,d=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);return d.hasValue()&&(c=d.toPixels(b)),c},a.Property.prototype.getUnits=function(){var a=this.value+"";return a.replace(/[0-9\.\-]/g,"")},a.Property.prototype.toPixels=function(b,c){if(!this.hasValue())return 0;var d=this.value+"";if(d.match(/em$/))return this.numValue()*this.getEM(b);if(d.match(/ex$/))return this.numValue()*this.getEM(b)/2;if(d.match(/px$/))return this.numValue();if(d.match(/pt$/))return this.numValue()*this.getDPI(b)*(1/72);if(d.match(/pc$/))return 15*this.numValue();if(d.match(/cm$/))return this.numValue()*this.getDPI(b)/2.54;if(d.match(/mm$/))return this.numValue()*this.getDPI(b)/25.4;if(d.match(/in$/))return this.numValue()*this.getDPI(b);if(d.match(/%$/))return this.numValue()*a.ViewPort.ComputeSize(b);var e=this.numValue();return c&&1>e?e*a.ViewPort.ComputeSize(b):e},a.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/s$/)?1e3*this.numValue():a.match(/ms$/)?this.numValue():this.numValue()},a.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/deg$/)?this.numValue()*(Math.PI/180):a.match(/grad$/)?this.numValue()*(Math.PI/200):a.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)},a.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(b,c,d,e,f,g){var h=null!=g?this.Parse(g):this.CreateFont("","","","","",a.ctx.font);return{fontFamily:f||h.fontFamily,fontSize:e||h.fontSize,fontStyle:b||h.fontStyle,fontWeight:d||h.fontWeight,fontVariant:c||h.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var b=this;this.Parse=function(c){for(var d={},e=a.trim(a.compressSpaces(c||"")).split(" "),f={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},g="",h=0;h<e.length;h++)f.fontStyle||-1==b.Styles.indexOf(e[h])?f.fontVariant||-1==b.Variants.indexOf(e[h])?f.fontWeight||-1==b.Weights.indexOf(e[h])?f.fontSize?"inherit"!=e[h]&&(g+=e[h]):("inherit"!=e[h]&&(d.fontSize=e[h].split("/")[0]),f.fontStyle=f.fontVariant=f.fontWeight=f.fontSize=!0):("inherit"!=e[h]&&(d.fontWeight=e[h]),f.fontStyle=f.fontVariant=f.fontWeight=!0):("inherit"!=e[h]&&(d.fontVariant=e[h]),f.fontStyle=f.fontVariant=!0):("inherit"!=e[h]&&(d.fontStyle=e[h]),f.fontStyle=!0);return""!=g&&(d.fontFamily=g),d}},a.ToNumberArray=function(b){for(var c=a.trim(a.compressSpaces((b||"").replace(/,/g," "))).split(" "),d=0;d<c.length;d++)c[d]=parseFloat(c[d]);return c},a.Point=function(a,b){this.x=a,this.y=b},a.Point.prototype.angleTo=function(a){return Math.atan2(a.y-this.y,a.x-this.x)},a.Point.prototype.applyTransform=function(a){var b=this.x*a[0]+this.y*a[2]+a[4],c=this.x*a[1]+this.y*a[3]+a[5];this.x=b,this.y=c},a.CreatePoint=function(b){var c=a.ToNumberArray(b);return new a.Point(c[0],c[1])},a.CreatePath=function(b){for(var c=a.ToNumberArray(b),d=[],e=0;e<c.length;e+=2)d.push(new a.Point(c[e],c[e+1]));return d},a.BoundingBox=function(a,b,c,d){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(a,b){null!=a&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=a,this.x2=a),a<this.x1&&(this.x1=a),a>this.x2&&(this.x2=a)),null!=b&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=b,this.y2=b),b<this.y1&&(this.y1=b),b>this.y2&&(this.y2=b))},this.addX=function(a){this.addPoint(a,null)},this.addY=function(a){this.addPoint(null,a)},this.addBoundingBox=function(a){this.addPoint(a.x1,a.y1),this.addPoint(a.x2,a.y2)},this.addQuadraticCurve=function(a,b,c,d,e,f){var g=a+2/3*(c-a),h=b+2/3*(d-b),i=g+1/3*(e-a),j=h+1/3*(f-b);this.addBezierCurve(a,b,g,i,h,j,e,f)},this.addBezierCurve=function(a,b,c,d,e,f,g,h){var j=[a,b],k=[c,d],l=[e,f],m=[g,h];for(this.addPoint(j[0],j[1]),this.addPoint(m[0],m[1]),i=0;i<=1;i++){var n=function(a){return Math.pow(1-a,3)*j[i]+3*Math.pow(1-a,2)*a*k[i]+3*(1-a)*Math.pow(a,2)*l[i]+Math.pow(a,3)*m[i]},o=6*j[i]-12*k[i]+6*l[i],p=-3*j[i]+9*k[i]-9*l[i]+3*m[i],q=3*k[i]-3*j[i];if(0!=p){var r=Math.pow(o,2)-4*q*p;if(!(0>r)){var s=(-o+Math.sqrt(r))/(2*p);s>0&&1>s&&(0==i&&this.addX(n(s)),1==i&&this.addY(n(s)));var t=(-o-Math.sqrt(r))/(2*p);t>0&&1>t&&(0==i&&this.addX(n(t)),1==i&&this.addY(n(t)))}}else{if(0==o)continue;var u=-q/o;u>0&&1>u&&(0==i&&this.addX(n(u)),1==i&&this.addY(n(u)))}}},this.isPointInBox=function(a,b){return this.x1<=a&&a<=this.x2&&this.y1<=b&&b<=this.y2},this.addPoint(a,b),this.addPoint(c,d)},a.Transform=function(b){var c=this;this.Type={},this.Type.translate=function(b){this.p=a.CreatePoint(b),this.apply=function(a){a.translate(this.p.x||0,this.p.y||0)},this.unapply=function(a){a.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(a){a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(b){var c=a.ToNumberArray(b);this.angle=new a.Property("angle",c[0]),this.cx=c[1]||0,this.cy=c[2]||0,this.apply=function(a){a.translate(this.cx,this.cy),a.rotate(this.angle.toRadians()),a.translate(-this.cx,-this.cy)},this.unapply=function(a){a.translate(this.cx,this.cy),a.rotate(-1*this.angle.toRadians()),a.translate(-this.cx,-this.cy)},this.applyToPoint=function(a){var b=this.angle.toRadians();a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),a.applyTransform([Math.cos(b),Math.sin(b),-Math.sin(b),Math.cos(b),0,0]),a.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(b){this.p=a.CreatePoint(b),this.apply=function(a){a.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(a){a.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(a){a.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(b){this.m=a.ToNumberArray(b),this.apply=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.applyToPoint=function(a){a.applyTransform(this.m)}},this.Type.SkewBase=function(b){this.base=c.Type.matrix,this.base(b),this.angle=new a.Property("angle",b)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(a){this.base=c.Type.SkewBase,this.base(a),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(a){this.base=c.Type.SkewBase,this.base(a),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].apply(a)},this.unapply=function(a){for(var b=this.transforms.length-1;b>=0;b--)this.transforms[b].unapply(a)},this.applyToPoint=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].applyToPoint(a)};for(var d=a.trim(a.compressSpaces(b)).replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),e=0;e<d.length;e++){var f=a.trim(d[e].split("(")[0]),g=d[e].split("(")[1].replace(")",""),h=new this.Type[f](g);h.type=f,this.transforms.push(h)}},a.AspectRatio=function(b,c,d,e,f,g,h,i,j,k){c=a.compressSpaces(c),c=c.replace(/^defer\s/,"");var l=c.split(" ")[0]||"xMidYMid",m=c.split(" ")[1]||"meet",n=d/e,o=f/g,p=Math.min(n,o),q=Math.max(n,o);"meet"==m&&(e*=p,g*=p),"slice"==m&&(e*=q,g*=q),j=new a.Property("refX",j),k=new a.Property("refY",k),j.hasValue()&&k.hasValue()?b.translate(-p*j.toPixels("x"),-p*k.toPixels("y")):(l.match(/^xMid/)&&("meet"==m&&p==o||"slice"==m&&q==o)&&b.translate(d/2-e/2,0),l.match(/YMid$/)&&("meet"==m&&p==n||"slice"==m&&q==n)&&b.translate(0,f/2-g/2),l.match(/^xMax/)&&("meet"==m&&p==o||"slice"==m&&q==o)&&b.translate(d-e,0),l.match(/YMax$/)&&("meet"==m&&p==n||"slice"==m&&q==n)&&b.translate(0,f-g)),"none"==l?b.scale(n,o):"meet"==m?b.scale(p,p):"slice"==m&&b.scale(q,q),b.translate(null==h?0:-h,null==i?0:-i)},a.Element={},a.EmptyProperty=new a.Property("EMPTY",""),a.Element.ElementBase=function(b){if(this.attributes={},this.styles={},this.children=[],this.attribute=function(b,c){var d=this.attributes[b];return null!=d?d:(1==c&&(d=new a.Property(b,""),this.attributes[b]=d),d||a.EmptyProperty)},this.getHrefAttribute=function(){for(var b in this.attributes)if(b.match(/:href$/))return this.attributes[b];return a.EmptyProperty},this.style=function(b,c){var d=this.styles[b];if(null!=d)return d;var e=this.attribute(b);if(null!=e&&e.hasValue())return this.styles[b]=e,e;var f=this.parent;if(null!=f){var g=f.style(b);if(null!=g&&g.hasValue())return g}return 1==c&&(d=new a.Property(b,""),this.styles[b]=d),d||a.EmptyProperty},this.render=function(a){if("none"!=this.style("display").value&&"hidden"!=this.attribute("visibility").value){if(a.save(),this.attribute("mask").hasValue()){var b=this.attribute("mask").getDefinition();null!=b&&b.apply(a,this)}else if(this.style("filter").hasValue()){var c=this.style("filter").getDefinition();null!=c&&c.apply(a,this)}else this.setContext(a),this.renderChildren(a),this.clearContext(a);a.restore()}},this.setContext=function(a){},this.clearContext=function(a){},this.renderChildren=function(a){for(var b=0;b<this.children.length;b++)this.children[b].render(a)},this.addChild=function(b,c){var d=b;c&&(d=a.CreateElement(b)),d.parent=this,this.children.push(d)},null!=b&&1==b.nodeType){for(var c=0;c<b.childNodes.length;c++){var d=b.childNodes[c];if(1==d.nodeType&&this.addChild(d,!0),this.captureTextNodes&&3==d.nodeType){var e=d.nodeValue||d.text||"";""!=a.trim(a.compressSpaces(e))&&this.addChild(new a.Element.tspan(d),!1)}}for(var c=0;c<b.attributes.length;c++){var f=b.attributes[c];this.attributes[f.nodeName]=new a.Property(f.nodeName,f.nodeValue)}var g=a.Styles[b.nodeName];if(null!=g)for(var h in g)this.styles[h]=g[h];if(this.attribute("class").hasValue())for(var i=a.compressSpaces(this.attribute("class").value).split(" "),j=0;j<i.length;j++){if(g=a.Styles["."+i[j]],null!=g)for(var h in g)this.styles[h]=g[h];if(g=a.Styles[b.nodeName+"."+i[j]],null!=g)for(var h in g)this.styles[h]=g[h]}if(this.attribute("id").hasValue()){var g=a.Styles["#"+this.attribute("id").value];if(null!=g)for(var h in g)this.styles[h]=g[h]}if(this.attribute("style").hasValue())for(var g=this.attribute("style").value.split(";"),c=0;c<g.length;c++)if(""!=a.trim(g[c])){var k=g[c].split(":"),h=a.trim(k[0]),l=a.trim(k[1]);this.styles[h]=new a.Property(h,l)}this.attribute("id").hasValue()&&null==a.Definitions[this.attribute("id").value]&&(a.Definitions[this.attribute("id").value]=this)}},a.Element.RenderedElementBase=function(b){this.base=a.Element.ElementBase,this.base(b),this.setContext=function(b){if(this.style("fill").isUrlDefinition()){var c=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=c&&(b.fillStyle=c)}else if(this.style("fill").hasValue()){var d=this.style("fill");"currentColor"==d.value&&(d.value=this.style("color").value),b.fillStyle="none"==d.value?"rgba(0,0,0,0)":d.value}if(this.style("fill-opacity").hasValue()){var d=new a.Property("fill",b.fillStyle);d=d.addOpacity(this.style("fill-opacity").value),b.fillStyle=d.value}if(this.style("stroke").isUrlDefinition()){var c=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=c&&(b.strokeStyle=c)}else if(this.style("stroke").hasValue()){var e=this.style("stroke");"currentColor"==e.value&&(e.value=this.style("color").value),b.strokeStyle="none"==e.value?"rgba(0,0,0,0)":e.value}if(this.style("stroke-opacity").hasValue()){var e=new a.Property("stroke",b.strokeStyle);e=e.addOpacity(this.style("stroke-opacity").value),b.strokeStyle=e.value}if(this.style("stroke-width").hasValue()){var f=this.style("stroke-width").toPixels();b.lineWidth=0==f?.001:f}if(this.style("stroke-linecap").hasValue()&&(b.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(b.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(b.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()){var g=a.ToNumberArray(this.style("stroke-dasharray").value);"undefined"!=typeof b.setLineDash?b.setLineDash(g):"undefined"!=typeof b.webkitLineDash?b.webkitLineDash=g:"undefined"!=typeof b.mozDash&&(b.mozDash=g);var h=this.style("stroke-dashoffset").numValueOrDefault(1);"undefined"!=typeof b.lineDashOffset?b.lineDashOffset=h:"undefined"!=typeof b.webkitLineDashOffset?b.webkitLineDashOffset=h:"undefined"!=typeof b.mozDashOffset&&(b.mozDashOffset=h)}if("undefined"!=typeof b.font&&(b.font=a.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.attribute("transform").hasValue()){var i=new a.Transform(this.attribute("transform").value);i.apply(b)}if(this.attribute("clip-path").hasValue()){var j=this.attribute("clip-path").getDefinition();null!=j&&j.apply(b)}this.style("opacity").hasValue()&&(b.globalAlpha=this.style("opacity").numValue())}},a.Element.RenderedElementBase.prototype=new a.Element.ElementBase,a.Element.PathElementBase=function(b){this.base=a.Element.RenderedElementBase,this.base(b),this.path=function(b){return null!=b&&b.beginPath(),new a.BoundingBox},this.renderChildren=function(b){this.path(b),a.Mouse.checkPath(this,b),""!=b.fillStyle&&(this.attribute("fill-rule").hasValue()?b.fill(this.attribute("fill-rule").value):b.fill()),""!=b.strokeStyle&&b.stroke();var c=this.getMarkers();if(null!=c){if(this.style("marker-start").isUrlDefinition()){var d=this.style("marker-start").getDefinition();d.render(b,c[0][0],c[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var d=this.style("marker-mid").getDefinition(),e=1;e<c.length-1;e++)d.render(b,c[e][0],c[e][1]);if(this.style("marker-end").isUrlDefinition()){var d=this.style("marker-end").getDefinition();d.render(b,c[c.length-1][0],c[c.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},a.Element.PathElementBase.prototype=new a.Element.RenderedElementBase,a.Element.svg=function(b){this.base=a.Element.RenderedElementBase,this.base(b),this.baseClearContext=this.clearContext,this.clearContext=function(b){this.baseClearContext(b),a.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(b){b.strokeStyle="rgba(0,0,0,0)",b.lineCap="butt",b.lineJoin="miter",b.miterLimit=4,this.baseSetContext(b),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),b.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var c=a.ViewPort.width(),d=a.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){c=this.attribute("width").toPixels("x"),d=this.attribute("height").toPixels("y");var e=0,f=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(e=-this.attribute("refX").toPixels("x"),f=-this.attribute("refY").toPixels("y")),b.beginPath(),b.moveTo(e,f),b.lineTo(c,f),b.lineTo(c,d),b.lineTo(e,d),b.closePath(),b.clip()}if(a.ViewPort.SetCurrent(c,d),this.attribute("viewBox").hasValue()){var g=a.ToNumberArray(this.attribute("viewBox").value),h=g[0],i=g[1];c=g[2],d=g[3],a.AspectRatio(b,this.attribute("preserveAspectRatio").value,a.ViewPort.width(),c,a.ViewPort.height(),d,h,i,this.attribute("refX").value,this.attribute("refY").value),a.ViewPort.RemoveCurrent(),a.ViewPort.SetCurrent(g[2],g[3])}}},a.Element.svg.prototype=new a.Element.RenderedElementBase,a.Element.rect=function(b){this.base=a.Element.PathElementBase,this.base(b),this.path=function(b){var c=this.attribute("x").toPixels("x"),d=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),f=this.attribute("height").toPixels("y"),g=this.attribute("rx").toPixels("x"),h=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(h=g),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(g=h),g=Math.min(g,e/2),h=Math.min(h,f/2),null!=b&&(b.beginPath(),b.moveTo(c+g,d),b.lineTo(c+e-g,d),b.quadraticCurveTo(c+e,d,c+e,d+h),b.lineTo(c+e,d+f-h),b.quadraticCurveTo(c+e,d+f,c+e-g,d+f),b.lineTo(c+g,d+f),b.quadraticCurveTo(c,d+f,c,d+f-h),b.lineTo(c,d+h),b.quadraticCurveTo(c,d,c+g,d),b.closePath()),new a.BoundingBox(c,d,c+e,d+f)}},a.Element.rect.prototype=new a.Element.PathElementBase,a.Element.circle=function(b){this.base=a.Element.PathElementBase,this.base(b),this.path=function(b){var c=this.attribute("cx").toPixels("x"),d=this.attribute("cy").toPixels("y"),e=this.attribute("r").toPixels();return null!=b&&(b.beginPath(),b.arc(c,d,e,0,2*Math.PI,!0),b.closePath()),new a.BoundingBox(c-e,d-e,c+e,d+e)}},a.Element.circle.prototype=new a.Element.PathElementBase,a.Element.ellipse=function(b){this.base=a.Element.PathElementBase,this.base(b),this.path=function(b){var c=4*((Math.sqrt(2)-1)/3),d=this.attribute("rx").toPixels("x"),e=this.attribute("ry").toPixels("y"),f=this.attribute("cx").toPixels("x"),g=this.attribute("cy").toPixels("y");return null!=b&&(b.beginPath(),b.moveTo(f,g-e),b.bezierCurveTo(f+c*d,g-e,f+d,g-c*e,f+d,g),b.bezierCurveTo(f+d,g+c*e,f+c*d,g+e,f,g+e),b.bezierCurveTo(f-c*d,g+e,f-d,g+c*e,f-d,g),b.bezierCurveTo(f-d,g-c*e,f-c*d,g-e,f,g-e),b.closePath()),new a.BoundingBox(f-d,g-e,f+d,g+e)}},a.Element.ellipse.prototype=new a.Element.PathElementBase,a.Element.line=function(b){this.base=a.Element.PathElementBase,this.base(b),this.getPoints=function(){return[new a.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new a.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(b){var c=this.getPoints();return null!=b&&(b.beginPath(),b.moveTo(c[0].x,c[0].y),
b.lineTo(c[1].x,c[1].y)),new a.BoundingBox(c[0].x,c[0].y,c[1].x,c[1].y)},this.getMarkers=function(){var a=this.getPoints(),b=a[0].angleTo(a[1]);return[[a[0],b],[a[1],b]]}},a.Element.line.prototype=new a.Element.PathElementBase,a.Element.polyline=function(b){this.base=a.Element.PathElementBase,this.base(b),this.points=a.CreatePath(this.attribute("points").value),this.path=function(b){var c=new a.BoundingBox(this.points[0].x,this.points[0].y);null!=b&&(b.beginPath(),b.moveTo(this.points[0].x,this.points[0].y));for(var d=1;d<this.points.length;d++)c.addPoint(this.points[d].x,this.points[d].y),null!=b&&b.lineTo(this.points[d].x,this.points[d].y);return c},this.getMarkers=function(){for(var a=[],b=0;b<this.points.length-1;b++)a.push([this.points[b],this.points[b].angleTo(this.points[b+1])]);return a.push([this.points[this.points.length-1],a[a.length-1][1]]),a}},a.Element.polyline.prototype=new a.Element.PathElementBase,a.Element.polygon=function(b){this.base=a.Element.polyline,this.base(b),this.basePath=this.path,this.path=function(a){var b=this.basePath(a);return null!=a&&(a.lineTo(this.points[0].x,this.points[0].y),a.closePath()),b}},a.Element.polygon.prototype=new a.Element.polyline,a.Element.path=function(b){this.base=a.Element.PathElementBase,this.base(b);var c=this.attribute("d").value;c=c.replace(/,/gm," "),c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2"),c=c.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),c=c.replace(/([0-9])([+\-])/gm,"$1 $2"),c=c.replace(/(\.[0-9]*)(\.)/gm,"$1 $2"),c=c.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),c=a.compressSpaces(c),c=a.trim(c),this.PathParser=new function(b){this.tokens=b.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new a.Point(0,0),this.control=new a.Point(0,0),this.current=new a.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var b=new a.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(b)},this.getAsControlPoint=function(){var a=this.getPoint();return this.control=a,a},this.getAsCurrentPoint=function(){var a=this.getPoint();return this.current=a,a},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var b=new a.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return b},this.makeAbsolute=function(a){return this.isRelativeCommand()&&(a.x+=this.current.x,a.y+=this.current.y),a},this.addMarker=function(a,b,c){null!=c&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(c)),this.addMarkerAngle(a,null==b?null:b.angleTo(a))},this.addMarkerAngle=function(a,b){this.points.push(a),this.angles.push(b)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var a=0;a<this.angles.length;a++)if(null==this.angles[a])for(var b=a+1;b<this.angles.length;b++)if(null!=this.angles[b]){this.angles[a]=this.angles[b];break}return this.angles}}(c),this.path=function(b){var c=this.PathParser;c.reset();var d=new a.BoundingBox;for(null!=b&&b.beginPath();!c.isEnd();)switch(c.nextCommand(),c.command){case"M":case"m":var e=c.getAsCurrentPoint();for(c.addMarker(e),d.addPoint(e.x,e.y),null!=b&&b.moveTo(e.x,e.y),c.start=c.current;!c.isCommandOrEnd();){var e=c.getAsCurrentPoint();c.addMarker(e,c.start),d.addPoint(e.x,e.y),null!=b&&b.lineTo(e.x,e.y)}break;case"L":case"l":for(;!c.isCommandOrEnd();){var f=c.current,e=c.getAsCurrentPoint();c.addMarker(e,f),d.addPoint(e.x,e.y),null!=b&&b.lineTo(e.x,e.y)}break;case"H":case"h":for(;!c.isCommandOrEnd();){var g=new a.Point((c.isRelativeCommand()?c.current.x:0)+c.getScalar(),c.current.y);c.addMarker(g,c.current),c.current=g,d.addPoint(c.current.x,c.current.y),null!=b&&b.lineTo(c.current.x,c.current.y)}break;case"V":case"v":for(;!c.isCommandOrEnd();){var g=new a.Point(c.current.x,(c.isRelativeCommand()?c.current.y:0)+c.getScalar());c.addMarker(g,c.current),c.current=g,d.addPoint(c.current.x,c.current.y),null!=b&&b.lineTo(c.current.x,c.current.y)}break;case"C":case"c":for(;!c.isCommandOrEnd();){var h=c.current,i=c.getPoint(),j=c.getAsControlPoint(),k=c.getAsCurrentPoint();c.addMarker(k,j,i),d.addBezierCurve(h.x,h.y,i.x,i.y,j.x,j.y,k.x,k.y),null!=b&&b.bezierCurveTo(i.x,i.y,j.x,j.y,k.x,k.y)}break;case"S":case"s":for(;!c.isCommandOrEnd();){var h=c.current,i=c.getReflectedControlPoint(),j=c.getAsControlPoint(),k=c.getAsCurrentPoint();c.addMarker(k,j,i),d.addBezierCurve(h.x,h.y,i.x,i.y,j.x,j.y,k.x,k.y),null!=b&&b.bezierCurveTo(i.x,i.y,j.x,j.y,k.x,k.y)}break;case"Q":case"q":for(;!c.isCommandOrEnd();){var h=c.current,j=c.getAsControlPoint(),k=c.getAsCurrentPoint();c.addMarker(k,j,j),d.addQuadraticCurve(h.x,h.y,j.x,j.y,k.x,k.y),null!=b&&b.quadraticCurveTo(j.x,j.y,k.x,k.y)}break;case"T":case"t":for(;!c.isCommandOrEnd();){var h=c.current,j=c.getReflectedControlPoint();c.control=j;var k=c.getAsCurrentPoint();c.addMarker(k,j,j),d.addQuadraticCurve(h.x,h.y,j.x,j.y,k.x,k.y),null!=b&&b.quadraticCurveTo(j.x,j.y,k.x,k.y)}break;case"A":case"a":for(;!c.isCommandOrEnd();){var h=c.current,l=c.getScalar(),m=c.getScalar(),n=c.getScalar()*(Math.PI/180),o=c.getScalar(),p=c.getScalar(),k=c.getAsCurrentPoint(),q=new a.Point(Math.cos(n)*(h.x-k.x)/2+Math.sin(n)*(h.y-k.y)/2,-Math.sin(n)*(h.x-k.x)/2+Math.cos(n)*(h.y-k.y)/2),r=Math.pow(q.x,2)/Math.pow(l,2)+Math.pow(q.y,2)/Math.pow(m,2);r>1&&(l*=Math.sqrt(r),m*=Math.sqrt(r));var s=(o==p?-1:1)*Math.sqrt((Math.pow(l,2)*Math.pow(m,2)-Math.pow(l,2)*Math.pow(q.y,2)-Math.pow(m,2)*Math.pow(q.x,2))/(Math.pow(l,2)*Math.pow(q.y,2)+Math.pow(m,2)*Math.pow(q.x,2)));isNaN(s)&&(s=0);var t=new a.Point(s*l*q.y/m,s*-m*q.x/l),u=new a.Point((h.x+k.x)/2+Math.cos(n)*t.x-Math.sin(n)*t.y,(h.y+k.y)/2+Math.sin(n)*t.x+Math.cos(n)*t.y),v=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))},w=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(v(a)*v(b))},x=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(w(a,b))},y=x([1,0],[(q.x-t.x)/l,(q.y-t.y)/m]),z=[(q.x-t.x)/l,(q.y-t.y)/m],A=[(-q.x-t.x)/l,(-q.y-t.y)/m],B=x(z,A);w(z,A)<=-1&&(B=Math.PI),w(z,A)>=1&&(B=0);var C=1-p?1:-1,D=y+C*(B/2),E=new a.Point(u.x+l*Math.cos(D),u.y+m*Math.sin(D));if(c.addMarkerAngle(E,D-C*Math.PI/2),c.addMarkerAngle(k,D-C*Math.PI),d.addPoint(k.x,k.y),null!=b){var w=l>m?l:m,F=l>m?1:l/m,G=l>m?m/l:1;b.translate(u.x,u.y),b.rotate(n),b.scale(F,G),b.arc(0,0,w,y,y+B,1-p),b.scale(1/F,1/G),b.rotate(-n),b.translate(-u.x,-u.y)}}break;case"Z":case"z":null!=b&&b.closePath(),c.current=c.start}return d},this.getMarkers=function(){for(var a=this.PathParser.getMarkerPoints(),b=this.PathParser.getMarkerAngles(),c=[],d=0;d<a.length;d++)c.push([a[d],b[d]]);return c}},a.Element.path.prototype=new a.Element.PathElementBase,a.Element.pattern=function(b){this.base=a.Element.ElementBase,this.base(b),this.createPattern=function(b,c){var d=this.attribute("width").toPixels("x",!0),e=this.attribute("height").toPixels("y",!0),f=new a.Element.svg;f.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),f.attributes.width=new a.Property("width",d+"px"),f.attributes.height=new a.Property("height",e+"px"),f.attributes.transform=new a.Property("transform",this.attribute("patternTransform").value),f.children=this.children;var g=document.createElement("canvas");g.width=d,g.height=e;var h=g.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&h.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var i=-1;1>=i;i++)for(var j=-1;1>=j;j++)h.save(),h.translate(i*g.width,j*g.height),f.render(h),h.restore();var k=b.createPattern(g,"repeat");return k}},a.Element.pattern.prototype=new a.Element.ElementBase,a.Element.marker=function(b){this.base=a.Element.ElementBase,this.base(b),this.baseRender=this.render,this.render=function(b,c,d){b.translate(c.x,c.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&b.rotate(d),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&b.scale(b.lineWidth,b.lineWidth),b.save();var e=new a.Element.svg;e.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),e.attributes.refX=new a.Property("refX",this.attribute("refX").value),e.attributes.refY=new a.Property("refY",this.attribute("refY").value),e.attributes.width=new a.Property("width",this.attribute("markerWidth").value),e.attributes.height=new a.Property("height",this.attribute("markerHeight").value),e.attributes.fill=new a.Property("fill",this.attribute("fill").valueOrDefault("black")),e.attributes.stroke=new a.Property("stroke",this.attribute("stroke").valueOrDefault("none")),e.children=this.children,e.render(b),b.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&b.scale(1/b.lineWidth,1/b.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&b.rotate(-d),b.translate(-c.x,-c.y)}},a.Element.marker.prototype=new a.Element.ElementBase,a.Element.defs=function(b){this.base=a.Element.ElementBase,this.base(b),this.render=function(a){}},a.Element.defs.prototype=new a.Element.ElementBase,a.Element.GradientBase=function(b){this.base=a.Element.ElementBase,this.base(b),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var c=0;c<this.children.length;c++){var d=this.children[c];"stop"==d.type&&this.stops.push(d)}this.getGradient=function(){},this.createGradient=function(b,c,d){var e=this;this.getHrefAttribute().hasValue()&&(e=this.getHrefAttribute().getDefinition());var f=function(b){if(d.hasValue()){var c=new a.Property("color",b);return c.addOpacity(d.value).value}return b},g=this.getGradient(b,c);if(null==g)return f(e.stops[e.stops.length-1].color);for(var h=0;h<e.stops.length;h++)g.addColorStop(e.stops[h].offset,f(e.stops[h].color));if(this.attribute("gradientTransform").hasValue()){var i=a.ViewPort.viewPorts[0],j=new a.Element.rect;j.attributes.x=new a.Property("x",-a.MAX_VIRTUAL_PIXELS/3),j.attributes.y=new a.Property("y",-a.MAX_VIRTUAL_PIXELS/3),j.attributes.width=new a.Property("width",a.MAX_VIRTUAL_PIXELS),j.attributes.height=new a.Property("height",a.MAX_VIRTUAL_PIXELS);var k=new a.Element.g;k.attributes.transform=new a.Property("transform",this.attribute("gradientTransform").value),k.children=[j];var l=new a.Element.svg;l.attributes.x=new a.Property("x",0),l.attributes.y=new a.Property("y",0),l.attributes.width=new a.Property("width",i.width),l.attributes.height=new a.Property("height",i.height),l.children=[k];var m=document.createElement("canvas");m.width=i.width,m.height=i.height;var n=m.getContext("2d");return n.fillStyle=g,l.render(n),n.createPattern(m,"no-repeat")}return g}},a.Element.GradientBase.prototype=new a.Element.ElementBase,a.Element.linearGradient=function(b){this.base=a.Element.GradientBase,this.base(b),this.getGradient=function(a,b){var c=b.getBoundingBox();this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var d="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),e="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),f="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),g="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return d==f&&e==g?null:a.createLinearGradient(d,e,f,g)}},a.Element.linearGradient.prototype=new a.Element.GradientBase,a.Element.radialGradient=function(b){this.base=a.Element.GradientBase,this.base(b),this.getGradient=function(a,b){var c=b.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var d="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),e="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),f=d,g=e;this.attribute("fx").hasValue()&&(f="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(g="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var h="objectBoundingBox"==this.gradientUnits?(c.width()+c.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return a.createRadialGradient(f,g,0,d,e,h)}},a.Element.radialGradient.prototype=new a.Element.GradientBase,a.Element.stop=function(b){this.base=a.Element.ElementBase,this.base(b),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var c=this.style("stop-color");this.style("stop-opacity").hasValue()&&(c=c.addOpacity(this.style("stop-opacity").value)),this.color=c.value},a.Element.stop.prototype=new a.Element.ElementBase,a.Element.AnimateBase=function(b){this.base=a.Element.ElementBase,this.base(b),a.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var a=this.attribute("attributeType").value,b=this.attribute("attributeName").value;return"CSS"==a?this.parent.style(b,!0):this.parent.attribute(b,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(a){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"!=this.attribute("repeatCount").value&&"indefinite"!=this.attribute("repeatDur").value)return"remove"!=this.attribute("fill").valueOrDefault("remove")||this.removed?!1:(this.removed=!0,this.getProperty().value=this.initialValue,!0);this.duration=0}this.duration=this.duration+a;var b=!1;if(this.begin<this.duration){var c=this.calcValue();if(this.attribute("type").hasValue()){var d=this.attribute("type").value;c=d+"("+c+")"}this.getProperty().value=c,b=!0}return b},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var b={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var c=b.progress*(this.values.value.length-1),d=Math.floor(c),e=Math.ceil(c);b.from=new a.Property("from",parseFloat(this.values.value[d])),b.to=new a.Property("to",parseFloat(this.values.value[e])),b.progress=(c-d)/(e-d)}else b.from=this.from,b.to=this.to;return b}},a.Element.AnimateBase.prototype=new a.Element.ElementBase,a.Element.animate=function(b){this.base=a.Element.AnimateBase,this.base(b),this.calcValue=function(){var a=this.progress(),b=a.from.numValue()+(a.to.numValue()-a.from.numValue())*a.progress;return b+this.initialUnits}},a.Element.animate.prototype=new a.Element.AnimateBase,a.Element.animateColor=function(b){this.base=a.Element.AnimateBase,this.base(b),this.calcValue=function(){var a=this.progress(),b=new RGBColor(a.from.value),c=new RGBColor(a.to.value);if(b.ok&&c.ok){var d=b.r+(c.r-b.r)*a.progress,e=b.g+(c.g-b.g)*a.progress,f=b.b+(c.b-b.b)*a.progress;return"rgb("+parseInt(d,10)+","+parseInt(e,10)+","+parseInt(f,10)+")"}return this.attribute("from").value}},a.Element.animateColor.prototype=new a.Element.AnimateBase,a.Element.animateTransform=function(b){this.base=a.Element.AnimateBase,this.base(b),this.calcValue=function(){for(var b=this.progress(),c=a.ToNumberArray(b.from.value),d=a.ToNumberArray(b.to.value),e="",f=0;f<c.length;f++)e+=c[f]+(d[f]-c[f])*b.progress+" ";return e}},a.Element.animateTransform.prototype=new a.Element.animate,a.Element.font=function(b){this.base=a.Element.ElementBase,this.base(b),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var c=0;c<this.children.length;c++){var d=this.children[c];"font-face"==d.type?(this.fontFace=d,d.style("font-family").hasValue()&&(a.Definitions[d.style("font-family").value]=this)):"missing-glyph"==d.type?this.missingGlyph=d:"glyph"==d.type&&(""!=d.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[d.unicode]&&(this.glyphs[d.unicode]=[]),this.glyphs[d.unicode][d.arabicForm]=d):this.glyphs[d.unicode]=d)}},a.Element.font.prototype=new a.Element.ElementBase,a.Element.fontface=function(b){this.base=a.Element.ElementBase,this.base(b),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},a.Element.fontface.prototype=new a.Element.ElementBase,a.Element.missingglyph=function(b){this.base=a.Element.path,this.base(b),this.horizAdvX=0},a.Element.missingglyph.prototype=new a.Element.path,a.Element.glyph=function(b){this.base=a.Element.path,this.base(b),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},a.Element.glyph.prototype=new a.Element.path,a.Element.text=function(b){this.captureTextNodes=!0,this.base=a.Element.RenderedElementBase,this.base(b),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a),this.style("dominant-baseline").hasValue()&&(a.textBaseline=this.style("dominant-baseline").value),this.style("alignment-baseline").hasValue()&&(a.textBaseline=this.style("alignment-baseline").value)},this.getBoundingBox=function(){return new a.BoundingBox(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"),0,0)},this.renderChildren=function(a){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.x+=this.getAnchorDelta(a,this,0);for(var b=0;b<this.children.length;b++)this.renderChild(a,this,b)};var c=this.style("text-anchor").valueOrDefault("start");this.getAnchorDelta=function(a,b,d){if("start"!=c){for(var e=0,f=d;f<b.children.length;f++){var g=b.children[f];if(f>d&&g.attribute("x").hasValue())break;e+=g.measureTextRecursive(a)}return-1*("end"==c?e:e/2)}return 0},this.renderChild=function(a,b,c){var d=b.children[c];d.attribute("x").hasValue()?d.x=d.attribute("x").toPixels("x")+this.getAnchorDelta(a,b,c):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),d.attribute("dx").hasValue()&&(this.x+=d.attribute("dx").toPixels("x")),d.x=this.x),this.x=d.x+d.measureText(a),d.attribute("y").hasValue()?d.y=d.attribute("y").toPixels("y"):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),d.attribute("dy").hasValue()&&(this.y+=d.attribute("dy").toPixels("y")),d.y=this.y),this.y=d.y,d.render(a);for(var c=0;c<d.children.length;c++)this.renderChild(a,d,c)}},a.Element.text.prototype=new a.Element.RenderedElementBase,a.Element.TextElementBase=function(b){this.base=a.Element.RenderedElementBase,this.base(b),this.getGlyph=function(a,b,c){var d=b[c],e=null;if(a.isArabic){var f="isolated";(0==c||" "==b[c-1])&&c<b.length-2&&" "!=b[c+1]&&(f="terminal"),c>0&&" "!=b[c-1]&&c<b.length-2&&" "!=b[c+1]&&(f="medial"),c>0&&" "!=b[c-1]&&(c==b.length-1||" "==b[c+1])&&(f="initial"),"undefined"!=typeof a.glyphs[d]&&(e=a.glyphs[d][f],null==e&&"glyph"==a.glyphs[d].type&&(e=a.glyphs[d]))}else e=a.glyphs[d];return null==e&&(e=a.missingGlyph),e},this.renderChildren=function(b){var c=this.parent.style("font-family").getDefinition();if(null==c)""!=b.fillStyle&&b.fillText(a.compressSpaces(this.getText()),this.x,this.y),""!=b.strokeStyle&&b.strokeText(a.compressSpaces(this.getText()),this.x,this.y);else{var d=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),e=this.parent.style("font-style").valueOrDefault(a.Font.Parse(a.ctx.font).fontStyle),f=this.getText();c.isRTL&&(f=f.split("").reverse().join(""));for(var g=a.ToNumberArray(this.parent.attribute("dx").value),h=0;h<f.length;h++){var i=this.getGlyph(c,f,h),j=d/c.fontFace.unitsPerEm;b.translate(this.x,this.y),b.scale(j,-j);var k=b.lineWidth;b.lineWidth=b.lineWidth*c.fontFace.unitsPerEm/d,"italic"==e&&b.transform(1,0,.4,1,0,0),i.render(b),"italic"==e&&b.transform(1,0,-.4,1,0,0),b.lineWidth=k,b.scale(1/j,-1/j),b.translate(-this.x,-this.y),this.x+=d*(i.horizAdvX||c.horizAdvX)/c.fontFace.unitsPerEm,"undefined"==typeof g[h]||isNaN(g[h])||(this.x+=g[h])}}},this.getText=function(){},this.measureTextRecursive=function(a){for(var b=this.measureText(a),c=0;c<this.children.length;c++)b+=this.children[c].measureTextRecursive(a);return b},this.measureText=function(b){var c=this.parent.style("font-family").getDefinition();if(null!=c){var d=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),e=0,f=this.getText();c.isRTL&&(f=f.split("").reverse().join(""));for(var g=a.ToNumberArray(this.parent.attribute("dx").value),h=0;h<f.length;h++){var i=this.getGlyph(c,f,h);e+=(i.horizAdvX||c.horizAdvX)*d/c.fontFace.unitsPerEm,"undefined"==typeof g[h]||isNaN(g[h])||(e+=g[h])}return e}var j=a.compressSpaces(this.getText());if(!b.measureText)return 10*j.length;b.save(),this.setContext(b);var k=b.measureText(j).width;return b.restore(),k}},a.Element.TextElementBase.prototype=new a.Element.RenderedElementBase,a.Element.tspan=function(b){this.captureTextNodes=!0,this.base=a.Element.TextElementBase,this.base(b),this.text=b.nodeValue||b.text||"",this.getText=function(){return this.text}},a.Element.tspan.prototype=new a.Element.TextElementBase,a.Element.tref=function(b){this.base=a.Element.TextElementBase,this.base(b),this.getText=function(){var a=this.getHrefAttribute().getDefinition();return null!=a?a.children[0].getText():void 0}},a.Element.tref.prototype=new a.Element.TextElementBase,a.Element.a=function(b){this.base=a.Element.TextElementBase,this.base(b),this.hasText=!0;for(var c=0;c<b.childNodes.length;c++)3!=b.childNodes[c].nodeType&&(this.hasText=!1);this.text=this.hasText?b.childNodes[0].nodeValue:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(b){if(this.hasText){this.baseRenderChildren(b);var c=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);a.Mouse.checkBoundingBox(this,new a.BoundingBox(this.x,this.y-c.toPixels("y"),this.x+this.measureText(b),this.y))}else{var d=new a.Element.g;d.children=this.children,d.parent=this,d.render(b)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){a.ctx.canvas.style.cursor="pointer"}},a.Element.a.prototype=new a.Element.TextElementBase,a.Element.image=function(b){this.base=a.Element.RenderedElementBase,this.base(b);var c=this.getHrefAttribute().value,d=c.match(/\.svg$/);if(a.Images.push(this),this.loaded=!0,d)this.img=a.ajax(c),this.loaded=!0;else{this.img=document.createElement("img");var e=this;this.img.onload=function(){e.loaded=!0},this.img.onerror=function(){"undefined"!=typeof console&&(e.loaded=!0)},this.img.src=c}this.renderChildren=function(b){var c=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),f=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y");0!=f&&0!=g&&(b.save(),d?b.drawSvg(this.img,c,e,f,g):(b.translate(c,e),a.AspectRatio(b,this.attribute("preserveAspectRatio").value,f,this.img.width,g,this.img.height,0,0),b.drawImage(this.img,0,0)),b.restore())},this.getBoundingBox=function(){var b=this.attribute("x").toPixels("x"),c=this.attribute("y").toPixels("y"),d=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y");return new a.BoundingBox(b,c,b+d,c+e)}},a.Element.image.prototype=new a.Element.RenderedElementBase,a.Element.g=function(b){this.base=a.Element.RenderedElementBase,this.base(b),this.getBoundingBox=function(){for(var b=new a.BoundingBox,c=0;c<this.children.length;c++)b.addBoundingBox(this.children[c].getBoundingBox());return b}},a.Element.g.prototype=new a.Element.RenderedElementBase,a.Element.symbol=function(b){this.base=a.Element.RenderedElementBase,this.base(b),this.baseSetContext=this.setContext,this.setContext=function(b){if(this.baseSetContext(b),this.attribute("viewBox").hasValue()){var c=a.ToNumberArray(this.attribute("viewBox").value),d=c[0],e=c[1];width=c[2],height=c[3],a.AspectRatio(b,this.attribute("preserveAspectRatio").value,this.attribute("width").toPixels("x"),width,this.attribute("height").toPixels("y"),height,d,e),a.ViewPort.SetCurrent(c[2],c[3])}}},a.Element.symbol.prototype=new a.Element.RenderedElementBase,a.Element.style=function(b){this.base=a.Element.ElementBase,this.base(b);for(var c="",d=0;d<b.childNodes.length;d++)c+=b.childNodes[d].nodeValue;c=c.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),c=a.compressSpaces(c);for(var e=c.split("}"),d=0;d<e.length;d++)if(""!=a.trim(e[d]))for(var f=e[d].split("{"),g=f[0].split(","),h=f[1].split(";"),i=0;i<g.length;i++){var j=a.trim(g[i]);if(""!=j){for(var k={},l=0;l<h.length;l++){var m=h[l].indexOf(":"),n=h[l].substr(0,m),o=h[l].substr(m+1,h[l].length-m);null!=n&&null!=o&&(k[a.trim(n)]=new a.Property(a.trim(n),a.trim(o)))}if(a.Styles[j]=k,"@font-face"==j)for(var p=k["font-family"].value.replace(/"/g,""),q=k.src.value.split(","),r=0;r<q.length;r++)if(q[r].indexOf('format("svg")')>0)for(var s=q[r].indexOf("url"),t=q[r].indexOf(")",s),u=q[r].substr(s+5,t-s-6),v=a.parseXml(a.ajax(u)),w=v.getElementsByTagName("font"),x=0;x<w.length;x++){var y=a.CreateElement(w[x]);a.Definitions[p]=y}}}},a.Element.style.prototype=new a.Element.ElementBase,a.Element.use=function(b){this.base=a.Element.RenderedElementBase,this.base(b),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a),this.attribute("x").hasValue()&&a.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&a.translate(0,this.attribute("y").toPixels("y"))},this.getDefinition=function(){var a=this.getHrefAttribute().getDefinition();return this.attribute("width").hasValue()&&(a.attribute("width",!0).value=this.attribute("width").value),this.attribute("height").hasValue()&&(a.attribute("height",!0).value=this.attribute("height").value),a},this.path=function(a){var b=this.getDefinition();null!=b&&b.path(a)},this.getBoundingBox=function(){var a=this.getDefinition();return null!=a?a.getBoundingBox():void 0},this.renderChildren=function(a){var b=this.getDefinition();if(null!=b){var c=b.parent;b.parent=null,b.render(a),b.parent=c}}},a.Element.use.prototype=new a.Element.RenderedElementBase,a.Element.mask=function(b){this.base=a.Element.ElementBase,this.base(b),this.apply=function(b,c){var d=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),f=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y");if(0==f&&0==g){for(var h=new a.BoundingBox,i=0;i<this.children.length;i++)h.addBoundingBox(this.children[i].getBoundingBox());var d=Math.floor(h.x1),e=Math.floor(h.y1),f=Math.floor(h.width()),g=Math.floor(h.height())}var j=c.attribute("mask").value;c.attribute("mask").value="";var k=document.createElement("canvas");k.width=d+f,k.height=e+g;var l=k.getContext("2d");this.renderChildren(l);var m=document.createElement("canvas");m.width=d+f,m.height=e+g;var n=m.getContext("2d");c.render(n),n.globalCompositeOperation="destination-in",n.fillStyle=l.createPattern(k,"no-repeat"),n.fillRect(0,0,d+f,e+g),b.fillStyle=n.createPattern(m,"no-repeat"),b.fillRect(0,0,d+f,e+g),c.attribute("mask").value=j},this.render=function(a){}},a.Element.mask.prototype=new a.Element.ElementBase,a.Element.clipPath=function(b){this.base=a.Element.ElementBase,this.base(b),this.apply=function(b){for(var c=0;c<this.children.length;c++){var d=this.children[c];if("undefined"!=typeof d.path){var e=null;d.attribute("transform").hasValue()&&(e=new a.Transform(d.attribute("transform").value),e.apply(b)),d.path(b),b.clip(),e&&e.unapply(b)}}},this.render=function(a){}},a.Element.clipPath.prototype=new a.Element.ElementBase,a.Element.filter=function(b){this.base=a.Element.ElementBase,this.base(b),this.apply=function(a,b){var c=b.getBoundingBox(),d=Math.floor(c.x1),e=Math.floor(c.y1),f=Math.floor(c.width()),g=Math.floor(c.height()),h=b.style("filter").value;b.style("filter").value="";for(var i=0,j=0,k=0;k<this.children.length;k++){var l=this.children[k].extraFilterDistance||0;i=Math.max(i,l),j=Math.max(j,l)}var m=document.createElement("canvas");m.width=f+2*i,m.height=g+2*j;var n=m.getContext("2d");n.translate(-d+i,-e+j),b.render(n);for(var k=0;k<this.children.length;k++)this.children[k].apply(n,0,0,f+2*i,g+2*j);a.drawImage(m,0,0,f+2*i,g+2*j,d-i,e-j,f+2*i,g+2*j),b.style("filter",!0).value=h},this.render=function(a){}},a.Element.filter.prototype=new a.Element.ElementBase,a.Element.feMorphology=function(b){this.base=a.Element.ElementBase,this.base(b),this.apply=function(a,b,c,d,e){}},a.Element.feMorphology.prototype=new a.Element.ElementBase,a.Element.feColorMatrix=function(b){function c(a,b,c,d,e,f){return a[c*d*4+4*b+f]}function d(a,b,c,d,e,f,g){a[c*d*4+4*b+f]=g}this.base=a.Element.ElementBase,this.base(b),this.apply=function(a,b,e,f,g){for(var h=a.getImageData(0,0,f,g),e=0;g>e;e++)for(var b=0;f>b;b++){var i=c(h.data,b,e,f,g,0),j=c(h.data,b,e,f,g,1),k=c(h.data,b,e,f,g,2),l=(i+j+k)/3;d(h.data,b,e,f,g,0,l),d(h.data,b,e,f,g,1,l),d(h.data,b,e,f,g,2,l)}a.clearRect(0,0,f,g),a.putImageData(h,0,0)}},a.Element.feColorMatrix.prototype=new a.Element.ElementBase,a.Element.feGaussianBlur=function(b){this.base=a.Element.ElementBase,this.base(b),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(b,c,d,e,f){return"undefined"==typeof stackBlurCanvasRGBA?void("undefined"!=typeof console):(b.canvas.id=a.UniqueId(),b.canvas.style.display="none",document.body.appendChild(b.canvas),stackBlurCanvasRGBA(b.canvas.id,c,d,e,f,this.blurRadius),void document.body.removeChild(b.canvas))}},a.Element.feGaussianBlur.prototype=new a.Element.ElementBase,a.Element.title=function(a){},a.Element.title.prototype=new a.Element.ElementBase,a.Element.desc=function(a){},a.Element.desc.prototype=new a.Element.ElementBase,a.Element.MISSING=function(a){"undefined"!=typeof console},a.Element.MISSING.prototype=new a.Element.ElementBase,a.CreateElement=function(b){var c=b.nodeName.replace(/^[^:]+:/,"");c=c.replace(/\-/g,"");var d=null;return d="undefined"!=typeof a.Element[c]?new a.Element[c](b):new a.Element.MISSING(b),d.type=b.nodeName,d},a.load=function(b,c){a.loadXml(b,a.ajax(c))},a.loadXml=function(b,c){a.loadXmlDoc(b,a.parseXml(c))},a.loadXmlDoc=function(b,c){a.init(b);var d=function(a){for(var c=b.canvas;c;)a.x-=c.offsetLeft,a.y-=c.offsetTop,c=c.offsetParent;return window.scrollX&&(a.x+=window.scrollX),window.scrollY&&(a.y+=window.scrollY),a};1!=a.opts.ignoreMouse&&(b.canvas.onclick=function(b){
var c=d(new a.Point(null!=b?b.clientX:event.clientX,null!=b?b.clientY:event.clientY));a.Mouse.onclick(c.x,c.y)},b.canvas.onmousemove=function(b){var c=d(new a.Point(null!=b?b.clientX:event.clientX,null!=b?b.clientY:event.clientY));a.Mouse.onmousemove(c.x,c.y)});var e=a.CreateElement(c.documentElement);e.root=!0;var f=!0,g=function(){a.ViewPort.Clear(),b.canvas.parentNode&&a.ViewPort.SetCurrent(b.canvas.parentNode.clientWidth,b.canvas.parentNode.clientHeight),1!=a.opts.ignoreDimensions&&(e.style("width").hasValue()&&(b.canvas.width=e.style("width").toPixels("x"),b.canvas.style.width=b.canvas.width+"px"),e.style("height").hasValue()&&(b.canvas.height=e.style("height").toPixels("y"),b.canvas.style.height=b.canvas.height+"px"));var d=b.canvas.clientWidth||b.canvas.width,g=b.canvas.clientHeight||b.canvas.height;if(1==a.opts.ignoreDimensions&&e.style("width").hasValue()&&e.style("height").hasValue()&&(d=e.style("width").toPixels("x"),g=e.style("height").toPixels("y")),a.ViewPort.SetCurrent(d,g),null!=a.opts.offsetX&&(e.attribute("x",!0).value=a.opts.offsetX),null!=a.opts.offsetY&&(e.attribute("y",!0).value=a.opts.offsetY),null!=a.opts.scaleWidth&&null!=a.opts.scaleHeight){var h=1,i=1,j=a.ToNumberArray(e.attribute("viewBox").value);e.attribute("width").hasValue()?h=e.attribute("width").toPixels("x")/a.opts.scaleWidth:isNaN(j[2])||(h=j[2]/a.opts.scaleWidth),e.attribute("height").hasValue()?i=e.attribute("height").toPixels("y")/a.opts.scaleHeight:isNaN(j[3])||(i=j[3]/a.opts.scaleHeight),e.attribute("width",!0).value=a.opts.scaleWidth,e.attribute("height",!0).value=a.opts.scaleHeight,e.attribute("viewBox",!0).value="0 0 "+d*h+" "+g*i,e.attribute("preserveAspectRatio",!0).value="none"}1!=a.opts.ignoreClear&&b.clearRect(0,0,d,g),e.render(b),f&&(f=!1,"function"==typeof a.opts.renderCallback&&a.opts.renderCallback(c))},h=!0;a.ImagesLoaded()&&(h=!1,g()),a.intervalID=setInterval(function(){var b=!1;if(h&&a.ImagesLoaded()&&(h=!1,b=!0),1!=a.opts.ignoreMouse&&(b|=a.Mouse.hasEvents()),1!=a.opts.ignoreAnimation)for(var c=0;c<a.Animations.length;c++)b|=a.Animations[c].update(1e3/a.FRAMERATE);"function"==typeof a.opts.forceRedraw&&1==a.opts.forceRedraw()&&(b=!0),b&&(g(),a.Mouse.runEvents())},1e3/a.FRAMERATE)},a.stop=function(){a.intervalID&&clearInterval(a.intervalID)},a.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(a,b){this.events.push({type:"onclick",x:a,y:b,run:function(a){a.onclick&&a.onclick()}})},this.onmousemove=function(a,b){this.events.push({type:"onmousemove",x:a,y:b,run:function(a){a.onmousemove&&a.onmousemove()}})},this.eventElements=[],this.checkPath=function(a,b){for(var c=0;c<this.events.length;c++){var d=this.events[c];b.isPointInPath&&b.isPointInPath(d.x,d.y)&&(this.eventElements[c]=a)}},this.checkBoundingBox=function(a,b){for(var c=0;c<this.events.length;c++){var d=this.events[c];b.isPointInBox(d.x,d.y)&&(this.eventElements[c]=a)}},this.runEvents=function(){a.ctx.canvas.style.cursor="";for(var b=0;b<this.events.length;b++)for(var c=this.events[b],d=this.eventElements[b];d;)c.run(d),d=d.parent;this.events=[],this.eventElements=[]}},a}this.canvg=function(b,c,d){if(null!=b||null!=c||null!=d){d=d||{},"string"==typeof b&&(b=document.getElementById(b)),null!=b.svg&&b.svg.stop();var e=a();(1!=b.childNodes.length||"OBJECT"!=b.childNodes[0].nodeName)&&(b.svg=e),e.opts=d;var f=b.getContext("2d");"undefined"!=typeof c.documentElement?e.loadXmlDoc(f,c):"<"==c.substr(0,1)?e.loadXml(f,c):e.load(f,c)}else for(var g=document.getElementsByTagName("svg"),h=0;h<g.length;h++){var i=g[h],j=document.createElement("canvas");j.width=i.clientWidth,j.height=i.clientHeight,i.parentNode.insertBefore(j,i),i.parentNode.removeChild(i);var k=document.createElement("div");k.appendChild(i),canvg(j,k.innerHTML)}}}(),"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(a,b,c,d,e){canvg(this.canvas,a,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:b,offsetY:c,scaleWidth:d,scaleHeight:e})}),function(){"use strict";MathInteractives.Common.Utilities.Models.BrowserCheck=Backbone.Model.extend({},{isAndroid:null,isWindows:null,isMobile:null,isMac:null,isIE:null,isIE11:null,isFirefox:null,isChrome:null,isSafari:null,isIOS:null,browserVersion:null,isNexus:null,init:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=MathInteractives.Common.Utilities.Models.BrowserCheck.USER_AGENTS;a=navigator.userAgent.toLowerCase(),b=a.indexOf(q.ANDROID)>-1,c=a.indexOf(q.MACINTOSH)>-1,d=a.indexOf(q.WINDOWS)>-1,f=a.indexOf(q.MSIE)>-1,i=a.indexOf(q.TRIDENT)>-1,g=a.indexOf(q.FIREFOX)>-1,h=a.indexOf(q.CHROME)>-1,k=!h&&a.indexOf(q.SAFARI)>-1,l=a.indexOf(q.MOBILE)>-1&&k,j=a.indexOf(q.NEXUS)>-1,e=b||l,n=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[],m=n[2]||"0",d&&h?(o=q.CHROME,p=a.indexOf(o),m=parseInt(a.substring(p+o.length+1,a.indexOf(" ",p)),10)):b?(o=q.ANDROID,p=a.indexOf(o),m=parseFloat(a.substring(p+o.length+1,a.indexOf(";",p)),10)):(l||d&&k)&&(o="version/",p=a.indexOf(o),m=parseFloat(a.substring(p+o.length,a.indexOf(" ",p)),10));var r=MathInteractives.Common.Utilities.Models.BrowserCheck;r.isAndroid=b,r.isWindows=d,r.isMobile=e,r.isMac=c,r.isIE=f,r.isIE11=i,r.isFirefox=g,r.isChrome=h,r.isSafari=k,r.isIOS=l,r.browserVersion=m,r.isNexus=j},USER_AGENTS:{ANDROID:"android",MACINTOSH:"macintosh",WINDOWS:"windows",MOBILE:"mobile",IPAD:"ipad",MSIE:"msie",TRIDENT:"trident",FIREFOX:"firefox",CHROME:"chrome",SAFARI:"safari",NEXUS:"nexus"}}),MathInteractives.Common.Utilities.Models.BrowserCheck.init()}(),function(){"use strict";MathInteractives.Common.Utilities.Models.Validator=Backbone.Model.extend({},{validateIntegers:function(a){var b=null;return b=MathInteractives.Validator.validateNegativeDecimals(a,!0,!0)},validateNegativeIntegers:function(a){var b=null;return b=MathInteractives.Validator.validateNegativeDecimals(a,!1,!0)},isTextSelected:function(a){var b=!1,c=null,d=null,e=null,f=MathInteractives.Validator.getInputSelection(a);return e=$(a),e.is("input:text")&&(c=e.val().length,d=f.end-f.start,b=c===d),b},getInputSelection:function(a){var b=0,c=0,d=null,e=null,f=null,g=null,h=null;return a&&("number"==typeof a.selectionStart&&"number"==typeof a.selectionEnd?(b=a.selectionStart,c=a.selectionEnd):(e=document.selection.createRange(),e&&e.parentElement()==a&&(g=a.value.length,d=a.value.replace(/\r\n/g,"\n"),f=a.createTextRange(),f.moveToBookmark(e.getBookmark()),h=a.createTextRange(),h.collapse(!1),f.compareEndPoints("StartToEnd",h)>-1?b=c=g:(b=-f.moveStart("character",-g),b+=d.slice(0,b).split("\n").length-1,f.compareEndPoints("EndToEnd",h)>-1?c=g:(c=-f.moveEnd("character",-g),c+=d.slice(0,c).split("\n").length-1))))),{start:b,end:c}},isMetaKeyPress:function(a){var b=null,c=null,d=null,e=null,f=!1;switch(c=a.which||a.keyCode,b=String.fromCharCode(c),d={CTRL:2,SHIFT:4,ALT:8,META:16},e=0,a.ctrlKey&&(e|=d.CTRL),a.shiftKey&&(e|=d.SHIFT),a.altKey&&(e|=d.ALT),a.metaKey&&(e|=d.META),c){case 8:case 9:case 13:case 17:case 18:case 19:case 20:case 27:case 45:case 46:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 91:case 144:f=!0}return f?f:e===d.CTRL&&65===c||e===d.CTRL&&67===c||e===d.CTRL&&86===c||e===d.CTRL&&88===c||e===d.CTRL&&89===c||e===d.CTRL&&90===c?f=!0:f},restrictToNumeric:function(a,b){a.each(function(){this.onkeypress=function(a){var c=a.which||a.keyCode;return"undefined"!=typeof b&&this.value.length>=b?!1:c>31&&(48>c||c>57)?!1:void 0}})},validateNegativeDecimals:function(a,b,c){var d=null,e=null,f=null,g=null,h=null,i=null,j=null,k=null,l=!0;return b=b||!1,c=c||!1,MathInteractives.Validator.isMetaKeyPress(a)?l:a.shiftKey?(l=!1,a.preventDefault(),l):(e=a.which||a.keyCode,d=109===e||173===e||189===e?"-":110===e||190===e?".":String.fromCharCode(e),f=a.target,g=MathInteractives.Validator.getInputSelection(f),h=f.value,i=h.substring(0,g.start)+d+h.substring(g.end),j=1===i.length?b?/^[\d]$/:/^-|[\d]$/:c?b?/^[\d]+$/:/^-{0,1}[\d]+$/:b?/^[\d]+\.{0,1}[\d]*$/:/^-{0,1}[\d]+\.{0,1}[\d]*$/,k=i.match(j),l=!(null===k),l||a.preventDefault(),l)},validateDecimals:function(a){var b=null;return b=MathInteractives.Validator.validateNegativeDecimals(a,!0)},isArrayValuesRepeating:function(a){var b=null,c=a.length,d=null,e=!1,f=null,g=null;for(b=0;c-1>b&&e!==!0;b++){if(f=a[b],0===f.length)return!1;for(d=b+1;c>d;d++)g=a[d],f.join()!==g.join()||MathInteractives.Validator.isArrayValuesEmpty(g)||(e=!0)}return e},isArrayValuesEmpty:function(a){var b=!1;return a.forEach(function(a){if(a instanceof Array)a.forEach(function(a){(void 0===a||""===a||null===a)&&(b=!0)});else{if(null===a)return!0;0===a.toString().trim().length&&(b=!0)}}),b},isArrayValuesNumeric:function(a){var b=!0;return MathInteractives.Validator.isArrayValuesEmpty(a)?!1:(a.forEach(function(a){a instanceof Array?a.forEach(function(a){isNaN(a)&&(b=!1)}):isNaN(a)&&(b=!1)}),b)}}),MathInteractives.Validator=MathInteractives.Common.Utilities.Models.Validator}(),function(){"use strict";MathInteractives.Common.Player.Models.Base=Backbone.Model.extend({log:function(a){MathInteractives.Debugger.log(a)},getJson:function(a){var b=this.get("jsonData"),c=b[a];return null!==b&&"undefined"!=typeof b?c?c.data:null:void 0},isAccessible:function(){var a=this.get("manager");return a?this.get("manager").model.get("isAccessible"):!1},set:function(a,b,c){if(!c)switch(a){case"jsonData":throw"jsonData overwrite not allowed"}return Backbone.Model.prototype.set.call(this,a,b)},toJSON:function(){var a=this.get("player");return null!==a&&void 0!==a&&a.serializationRequired===!0&&MathInteractives.Common.Player.Models.Base.serializeModel(this),this.attributes},initializeSavedState:function(){var a=new Backbone.Model,b=this;this.parseModel(this.attributes,a),$.each(a.attributes,function(a,c){b.set(a,c)})},compareSavedState:function(a){var b=this.get("player").model,c="undefined"==typeof a?b.getCurrentActiveTab():a,d=b.getAttrsForSaveStateComparison()[c],e=JSON.parse(b.get("previousSaveState")),f=this.get("attributesToIgnore")||[],g=b.get("config").tabsData[c].view.attributesToIgnore||[],h=[],i=null,j=null,k=null;return e?d?(j=e[d],h=this.attributes[d]instanceof Backbone.Model?this.attributes[d].attributes.attributesToIgnore:this.attributes[d].attributesToIgnore,Array.isArray(h)&&(f=f.concat(h)),f=f.concat(g),i=b.ignoreAttrsForSaveState(j,f),k=b.ignoreAttrsForSaveState(this.attributes[d],f),i===k):(i=b.ignoreAttrsForSaveState(JSON.parse(b.get("previousSaveState")),f),k=b.ignoreAttrsForSaveState(this.attributes,f),i===k):!1},updatePreviousSaveState:function(a){this.get("player")._updatePreviousSaveState(a)},parseCollection:function(a,b){var c=this;return a.length>0&&a.pop(),$.each(a,function(a,d){var e,f=d.modelName;e=null!==f&&void 0!==f?c.executeFunctionByName(f,window):new MathInteractives.Common.Player.Models.Base,b.add(e),c.parseModel(d,e)}),b},parseModel:function(a,b){for(var c in a)if(a.hasOwnProperty(c))if("object"==typeof a[c]&&null!==a[c]&&void 0!==a[c])if(null!==a[c].length&&void 0!==a[c].length)if(a[c].length>0){var d=a[c][a[c].length-1];if("Collection"===d.instanceType){var e,f=d.collectionName;e=null!==f&&void 0!==f?this.executeFunctionByName(f,window):new MathInteractives.Common.Player.Collections.Base,this.parseCollection(a[c],e),b.set(c,e)}else b.set(c,a[c])}else b.set(c,a[c]);else if("Model"===a[c].instanceType){var g,h=a[c].modelName;g=null!==h&&void 0!==h?this.executeFunctionByName(h,window):new MathInteractives.Common.Player.Models.Base,this.parseModel(a[c],g),b.set(c,g)}else"Object"===a[c].instanceType&&b.set(c,a[c]);else b.set(c,a[c])},executeFunctionByName:function(a,b){for(var c=(Array.prototype.slice.call(arguments,2),a.split(".")),d=c.pop(),e=0;e<c.length;e++)b=b[c[e]];return new b[d]}},{serializeModel:function(a){var b=this;return $.each(a.attributes,function(c,d){d instanceof Backbone.Model?(a.get(c).set("instanceType","Model"),a.get(c).set("modelName",a.modelName),b.serializeModel(d)):d instanceof Backbone.Collection?b.serializeCollection(d):d instanceof Array||d instanceof Object&&(a.get(c).instanceType="Object")}),a},serializeCollection:function(a){for(var b=0;b<a.models.length;b++)a.models[b].set("instanceType","Model"),a.models[b].set("modelName",a.models[b].modelName),this.serializeModel(a.models[b])}})}(),function(){"use strict";MathInteractives.Common.Player.Models.BaseInteractive=MathInteractives.Common.Player.Models.Base.extend({getCurrentStateData:function(){}})}(),function(){MathInteractives.Common.Player.Views.Base||(MathInteractives.Common.Player.Views.Base=Backbone.View.extend({filePath:null,manager:null,player:null,idPrefix:null,soundManager:null,initializeDefaultProperties:function(){this.player||(this.player=this.model.get("player")),this.filePath=this.player.getPath(),this.idPrefix=this.player.getIDPrefix(),this.manager=this.player.getManager(),this.soundManager=this.player.getSoundManager(),this.isMobile=MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile},loadScreen:function(a){"undefined"!=typeof this.manager&&null!==this.manager?this.manager.loadScreen(a,this.idPrefix):this.log("Error!! :: manager is null or undefined!!")},unloadScreen:function(a){"undefined"!=typeof this.manager&&null!==this.manager?this.manager.unloadScreen(a,this.idPrefix):this.log("Error!! :: manager is null or undefined!!")},getTabIndex:function(a){var b,c;return b=this.idPrefix+a,"undefined"!=typeof this.manager&&null!==this.manager?c=this.manager.getTabIndex(b):this.log("Error!! :: manager is null or undefined!!"),c},setTabIndex:function(a,b){var c;c=this.idPrefix+a,"undefined"!=typeof this.manager&&null!==this.manager?this.manager.setTabIndex(c,b):this.log("Error!! :: manager is null or undefined!!")},getPath:function(a){var b;return"undefined"!=typeof this.filePath&&null!==this.filePath?b=this.filePath.getPath(a):this.log("Error!! :: filePath is null or undefined!!"),b},getImagePath:function(a){var b;return"undefined"!=typeof this.filePath&&null!==this.filePath?b=this.filePath.getImagePath(a):this.log("Error!! :: filePath is null or undefined!!"),b},getImageElement:function(a){var b=null;return"undefined"!=typeof this.filePath&&null!==this.filePath?b=this.filePath.getImageElement(a):this.log("Error!! :: filePath is null or undefined!!"),b},getSpritePartBase64URL:function(a,b,c,d,e){var f=this.getImageElement(a);return null!==f&&void 0!==f?MathInteractives.Common.Utilities.Models.Utils.getSpritePartBase64URL(f,b,c,d,e):null},setFocus:function(a,b){var c;c=this.idPrefix+a,"undefined"!=typeof this.manager&&null!==this.manager?this.manager.setFocus(c,b):this.log("Error!! :: manager is null or undefined!!")},changeMessage:function(a,b,c){var d;d=this.idPrefix+a,"undefined"!=typeof this.manager&&null!==this.manager?this.manager.changeMessage(d,b,c):this.log("Error!! :: manager is null or undefined!!")},changeAccMessage:function(a,b,c){var d;d=this.idPrefix+a,"undefined"!=typeof this.manager&&null!==this.manager?this.manager.changeAccMessage(d,b,c):this.log("Error!! :: manager is null or undefined!!")},setMessage:function(a,b,c){var d;d=this.idPrefix+a,"undefined"!=typeof this.manager&&null!==this.manager?this.manager.setMessage(d,b,c):this.log("Error!! :: manager is null or undefined!!")},setAccMessage:function(a,b,c){var d;d=this.idPrefix+a,"undefined"!=typeof this.manager&&null!==this.manager?this.manager.setAccMessage(d,b,c):this.log("Error!! :: manager is null or undefined!!")},getMessage:function(a,b,c){var d,e;return d=this.idPrefix+a,"undefined"!=typeof this.manager&&null!==this.manager?e=this.manager.getMessage(d,b,c):this.log("Error!! :: manager is null or undefined!!"),e},getAccMessage:function(a,b,c){var d,e;return d=this.idPrefix+a,"undefined"!=typeof this.manager&&null!==this.manager?e=this.manager.getAccMessage(d,b,c):this.log("Error!! :: manager is null or undefined!!"),e},getMinusSignLocText:function(){var a="";return a='<span pron="'+this.manager.getAccMessage("comm19",0)+'">&minus;</span>'},focusOut:function(a,b,c,d){var e;e=this.idPrefix+a,"undefined"!=typeof this.manager&&null!==this.manager?this.manager.focusOut(e,b,c,d):this.log("Error!! :: manager is null or undefined!!")},focusIn:function(a,b,c,d){var e;e=this.idPrefix+a,"undefined"!=typeof this.manager&&null!==this.manager?this.manager.focusIn(e,b,c,d):this.log("Error!! :: manager is null or undefined!!")},updateFocusRect:function(a){var b;b=this.idPrefix+a,"undefined"!=typeof this.manager&&null!==this.manager?this.manager.updateFocusRect(b):this.log("Error!! :: manager is null or undefined!!")},updatePopupBounds:function(a){"undefined"!=typeof this.manager&&null!==this.manager?this.manager.updatePopupBounds(a):this.log("Error!! :: manager is null or undefined!!")},createAccDiv:function(a){a.elementId=this.idPrefix+a.elementId,"undefined"!=typeof this.manager&&null!==this.manager?this.manager.createAccDiv(a):this.log("Error!! :: manager is null or undefined!!")},restrictAccDivSize:function(a){var b=this.idPrefix+a;"undefined"!=typeof this.manager&&null!==this.manager?this.manager.restrictAccDivSize(b):this.log("Error!! :: manager is null or undefined!!")},enableTab:function(a,b){var c=this.idPrefix+a;"undefined"!=typeof this.manager&&null!==this.manager?this.manager.enableTab(c,b):this.log("Error!! :: manager is null or undefined!!")},log:function(a){MathInteractives.Debugger.log(a)},getJson:function(a){return this.model.getJson(a)},getFontAwesomeClass:function(a){var b=this.filePath._fontAwesomeIconData;return b[a]},isAccessible:function(){return"undefined"!=typeof this.manager&&null!==this.manager?this.manager.model.get("isAccessible"):(this.log("Error!! :: manager is null or undefined!!"),!1)},stopReading:function(){MathInteractives.global.SpeechStream&&MathInteractives.global.SpeechStream.stopReading()},refreshDOM:function(){var a=$("<span>",{"class":"temp-dom-refresh-span"});this.$el.append(a),a.remove()},play:function(a){this.soundManager&&this.soundManager.play(a)},pause:function(){this.soundManager&&this.soundManager.pause()},stopAllSounds:function(){try{MathInteractives.Common.Components.Views.AudioManager.stopAllSounds()}catch(a){}this.stopReading()},hideTabDrawer:function(){this.player.$el.find(".header-tab-drawer-btn").data("isDrawerVisible")===!0&&this.player.$el.trigger("click.drawerHide")}}))}(),function(){"use strict";MathInteractives.Common.Player.Models.TTS=Backbone.Model.extend({defaults:function(){return{containerId:"",messagesToPlay:null,isSetFocusOnComplete:!0,ttsBaseClass:null,ttsColor:null,tooltipColorType:null,isDisabled:!1}},getTTSBaseClass:function(){return this.get("ttsBaseClass")},setTTSBaseClass:function(a){this.set("ttsBaseClass",a)},getFocusStatusOnComplete:function(){return this.get("isSetFocusOnComplete")},setFocusStatusOnComplete:function(a){this.set("isSetFocusOnComplete",a)},getTTSColor:function(){return this.get("ttsColor")},setTTSColor:function(a){this.set("ttsColor",a)}})}(),function(){MathInteractives.Common.Player.Views.TTS||(MathInteractives.Common.Player.Views.TTS=MathInteractives.Common.Player.Views.Base.extend({ttsPlayView:null,ttsPauseView:null,ttsSoundView:null,$container:null,$ttsTooltip:null,$ttsContainer:null,$ttsPauseContainer:null,messagesToPlay:null,ttsTooltipView:null,_touchStartTimer:null,path:null,ttsColor:null,soundImage:!0,player:null,themeType:null,initialize:function(){this.path=this.model.get("path"),this.idPrefix=this.model.get("idPrefix"),this.manager=this.model.get("manager"),this.player=this.model.get("player"),this.themeType=this.player.getPlayerThemeType(),this.filePath=this.model.get("filePath"),this.ttsColor=this.model.get("ttsColor"),this.render(),this._attachEvents(),2!==this.themeType?this._attachTooltip():this.loadScreen("tts-button-component"),this.$messagesToPlay=this.model.get("messagesToPlay"),this.ttsColor=this.model.getTTSColor()},render:function(){this.$container=this.$el,2===this.themeType?this._generateTTSThemeType2():this._generateTTS()},renderTTSAccessibility:function(a){var b=this.getAccMessage("tts-btn",0),c=null,d={elementId:this.$ttsContainer.attr("id").split(this.idPrefix)[1],tabIndex:a,role:"button",acc:b},e={elementId:this.$ttsPauseContainer.attr("id").split(this.idPrefix)[1],tabIndex:a,role:"button",acc:b};2===this.themeType?(c={elementId:this.$ttsPlayContainer.attr("id").split(this.idPrefix)[1],tabIndex:a,role:"button",acc:b},this.createAccDiv(c)):(e.offsetTop=-2,e.offsetLeft=-1,d.offsetTop=-2,d.offsetLeft=-1),this.createAccDiv(e),this.createAccDiv(d)},enableTTSBtnTab:function(a){var b=this.$ttsContainer.attr("id").split(this.idPrefix)[1],c=this.$ttsPauseContainer.attr("id").split(this.idPrefix)[1];this.enableTab(b,a),this.enableTab(c,a)},_generateTTSThemeType2:function(){var a,b,c,d=this.model.get("containerId"),e=this.model,f=e.getTTSBaseClass();a=$("<div>",{id:d+"-sound-btn","class":"sound-tts-container"}),c=$("<div>",{id:d+"-play-btn","class":"play-tts-container"}),b=$("<div>",{id:d+"-pause-btn","class":"pause-tts-container"}),this.$container.append(b).append(a).append(c);var g={player:this.player,manager:this.manager,path:this.filePath,data:{id:d+"-sound-btn",type:MathInteractives.Common.Components.Theme2.Views.Button.TYPE.TTS_SOUND,baseClass:f,tooltipText:this.manager.getMessage("tts-tooltip-play",0),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE,tooltipColorType:this.model.get("tooltipColorType")}};null!==this.ttsColor&&(g.data.colorType=this.ttsColor),this.ttsSoundView=MathInteractives.global.Theme2.Button.generateButton(g);var h={player:this.player,manager:this.manager,path:this.filePath,data:{id:d+"-play-btn",type:MathInteractives.Common.Components.Theme2.Views.Button.TYPE.TTS_PLAY,baseClass:f,tooltipText:this.manager.getMessage("tts-tooltip-play",0),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE,tooltipColorType:this.model.get("tooltipColorType")}};null!==this.ttsColor&&(h.data.colorType=this.ttsColor),this.ttsPlayView=MathInteractives.global.Theme2.Button.generateButton(h);var i={player:this.player,manager:this.manager,path:this.filePath,data:{id:d+"-pause-btn",type:MathInteractives.Common.Components.Theme2.Views.Button.TYPE.TTS_PAUSE,baseClass:f,tooltipText:this.manager.getMessage("tts-tooltip-pause",0),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE,tooltipColorType:this.model.get("tooltipColorType")}};null!==this.ttsColor&&(i.data.colorType=this.ttsColor),this.ttsPauseView=MathInteractives.global.Theme2.Button.generateButton(i),this.$container.css({height:a.height(),width:a.width()}),this.$ttsContainer=a,this.$ttsPauseContainer=b,this.$ttsPlayContainer=c,this.$ttsPauseContainer.hide(),this.$ttsPlayContainer.hide()},hideTTSTooltip:function(){this.ttsPauseView&&this.ttsPauseView.removeTooltip(),this.ttsPlayView&&this.ttsPlayView.removeTooltip(),this.ttsSoundView&&this.ttsSoundView.removeTooltip()},_generateTTS:function(){var a,b,c=this.model.get("containerId");a=$("<div>",{id:c+"-play-btn","class":"tts-container"}),b=$("<div>",{id:c+"-pause-btn","class":"pause-tts-container"}),this.$container.append(b).append(a);var d={id:c+"-play-btn",type:MathInteractives.Common.Components.Views.Button.TYPE.TTS_SOUND,path:this.path};MathInteractives.global.Button.generateButton(d);var e={id:c+"-pause-btn",type:MathInteractives.Common.Components.Views.Button.TYPE.TTS_PAUSE,path:this.path};MathInteractives.global.Button.generateButton(e),this.$container.css({height:a.height(),width:a.width()}),this.$ttsContainer=a,this.$ttsPauseContainer=b},_attachEvents:function(){var a,b=this.$ttsContainer,c=this.$ttsPauseContainer;b.on("mouseover",$.proxy(this._onMouseOver,this)),b.on("mouseout",$.proxy(this._onMouseOut,this)),b.on("mousedown",$.proxy(this._onttsMouseDown,this)),b.on("mouseup",$.proxy(this._onttsMouseup,this)),b.on("focusOnCompletion",$.proxy(this._focusOnSpeechComplete,this)),c.on("mouseover",$.proxy(this._onMouseOver,this)),c.on("mouseout",$.proxy(this._onMouseOut,this)),c.on("mousedown",$.proxy(this._onPauseMouseDown,this)),c.on("mouseup",$.proxy(this._onPauseMouseup,this)),2===this.themeType&&(a=this.$ttsPlayContainer,a.on("mouseover",$.proxy(this._onMouseOver,this)),a.on("mouseout",$.proxy(this._onMouseOut,this)),a.on("mousedown",$.proxy(this._onPauseMouseDown,this)),a.on("mouseup",$.proxy(this._onPauseMouseup,this)),a.on("focusOnCompletion",$.proxy(this._focusOnSpeechComplete,this)),MathInteractives.Common.Utilities.Models.Utils.EnableTouch(a)),MathInteractives.Common.Utilities.Models.Utils.EnableTouch(b),MathInteractives.Common.Utilities.Models.Utils.EnableTouch(c),2!==this.themeType?(c.on("click",$.proxy(this._onClick,this)),b.on("click",$.proxy(this._onClick,this))):(c.on("click",$.proxy(this._onClickThemeType2,this)),b.on("click",$.proxy(this._onClickThemeType2,this)),a.on("click",$.proxy(this._onClickThemeType2,this)))},disableTTS:function(a){var b;b=a?MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED:MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE,this.model.set("isDisabled",a),this.ttsPlayView.setButtonState(b),this.ttsPauseView.setButtonState(b),this.ttsSoundView.setButtonState(b)},_attachTooltip:function(){this.loadScreen("tts-button-component");var a=this.$container;this.tooltip=new MathInteractives.Common.Components.Models.Tooltip({id:this.model.get("containerId")+"-tooltip",text:this.getMessage("tts-tooltip-play",0),elementOffsetPosition:a.offset(),elementDimensions:{width:a.width(),height:a.height()},path:this.path,player:this.model.get("player")}),this.ttsTooltipView=new MathInteractives.Common.Components.Views.Tooltip({model:this.tooltip}),MathInteractives.global.PlayerTTS.ttsView=this,MathInteractives.global.PlayerTTS.ttsView.tooltipView=this.ttsTooltipView},_focusOnSpeechComplete:function(a){var b=MathInteractives.global.SpeechStream.currentTTSId.split(this.idPrefix)[1],c=MathInteractives.global.PlayerTTS.ttsView,d=c.model.getFocusStatusOnComplete();if($("#"+MathInteractives.global.SpeechStream.currentTTSId).is(":visible")===!0&&d===!0){var e=$(this.$ttsPauseContainer).find(".acc-read-elem");void 0!==typeof e&&document.activeElement.id===e.attr("id")&&this.setFocus(b,1)}this.setFocus(this.$ttsContainer.attr("id").split(this.idPrefix)[1]),2===this.themeType&&(this.$ttsPauseContainer.hide(),this.$ttsPauseContainer.trigger("mouseout"),this.$ttsPlayContainer.hide(),this.$ttsContainer.show())},_onMouseOver:function(a){if(this.model.get("isDisabled")!==!0){var b=$(a.currentTarget);b.addClass("hover"),2!==this.themeType&&(this.tooltip.set("elementOffsetPosition",this.$container.offset()),this.ttsTooltipView.showTooltip())}},_onMouseOut:function(a){$(a.currentTarget).removeClass("hover"),2!==this.themeType&&this.ttsTooltipView.hideTooltip()},_onttsMouseDown:function(a){(MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile||1===a.which)&&this.model.get("isDisabled")!==!0&&(this.$ttsContainer.addClass("down"),this.ttsTooltipView&&MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile&&2!==this.themeType&&(this.tooltip.set("elementOffsetPosition",this.$container.offset()),this.ttsTooltipView.showTooltip(),MathInteractives.global.PlayerTTS.ttsView.tooltipView=this.ttsTooltipView))},_onPauseMouseDown:function(a){(MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile||1===a.which)&&this.model.get("isDisabled")!==!0&&(this.$ttsPauseContainer.addClass("down"),this.ttsTooltipView&&MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile&&2!==this.themeType&&(this.tooltip.set("elementOffsetPosition",this.$container.offset()),this.ttsTooltipView.showTooltip(),MathInteractives.global.PlayerTTS.ttsView.tooltipView=this.ttsTooltipView))},_onttsMouseup:function(a){null!==this._touchStartTimer&&window.clearTimeout(this._touchStartTimer),(MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile||1===a.which)&&this.$ttsContainer.removeClass("down")},_onPauseMouseup:function(a){null!==this._touchStartTimer&&window.clearTimeout(this._touchStartTimer),(MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile||1===a.which)&&this.$ttsPauseContainer.removeClass("down")},_onClickThemeType2:function(a){var b,c=MathInteractives.global.SpeechStream.currentTTSId;if(this.model.get("isDisabled")!==!0){void 0!==MathInteractives.global.Theme2.PlayerTTS.ttsView&&2!==MathInteractives.global.Theme2.PlayerTTS.ttsView.themeType&&MathInteractives.global.Theme2.PlayerTTS.resetTooltipText(),MathInteractives.global.Theme2.PlayerTTS.ttsView=this;var d=a.currentTarget.id;MathInteractives.global.AudioManager,d===this.$ttsContainer.attr("id")||d===this.$ttsPlayContainer.attr("id")?("undefined"!=typeof c&&c!==a.currentTarget.id&&d===this.$ttsContainer.attr("id")&&(MathInteractives.global.SpeechStream.stopReading(),c=c.replace("play","sound"),c=c.replace("pause","sound"),b=c.split("-sound-btn")[0],$("#"+b+"-pause-btn").hide(),$("#"+b+"-play-btn").hide(),$("#"+c).show()),this.soundImage&&(this.soundImage=!1),MathInteractives.global.Theme2.PlayerTTS.ttsView=this,MathInteractives.global.SpeechStream.playTTSSpeaker(this.$messagesToPlay),this.$ttsContainer.hide(),this.$ttsPlayContainer.hide(),this.$ttsPauseContainer.show(),MathInteractives.global.SpeechStream.currentTTSId=a.currentTarget.id,this.setFocus(this.$ttsPauseContainer.attr("id").split(this.idPrefix)[1])):(this.$ttsContainer.hide(),this.$ttsPauseContainer.hide(),this.$ttsPlayContainer.show(),MathInteractives.global.SpeechStream.pauseReading(),this.setFocus(this.$ttsPlayContainer.attr("id").split(this.idPrefix)[1]))}},_onClick:function(a){if(MathInteractives.global.AudioManager&&MathInteractives.global.AudioManager.stopAllSounds(),MathInteractives.global.PlayerTTS.ttsView!==this&&(2===MathInteractives.global.PlayerTTS.ttsView.themeType?(MathInteractives.global.PlayerTTS.ttsView.$ttsPlayContainer.hide(),MathInteractives.global.PlayerTTS.ttsView.$ttsPauseContainer.hide(),MathInteractives.global.PlayerTTS.ttsView.$ttsContainer.show()):MathInteractives.global.PlayerTTS.resetTooltipText(),MathInteractives.global.PlayerTTS.ttsView=this,this.setFocus()),a.currentTarget.id===this.$ttsContainer.attr("id")){if("undefined"!=typeof MathInteractives.global.SpeechStream.currentTTSId&&MathInteractives.global.SpeechStream.currentTTSId!==a.currentTarget.id?(MathInteractives.global.SpeechStream.stopReading(),2===this.themeType&&($("#"+MathInteractives.global.SpeechStream.currentTTSId).css({"background-image":'url("'+this.path.getImagePath("tts-sound-button")+'")'}),MathInteractives.global.PlayerTTS.ttsView.tooltipView.changeTooltipText(this.getMessage("tts-tooltip-play",0)))):this.ttsTooltipView.changeTooltipText(this.getMessage("tts-tooltip-pause",0)),this.$ttsContainer.hide(),this.soundImage){var b=this.$ttsContainer;b.css({"background-image":'url("'+this.path.getImagePath("tts-play-button")+'")'}),this.soundImage=!1}this.$ttsPauseContainer.show(),MathInteractives.global.PlayerTTS.ttsView=this,MathInteractives.global.SpeechStream.playTTSSpeaker(this.$messagesToPlay),MathInteractives.global.SpeechStream.currentTTSId=a.currentTarget.id,this.setFocus(this.$ttsPauseContainer.attr("id").split(this.idPrefix)[1])}else this.$ttsContainer.show(),this.$ttsPauseContainer.hide(),MathInteractives.global.SpeechStream.pauseReading(),this.ttsTooltipView.changeTooltipText(this.getMessage("tts-tooltip-play",0)),this.setFocus(this.$ttsContainer.attr("id").split(this.idPrefix)[1])},_ttsTouchStartEvent:function(a){var b=this;this.$ttsContainer.one("touchmove",function(a){a.preventDefault(),null!==b._touchStartTimer&&window.clearTimeout(b._touchStartTimer)}),this._touchStartTimer=window.setTimeout(function(a){b._onttsMouseDown(a),b._touchStartTimer=null},200)},_pauseTouchStartEvent:function(a){var b=this;this.$ttsPauseContainer.one("touchmove",function(a){a.preventDefault(),null!==b._touchStartTimer&&window.clearTimeout(b._touchStartTimer)}),this._touchStartTimer=window.setTimeout(function(a){
b._onPauseMouseDown(a),b._touchStartTimer=null},200)},_removeTooltip:function(){this.ttsTooltipView&&(null!==this._touchStartTimer&&window.clearTimeout(this._touchStartTimer),this.ttsTooltipView.hideTooltip())}},{tooltipView:null,generateTTS:function(a){var b;if(a){b="#"+a.containerId,(null===a.tooltipColorType||"undefined"==typeof a.tooltipColorType)&&MathInteractives.Common.Components.Theme2.Views&&MathInteractives.Common.Components.Theme2.Views.Tooltip&&(a.tooltipColorType=MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.GENERAL);var c=new MathInteractives.Common.Player.Models.TTS(a),d=new MathInteractives.Common.Player.Views.TTS({el:b,model:c});return d}},resetTooltipText:function(){MathInteractives.global.PlayerTTS.ttsView.$el.find(".pause-tts-container").hide(),MathInteractives.global.PlayerTTS.ttsView.$el.find(".tts-container").show(),MathInteractives.global.PlayerTTS.ttsView.$el.find(".sound-tts-container").show(),MathInteractives.global.PlayerTTS.ttsView.$el.find(".sound-tts-container").length>0&&MathInteractives.global.PlayerTTS.ttsView.$el.find(".play-tts-container").hide(),MathInteractives.global.PlayerTTS.ttsView.soundImage||0===MathInteractives.global.PlayerTTS.ttsView.$el.find(".sound-tts-container").length&&(MathInteractives.global.PlayerTTS.ttsView.$ttsContainer.css({"background-image":'url("'+MathInteractives.global.PlayerTTS.ttsView.path.getImagePath("tts-sound-button")+'")'}),MathInteractives.global.PlayerTTS.ttsView.soundImage=!0),MathInteractives.global.PlayerTTS.ttsView.tooltipView&&MathInteractives.global.PlayerTTS.ttsView.tooltipView.changeTooltipText(MathInteractives.global.PlayerTTS.ttsView.getMessage("tts-tooltip-play",0))}}),MathInteractives.global.PlayerTTS=MathInteractives.Common.Player.Views.TTS,MathInteractives.global.Theme2.PlayerTTS=MathInteractives.Common.Player.Views.TTS)}(),function(){"use strict";MathInteractives.Common.Player.Models.Player=Backbone.Model.extend({defaults:function(){return{tabCollection:null,activityAreaCollection:null,currentTabView:null,defaultTab:0,currentActiveTab:null,modals:null,isTabSwitchAllowed:!0,isDrawerButtonEnable:!0,previousSaveState:null,backupSaveState:null,isPoppedOut:!1}},initialize:function(){var a=new MathInteractives.Common.Player.Collections.Tabs;this.set("tabCollection",a);var b=new MathInteractives.Common.Player.Collections.ActivityAreas;this.set("activityAreaCollection",b)},initializeModals:function(a){for(var b=new Array(a),c=0;a>c;c++)b[c]=!1;this.set("modals",b)},getModalPresent:function(){return this.get("modals")[this.getCurrentActiveTab()]},setModalPresent:function(a){var b=this.get("modals");b[this.getCurrentActiveTab()]=a,this.set("modals",b)},getCurrentActiveTab:function(){return this.get("currentActiveTab")},ignoreAttrsForSaveState:function(a,b){var c=["path","manager","player","jsonData","currentTab","helpElements","attributesToIgnore"];return Array.isArray(b)&&(c=c.concat(b)),JSON.stringify(a,function(a,b){return c.indexOf(a)>-1?void 0:b})},getAttrsForSaveStateComparison:function(){var a=[],b=this.get("config"),c=this.get("tabCollection"),d=0;for(d=0;d<c.length;d++)a.push(b.tabsData[d].view.attrForSaveStateComparison);return a},clearNestedValue:function(a,b,c,d){null!=a[b][c[d]]&&(d<c.length-1?(d++,this.clearNestedValue(a,b,c,d)):a[b][c[d]]=void 0)},rollbackSaveState:function(){var a=this.get("backupSaveState");this.set("previousSaveState",a)},performBackupSaveState:function(){var a=this.get("previousSaveState");this.set("backupSaveState",a)}},{THEME1:MathInteractives.Common.Player.Models.InteractivityPreloader.PRELOADER_TYPE1,THEME2:MathInteractives.Common.Player.Models.InteractivityPreloader.PRELOADER_TYPE2,BEFORE_TAB_SWITCH_EVENT:"beforeTabSwitch",TAB_ITEMS_START_TAB_INDEX:4710}),MathInteractives.global.PlayerModel=MathInteractives.Common.Player.Models.Player}(),function(){"use strict";MathInteractives.Common.Player.Models.Header=Backbone.Model.extend({defaults:function(){return{buttons:{theme1:[{id:"help-btn"},{id:"screen-shot-btn"},{id:"save-btn"}],theme2:[{id:"mute-btn"},{id:"unmute-btn"},{id:"pop-out-btn"},{id:"screen-shot-btn"},{id:"help-btn"},{id:"save-btn"}]},currentTemplate:null,interactiveModel:null,helpScreenShowCallback:null,helpScreenCloseCallback:null,isMuted:!1,isPoppedOut:!1}},helpText:"This feature is currently unavailable.",initialize:function(){}},{template:null})}(),function(){"use strict";MathInteractives.Common.Player.Models.Tab=Backbone.Model.extend({defaults:function(){return{active:null,enable:!0,isHelpScreenShown:null,isHelpEnabled:!0}},initialize:function(){}},{ATTACH_EVENTS:"attach-events"})}(),function(){"use strict";MathInteractives.Common.Player.Models.ActivityArea=Backbone.Model.extend({defaults:function(){return{show:null}},initialize:function(){}},{})}(),function(){if(!MathInteractives.Common.Player.Views.Player)var a=MathInteractives.Common.Player.Views.Player=Backbone.View.extend({_moduleName:null,_tabsData:null,_config:null,_header:null,_tabChangeData:null,_managerModel:null,_manager:null,interactiveModel:null,_path:null,tab:null,_stepsData:null,_activityAreaViews:null,_step2FirstLoad:!1,_tabToSwitchAfterPreload:1,_overviewTabInstance:null,_currentActiveTab:null,_isSelectedTabClicked:!1,isLetsGoClicked:!1,soundManagerInstance:null,taskStack:[],screenShotModalView:null,initialize:function(){var a=MathInteractives.Common.Player.Views.Player;switch(this._path=this.model.get("path"),this._config=this.model.get("config"),this._jsonDataMapping(),this._initializeManager(),this._moduleName=this._config.module,this._tabsData=this._config.tabsData,this.tab=[],this._tabsData.length>1&&this.getPlayerThemeType()===MathInteractives.Common.Player.Views.Player.THEMES.THEME_1&&(this._manager.unloadScreen("tab-contents",this.getIDPrefix()),this._manager.loadScreen("tab-contents",this.getIDPrefix())),this._stepsData=this._config.steps,this._attachEvents(),this.getPlayerThemeType()){case a.THEMES.THEME_1:this._manager.unloadScreen("theme-1-header-buttons",this.getIDPrefix()),this._manager.loadScreen("theme-1-header-buttons",this.getIDPrefix());break;case a.THEMES.THEME_2:this._manager.unloadScreen("theme-2-header-buttons",this.getIDPrefix()),this._manager.loadScreen("theme-2-header-buttons",this.getIDPrefix())}this.render(),this._defaultSetupOfPlayer(),this._restrictTextSelection(),this._manager.loadScreen("player",this.getIDPrefix()),this.model.get("isAccessible")===!0&&this._manager.initializeAccessibilityComponents(this.$el.parent()),this._enableDisableApplicationMode(!0),this._header.initTheme2Help(),$.isEmptyObject(this.model.get("audioFileDataMap"))||this.getPlayerThemeType()===a.THEMES.THEME_1||(this.soundManagerInstance=this.initializeAudioManager())},_jsonDataMapping:function(){var a,b,c,d,e,f,g,h,i,j,k,l="miscellaneous-screen";a=this.model.get("managerData"),c=$.extend([],a.common);for(var m in c)c[m].id===l&&(b=c[m]);e=b.elements,k=e.length,d=$.extend([],a.interactive),h=d.length;for(var n=0;h>n;n++){g=d[n].elements,i=g.length;for(var o=0;i>o;o++){f=g[o].messages,j=f.length;for(var p=0;j>p;p++)for(var q=0;k>q;q++)if(void 0!==f[p]&&null!==f[p]&&f[p].message.commonId===e[q].id){var r,s;s=e[q].messages[0].isAccTextSame?e[q].messages[0].message.loc:e[q].messages[0].message.acc,r=e[q].messages[0].message.loc,f[p].isAccTextSame?(f[p].message.loc=r,f[p].message.acc=r):"undefined"==typeof f[p].message.acc||null===f[p].message.acc?(f[p].message.loc=r,f[p].message.acc=""):"undefined"==typeof f[p].message.loc||null===f[p].message.loc?f[p].message.acc=s:(f[p].message.loc=r,f[p].message.acc=s)}}}},isHelpOpen:function(){return this._header.isHelpScreenShown},_enableDisableApplicationMode:function(a){a?$(this.el).parent().attr("role","application"):$(this.el).parent().removeAttr("role"),this._refreshDOM()},_refreshDOM:function(){var a=$("<span>",{"class":"temp-dom-refresh-span"});this.$el.append(a),a.remove()},_initializeManager:function(){var a,b,c,d,e,f,g,h=this,i=(h.model.get("jsonData"),h.model.get("managerData")),j=h.model.get("pronunciationData"),k=this.model.get("isAccessible");switch(MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile&&(k=!1),a=MathInteractives.Common.Player.Views.Player,this.getPlayerThemeType()){case a.THEMES.THEME_1:case a.THEMES.THEME_2:this.model.set("isAccessible",k)}b=new MathUtilities.Components.Manager.Models.Manager({startTabindex:this.model.get("startTabindex")||0,isAccessible:k,isWrapOn:!1,noTextMode:this.model.get("isNoTextMode"),debug:!0}),c=$.extend([],i.common),d=$.extend([],i.interactive),k&&(f=j.common,g=j.interactive,c=this.changeProunciations(c,f),d=this.changeProunciations(d,g),d=this.changeProunciations(d,f)),this.getPlayerThemeType()===a.THEMES.THEME_2&&this.fixTabDrawerFocusRects(d),b.parse(c),b.parse(d),e=new MathUtilities.Components.Manager.Views.Manager({model:b}),this._manager=e},fixTabDrawerFocusRects:function(a){var b,c;return b=a.filter(function(a){return"tab-contents"===a.id?!0:!1}),c=b[0].elements,$.each(c,function(){this.offsetTop=-4,this.offsetLeft=-4}),a},changeProunciations:function(a,b){var c,d,e,f,g,h,i,j=a,k=j.length;if(void 0!==j&&k>0)for(c=0;k>c;c++)for(f=j[c].elements.length,d=0;f>d;d++)for(g=j[c].elements[d].messages,h=g.length,e=0;h>e;e++)void 0!==g[e].isAccTextSame&&g[e].isAccTextSame===!0&&(g[e].isAccTextSame=!1,g[e].message.acc=g[e].message.loc),i=g[e].message.acc,"undefined"!=typeof i&&(g[e].message.acc=this.getOriginalMessage(i,b));return a},getOriginalMessage:function(a,b){var c,d,e,f,g,h,i,j,k=this,l=a;if(b){if(void 0!==b.sentences)for(g=b.sentences.length,i=0;g>i;i++)j=b.sentences[i],e=j.originalSentence,h=j.pronouncedSentence,new RegExp(e,"gi").test(l)&&(a=k.replaceSentence(a,e,h));if(void 0!==b.words)for(f=b.words.length,i=0;f>i;i++)j=b.words[i],c=j.originalWord,d=j.pronouncedWord,new RegExp(c,"gi").test(l)&&(a=k.replaceWord(a,c,d))}return a},replaceSentence:function(a,b,c){return a.replace(new RegExp(b,"gi"),c)},replaceWord:function(a,b,c){var d="\\b("+b+")\\b";return a.replace(new RegExp(d,"gi"),c)},render:function(){this._appendDivsToCalculateHeightWidth(),this._initializeHeader();var a=this._tabsData.length,b=null,c=this._tabsData,d=this._config,e=null,a=c.length;switch(d.themeType){case MathInteractives.global.PlayerModel.THEME1:e=a>1?"theme1-tabs":"theme1";break;case MathInteractives.global.PlayerModel.THEME2:e=a>1?"theme2-tabs":"theme2";break;default:e=a>1?"theme1-tabs":"theme1"}this.model.initializeModals(a),this._initializeInteractiveModel(),this.$(".activity-area-container").addClass(e),this._activityAreaViews=[];for(var f=0;a>f;f++)b=c[f].templateName,this._insertActivityArea(f,b,c[f].shadow,this._moduleName,e),"undefined"!=typeof d.isTwoStepLoad&&d.isTwoStepLoad||this._pushCurrentTabContent(f);if(this._tabsData.length>1&&this.getPlayerThemeType()===MathInteractives.Common.Player.Views.Player.THEMES.THEME_2){var g=this,h=this.model.get("tabCollection"),i=MathInteractives.Common.Player.Models.Player.TAB_ITEMS_START_TAB_INDEX;this._manager.unloadScreen("tab-contents",this.getIDPrefix()),this._manager.loadScreen("tab-contents",this.getIDPrefix()),h.each(function(a){g._manager.setTabIndex(a.get("id"),i),i+=10})}return this._header.model.set("interactiveModel",this.interactiveModel),d.isTwoStepLoad===!0&&(this._step2FirstLoad=!0,this.enableHeaderButtons(!1),this._pushCurrentTabContent(0)),"undefined"==typeof d.resizeTab||d.resizeTab,MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile||this.$el.css("cursor","default"),this},_attachEvents:function(){this.model.on("change:currentActiveTab",$.proxy(this._tabChangeEvent,this));var a=MathInteractives.Common.Player.Views.Player,b=this.$(".tabs-container");switch(this.getPlayerThemeType()){case a.THEMES.THEME_1:break;case a.THEMES.THEME_2:b.attr("data-html2canvas-ignore","true"),this.$el.off("click.drawerHide").on("click.drawerHide",$.proxy(function(){"0px"===b.css("left")&&this._hideDrawer()},this)),this.model.off(a.Events.SECOND_STEP_COMPLETE).on(a.Events.SECOND_STEP_COMPLETE,$.proxy(this._step2PreloadComplete,this)),this.model.off(a.Events.SECOND_STEP_PROGRESS).on(a.Events.SECOND_STEP_PROGRESS,$.proxy(this._step2PreloadProgress,this)),this.model.off(a.Events.SECOND_STEP_ERROR).on(a.Events.SECOND_STEP_ERROR,$.proxy(this._step2PreloadError,this))}this.model.off(a.Events.SAVE_STATE_ERROR).on(a.Events.SAVE_STATE_ERROR,$.proxy(this._onSaveOperationError,this)),this.model.off(a.Events.SAVE_STATE_SUCCESS).on(a.Events.SAVE_STATE_SUCCESS,$.proxy(this._onSaveOperationSuccess,this))},_appendDivsToCalculateHeightWidth:function(){var a=this.$("#text-dimentions-hack"),b=$("<div>",{id:"text-dimentions-hack-holder-wrapper","class":"de-mathematics-interactive"}),c=$("<div>",{id:"text-dimentions-hack-holder",style:"float:initial;  min-height: initial;margin-left: initial;line-height:normal;"});b.append(c),a.append(b).removeAttr("style");var d=this.$("#"+this.getIDPrefix()+"de-math-interactive-dimension-hack-div-container.de-mathematics-interactive");d=$("<div>",{id:this.getIDPrefix()+"de-math-interactive-dimension-hack-div-container","class":"de-mathematics-interactive"});var e=$("<div>",{id:this.getIDPrefix()+"de-math-interactive-hack-text-div-wrapper"}),f=$("<div>",{id:this.getIDPrefix()+"de-math-interactive-hack-text-div",style:"float:initial;  min-height: initial;margin-left: initial;line-height:normal;"});e.append(f),d.append(e);var g=$("<div>",{id:this.getIDPrefix()+"de-math-interactive-hack-dimension-div-wrapper"}),h=$("<div>",{id:this.getIDPrefix()+"de-math-interactive-hack-dimension-div",style:"float:initial;  min-height: initial;margin-left: initial;line-height:normal;"});g.append(h),d.append(g),this.$el.append(d)},_initializeHeader:function(){for(var a,b=[],c=0;c<this._tabsData.length;c++)a=this._tabsData[c].helpScreenTemplateData,void 0!==a&&null!==a&&b.push(a);var d=new MathInteractives.Common.Player.Models.Header({parentModel:this.model,helpScreenTemplates:b,moduleName:this._moduleName,path:this._path,player:this,containerId:this.model.get("containerId"),manager:this._manager}),e=new MathInteractives.Common.Player.Views.Header({model:d,el:this.$el.find(".header-container")});this.screenShotModalView=new MathInteractives.Common.Player.Views.ScreenShotModal,this._header=e,d.off("save-image").on("save-image",$.proxy(this.saveImage,this)),d.off("save-state").on("save-state",$.proxy(this.saveState,this)),d.off("tabs-drawer-click").on("tab-drawer-click",$.proxy(this._drawerAnimation,this)),d.off("help-click").on("help-click",$.proxy(this._getCurrentTab,this)),d.off("popout-click").on("popout-click",$.proxy(this._onPopoutBtnClick,this)),this.screenShotModalView.off("screenShotNameEntered").on("screenShotNameEntered",$.proxy(this.screenShotNameEntered,this))},_initializeInteractiveModel:function(){var a,b,c=this._config.model,d=this._moduleName,e=this._config.newSaveState,f=c.data||{},g=this.model.get("jsonData");"undefined"!=typeof c.module&&(d=c.module),a=c.commonInteractive===!0?MathInteractives.Common.Interactivities[d].Models[c["class"]]:MathInteractives.Interactivities[d].Models[c["class"]],"undefined"!=typeof e&&e===!0?(b=this.model.get("initialState"),("undefined"==typeof b||null===b)&&(b={}),$.extend(b,{jsonData:g,manager:this._manager,player:this,path:this._path})):b={jsonData:g,manager:this._manager,player:this,path:this._path,savedState:this.model.get("initialState")},$.extend(b,f),this.interactiveModel=new a(b)},_insertTab:function(a,b){var c=this.model.get("defaultTab"),d=this.getIDPrefix()+"player-tab-"+a,e=this._stepsData,f=null,g=[],h=0,i=this.model.get("isAccessible"),j=(this.model.get("startTabindex")||0,i?this._manager.getTabIndex(d):-1),k=MathInteractives.Common.Utilities.Models.BrowserCheck;e&&(h=this._tabsData.length-1,f=this._stepsData.show,g=this._stepsData.initialEnabledIndices);var l=new MathInteractives.Common.Player.Models.Tab({id:d,text:this._manager.getMessage(d,0),activityAreaModel:b,playerView:this,path:this._path,isStep:f,enabledTabs:g,lastTabIndex:h}),m=new MathInteractives.Common.Player.Views.Tab({model:l});if(this.tab.push(m.$el),this.$el.find(".tabs-container").append(m.$el),(k.isIE||k.isIE11)&&m.setMinWidthOfTextDiv(),this.getPlayerThemeType()===MathInteractives.Common.Player.Views.Player.THEMES.THEME_1){var n={elementId:d,tabIndex:j,role:"button",offsetTop:-4,offsetLeft:-4,acc:this._manager.getAccMessage(d,0)};this._manager.createAccDiv(n)}l.get("enable")||this._manager.enableTab(d,!1),this.model.get("tabCollection").push(l),a===c?(this.model.set("currentTabView",m),this.model.set("currentActiveTab",a)):this.updateHeaderButtonsTabIndex()},_insertActivityArea:function(a,b,c,d,e){var f=new MathInteractives.Common.Player.Models.ActivityArea({id:this.getIDPrefix()+"activity-area-"+a,shadow:c,moduleName:d,prefix:this.getIDPrefix(),path:this._path,uiClass:e});this._insertTab(a,f);var g=new MathInteractives.Common.Player.Views.ActivityArea({model:f});this.$el.find(".activity-area-container").append(g.el),this.model.get("activityAreaCollection").push(f),this._activityAreaViews.push(g)},_defaultSetupOfPlayer:function(){var a=this.model.get("currentTabView"),b=this.interactiveModel.get("initialTabsState")||[],c=this._tabsData.length;this.tabClicked(a,{silent:!0});var c=this.model.get("noOfTabs");if((1===c||this.getPlayerThemeType()===MathInteractives.Common.Player.Views.Player.THEMES.THEME_2)&&this.$el.find(".tabs-container").hide(),b.length>0)for(var d=1;c>d;d++)this.enableTab(b[d-1],d)},getIsTabSwitchAllowed:function(){return this.model.get("isTabSwitchAllowed")},setIsTabSwitchAllowed:function(a){this.model.set("isTabSwitchAllowed",a)},tabClicked:function(a,b){var c,d,e=this,f=e.getIDPrefix(),g=this.model.get("tabCollection"),h=MathInteractives.Common.Player.Views.Player.Events,i=null;if(d=this.getPlayerThemeType(),b&&b.silent||this.trigger(MathInteractives.global.PlayerModel.BEFORE_TAB_SWITCH_EVENT,a._tabNumber),this._step2FirstLoad&&!b)return this.enableAllHeaderButtons(!1),this._step2FirstLoad=!1,i=MathInteractives.Common.Components.Theme2.Views.OverviewTab.Events,this._tabToSwitchAfterPreload=a._tabNumber,this._overviewTabInstance.trigger(i.SECOND_STEP_LOAD),void(this.soundManagerInstance?this.loadAudio():this.model.trigger(h.SECOND_STEP_START));if(this.getIsTabSwitchAllowed()===!1)return void this.setIsTabSwitchAllowed(!0);if(null!==a&&g.contains(a.model)){var j=this.getPlayerThemeType()===MathInteractives.Common.Player.Views.Player.THEMES.THEME_2?1:0;g.each(function(a){a.set("active",!1),a.trigger(a.ATTACH_EVENTS,!0),c=a.id,e._manager.setAccMessage(c,e._manager.getAccMessage(c.split(f)[1],0)+" "+e._manager.getAccMessage("unSelected-tab-btn-acc-text",j))}),a.model.set("active",!0),a.model.trigger(a.model.ATTACH_EVENTS,!1),c=a.model.id,2===d&&this._enableHelpForTheme2(a._tabNumber,a.model),0===a._tabNumber&&this._step2FirstLoad!==!0&&this._manager.setFocus(f+"overview-readable-text-region"),this._handleHelpScreenVisibilityOnTabSwitch(a._tabNumber,a.model),e._manager.setAccMessage(c,e._manager.getAccMessage(c.split(f)[1],0)+" "+e._manager.getAccMessage("Selected-tab-btn-acc-text",j))}this._manager.setMessage(this.getIDPrefix()+"header-subtitle",this._manager.getMessage(c,0)),this._manager.setAccMessage(this.getIDPrefix()+"header-subtitle",this._manager.getAccMessage(c,0)),"undefined"!=typeof b&&b.silent||this._header.$(".header-tab-drawer-btn").trigger("click"),2===d&&this._header.isTabDrawerClicked&&this._hideDrawer()},selectedTabClicked:function(){this._isSelectedTabClicked=!0},switchToTab:function(a){var b,c,d=this,e=this.model.get("tabCollection"),f=this.getIDPrefix(),g=f+"player-tab-"+a,h=e.get(g),i=!0,j=MathInteractives.Common.Player.Views.Player.Events;if(c=this.getPlayerThemeType(),void 0!==h){if(this._step2FirstLoad)return this._step2FirstLoad=!1,this._tabToSwitchAfterPreload=a,void(this.soundManagerInstance?this.loadAudio():this.model.trigger(j.SECOND_STEP_START));var k=this.getPlayerThemeType()===MathInteractives.Common.Player.Views.Player.THEMES.THEME_2?1:0;e.each(function(a){return a.set("active",!1),a.trigger(a.ATTACH_EVENTS,!0),b=a.id,d._manager.setAccMessage(b,d._manager.getAccMessage(b.split(f)[1],0)+" "+d._manager.getAccMessage("unSelected-tab-btn-acc-text",k)),a.get("enable")||a.id!==g?void 0:void(i=!1)}),i?(h.set("active",!0),h.trigger(h.ATTACH_EVENTS,!1),2===c&&d._enableHelpForTheme2(a,h),d._handleHelpScreenVisibilityOnTabSwitch(a,h),this._manager.setMessage(this.getIDPrefix()+"header-subtitle",this._manager.getMessage(g,0)),this._manager.setAccMessage(this.getIDPrefix()+"header-subtitle",this._manager.getAccMessage(g,0)),b=h.id,d._manager.setAccMessage(b,d._manager.getAccMessage(b.split(f)[1],0)+" "+d._manager.getAccMessage("Selected-tab-btn-acc-text",k))):this.switchToTab(a-1)}2===c&&this._header.isTabDrawerClicked&&this._hideDrawer()},_enableHelpForTheme2:function(a,b){var c,d=a;c=0===d?!1:b.get("isHelpEnabled"),this.enableHelp(c)},_handleHelpScreenVisibilityOnTabSwitch:function(a,b){var c,d,e,f=this._header._helpView;c=a,d=b,e=d.get("isHelpScreenShown"),void 0!==f&&null!==f&&(0===c?this._header._helpView.hideHelpTooltip():(this._header._helpView.hideHelpTooltip(),e&&(this._header._helpView.showHelpTooltip(),this._header._helpBtn.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_SELECTED))))},switchToStep:function(a){this.switchToTab(a)},_pushCurrentTabContent:function(a){var b,c=this._tabsData[a],d=this._moduleName,e=null,f=null,g=null,h=this._activityAreaViews[a],i=null,j=null;if("undefined"!=typeof c.module&&(d=c.module),c.commonInteractive===!0?(b=MathInteractives.Common.Interactivities[d].templates[c.templateName],e=MathInteractives.Common.Interactivities[d].Views[c.view["class"]]):(b=MathInteractives.Interactivities[d].templates[c.templateName],e=MathInteractives.Interactivities[d].Views[c.view["class"]]),j="undefined"!=typeof c.templateData?c.templateData:{},j.idPrefix=this.getIDPrefix(),h.$el.append(b(j).trim()),f=c.view.data.el,g=this.$(f),0===g.length&&(f=f.replace(/\#/g,"#"+this.getIDPrefix()),g=this.$(f)),null!==c.overviewTabData&&void 0!==c.overviewTabData){var k={id:f.replace("#",""),idPrefix:this.getIDPrefix(),manager:this._manager,player:this,path:this._path,screenID:c.overviewTabData.screenID,leftImageContainerID:c.overviewTabData.leftImageContainerID,audioFileDataMap:this.model.get("audioFileDataMap")};null!=c.overviewTabData.focusOnHeader&&(k.focusOnHeader=c.overviewTabData.focusOnHeader);var i=MathInteractives.global.Theme2.OverviewTab,l=i.generateOverviewTab(k);this._overviewTabInstance=l}new e({el:g,model:this.interactiveModel}),this.interactiveModel.off("save-state").on("save-state",$.proxy(this.getCurrentStateData,this))},_updateInteractiveModelJsonData:function(){var a=this.model.get("jsonData");this.interactiveModel.set("jsonData",a,!0)},_step2PreloadComplete:function(b){var c=MathInteractives.Common.Components.Theme2.Views.OverviewTab.Events,d=this._overviewTabInstance;this.enableAllHeaderButtons(!0),this._updateInteractiveModelJsonData(),this._initiateRemainingInteractive(),this._config.isSaveStateCheckEnabled&&this._updatePreviousSaveState(),this.switchToTab(this._tabToSwitchAfterPreload),this.trigger(a.Events.SECOND_STEP_INTERACTIVE_LOAD_COMPLETE,b),d&&d.trigger(c.SECOND_STEP_COMPLETE,b)},_step2PreloadProgress:function(a){var b=MathInteractives.Common.Components.Theme2.Views.OverviewTab.Events,c=this._overviewTabInstance;c&&c.trigger(b.SECOND_STEP_PROGRESS,a)},_step2PreloadError:function(a){var b=MathInteractives.Common.Components.Theme2.Views.OverviewTab.Events,c=this._overviewTabInstance;c&&c.trigger(b.SECOND_STEP_ERROR,a)},_initiateRemainingInteractive:function(){var a,b=this._activityAreaViews;for(a=1;a<b.length;a++)this._pushCurrentTabContent(a)},_updatePreviousSaveState:function(a){var b="undefined"==typeof a?this.model.getCurrentActiveTab():a,c=this.model.getAttrsForSaveStateComparison()[b],d=this.interactiveModel.get("attributesToIgnore"),e=null,f=null;c?(f=JSON.parse(this.model.get("previousSaveState")),f[c]=$.extend(!0,{},this.interactiveModel.attributes[c]),e=this.model.ignoreAttrsForSaveState(f,d)):e=this.model.ignoreAttrsForSaveState($.extend(!0,{},this.interactiveModel.attributes),d),this.model.set("previousSaveState",e)},onGoButtonClicked:function(a){var b=this.getCurrentActiveTab()+1,c=MathInteractives.Common.Components.Theme2.Views.OverviewTab.Events;this._step2FirstLoad&&(this.enableAllHeaderButtons(!1),b=this.interactiveModel.get("currentTab")||b,a.trigger(c.SECOND_STEP_LOAD)),this.trigger(c.GO_BUTTON_CLICKED,a),this.isLetsGoClicked=!0,this.switchToTab(b)},getCurrentStateData:function(){this.model.trigger("save-state",{interactiveGuid:this.model.get("interactiveId")})},saveImage:function(a){this.screenShotModalView.open(a.base64Image)},screenShotNameEntered:function(a){this.model.trigger("save-image",a)},saveState:function(){this.model.trigger("save-state",{interactiveGuid:this.model.get("interactiveId")})},popoutInteractive:function(a){this.model.trigger("pop-out",{interactiveGuid:this.model.get("interactiveId"),containerId:"",data:{startover:a}})},_onSaveOperationError:function(a){this.model.rollbackSaveState(),this._generatePopupOnSaveStateError(a),this._clearTaskStack()},_onSaveOperationSuccess:function(a){this._performPendingTasks()},_addTaskToStack:function(a){return"undefined"==typeof a||null===a||"undefined"==typeof a.notification||null===a.notification?!1:(this.taskStack.push(a),!0)},_clearTaskStack:function(){this.taskStack.splice(0,this.taskStack.length)},_performPendingTasks:function(){for(var a=null;this.taskStack.length>0;)a=this.taskStack.pop(),this._performTask(a)},_performTask:function(a){if("undefined"!=typeof a&&null!==a){var b=MathInteractives.Common.Player.Views.Player.TASK_NOTIFICATIONS;switch(a.notification){case b.POPOUT_INTERACTIVE:"function"==typeof a.data&&a.data.apply()}}},_generatePopupOnSaveStateError:function(a){var b,c,d,e;switch(e=this.getManager(),e.unloadScreen("save-state-popup",this.getIDPrefix()),e.loadScreen("save-state-popup",this.getIDPrefix()),d=this.getPlayerThemeType(),Player=MathInteractives.Common.Player.Views.Player,d){case Player.THEMES.THEME_1:b={player:this,path:this._path,manager:e,idPrefix:this.getIDPrefix(),title:a.title,accTitle:a.accTitle,text:a.text,accText:a.accText,buttons:[{id:"save-state-popup-ok-btn",text:e.getMessage("save-state-popup-ok-btn",0),response:{isPositive:!0,buttonClicked:"save-state-popup-ok-btn"}}]},c=MathInteractives.global.PlayerPopup.createPopup(b);break;case Player.THEMES.THEME_2:b={title:a.title,accTitle:a.accTitle,text:a.text,accText:a.accText,manager:e,idPrefix:this.getIDPrefix(),player:this,path:this._path,type:MathInteractives.global.Theme2.PopUpBox.CONFIRM,buttons:[{id:"save-state-popup-ok-btn",text:e.getMessage("save-state-popup-ok-btn",0),response:{isPositive:!0,buttonClicked:"save-state-popup-ok-btn"}}]},c=MathInteractives.global.Theme2.PopUpBox.createPopup(b),c.$el.addClass("save-popout-feature-popup")}},_drawerAnimation:function(a,b){b?this._hideDrawer():this._showDrawer()},_showDrawer:function(){var a=this,b=this._isIE9(),c=this.$(".tabs-container");this.$(".header-tab-drawer-btn").data("isDrawerVisible",!0),b===!0?(this.$(".tabs-container").show(),c.stop().animate({left:"0px"},{duration:500,step:function(b,c){-250===c.start&&a._drawerAnimationStartCallback("show")},complete:$.proxy(function(){this._drawerAnimationCompleteCallback("show")},this)})):(c.show().off("animationstart webkitAnimationStart MSAnimationStart oAnimationStart").on("animationstart webkitAnimationStart MSAnimationStart oAnimationStart",$.proxy(function(){this._drawerAnimationStartCallback("show")},this)).addClass("tabs-container-animation"),c.off("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd").on("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",$.proxy(function(){this._drawerAnimationCompleteCallback("show")},this)).removeClass("tabs-container-animation-reverse").addClass("tabs-container-animation"))},_hideDrawer:function(){var a=this,b=this._isIE9(),c=this.$(".tabs-container");this.$(".header-tab-drawer-btn").data("isDrawerVisible",!1),b===!0?c.stop().animate({left:"-250px"},{duration:500,step:function(b,c){0===c.start&&a._drawerAnimationStartCallback("hide")},complete:$.proxy(function(){this._drawerAnimationCompleteCallback("hide")},this)}):(c.off("animationstart webkitAnimationStart MSAnimationStart oAnimationStart").on("animationstart webkitAnimationStart MSAnimationStart oAnimationStart",$.proxy(function(){this._drawerAnimationStartCallback("hide")},this)).addClass("tabs-container-animation-reverse"),c.off("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd").on("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",$.proxy(function(){this._drawerAnimationCompleteCallback("hide")},this)).removeClass("tabs-container-animation").addClass("tabs-container-animation-reverse"))},_isIE9:function(){var a=MathInteractives.Common.Utilities.Models.BrowserCheck,b=a.isIE,c=a.browserVersion,d=b===!0&&"9.0"===c;return d},_setTabContainerPosition:function(){var a=this.$(".tabs-container");a.hasClass("tabs-container-animation")?a.css("left","0px"):a.hasClass("tabs-container-animation-reverse")&&a.css("left","-250px")},_drawerAnimationCompleteCallback:function(a){var b=this._isIE9();if(this._header._drawerBtn)switch(this.model.get("tabCollection"),a){case"hide":this._header._drawerBtn.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE),this._isSelectedTabClicked&&(this._isSelectedTabClicked=!1,this._manager.setFocus(this.getIDPrefix()+"header-tab-drawer-btn",0)),this.$(".tabs-container").hide();break;case"show":this._header._drawerBtn.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_SELECTED),this._manager.setFocus(this.getIDPrefix()+"player-tab-0")}b||this._setTabContainerPosition(),this._header.enableTabDrawer(this.model.get("isDrawerButtonEnable")),this._header.enableHeaderSubtitle(!0)},_drawerAnimationStartCallback:function(a){if(this._isIE9(),this._header._drawerBtn)switch(a){case"hide":this._header._drawerBtn.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE);break;case"show":this._header._drawerBtn.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_SELECTED)}this._header.enableTabDrawer(!1),this._header.enableHeaderSubtitle(!1)},_getCurrentTab:function(){var a=this.getCurrentActiveTab();this._currentActiveTab=a;var b=this.model.get("currentTabView");b.model.set("isHelpScreenShown",this._header.isHelpScreenShown)},enableTab:function(a,b,c){var d=this.model.get("tabCollection"),e=this;if("undefined"==typeof b)d.each(function(b){b.set("enable",a),e._manager.enableTab(b.get("id"),a)});else if(d.models[b].set("enable",a),e._manager.enableTab(d.models[b].get("id"),a),c===!0)if(a===!0)for(var f=0;b>=f;f++)d.models[f].set("enable",!0),e._manager.enableTab(d.models[f].get("id"),!0);else if(a===!1)for(var g=this._tabsData.length-1,f=g;f>=b;f--)d.models[f].set("enable",!1),e._manager.enableTab(d.models[f].get("id"),!1)},enableStep:function(a,b){this.enableTab(a,b,!0)},isTabEnabled:function(a){var b=this.model.get("tabCollection"),c=b.models[a].get("enable");return c},getLastEnabledStep:function(){var a=this.model.get("tabCollection"),b=null,c=null;return a.each(function(a){a.get("enable")===!0&&(c=parseInt(a.get("id").substr(a.get("id").length-1,1),10),(null==b||c>b)&&(b=c))}),b},bindTabChange:function(a,b,c){void 0!==c&&(null===this._tabChangeData&&(this._tabChangeData={}),this._tabChangeData[c]={fnc:a,scope:b})},bindStepChange:function(a,b,c){this.bindTabChange(a,b,c)},_tabChangeEvent:function(){MathInteractives.global.SpeechStream.stopReading(),this._header.model.set("currentTemplate",null);var a=this.model.get("currentActiveTab"),b=this._tabChangeData;if(null!==b&&b.hasOwnProperty(a)){var c={currentActiveTab:a,isLetsGoClicked:this.isLetsGoClicked};b[a].fnc.apply(b[a].scope||this,[c]),this.isLetsGoClicked=!1}this.updateHeaderButtonsTabIndex()},updateHeaderButtonsTabIndex:function(){var a=this.model.get("currentActiveTab"),b="player-tab-"+(a+1),c=this.$("#"+this.getIDPrefix()+b).length>0?!0:!1,d=this._manager.getTabIndex(b);
switch(this.getPlayerThemeType()){case MathInteractives.Common.Player.Views.Player.THEMES.THEME_1:c&&d?(this._manager.setTabIndex(this.getIDPrefix()+"save-btn",d-50),this._manager.setTabIndex(this.getIDPrefix()+"screen-shot-btn",d-40),this._manager.setTabIndex(this.getIDPrefix()+"help-btn",d-30)):(this._manager.unloadScreen("theme-1-header-buttons",this.getIDPrefix()),this._manager.loadScreen("theme-1-header-buttons",this.getIDPrefix()));break;case MathInteractives.Common.Player.Views.Player.THEMES.THEME_2:this._manager.unloadScreen("theme-2-header-buttons",this.getIDPrefix()),this._manager.loadScreen("theme-2-header-buttons",this.getIDPrefix())}},enableHelp:function(a){var b,c;void 0!==a&&null!==a&&this._header.enableHelp(a),b=this.getCurrentActiveTab(),c=this.model.get("tabCollection"),currentTabModel=c.models[b],currentTabModel.set("isHelpEnabled",a)},enableHelpElement:function(a,b,c){this._header.trigger(MathInteractives.Common.Player.Views.Player.Events.TOGGLE_ELEMENT_HELP,{eleId:a,msgId:b,bEnableHelp:c})},changeHelpElementText:function(a,b,c,d){this._header.trigger(MathInteractives.Common.Player.Views.Player.Events.CHANGE_HELP_TEXT,{eleId:a,msgId:b,text:c,accText:d})},enableScreenShot:function(a){void 0!==a&&null!==a&&this._header.enableScreenShot(a)},enableSave:function(a){void 0!==a&&null!==a&&this._header.enableSave(a)},enableHeaderButtons:function(a){void 0!==a&&null!==a&&this._header.enableHeaderButtons(a)},enableAllHeaderButtons:function(a){void 0!==a&&null!==a&&(this._header.enableAllHeaderButtons(a),this.model.set("isDrawerButtonEnable",a))},changeHelpScreen:function(a){this._header.model.set("currentTemplate",a)},applyShowCallbackForHelpScreen:function(a){this._header.model.set("helpScreenShowCallback",a)},applyCloseCallbackForHelpScreen:function(a){this._header.model.set("helpScreenCloseCallback",a)},getIDPrefix:function(){return this.model.get("prefix")},getManager:function(){return this._manager},getSoundManager:function(){return this.soundManagerInstance},getPath:function(){return this._path},_restrictTextSelection:function(){MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile||(this.$el[0].onselectstart=function(a){var b,c=a.target.nodeName.toLowerCase();return a.target.type&&(b=a.target.type.toLowerCase()),"input"!=c&&"text"!=b&&"textarea"!=c?!1:void 0})},getModalPresent:function(){return this.model.getModalPresent()},setModalPresent:function(a){this.model.setModalPresent(a)},getIsMuted:function(){return this._header.model.get("isMuted")},setIsMuted:function(a){this._header.model.set("isMuted",a)},getCurrentActiveTab:function(){return this.model.getCurrentActiveTab()},_adjustTabWidth:function(){var a,b,c=this._tabsData.length;if(!(1>=c))for(var d=1;c>d;d++){var e=this.tab[d].find(".tab-mid"),f=this.tab[d-1].find(".tab-mid");if(a=e.width(),b=f.width(),0===a)if(a>b)for(var g=d-1;g>=0;g--)this.tab[g].find(".tab-mid").width(a);else this.tab[d].find(".tab-mid").width(b)}},isSaveStateAllowed:function(){return"undefined"!=typeof this._config.isSaveStateAllowed?this._config.isSaveStateAllowed:!0},isPoppedOut:function(){return this.model.get("isPoppedOut")},isMuteUnmuteShow:function(){return this._config.showMute||!1},getTextHeightWidth:function(a,b,c,d){var e={height:0,width:0},f=this.$("#"+this.getIDPrefix()+"de-math-interactive-dimension-hack-div-container").find("#"+this.getIDPrefix()+"de-math-interactive-hack-text-div-wrapper").addClass(d),g=f.find("#"+this.getIDPrefix()+"de-math-interactive-hack-text-div").addClass(b).html(a);return c&&g.attr("style",c),a&&""!==a&&(e.height=g.getTextHeight(),e.width=g.getTextWidth()),g.html("").removeClass(b),g.removeAttr("style"),f.removeClass(d),e},getDivHeightWidth:function(a,b,c,d){var e={height:0,width:0},f=this.$("#"+this.getIDPrefix()+"de-math-interactive-dimension-hack-div-container").find("#"+this.getIDPrefix()+"de-math-interactive-hack-dimension-div-wrapper").addClass(d),g=f.find("#"+this.getIDPrefix()+"de-math-interactive-hack-dimension-div").addClass(b).html(a);return c&&g.attr("style",c),e.height=g.height(),e.width=g.width(),g.html("").removeClass(b),g.removeAttr("style"),f.removeClass(d),e},getPlayerThemeType:function(){var a=this._config.playerTheme;return"undefined"==typeof a||null===a?MathInteractives.Common.Player.Views.Player.THEMES.THEME_1:a},hideTheme2Help:function(a){var b=this.model.get("tabCollection"),c=this.getIDPrefix()+"player-tab-"+a,d=b.get(c);d.set("isHelpScreenShown",!1),this._handleHelpScreenVisibilityOnTabSwitch(a,d)},getJson:function(a){var b=this.model.get("jsonData");return b&&b[a]?b[a].data:null},initializeAudioManager:function(){var a=this.model.get("audioFileDataMap"),b=(Object.keys(a).length,null),c=null,d=null;for(b in a)d=$.extend({},a[b]),d.player=this,d.displayPreloader=!1,d.audioSpriteId||(d.audioSpriteId=[]),d.audioSpriteId.push(b),d.isTheme2=!0,c=MathInteractives.global.AudioManager.initAudioManager(d),a[b].instance=c;return c},loadAudio:function(){this.listenToOnce(this.soundManagerInstance,MathInteractives.Common.Components.Views.AudioManager.AUDIO_EVENT.LOAD_COMPLETE,function(){this.model.trigger(MathInteractives.Common.Player.Views.Player.Events.SECOND_STEP_START)}),this.soundManagerInstance.load()},_onPopoutBtnClick:function(){var a=this.isSaveStateAllowed()===!0?!0:!1,b=this._config.isSaveStateCheckEnabled?this.interactiveModel.compareSavedState():!1;a&&b||this._step2FirstLoad===!0?this.popoutInteractive(this._step2FirstLoad):this._generatePopupOnPopoutClick(a)},_generatePopupOnPopoutClick:function(a){var b,c,d,e,f,g,h=this,i=this.getManager(),j=this.getIDPrefix();switch(i.unloadScreen("pop-out-popup",j),i.loadScreen("pop-out-popup",j),d=this.getPlayerThemeType(),Player=MathInteractives.Common.Player.Views.Player,a?(e=[{id:"popout-save-and-proceed-btn",text:i.getMessage("popout-save-and-proceed-btn",0),response:{isPositive:!1,buttonClicked:"popout-save-and-proceed-btn"}},{id:"popout-start-over-btn",text:i.getMessage("popout-start-over-btn",0),response:{isPositive:!0,buttonClicked:"popout-start-over-btn"}}],f={fnc:function(a){if(a.isPositive)this.popoutInteractive(!0);else{var b=MathInteractives.Common.Player.Views.Player;h._addTaskToStack({notification:b.TASK_NOTIFICATIONS.POPOUT_INTERACTIVE,data:$.proxy(function(){this.popoutInteractive(!1)},h)}),h.saveState()}},scope:h},g=1):(e=[{id:"popout-proceed-btn",text:i.getMessage("popout-proceed-btn",0),response:{isPositive:!0,buttonClicked:"popout-proceed-btn"}},{id:"popout-cancel-btn",text:i.getMessage("pop-up-no-btn-text",0),response:{isPositive:!1,buttonClicked:"popout-cancel-btn"}}],f={fnc:function(a){a.isPositive&&this.popoutInteractive(!0)},scope:h},g=2),d){case Player.THEMES.THEME_1:b={player:this,path:this._path,manager:i,idPrefix:j,title:i.getMessage("theme1-popout-popup",0),accTitle:i.getAccMessage("theme1-popout-popup",0),text:i.getMessage("theme1-popout-popup",g),accText:i.getAccMessage("theme1-popout-popup",g),buttons:e,closeCallback:f},c=MathInteractives.global.PlayerPopup.createPopup(b);break;case Player.THEMES.THEME_2:b={title:i.getMessage("theme2-popout-popup",0),accTitle:i.getAccMessage("theme2-popout-popup",0),text:i.getMessage("theme2-popout-popup",g),accText:i.getAccMessage("theme2-popout-popup",g),manager:i,idPrefix:j,player:this,path:this._path,type:MathInteractives.global.Theme2.PopUpBox.CONFIRM,buttons:e,closeCallback:f},c=MathInteractives.global.Theme2.PopUpBox.createPopup(b),c.$el.addClass("save-popout-feature-popup"),i.updateFocusRect(j+"theme2-pop-up-text")}}},{THEMES:{THEME_1:1,THEME_2:2},Events:{SECOND_STEP_START:"step-2-preload-start",SECOND_STEP_PROGRESS:"step-2-preload-progress",SECOND_STEP_COMPLETE:"step-2-preload-complete",SECOND_STEP_ERROR:"step-2-preload-error",TOGGLE_ELEMENT_HELP:"theme2-enable-element-help",HELP_CLICKED:"help-click",CHANGE_HELP_TEXT:"theme2-change-text-element-help",SAVE_STATE_ERROR:"save-state-error",SAVE_STATE_SUCCESS:"save-state-success",SECOND_STEP_INTERACTIVE_LOAD_COMPLETE:"step-2-interactive-load-complete",MUTE_CLICKED:"mute-click",UNMUTE_CLICKED:"unmute-click",UNLOAD_INTERACTIVE:"unload-interactive",SCREENSHOT_START:"screenshot-start",SCREENSHOT_END:"screenshot-end"},TASK_NOTIFICATIONS:{POPOUT_INTERACTIVE:1}})}(),function(){MathInteractives.Common.Player.Views.Header||(MathInteractives.Common.Player.Views.Header=Backbone.View.extend({el:".header-container",_helpBtn:null,_drawerBtn:null,_screenShotBtn:null,_saveBtn:null,_unmuteBtn:null,_muteBtn:null,idPrefix:null,path:null,player:null,manager:null,_helpView:null,Button:null,isHelpScreenShown:!1,isTabDrawerClicked:!1,events:{},initialize:function(){this.path=this.model.get("path"),this.player=this.model.get("player"),this.manager=this.model.get("manager"),this.idPrefix=this.model.get("parentModel").get("prefix"),this.manager.loadScreen("player-header",this.idPrefix),this.render(),this._attachEvents()},initTheme2Help:function(){var a=this.player.getPlayerThemeType(),b=MathInteractives.Common.Player.Views.Player,c=this.model.get("interactiveModel");a===b.THEMES.THEME_2&&c&&c.get("helpElements")&&MathInteractives.Common.Components.Theme2.Views.Help&&(this._helpView=MathInteractives.Common.Components.Theme2.Views.Help.generateHelpScreen({player:this.player,manager:this.manager,idPrefix:this.idPrefix,filePath:this.path,helpElements:c.get("helpElements")}),this._helpView.hideHelpTooltip())},render:function(){var a,b;b=this.model.get("buttons");var c=this.player.getPlayerThemeType(),d=MathInteractives.Common.Player.Views.Player;switch(c){case d.THEMES.THEME_2:c=!0,a=b.theme2,this.Button=MathInteractives.Common.Components.Theme2.Views.Button;break;default:this.Button=MathInteractives.Common.Components.Views.Button,c=!1,a=b.theme1}var e=a,f={headerButtons:e,idPrefix:this.idPrefix,playerTheme:c},g=MathInteractives.Common.Player.templates.header(f).trim(),h=this.$el;return h.find(".header-content").append(g),c?(this._renderHeaderButtonsTheme2(),this.manager.loadScreen("theme-2-header-subtitle",this.idPrefix)):(h.find(".header-left, .header-right").css({"background-image":'url("'+this.path.getImagePath("player-lr")+'")'}),h.find(".header-middle").css({"background-image":'url("'+this.path.getImagePath("player-m")+'")'}),this._renderHeaderButtonsTheme1()),this},_attachEvents:function(){null!==this._screenShotBtn&&this._screenShotBtn.$el.off("click.capture").on("click.capture",$.proxy(this._captureScreen,this)),this.enableHelp(!0),this.enableSave(!0),this.enablePopOut(!0),this.enableTabDrawer(!0),this.enableHeaderSubtitle(!0),this.enableMuteUnmuteButton(!0);var a=this;this.on(MathInteractives.Common.Player.Views.Player.Events.TOGGLE_ELEMENT_HELP,function(b){a._helpView&&a._helpView.trigger(MathInteractives.Common.Player.Views.Player.Events.TOGGLE_ELEMENT_HELP,b)}),this.on(MathInteractives.Common.Player.Views.Player.Events.CHANGE_HELP_TEXT,function(b){a._helpView&&a._helpView.trigger(MathInteractives.Common.Player.Views.Player.Events.CHANGE_HELP_TEXT,b)})},_drawerBtnClick:function(a){MathInteractives.global.SpeechStream.stopReading(),this.isTabDrawerClicked=!0,a.stopPropagation();var b,c=this._drawerBtn.$el;b=c.data("isDrawerVisible"),b?c.data("isDrawerVisible",!1):c.data("isDrawerVisible",!0),this.model.trigger("tab-drawer-click",a,b)},enableTabDrawer:function(a){null!==this._drawerBtn&&"undefined"!=typeof this._drawerBtn&&(this._drawerBtn.$el.off("click.drawerBtn"),this._drawerBtn.setButtonState(this.Button.BUTTON_STATE_DISABLED),a&&(this._drawerBtn.$el.on("click.drawerBtn",$.proxy(this._drawerBtnClick,this)),this._drawerBtn.setButtonState(this.Button.BUTTON_STATE_ACTIVE)))},enableHeaderSubtitle:function(a){var b=this.$(".header-subtitle");b.off("click.headerSubTitle"),b.off("mouseenter"),b.off("mouseleave"),a&&(b.on("mouseenter",$.proxy(function(a){b.addClass("hover")},this)),b.on("mouseleave",$.proxy(function(a){b.removeClass("hover")},this)),b.on("click.headerSubTitle",$.proxy(function(a){a.stopPropagation(),b.removeClass("hover"),MathInteractives.global.SpeechStream.stopReading(),null!==this._drawerBtn&&"undefined"!=typeof this._drawerBtn&&this.model.trigger("tab-drawer-click",a,this._drawerBtn.$el.data("isDrawerVisible"))},this)),MathInteractives.Common.Utilities.Models.Utils.EnableTouch(b,{specificEvents:MathInteractives.Common.Utilities.Models.Utils.SPECIFIC_EVENTS.HOVER}))},enableMuteUnmuteButton:function(a){return null===this._muteBtn||null===this._unmuteBtn?!1:(this._unmuteBtn.$el.off("click.mute"),this._muteBtn.$el.off("click.mute"),this._unmuteBtn.setButtonState(this.Button.BUTTON_STATE_DISABLED),this._muteBtn.setButtonState(this.Button.BUTTON_STATE_DISABLED),void(a&&(this._unmuteBtn.$el.on("click.mute",$.proxy(this._unMuteClick,this)),this._muteBtn.$el.on("click.mute",$.proxy(this._muteClick,this)),this._unmuteBtn.setButtonState(this.Button.BUTTON_STATE_ACTIVE),this._muteBtn.setButtonState(this.Button.BUTTON_STATE_ACTIVE))))},enableHeaderButtons:function(a){this.enableHelp(a),this.enableSave(a),this.enableScreenShot(a),this.enableMuteUnmuteButton(a)},enableAllHeaderButtons:function(a){this.enableHelp(a),this.enableSave(a),this.enableScreenShot(a),this.enableMuteUnmuteButton(a),this.enableTabDrawer(a),this.enablePopOut(a),this.enableHeaderSubtitle(a)},_renderHeaderButtonsTheme2:function(){var a={data:{id:this.idPrefix+"help-btn",type:this.Button.TYPE.HELP,colorType:this.Button.COLORTYPE.HEADER_BLUE,tooltipText:this.manager.getMessage(this.idPrefix+"help",0)},path:this.path,player:this.player,manager:this.manager,idPrefix:this.idPrefix},b=MathInteractives.global.Theme2.Button.generateButton(a);if(this._helpBtn=b,this.player.isMuteUnmuteShow()&&!MathInteractives.Common.Utilities.Models.BrowserCheck.isIOS){var c={data:{id:this.idPrefix+"mute-btn",type:this.Button.TYPE.MUTE,colorType:this.Button.COLORTYPE.HEADER_BLUE,tooltipText:this.manager.getMessage(this.idPrefix+"mute",0),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.BOTTOM_LEFT},path:this.path,player:this.player,manager:this.manager,idPrefix:this.idPrefix},d=MathInteractives.global.Theme2.Button.generateButton(c);this._muteBtn=d;var e={data:{id:this.idPrefix+"unmute-btn",type:this.Button.TYPE.UNMUTE,colorType:this.Button.COLORTYPE.HEADER_BLUE,tooltipText:this.manager.getMessage(this.idPrefix+"unmute",0),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.BOTTOM_LEFT},path:this.path,player:this.player,manager:this.manager,idPrefix:this.idPrefix},f=MathInteractives.global.Theme2.Button.generateButton(e);this._unmuteBtn=f,this._unmuteBtn.hideButton()}else this.$("#"+this.idPrefix+"mute-btn, #"+this.idPrefix+"unmute-btn").remove();var g={data:{id:this.idPrefix+"screen-shot-btn",type:this.Button.TYPE.CAMERA,colorType:this.Button.COLORTYPE.HEADER_BLUE,tooltipText:this.manager.getMessage(this.idPrefix+"screenshot",0)},path:this.path,player:this.player,manager:this.manager,idPrefix:this.idPrefix},h=this.player.isPoppedOut();if(h===!1){var i={data:{id:this.idPrefix+"pop-out-btn",type:this.Button.TYPE.POP_OUT,colorType:this.Button.COLORTYPE.HEADER_BLUE,tooltipText:this.manager.getMessage(this.idPrefix+"pop-out",0)},path:this.path,player:this.player,manager:this.manager,idPrefix:this.idPrefix};this.player.isMuteUnmuteShow()||(i.data.tooltipType=MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.BOTTOM_LEFT_CENTER);var j=MathInteractives.global.Theme2.Button.generateButton(i);this._popOutBtn=j}else this.$("#"+this.idPrefix+"pop-out-btn").remove(),this.player.isMuteUnmuteShow()||(g.data.tooltipType=MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.BOTTOM_LEFT);if(this.$("#"+this.idPrefix+"screen-shot-btn").length>0){var k=MathInteractives.global.Theme2.Button.generateButton(g);this._screenShotBtn=k}var l={player:this.player,manager:this.manager,path:this.path,idPrefix:this.idPrefix,data:{id:this.idPrefix+"header-tab-drawer-btn",type:MathInteractives.global.Theme2.Button.TYPE.DRAWER,colorType:MathInteractives.global.Theme2.Button.COLORTYPE.DRAWER,tooltipText:this.manager.getMessage(this.idPrefix+"drawer",0),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.BOTTOM_RIGHT,borderRadius:0}};this._drawerBtn=this.Button.generateButton(l);var m=this.player.isSaveStateAllowed(),n=this.$("#"+this.idPrefix+"save-btn").length;if(m===!0&&n>0){var o={player:this.player,manager:this.manager,path:this.path,idPrefix:this.idPrefix,data:{id:this.idPrefix+"save-btn",type:MathInteractives.global.Theme2.Button.TYPE.SAVE,colorType:this.Button.COLORTYPE.HEADER_BLUE}},p=MathInteractives.global.Theme2.Button.generateButton(o);this._saveBtn=p}else n>0&&this.$("#"+this.idPrefix+"save-btn").remove()},_unMuteClick:function(){MathInteractives.global.SpeechStream.stopReading(),this._unmuteBtn.hideButton(),this._muteBtn.showButton(),this.manager.setFocus(this.idPrefix+"mute-btn"),this.model.set("isMuted",!1),this.player.trigger(MathInteractives.Common.Player.Views.Player.Events.UNMUTE_CLICKED)},_muteClick:function(){MathInteractives.global.SpeechStream.stopReading(),this._unmuteBtn.showButton(),this._muteBtn.hideButton(),this.manager.setFocus(this.idPrefix+"unmute-btn"),this.model.set("isMuted",!0),this.player.trigger(MathInteractives.Common.Player.Views.Player.Events.MUTE_CLICKED)},_renderHeaderButtonsTheme1:function(){var a={id:this.idPrefix+"help-btn",type:this.Button.TYPE.HELP,tooltipText:this.manager.getMessage(this.idPrefix+"help",0),path:this.path,player:this.player,manager:this.manager},b=MathInteractives.global.Button.generateButton(a);if(this._helpBtn=b,this.$("#"+this.idPrefix+"screen-shot-btn").length>0){var c={id:this.idPrefix+"screen-shot-btn",type:this.Button.TYPE.CAMERA,tooltipText:this.manager.getMessage(this.idPrefix+"screenshot",0),path:this.path,player:this.player,manager:this.manager},d=MathInteractives.global.Button.generateButton(c);this._screenShotBtn=d}var e=this.player.isSaveStateAllowed(),f=this.$("#"+this.idPrefix+"save-btn").length;if(e===!0&&f>0){var g={id:this.idPrefix+"save-btn",type:this.Button.TYPE.SAVE,path:this.path,manager:this.manager,player:this.player,idPrefix:this.idPrefix,displayType:"both",iConPosition:"right"},h=MathInteractives.global.Button.generateButton(g);this._saveBtn=h}else f>0&&this.$("#"+this.idPrefix+"save-btn").remove()},enablePopOut:function(a){null!==this._popOutBtn&&"undefined"!=typeof this._popOutBtn&&(this._popOutBtn.$el.off("click"),this._popOutBtn.setButtonState(this.Button.BUTTON_STATE_DISABLED),a&&(this._popOutBtn.$el.on("click",$.proxy(this._popoutActivity,this)),this._popOutBtn.setButtonState(this.Button.BUTTON_STATE_ACTIVE)))},enableHelp:function(a){this._helpBtn.$el.off("click.help"),this._helpBtn.setButtonState(this.Button.BUTTON_STATE_DISABLED),a&&(this._helpBtn.$el.on("click.help",$.proxy(this._showHelp,this)),this._helpBtn.setButtonState(this.Button.BUTTON_STATE_ACTIVE))},enableScreenShot:function(a){null!==this._screenShotBtn&&(this._screenShotBtn.$el.off("click.capture"),this._screenShotBtn.setButtonState(this.Button.BUTTON_STATE_DISABLED),a&&(this._screenShotBtn.$el.on("click.capture",$.proxy(this._captureScreen,this)),this._screenShotBtn.setButtonState(this.Button.BUTTON_STATE_ACTIVE)))},enableSave:function(a){null!==this._saveBtn&&(this._saveBtn.$el.off("click.save"),this._saveBtn.setButtonState(this.Button.BUTTON_STATE_DISABLED),a&&(this._saveBtn.$el.off("click.save").on("click.save",$.proxy(this._saveModelState,this)),this._saveBtn.setButtonState(this.Button.BUTTON_STATE_ACTIVE)))},_showHelp:function(a){var b,c=(this.model.helpText,this.player.getPlayerThemeType()),d=MathInteractives.Common.Player.Views.Player;if(this.model.get("interactiveModel"),MathInteractives.global.SpeechStream.stopReading(),c===d.THEMES.THEME_2)return this._helpView&&(this._helpView.toggleHelpView(),b=this._helpView.toggle,this.isHelpScreenShown=b),this.isHelpScreenShown?this._helpBtn.setButtonState(this.Button.BUTTON_STATE_SELECTED):(this._helpBtn.setButtonState(this.Button.BUTTON_STATE_ACTIVE),this.manager.setFocus(this.idPrefix+"help-btn")),this.model.trigger("help-click"),this.player.trigger(MathInteractives.Common.Player.Views.Player.Events.HELP_CLICKED,b),void this.player.setModalPresent(b);this.enableHelp(!1);var e=this.model.get("currentTemplate");this._showHelpScreen(e)},_captureScreen:function(){MathInteractives.global.SpeechStream.stopReading();var a=this,b=MathInteractives.Common.Player.Views.Player;a.player.trigger(b.Events.SCREENSHOT_START);var c=$("<div>",{"class":"screen-shot-modal","data-html2canvas-ignore":"true"});a.player.$el.append(c),a.player.setModalPresent(!0),setTimeout(function(){MathInteractives.global.SpeechStream.stopReading(),MathInteractives.Common.Utilities.Models.ScreenUtils.init(),MathInteractives.Common.Utilities.Models.ScreenUtils.getScreenShot({container:a.player.$el,type:MathInteractives.Common.Utilities.Models.ScreenUtils.types.BASE64,background:"transparent",useCORS:!0,complete:function(d){a.model.trigger("save-image",{base64Image:d}),a.player.trigger(b.Events.SCREENSHOT_END),c.remove(),a.player.setModalPresent(!1)}})},50)},_saveModelState:function(){MathInteractives.global.SpeechStream.stopReading(),this.model.trigger("save-state")},_showHelpScreen:function(a){MathInteractives.global.SpeechStream.stopReading(!1);var b=this.$el.parent(),c=this.model.get("helpScreenTemplates"),d=this.model.get("parentModel").get("currentActiveTab"),e=c[d].template,f={idPrefix:this.idPrefix},g=c[d].templateImages,h=c[d].accTextElemId,i=this.model.get("moduleName"),j=this.model.get("helpScreenShowCallback");null!==a&&(e=a.template,g=a.templateImages,h=a.accTextElemId),b.find(".help-screen").remove();var k=$("<div>",{"class":"help-screen"}),l=$("<div>",{"class":"help-screen-content"}).appendTo(k),m=$("<div>",{id:this.idPrefix+"help-screen-acc-div","class":"help-screen-acc-div"}).appendTo(k),n=$("<div>",{"class":"help-screen-close-btn",id:this.idPrefix+"help-screen-close-btn"}).appendTo(k);if(null!==j&&j.fnc.apply(j.scope||this),n.on("click.helpScreenClose",$.proxy(this._helpScreenCloseButtonClick,this)),c.length>0){b.append(k),m.css({height:l.height()-10-this.$el.height(),width:l.width()-10}),void 0!==e&&l.append(MathInteractives.Interactivities[i].templates[e](f).trim());var o;for(var p in g)o=$("#"+this.idPrefix+g[p]),o.length>0&&o.css({"background-image":'url("'+this.path.getImagePath(g[p])+'")'});MathInteractives.global.Button.generateButton({id:this.idPrefix+"help-screen-close-btn",type:this.Button.TYPE.GENERAL,path:this.path,fixedMinWidth:!0,text:this.manager.getMessage(this.idPrefix+"help-screen-close-btn-text",0)}),this.player.setModalPresent(!0)}else{var q=new MathInteractives.Common.Player.Models.PopUp({text:text,callback:callback,isConfirmBox:isConfirmBox});new MathInteractives.Common.Player.Views.PopUp({model:q})}if(this.manager.loadScreen("help-modal-screen",this.idPrefix),h){var r=this.manager.getAccMessage(this.idPrefix+h,"0");this.manager.setAccMessage(this.idPrefix+"help-screen-acc-div",r),this.manager.setFocus(this.idPrefix+"help-screen-acc-div")}$("#"+this.idPrefix+"help-screen-acc-div").bind("keydown",$.proxy(function(a){9===a.keyCode&&a.shiftKey&&(a.preventDefault(),this.manager.setFocus(this.idPrefix+"heading"))},this)),this.$("#"+this.idPrefix+"heading").bind("keydown",$.proxy(function(a){return a.target.parentNode!==a.currentTarget?!0:void(9!==a.keyCode||a.shiftKey||(a.stopPropagation(),a.preventDefault(),this.manager.setFocus(this.idPrefix+"help-screen-acc-div")))},this))},_helpScreenCloseButtonClick:function(){$("#"+this.idPrefix+"help-screen-acc-div").unbind("keydown"),this.$("#"+this.idPrefix+"heading").unbind("keydown"),MathInteractives.global.SpeechStream.stopReading(),this.$el.parent().find(".help-screen").remove(),this.enableHelp(!0);var a=this.model.get("helpScreenCloseCallback");null!==a&&a.fnc.apply(a.scope||this),this.player.setModalPresent(!1),this.manager.setFocus(this.idPrefix+"help-btn")},_popoutActivity:function(){MathInteractives.global.SpeechStream.stopReading(),this.model.trigger("popout-click")}},{}))}(),function(){MathInteractives.Common.Player.Views.Tab||(MathInteractives.Common.Player.Views.Tab=Backbone.View.extend({_path:null,_tabNumber:null,player:null,playerTheme:null,initialize:function(){var a=this,b=this.model.get("id");this._tabNumber=parseInt(b.slice(b.search("player-tab-")+11),10),this.player=this.model.get("playerView"),this._path=this.player.getPath(),this.playerTheme=this.player.getPlayerThemeType(),Backbone.listenTo(this.model,"change:active",$.proxy(this._changeActivityAreaState,this)),Backbone.listenTo(this.model,"change:enable",$.proxy(this._enableDisableTab,this)),Backbone.listenTo(this.model,this.model.ATTACH_EVENTS,$.proxy(this._attachEvents,this)),a.render()},render:function(){this.$el.addClass("tabs tabs"+this._tabNumber).attr({id:this.model.get("id")});var a=this.player.model.get("isAccessible"),b=MathInteractives.Common.Player.Views.Player;return a&&this.$el.addClass("math-utilities-manager-access"),this.playerTheme===b.THEMES.THEME_1&&this._generateThreeSplice(),this._attachEvents(!0),this._setDisabledSteps(),this},setMinWidthOfTextDiv:function(){var a=this.$(".tab-mid");a.css("min-width",a.width())},_generateThreeSplice:function(){var a=this.$el,b=this.model.get("isStep");if($("<div/>").addClass("tab-left").appendTo(a),$("<div/>").addClass("tab-mid").appendTo(a).html(this.model.get("text")),$("<div/>").addClass("tab-right").appendTo(a),this.$(".tab-left, .tab-right").css({"background-image":'url("'+this._path.getImagePath("player-lr")+'")'}),this.$(".tab-mid").css({"background-image":'url("'+this._path.getImagePath("player-m")+'")'}),b){var c=this.model.get("lastTabIndex"),d=c-this._tabNumber+1;this.$(".tab-left").addClass("step-left"),this.$(".tab-mid").addClass("step-mid"),$("<div/>").addClass("step-circle").css({"background-image":'url("'+this._path.getImagePath("player-lr")+'")'}).html(this._tabNumber+1).appendTo(this.$(".tab-mid")),this.$(".tab-right").addClass("step-right"),this._tabNumber===c&&this.$(".tab-right").addClass("last-step"),a.css({"z-index":d,border:"none"}),this._tabNumber>0&&a.css({"margin-left":"-14px"})}},_generateSingleSpliceTab:function(){this.$el.html(this.model.get("text"))},_attachEvents:function(a){this.$el.off("click.playerTab click.playerSelectedTab mouseover.playerTab mouseout.playerTab");var b=this;this.touchStartTimer=null,a?(this.$el.off("mouseover.playerTab").on("mouseover.playerTab",function(){b.model.get("enable")&&b._addClass("tab-hover")}),this.$el.off("mouseleave.playerTab").on("mouseleave.playerTab",function(){b.model.get("enable")&&b._removeClass("tab-hover")}),this.$el.off("click.playerTab").on("click.playerTab",$.proxy(this._clickHandler,this)),MathInteractives.Common.Utilities.Models.Utils.EnableTouch($(this.$el),{specificEvents:MathInteractives.Common.Utilities.Models.Utils.SPECIFIC_EVENTS.HOVER})):this.$el.on("click.playerSelectedTab",$.proxy(this._selectedClickHandler,this))},_clickHandler:function(a){this.model.get("enable")&&this.player.tabClicked(this)},_selectedClickHandler:function(a){this.player.selectedTabClicked(this)},_changeActivityAreaState:function(){var a=this.model.get("activityAreaModel"),b=this.model.get("active"),c=this.$el;a.set("show",b),b===!0?(this.player.model.set("currentTabView",this),this.player.model.set("currentActiveTab",parseInt(this.model.get("id").substr(this.model.get("id").length-1,1),10)),this._removeClass("tab-hover"),this._addClass("tab-active"),c.find(".acc-read-elem").removeAttr("role"),c.addClass("tab-selected")):b===!1&&(this._removeClass("tab-active tab-hover"),c.find(".acc-read-elem").attr("role","button"),c.removeClass("tab-selected"))},_enableDisableTab:function(){var a=this.model.get("enable");a?this.$el.removeClass("step-disabled tab-disabled"):this.$el.addClass("tab-disabled"),this._attachEvents(a)},_setDisabledSteps:function(){var a=(this.model.get("id"),this._tabNumber),b=this.model.get("enabledTabs"),c=!1;if(b.length>0){for(var d=b.length,e=0;d>e;e++)b[e]===a&&(c=!0);c||(this.model.set("enable",!1),this.$el.hasClass("tab-disabled")||this.$el.addClass("tab-disabled"))}},_addClass:function(a){var b=MathInteractives.Common.Player.Views.Player;switch(this.playerTheme){case b.THEMES.THEME_1:this.$(".tab-right,.tab-left,.tab-mid").addClass(a);break;case b.THEMES.THEME_2:this.$el.addClass(a)}},_removeClass:function(a){var b=MathInteractives.Common.Player.Views.Player;switch(this.playerTheme){case b.THEMES.THEME_1:this.$(".tab-right,.tab-left,.tab-mid").removeClass(a);break;case b.THEMES.THEME_2:this.$el.removeClass(a)}}},{}))}(),function(){MathInteractives.Common.Player.Views.ActivityArea||(MathInteractives.Common.Player.Views.ActivityArea=Backbone.View.extend({_path:null,initialize:function(){this._path=this.model.get("path"),Backbone.listenTo(this.model,"change:show",$.proxy(this._showActivityArea,this)),this.render()},render:function(){var a=(this.model.get("templateName"),this.model.get("moduleName"),this.model.get("uiClass"));this.$el.addClass("activity-area "+a).attr({id:this.model.get("id")});var b=this.model.get("shadow");if("undefined"!=typeof b&&b===!0){var c=$("<div>",{"class":"top-left-shadow-image"}).css({"background-image":'url("'+this._path.getImagePath("corner-shadows")+'")',"background-position":"0px -42px"}),d=$("<div>",{"class":"top-middle-shadow-image"}).css({"background-image":'url("'+this._path.getImagePath("top-shadow")+'")'}),e=$("<div>",{"class":"top-right-shadow-image"}).css({"background-image":'url("'+this._path.getImagePath("corner-shadows")+'")',"background-position":"0px -63px"}),f=$("<div>",{"class":"middle-left-shadow-image"}).css({"background-image":'url("'+this._path.getImagePath("left-shadow")+'")'}),g=$("<div>",{"class":"middle-right-shadow-image"}).css({"background-image":'url("'+this._path.getImagePath("right-shadow")+'")'}),h=$("<div>",{"class":"bottom-left-shadow-image"}).css({"background-image":'url("'+this._path.getImagePath("corner-shadows")+'")',"background-position":"0px 0px"}),i=$("<div>",{"class":"bottom-right-shadow-image"}).css({"background-image":'url("'+this._path.getImagePath("corner-shadows")+'")',"background-position":"0px -21px"}),j=$("<div>",{"class":"bottom-middle-shadow-image"}).css({"background-image":'url("'+this._path.getImagePath("bottom-shadow")+'")'});this.$el.append(c,d,e,f,g,h,j,i)}return this},_showActivityArea:function(){var a=this.model.get("show");a===!0?(this.$el.show(),this.$el.removeAttr("data-html2canvas-ignore")):(this.$el.hide(),this.$el.attr("data-html2canvas-ignore","true"))}},{}))}(),function(){"use strict";MathInteractives.Common.Player.Collections.ActivityAreas=Backbone.Collection.extend({model:MathInteractives.Common.Player.Models.ActivityArea})}(),function(){"use strict";MathInteractives.Common.Player.Collections.Tabs=Backbone.Collection.extend({model:MathInteractives.Common.Player.Models.Tab})}(),function(){"use strict";MathInteractives.Common.Player.Models.CanvasItem=Backbone.Model.extend({defaults:function(){return{tabindex:null,paperItem:null}},initialize:function(a){this.set("canvasAccId",a)}})}(),function(){"use strict";MathInteractives.Common.Player.Collections.CanvasItems=Backbone.Collection.extend({model:MathInteractives.Common.Player.Models.CanvasItem,currentItem:null,initialize:function(){},getCurrentItem:function(){return this.currentItem},getCurrentItemIndex:function(){return this.indexOf(this.getCurrentItem("currentItem"))},setCurrentItem:function(a){"undefined"==typeof a&&(a=null),this.currentItem=a},next:function(){var a=null;return a=this.at(this.indexOf(this.getCurrentItem("currentItem"))+1),this.setCurrentItem(a),a},prev:function(){var a=null;return a=this.at(this.indexOf(this.getCurrentItem("currentItem"))-1),this.setCurrentItem(a),a},hasNext:function(){var a=!1,b=this.indexOf(this.getCurrentItem("currentItem"))+1;return b>0&&b<this.length&&(a=!0),a},hasPrev:function(){var a=!1;return this.indexOf(this.getCurrentItem("currentItem"))-1>=0&&(a=!0),a}})}(),function(){"use strict";MathInteractives.Common.Player.Collections.Base=Backbone.Collection.extend({model:MathInteractives.Common.Player.Models.Base,
toJSON:function(){this.serializationRequired===!0&&MathInteractives.Common.Player.Models.Base.serializeCollection(this);for(var a=[],b=0;b<this.models.length;b++)a.push(this.models[b].attributes);return this.serializationRequired===!0&&a.push({instanceType:"Collection",collectionName:this.collectionName}),a}})}(),function(){"use strict";MathInteractives.Common.Player.Views.ScreenShotModal=Backbone.View.extend({base64Img:null,isOpened:!1,events:{"submit form":"onSubmit"},initialize:function(){var a=$(MathInteractives.Common.Player.templates.screenShotModal());$("body").append(a),this.$el=$("#save-screen-shot-modal"),$("body").on("shown.bs.modal",".modal",function(){$("input[name='saveStateName']").focus()})},open:function(a){this.isOpened=!0,this.$el.find("input[name='saveStateName']").val(""),this.$el.find("div.control-group").removeClass("error"),this.$el.modal(),this.base64Img=a},onSubmit:function(a){if(this.isOpened){a.preventDefault();var b=$(a.target).find("input[name='saveStateName']").val();""===b?this.$el.find("div.control-group").addClass("error"):(this.$el.modal("hide"),this.trigger("screenShotNameEntered",{fileName:b,base64Image:this.base64Img})),this.isOpened=!1}}})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Player.templates=MathInteractives.Common.Player.templates||{};b.header=a(function(a,b,c,d,e){function f(a,b){var d,e="";return e+='\r\n<div id="',(d=c.idPrefix)?d=d.call(a,{hash:{},data:b}):(d=a.idPrefix,d=typeof d===k?d.apply(a):d),e+=l(d)+'header-tab-drawer-btn" class="header-tab-drawer-btn"></div>\r\n<div class="header-horizontal-divider"></div>\r\n'}function g(a,b){var d,e="";return e+='\r\n<div class="header-dot"></div>\r\n<div class="header-subtitle header-subtitle-hover" id="',(d=c.idPrefix)?d=d.call(a,{hash:{},data:b}):(d=a.idPrefix,d=typeof d===k?d.apply(a):d),e+=l(d)+'header-subtitle"></div>\r\n'}function h(a,b,c){var d,e="";return e+='\r\n<div class="header-btn" id="'+l((d=c.idPrefix,typeof d===k?d.apply(a):d))+l((d=a.id,typeof d===k?d.apply(a):d))+'">\r\n</div>\r\n'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var i,j="",k="function",l=this.escapeExpression,m=this;return j+="\ufeff\r\n\r\n",i=c["if"].call(b,b.playerTheme,{hash:{},inverse:m.noop,fn:m.program(1,f,e),data:e}),(i||0===i)&&(j+=i),j+='\r\n\r\n<div class="heading" id="',(i=c.idPrefix)?i=i.call(b,{hash:{},data:e}):(i=b.idPrefix,i=typeof i===k?i.apply(b):i),j+=l(i)+'heading"></div>\r\n\r\n',i=c["if"].call(b,b.playerTheme,{hash:{},inverse:m.noop,fn:m.program(3,g,e),data:e}),(i||0===i)&&(j+=i),j+="\r\n\r\n",i=c.each.call(b,b.headerButtons,{hash:{},inverse:m.noop,fn:m.programWithDepth(5,h,e,b),data:e}),(i||0===i)&&(j+=i),j+=" "})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.tooltip=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff<div class="de-mathematics-interactive-tooltip tooltips" id="',(g=c.id)?f=g.call(b,{hash:{},data:e}):(g=b&&b.id,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'"> \r\n    <div class="de-mathematics-interactive-tooltip tooltip-left"></div> \r\n    <div class="de-mathematics-interactive-tooltip tooltip-mid">',(g=c.content)?f=g.call(b,{hash:{},data:e}):(g=b&&b.content,f=typeof g===i?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(h+=f),h+='</div>\r\n    <div class="de-mathematics-interactive-tooltip tooltip-right"></div>\r\n    <div class="de-mathematics-interactive-tooltip tooltip-arrow"></div>\r\n</div>\r\n'})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Player.templates=MathInteractives.Common.Player.templates||{};b.screenShotModal=a(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div id="save-screen-shot-modal" class="modal fade">\r\n  <div class="modal-dialog bootstrapped">\r\n    <form class="modal-content form-horizontal">\r\n      <div class="modal-header">\r\n        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button>\r\n        <h4 class="modal-title">Name:</h4>\r\n      </div>\r\n      <div class="modal-body">\r\n        <div class="control-group">\r\n          <p><input type="text" name="saveStateName" /><span class="help-inline">* Required</span></p>\r\n        </div>\r\n      </div>\r\n      <div class="modal-footer">\r\n        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n        <button type="submit" class="btn btn-primary">Save</button>\r\n      </div>\r\n    </form><!-- /.modal-content -->\r\n  </div><!-- /.modal-dialog -->\r\n</div><!-- /.modal -->\r\n<div id="scrollable"></div>\r\n'})}(),function(){"use strict";MathInteractives.Common.Components.Views.ContextMenu=Backbone.View.extend({_manager:null,_callerView:null,_$contextElement:null,initialize:function(){this._manager=this.model.getManager(),this.render()},render:function(){this.$el.find(".contextMenuHolder").remove(),this.$el.append('<div class="contextMenuHolder" style=""></div>');for(var a=this.model.getElements(),b=0;b<a.length;b++)a[b].off("keyup.contextmenu").on("keyup.contextmenu",$.proxy(this._elementKeyup,this))},editContextMenu:function(a,b){return this.model.editIgnoreIds(a,b)},enableDisableContextMenu:function(a,b){if(0!==a.length)if(b===!0)for(var c=0;c<a.length;c++)a[c].off("keyup.contextmenu").on("keyup.contextmenu",$.proxy(this._elementKeyup,this)),this.model.addRefToElementsArray(a[c]);else for(var c=0;c<a.length;c++)a[c].off("keyup.contextmenu"),this.model.removeRefFromElementsArray(a[c])},_focusLostonMenuHolder:function(a,b){},_playerClick:function(a,b){this._hideContextMenu(a,b)},_focusinContextMenuItem:function(a,b){$(a.currentTarget).addClass("menufocussed")},_focusoutContextMenuItem:function(a,b){$(a.currentTarget).removeClass("menufocussed")},_elementKeyup:function(a,b){if(219===a.keyCode){var c,d,e,f,g,h=this.model.getInteractivityPrefix(),i=this.model.getContextMenuCount(),j=this.model.getScreenID(),k=-this.$el.offset().top+$(a.currentTarget).offset().top+$(a.currentTarget).height()/2,l=-this.$el.offset().left+$(a.currentTarget).offset().left+$(a.currentTarget).width()/2,m=this.model.getIgnoreIds(),n=null,o=this.model.get("maxItemCount"),p=null;this._$contextElement=$(a.currentTarget),("undefined"==typeof j||0===j.trim().length)&&(j="ContextMenu"),this.$el.find(".contextMenuHolder").empty().append('<div class="contextWrapper"></div>');for(var q=0;i>q;q++)n=$.inArray(h+j+"-"+q,m),-1===n&&(null===p&&(p=h+j+"-"+q),c=h+j+"-"+q,d=$("<div id="+c+' class="ContextMenuItem"></div>'),this.$el.find(".contextMenuHolder .contextWrapper").append(d),this.model.isParentToChildMenu(c)===!0&&d.addClass("notAnElement"));null===p||(this.$el.find(".contextMenuHolder").show().css({left:0,top:0}),this._manager.loadScreen(j,h),o>0&&(e=this.$el.find(".contextMenuHolder .ContextMenuItem").first().height(),e+=5,this.$el.find(".contextMenuHolder").css({height:e*o})),this.$el.find(".contextMenuHolder").height()<this.$el.find(".contextWrapper").height()&&this.$el.find(".contextMenuHolder").css("width",this.$el.find(".contextMenuHolder").width()+17),g=this.$el.find(".contextMenuHolder").height()+2*MathInteractives.global.ContextMenu.WRAPPER_PADDING+2*MathInteractives.global.ContextMenu.PLAYER_PADDING,f=this.$el.find(".contextMenuHolder").width()+2*MathInteractives.global.ContextMenu.WRAPPER_PADDING+2*MathInteractives.global.ContextMenu.PLAYER_PADDING,l+f>this.$el.width()&&(l-=f),k+g>this.$el.height()&&(k-=g),this.$el.find(".contextMenuHolder").css({left:l,top:k}),this.$el.find(".contextMenuHolder .ContextMenuItem").off("keyup.contextmenu focusin.contextmenu focusout.contextmenu keydown.contextmenu").on("keyup.contextmenu",$.proxy(this._contextMenuItemKeyup,this)).on("focusout.contextmenu",$.proxy(this._focusoutContextMenuItem,this)).on("focusin.contextmenu",$.proxy(this._focusinContextMenuItem,this)).on("keydown.contextmenu",$.proxy(this._contextMenuItemKeydown,this)),this._manager.setFocus(this.$el.find(".contextMenuHolder .ContextMenuItem").first().attr("id")),this._$contextElement.trigger(MathInteractives.global.ContextMenu.CONTEXTMENU_OPEN,[a,b]))}},_hideEmptyContextMenuDiv:function(a,b){this.$el.find(".contextMenuHolder").empty().hide(),this.$el.find(".contextMenuHolder.childContextMenuHolder").remove()},_hideContextMenu:function(a,b){this._hideEmptyContextMenuDiv(a,b),this._$contextElement.trigger(MathInteractives.global.ContextMenu.CONTEXTMENU_HIDE,[a,b]),this._$contextElement=null},_hideChildContextMenu:function(a,b){var c=$(a.currentTarget).parents(".contextMenuHolder").attr("parent");$(a.currentTarget).parents(".contextMenuHolder").remove(),c&&this._manager.setFocus(c)},_contextMenuItemSelected:function(a,b){this._hideEmptyContextMenuDiv(a,b),this._$contextElement.trigger(MathInteractives.global.ContextMenu.CONTEXTMENU_SELECT,[a,b]),this._$contextElement=null},_showNestedMenu:function(a,b){var c=$(a.currentTarget);this.model.get("nestedMenuData")[c.attr("id")]&&$.proxy(this._openChildContextMenu,this)(a,b)},_openChildContextMenu:function(a,b){var c,d,e,f=$(a.currentTarget),g=0,h=this.model.getIgnoreIds(),i=$('<div class="contextMenuHolder childContextMenuHolder" parent='+f.attr("id")+"></div>"),j=-this.$el.offset().top+$(a.currentTarget).offset().top-5-1,k=-this.$el.offset().left+$(a.currentTarget).offset().left+f.parents(".contextMenuHolder").width()+5;for(this.$el.append(i),i.css({top:j,left:k}).show();g<this.model.get("nestedMenuData")[f.attr("id")].menuCount;g++)d=$.inArray(f.attr("id")+"-"+g,h),-1===d&&(e=f.attr("id")+"-"+g,c=$('<div id="'+e+'" class="ContextMenuItem positionParentDiv childContextMenuItem"></div>'),i.append(c),this.model.isParentToChildMenu(e)===!0&&c.addClass("notAnElement"));this._manager.loadScreen(f.attr("id"),this.model.getInteractivityPrefix()),this.$el.find(".contextMenuHolder .ContextMenuItem.childContextMenuItem ").off("keyup.contextmenu focusin.contextmenu focusout.contextmenu keydown.contextmenu").on("keyup.contextmenu",$.proxy(this._contextMenuItemKeyup,this)).on("focusout.contextmenu",$.proxy(this._focusoutContextMenuItem,this)).on("focusin.contextmenu",$.proxy(this._focusinContextMenuItem,this)).on("keydown.contextmenu",$.proxy(this._contextMenuItemKeydown,this)),this._manager.setFocus(i.children().first().attr("id"))},_contextMenuItemKeyup:function(a,b){switch(a.keyCode){case 13:case 32:if($(a.currentTarget).hasClass("notAnElement"))return;$.proxy(this._contextMenuItemSelected,this)(a,b);break;case 27:$.proxy(this._hideContextMenu,this)(a,b);break;case 39:$.proxy(this._showNestedMenu,this)(a,b);break;case 37:$(a.currentTarget).hasClass("childContextMenuItem")&&$.proxy(this._hideChildContextMenu,this)(a,b);break;default:a.preventDefault(),a.stopPropagation()}},_contextMenuItemKeydown:function(a,b){var c,d=$(a.currentTarget),e=d.attr("id").toString().lastIndexOf("-"),f=1,g=d.attr("id").toString().substring(0,e),h=d.attr("id").toString().substring(e+1);switch(a.keyCode){case 9:a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),this._hideContextMenu(a,b);break;case 38:a.preventDefault();do c=g+"-"+parseInt(parseInt(h)-f),f++;while(this.model.isIgnored(c));1===$("#"+c).length?this._manager.setFocus(c):this._manager.setFocus(d.parents(".contextMenuHolder").find(".ContextMenuItem").last().attr("id"));break;case 40:a.preventDefault();do c=g+"-"+parseInt(parseInt(h)+f),f++;while(this.model.isIgnored(c));1===$("#"+c).length?this._manager.setFocus(c):this._manager.setFocus(d.parents(".contextMenuHolder").find(".ContextMenuItem").first().attr("id"))}}},{SCROLLBAR_WIDTH:17,WRAPPER_PADDING:5,PLAYER_PADDING:8,CONTEXTMENU_OPEN:"context-menu-displayed",CONTEXTMENU_HIDE:"context-menu-hidden",CONTEXTMENU_SELECT:"context-menu-selected",initContextMenu:function(a){if(a){var b=new MathInteractives.Common.Components.Models.ContextMenu(a);b.setInteractivityPrefix(a.prefix),b.setElements(a.elements),b.setContextMenuCount(a.contextMenuCount),b.setScreenID(a.screenId),b.setManager(a.manager),b.setNestedMenuData({}),a.nestedMenuData&&b.setNestedMenuData(a.nestedMenuData);var c=new MathInteractives.Common.Components.Views.ContextMenu({el:a.el,model:b});return c._callerView=a.thisView,c}}}),MathInteractives.global.ContextMenu=MathInteractives.Common.Components.Views.ContextMenu}(),function(){"use strict";MathInteractives.Common.Components.Models.ContextMenu=Backbone.Model.extend({defaults:function(){return{elements:null,ignoreScreenElementIds:[],onSelectCallback:null,onRemoveCallback:null,onDisplayCallback:null,contextMenuCount:null,screenId:null,interactivityPrefix:null,manager:null,nestedMenuData:null,maxItemCount:null}},isParentToChildMenu:function(a){var b=this.get("nestedMenuData")[a];return b?!0:!1},isIgnored:function(a){var b=$.inArray(a,this.getIgnoreIds());return-1===b?!1:!0},setElements:function(a){this.set("elements",a)},setSelectCallback:function(a){this.set("onSelectCallback",a)},setRemoveCallback:function(a){this.set("onRemoveCallback",a)},setDisplayCallback:function(a){this.set("onDisplayCallback",a)},setContextMenuCount:function(a){this.set("contextMenuCount",a)},setScreenID:function(a){this.set("screenId",a)},setInteractivityPrefix:function(a){this.set("interactivityPrefix",a)},setManager:function(a){this.set("manager",a)},setNestedMenuData:function(a){if("undefined"!=typeof a&&null!==a){for(var b=Object.keys(a),c=0,d={},e=this.getInteractivityPrefix(),f=this.getScreenID();c<b.length;c++)d[e+f+"-"+b[c]]=a[b[c]];this.set("nestedMenuData",d)}},getElements:function(){return this.get("elements")},getSelectCallback:function(){return this.get("onSelectCallback")},getRemoveCallback:function(){return this.get("onRemoveCallback")},getDisplayCallback:function(){return this.get("onDisplayCallback")},getContextMenuCount:function(){return this.get("contextMenuCount")},getScreenID:function(){return this.get("screenId")},getInteractivityPrefix:function(){return this.get("interactivityPrefix")},getManager:function(){return this.get("manager")},getIgnoreIds:function(){return this.get("ignoreScreenElementIds")},addIntoIgnoreIds:function(a){var b=$.inArray(a,this.getIgnoreIds());return-1===b?(this.getIgnoreIds().push(a),!0):!1},editIgnoreIds:function(a,b){if(0!==a.length){var c=this.getIgnoreIds();if(b===!0){for(var d=0;d<a.length;d++)if(!this.get("nestedMenuData")[a[d]]){var e=this.addIntoIgnoreIds(a[d]);1==e&&this._checkAndDisableParentHierarchy(a[d])}}else for(var d=0;d<a.length;d++)if(!this.get("nestedMenuData")[a[d]]){var f=$.inArray(a[d],c);f>=0&&(c.splice(f,1),this._checkAndEnableParentHierarchy(a[d]))}return c}},_checkAndDisableParentHierarchy:function(a){var b,c,d=a.lastIndexOf("-"),e=a.substring(0,d),f=(a.substring(d+1),!0),g=0;if(this.get("nestedMenuData")[e]&&(c=this.get("nestedMenuData")[e].menuCount,this.isParentToChildMenu(e)!==!1)){for(;c>g;g++)b=$.inArray(e+"-"+g,this.get("ignoreScreenElementIds")),-1===b&&(f=!1);if(f===!0){var h=this.addIntoIgnoreIds(e);h===!0&&this._checkAndDisableParentHierarchy(e)}}},_checkAndEnableParentHierarchy:function(a){var b,c=a.lastIndexOf("-"),d=a.substring(0,c),e=(a.substring(c+1),this.get("ignoreScreenElementIds"));b=$.inArray(d,e),-1!==b&&(e.splice(b,1),this._checkAndEnableParentHierarchy(d))},addRefToElementsArray:function(a){for(var b=this.get("elements"),c=!1,d=0;d<b.length;d++)b[d][0]===a[0]&&(c=!0);c===!1&&b.push(a)},removeRefFromElementsArray:function(a){for(var b=this.get("elements"),c=null,d=0;d<b.length;d++)b[d][0]===a[0]&&(c=d);c>=0&&b.splice(c,1)}})}(),function(a){"use strict";var b=null,c=null;a.Common.Components.Models.DragDrop=MathInteractives.Common.Player.Models.BaseInteractive.extend({defaults:{type:null,elements:null,options:null,dropSlots:null,preventDefaultFunctionality:null,idPrefix:null,manager:null,player:null,contextMenuScreenId:null,_elementModels:null,_scope:null,_contextMenuView:null,currentSelectedDraggableIndex:-1,isIE:null},initialize:function(){switch(this.setUpAllProperties(),this.getType()){case"drag":this.setUpDraggable();break;case"drop":this.setUpDroppable();break;default:b.log(b.LOG_MESSAGES.INVALID)}},setUpAllProperties:function(){return this.setIdPrefix(this.getIdPrefix()),this.set("isIE",MathInteractives.Common.Utilities.Models.BrowserCheck.isIE),b.checkIsNull(this.getIdPrefix())||b.checkIsUndefined(this.getIdPrefix())?(b.log(b.LOG_MESSAGES.INVALID_IDPREFIX),!1):(this.setScope(this.getIdPrefix()),this.setElements(this.getElements()),this.setDropSlots(this.getDropSlots()?this.getDropSlots():[]),this.setOptions(this.getOptions()?this.getOptions():{}),this.set_elementModels([]),this.setPreventDefaultFunctionality(this.getPreventDefaultFunctionality()),this.setManager(this.getManager()),this.setPlayer(this.getPlayer()),void this.setContextMenuScreenId(this.getContextMenuScreenId()))},setUpDraggable:function(){this.makeElementsDraggable(this.getOptions(),this.getPreventDefaultFunctionality(),this.getIdPrefix()),this.populateDropSlotsAndAttachEvents(),null!==this.getContextMenuScreenId()&&(this.generateContextMenuForDraggable(),this._generateContextMenu())},setUpDroppable:function(){this.makeElementsDroppable(this.getOptions(),this.getPreventDefaultFunctionality(),this.getIdPrefix()),this.attachDropEvents()},makeElementsDraggable:function(a,c,d){var e=this,f=e.getElements(),g=f.length,h=null,i=null;for(h=0;g>h;h++)i=b.getIdSelectorString(f[h]),b.checkIsDraggableAlready(d,i)||e.makeElementDraggable(i,a,c,d)},makeElementDraggable:function(a,c,d,e){var f=this,g=new b.Draggable({id:a,options:c,preventDefaultFunctionality:d,idPrefix:e});b.addDraggableElement(e,g),this.get_elementModels().push(g),$(g.getId()).off("click").on("click",$.proxy(f.keyPressHandler,f))},keyPressHandler:function(a){if(a.stopPropagation(),1!==a.which){var c=this,d=c.getIdPrefix(),e=d.length,f=b.getAccessibilityView(d),g=a.target.id.slice(e),h=f.getTabIndex(g),i=this.getDropSlots(),j=h+1,k=null,l=0,m=[],n=null,o=i.length;MathInteractives.Common.Components.Models.DragDrop.DRAGGABLE_SELECTED=a.target.parentElement;var p=$(a.target).parent().attr("id");for(l=0;o>l;l++)k=i[l],b.getModelFromDroppables(d,k).get("isDroppable")&&k!==p&&m.push(k);for(n=m.length,l=0;n>l;l++,j++)k=m[l],$("#"+k).off("click").on("click",$.proxy(c.keyPressDropEventHandler,c,a)),k=m[l].slice(e),f.setTabIndex(k,j),$("#"+d+k).off("keydown.selection").on("keydown.selection",function(a){(13===a.keyCode||32===a.keyCode)&&$.proxy(c.removeDropSlotTabIndex,c)}),0===l&&(f.setFocus(k),$("#"+d+k).off("keydown.remove-tab-index-first-element").on("keydown.remove-tab-index-first-element",function(a){9===a.keyCode&&a.shiftKey&&$("body").off("keyup.remove-tab-index-first-element").on("keyup.remove-tab-index-first-element",function(a){9===a.keyCode&&($("body").off("keyup.remove-tab-index-first-element"),$.proxy(c.removeDropSlotTabIndex,c)(),c.get("isIE")&&f.setFocus(c.get("elements")[0].replace(c.get("idPrefix"),""),5))})})),l===n-1&&$("#"+d+k).off("keydown.remove-tab-index-last-element").on("keydown.remove-tab-index-last-element",function(a){9!==a.keyCode||a.shiftKey||$("body").off("keyup.remove-tab-index-last-element").on("keyup.remove-tab-index-last-element",function(a){$("body").off("keyup.remove-tab-index-last-element"),$.proxy(c.removeDropSlotTabIndex,c)()})})}},setTabIndexForDraggable:function(a,c,d,e){if(!e||!$(e.target.parentElement).hasClass("ui-draggable")){var f,g=c+1,h=this.getIdPrefix().length,i=null,j=a.length;for(f=0;j>f;f++,g++)b.getModelFromDroppables(this.getIdPrefix(),a[f]).get("isDroppable")&&(i=a[f].slice(h),d.setTabIndex(i,g))}},keyPressDropEventHandler:function(a,c){var d={draggable:[a.target]},e=c.currentTarget.id,f=this.getDropSlots(),g=f.indexOf(e),h=this.getIdPrefix();b.getModelFromDroppables(h,f[g]).dropHandler(a,d),this.removeDropSlotTabIndex()},removeDropSlotTabIndex:function(a){var c=this,d=c.getIdPrefix(),e=b.getAccessibilityView(d),f=this.getDropSlots(),g=null,h=0,i=f.length;for(h=0;i>h;h++)g=f[h].replace(d,""),e.enableTab(g,!1)},populateDropSlotsAndAttachEvents:function(){var a=this,c=a.get_elementModels(),d=c.length,e=a.getDropSlots(),f=e.length,g=null,h=null,i=null;for(g=0;f>g;g++)for(i=b.getIdSelectorString(e[g]),h=0;d>h;h++)c[h].addDropSlot(i),a.attachEvents(c[h])},makeElementsDroppable:function(a,c,d){var e=this,f=e.getElements(),g=f.length,h=null,i=null;for(h=0;g>h;h++)i=b.getIdSelectorString(f[h]),b.checkIsDroppableAlready(d,i)||e.makeElementDroppable(i,a,c,d)},makeElementDroppable:function(a,c,d,e){var f=this.getIdPrefix(),g=new b.Droppable({id:a,options:c,preventDefaultFunctionality:d,idPrefix:e});b.addDroppableElement(f,g),this.get_elementModels().push(g)},attachDropEvents:function(){var a=this,b=a.get_elementModels(),c=b.length,d=null;for(d=0;c>d;d++)a.attachEvents(b[d])},attachEvents:function(a){var c=this;"drag"===this.getType()?(c.stopListening(a,b.INDIVIDUAL_EVENTS.DRAG.START,c.dispatchDragStartEvent),c.stopListening(a,b.INDIVIDUAL_EVENTS.DRAG.DRAG,c.dispatchDragEvent),c.stopListening(a,b.INDIVIDUAL_EVENTS.DRAG.STOP,c.dispatchDragStopEvent),c.listenTo(a,b.INDIVIDUAL_EVENTS.DRAG.START,c.dispatchDragStartEvent),c.listenTo(a,b.INDIVIDUAL_EVENTS.DRAG.DRAG,c.dispatchDragEvent),c.listenTo(a,b.INDIVIDUAL_EVENTS.DRAG.STOP,c.dispatchDragStopEvent)):"drop"===this.getType()&&(c.stopListening(a,b.INDIVIDUAL_EVENTS.DROP.DROP,c.dispatchDropEvent),c.listenTo(a,b.INDIVIDUAL_EVENTS.DROP.DROP,c.dispatchDropEvent))},_functionCaller:function(a,c){var d=this,e=this.getIdPrefix(),f=this.getType(),g=d.get_elementModels(),h=g.length,i=null;for(i=0;h>i;i++)b[a](e,f,g[i].getId(),c)},_disableIndividialElement:function(a,c){var d=this.getIdPrefix(),e=this.getType();b[a](d,e,c)},_enableIndividialElement:function(a,c){var d=this.getIdPrefix(),e=this.getType();b[a](d,e,c)},_generateContextMenu:function(){var a=this,c=this.getIdPrefix(),d=(b.getAccessibilityView(c),this.getDropSlots()),e=null,f=this.getPlayer(),g=a.get_elementModels(),h=0,i=[],j=g.length,k=a.getManager(),l=this.getContextMenuScreenId(),m=d.length;for(h=0;j>h;h++)i.push($(g[h].getId())),i[h].off(MathInteractives.global.ContextMenu.CONTEXTMENU_SELECT).on(MathInteractives.global.ContextMenu.CONTEXTMENU_SELECT,$.proxy(this.onContextMenuSelect,this)),i[h].off(MathInteractives.global.ContextMenu.CONTEXTMENU_HIDE).on(MathInteractives.global.ContextMenu.CONTEXTMENU_HIDE,$.proxy(this.onContextMenuHide,this));var n={el:f.$el,prefix:c,elements:i,contextMenuCount:m,manager:k,thisView:a,nestedMenuData:{},screenId:l};e=MathInteractives.global.ContextMenu.initContextMenu(n),this.setContextMenuView(e)},editContextMenu:function(a,b){var c=this.getContextMenuView();c.editContextMenu(a,b)},onContextMenuHide:function(a,c){var d=b.getAccessibilityView(this.getIdPrefix()),e=this.getIdPrefix().length,f=a.target.id,g=f.slice(e);d.setFocus(g)},onContextMenuSelect:function(a,c){var d,e,f={draggable:[a.currentTarget]},g=c.currentTarget.id,h=g.split("-");e=h[h.length-1],d=parseInt(e);var i=this.getIdPrefix();this.removeDropSlotTabIndex(),b.DRAGGABLE_SELECTED=a.target.parentElement,b.getModelFromDroppables(i,this.getDropSlots()[d]).dropHandler(a,f)},dispatchDragStartEvent:function(a){this.trigger(b.EVENTS.DRAG.START,a)},dispatchDragEvent:function(a){this.trigger(b.EVENTS.DRAG.DRAG,a)},dispatchDragStopEvent:function(a){this.trigger(b.EVENTS.DRAG.STOP,a)},dispatchDropEvent:function(a){this.trigger(b.EVENTS.DROP.DROP,a)},destroy:function(){this._functionCaller("DESTROY")},addDropSlot:function(a){this._functionCaller("ADD_DROP_SLOT",a)},disable:function(){this._functionCaller("DISABLE")},enable:function(){this._functionCaller("ENABLE")},addOptions:function(a){return a?void this._functionCaller("ADD_OPTIONS",a):void 0},generateContextMenuForDraggable:function(){"drag"===this.getType()&&this._generateContextMenu()},disableIndividialElement:function(a){this._disableIndividialElement("DISABLE",a)},enableIndividialElement:function(a){this._disableIndividialElement("ENABLE",a)},getIdPrefix:function(){return this.get("idPrefix")},setIdPrefix:function(a){this.set("idPrefix",a)},getScope:function(){return this.get("_scope")},setScope:function(a){this.set("_scope",a)},getType:function(){return this.get("type")},getElements:function(){return this.get("elements")},setElements:function(a){this.set("elements",a)},getDropSlots:function(){return this.get("dropSlots")},setDropSlots:function(a){var c=b.checkIsNull(a);c&&(a=[]),this.set("dropSlots",a)},getOptions:function(){return this.get("options")},setOptions:function(a){var c=b.checkIsNull(a);c&&(a={}),this.set("options",a)},getPreventDefaultFunctionality:function(){return this.get("preventDefaultFunctionality")},setPreventDefaultFunctionality:function(a){this.set("preventDefaultFunctionality",a)},get_elementModels:function(){return this.get("_elementModels")},set_elementModels:function(a){this.set("_elementModels",a)},getManager:function(){return this.get("manager")},setManager:function(a){this.set("manager",a)},getPlayer:function(){return this.get("player")},setPlayer:function(a){this.set("player",a)},getContextMenuView:function(){return this.get("_contextMenuView")},setContextMenuView:function(a){this.set("_contextMenuView",a)},getContextMenuScreenId:function(){return this.get("contextMenuScreenId")},setContextMenuScreenId:function(a){this.set("contextMenuScreenId",a)}},{SCOPES:{},currentScope:null,addDraggableElement:function(a,c){b.SCOPES[a].Draggables[c.getId()]=c},addDroppableElement:function(a,c){b.SCOPES[a].Droppables[c.getId()]=c},getModelFromDraggables:function(a,d){return d=d.indexOf("#")<0?b.getIdSelectorString(d):d,c=b.SCOPES[a].Draggables[d],void 0===c||null===c?(b.log(b.LOG_MESSAGES.INVALID),null):c},getModelFromDroppables:function(a,d){return d=d.indexOf("#")<0?b.getIdSelectorString(d):d,c=b.SCOPES[a].Droppables[d],void 0===c||null===c?(b.log(b.LOG_MESSAGES.INVALID),null):c},getAccessibilityView:function(a){return c=b.SCOPES[a].AccessibilityView,void 0===c||null===c?(b.log(b.LOG_MESSAGES.INVALID),null):c},removeItemFromDraggables:function(a,c){c=c.indexOf("#")<0?b.getIdSelectorString(c):c,b.SCOPES[a].Draggables[c]=null},removeItemFromDroppables:function(a,c){c=c.indexOf("#")<0?b.getIdSelectorString(c):c,b.SCOPES[a].Droppables[c]=null},checkIsDraggableAlready:function(a,c){c=c.indexOf("#")<0?b.getIdSelectorString(c):c;var d=b.SCOPES[a].Draggables[c],e=b.checkIsNull(d),f=b.checkIsUndefined(d);return e===!1&&f===!1?!0:!1},checkIsDroppableAlready:function(a,c){c=c.indexOf("#")<0?b.getIdSelectorString(c):c;var d=b.SCOPES[a].Droppables[c],e=b.checkIsNull(d),f=b.checkIsUndefined(d);return e===!1&&f===!1?!0:!1},Draggable:Backbone.Model.extend({defaults:{id:null,options:null,isDraggable:null,dropSlots:null,preventDefaultFunctionality:null,idPrefix:null,_isClone:null},initialize:function(){this.setIsDraggable(!1),this.setDropSlots([]),this.set_isClone(!1),this.initializeDraggable(),this.setPreventDefaultFunctionality(this.getPreventDefaultFunctionality()),this.setIdprefix(this.getIdprefix()),this.bindPropertyChangeListeners()},initializeDraggable:function(){var a=this.getId(),b=MathInteractives.Common.Utilities.Models.Utils;if(!this.isIdNull()){var c=this,d=$(a),e=c.getOptions();"clone"===e.helper&&c.set_isClone(!0),e=c.overrideOptions(e),b.EnableTouch(a,{specificEvents:b.SpecificEvents.DRAGGABLE}),d.draggable(e),this.setIsDraggable(!0)}},overrideOptions:function(a){var c=this;return a.revert=b.checkIsUndefined(a.revert)?"invalid":a.revert,a.zIndex=b.checkIsUndefined(a.zIndex)?999:a.zIndex,(null===a.helper||"undefined"==typeof a.helper)&&(a.helper="clone"),a.start=$.proxy(c.dragStartHandler,c),a.drag=$.proxy(c.dragHandler,c),a.stop=$.proxy(c.dragStopHandler,c),a},isIdNull:function(){return b.checkIsNull(this.getId())?(b.log(b.LOG_MESSAGES.NO_ID),!0):!1},addDropSlot:function(a){this.isDropSlotAdded(a)||this.getDropSlots().push(a)},isDropSlotAdded:function(a){return this.getDropSlots().indexOf(a)<0?!1:!0},dragStartHandler:function(a,c){if(this.getIsDraggable()!==!1){var d=$(this.getId()),e=b._createCustomEventObject(a,c,d);b.getAccessibilityView(this.getIdprefix()).hideTabDrawer(),this.getPreventDefaultFunctionality()||this.get_isClone()||d.css({visibility:"hidden"}),this.trigger(b.INDIVIDUAL_EVENTS.DRAG.START,e)}},dragHandler:function(a,c){if(this.getIsDraggable()!==!1){var d=$(this.getId()),e=b._createCustomEventObject(a,c,d);this.trigger(b.INDIVIDUAL_EVENTS.DRAG.DRAG,e)}},dragStopHandler:function(a,c){if(this.getIsDraggable()!==!1){var d=$(this.getId()),e=b._createCustomEventObject(a,c,d);this.getPreventDefaultFunctionality()||this.get_isClone()||d.css({visibility:"visible"}),this.trigger(b.INDIVIDUAL_EVENTS.DRAG.STOP,e)}},revertDraggableOnce:function(a){},bindPropertyChangeListeners:function(){this.on("change:options",$.proxy(this.onSetOptions,this)),this.on("change:isDraggable",$.proxy(this.onSetIsDraggable,this))},onSetOptions:function(){$(this.getId()).draggable(this.getOptions())},onSetIsDraggable:function(){switch(this.getIsDraggable()){case!0:return void $(this.getId()).draggable("enable");case!1:return void $(this.getId()).draggable("disable");default:return void b.log(b.LOG_MESSAGES.INVALID)}},getId:function(){return this.get("id")},getIsDraggable:function(){return this.get("isDraggable")},setIsDraggable:function(a){var c=b.checkIsUndefined(a);return c?void 0:void this.set("isDraggable",a)},getDropSlots:function(){return this.get("dropSlots")},setDropSlots:function(a){this.set("dropSlots",a)},getOptions:function(){return this.get("options")},setOptions:function(a){this.set("options",a)},get_isClone:function(){return this.get("_isClone")},set_isClone:function(a){this.set("_isClone",a)},getPreventDefaultFunctionality:function(){return this.get("preventDefaultFunctionality")},setPreventDefaultFunctionality:function(a){this.set("preventDefaultFunctionality",a)},getIdprefix:function(){return this.get("idPrefix")},setIdprefix:function(a){this.set("idPrefix",a)}},{}),Droppable:Backbone.Model.extend({defaults:{id:null,options:null,isDroppable:null,preventDefaultFunctionality:null,idPrefix:null},initialize:function(){this.setIsDroppable(!1),this.initializeDroppable(),this.setPreventDefaultFunctionality(this.getPreventDefaultFunctionality()),this.setIdprefix(this.getIdprefix()),this.bindPropertyChangeListeners()},initializeDroppable:function(){var a=this,b=this.getId(),c=MathInteractives.Common.Utilities.Models.Utils;if(!this.isIdNull()){var d=$(b),e=this.getOptions();e.drop=$.proxy(a.dropHandler,a),c.EnableTouch(b,{specificEvents:c.SpecificEvents.DRAGGABLE}),d.droppable(e),this.setIsDroppable(!0)}},dropHandler:function(a,c){if(this.getIsDroppable()!==!1){var d=this.getIdprefix(),e=$(this.getId()),f=b._createCustomEventObject(a,c,e),g=b.getIdSelectorString(c.draggable[0].id),h=b.getModelFromDraggables(d,g),i=null,j=null,k=!1;h&&(k=!0,i=$(h.getId()),j=h.getDropSlots()),k&&(j.indexOf(this.getId())<0?this.getPreventDefaultFunctionality()||(c.draggable.draggable("option","revert",!0),i.show()):(f.isValidDrop=!0,this.getPreventDefaultFunctionality()||(c.draggable.draggable("option","revert","invalid"),e.append(i)))),this.trigger(b.INDIVIDUAL_EVENTS.DROP.DROP,f)}},isIdNull:function(){return b.checkIsNull(this.getId())?(b.log(b.LOG_MESSAGES.NO_ID),!0):!1},bindPropertyChangeListeners:function(){this.on("change:options",$.proxy(this.onSetOptions,this)),this.on("change:isDroppable",$.proxy(this.onSetIsDroppable,this))},onSetOptions:function(){$(this.getId()).droppable(this.getOptions())},onSetIsDroppable:function(){switch(this.getIsDroppable()){case!0:return void $(this.getId()).droppable("enable");case!1:return void $(this.getId()).droppable("disable")}},getId:function(){return this.get("id")},getIsDroppable:function(){return this.get("isDroppable")},setIsDroppable:function(a){var c=b.checkIsUndefined(a);return c?void 0:void this.set("isDroppable",a)},getOptions:function(){return this.get("options")},setOptions:function(a){this.set("options",a)},getPreventDefaultFunctionality:function(){
return this.get("preventDefaultFunctionality")},setPreventDefaultFunctionality:function(a){this.set("preventDefaultFunctionality",a)},getIdprefix:function(){return this.get("idPrefix")},setIdprefix:function(a){this.set("idPrefix",a)}},{}),DRAGGABLE_SELECTED:null,log:function(a){},LOG_MESSAGES:{NO_ID:"Please Specify ID",NO_MODEL:"Model is Undefined",INVALID:"Invalid call/type",INVALID_IDPREFIX:"Please specify idPrefix"},EVENTS:{DRAG:{START:"drag-start",DRAG:"drag",STOP:"stop"},DROP:{DROP:"drop"}},INDIVIDUAL_EVENTS:{DRAG:{START:"individual-drag-start",DRAG:"individual-drag",STOP:"individual-stop",KEYPRESS:"individual-keypress"},DROP:{DROP:"individual-drop"}},DESTROY:function(a,c,d){if("drag"===c){var e=b.getModelFromDraggables(a,d);$(e.getId()).draggable("destroy"),b.removeItemFromDraggables(a,d)}else if("drop"===c){var f=b.getModelFromDroppables(a,d);$(f.getId()).droppable("destroy"),b.removeItemFromDroppables(a,d)}},ADD_OPTIONS:function(a,c,d,e){if(e){var f=null,g=null,h=null;if("drag"===c?f=b.getModelFromDraggables(a,d):"drop"===c&&(f=b.getModelFromDroppables(a,d)),f)return g=f.getOptions(),h=b._combineObjects(g,e),void f.setOptions(h)}},ADD_DROP_SLOT:function(a,c,d,e){"drag"===c&&(e=e.indexOf("#")<0?b.getIdSelectorString(e):e,b.getModelFromDraggables(a,d).addDropSlot(e))},ENABLE:function(a,c,d){var e=null;"drag"===c?(e=b.getModelFromDraggables(a,d),e.setIsDraggable(!0)):"drop"===c&&(e=b.getModelFromDroppables(a,d),e.setIsDroppable(!0))},DISABLE:function(a,c,d){var e=null;"drag"===c?(e=b.getModelFromDraggables(a,d),e.setIsDraggable(!1)):"drop"===c&&(e=b.getModelFromDroppables(a,d),e.setIsDroppable(!1),$(d).off("focusout"),$(d).off("focusin"))},REVERT_DRAGGABLE:function(a,c){var d,e,f=c.ui.draggable;f=$(f),e=f.attr("id"),f.draggable("option","revert",!0),"undefined"!=typeof e&&(d=b.getModelFromDraggables(a,e),d.listenToOnce(d,b.INDIVIDUAL_EVENTS.DRAG.STOP,d.revertDraggableOnce))},SETUP_SCOPE:function(a,c,d){b.SCOPES[a]=null,b.SCOPES[a]={Draggables:{},Droppables:{},AccessibilityView:function(){if(b.SCOPES[a]&&b.SCOPES[a].AccessibilityView)return b.SCOPES[a].AccessibilityView;var e=MathInteractives.Common.Player.Views.Base.extend({idPrefix:a,manager:c,player:d});return new e}()}},_createCustomEventObject:function(a,b,c,d){return{originalEvent:a?a:null,ui:b?b:null,$element:c?c:null,extraOptions:d?d:null,isValidDrop:!1}},_combineObjects:function(a,b){if($.each){var c={};return $.each(a,function(a,b){c[a]=b}),$.each(b,function(a,b){c[a]=b}),c}},checkIsUndefined:function(a){return void 0===a?!0:!1},checkIsNull:function(a){return null===a?!0:!1},getIdSelectorString:function(a){return"#"+a},createDragDropModel:function(a){if(a){var c=new b(a);return c}}}),b=a.Common.Components.Models.DragDrop}(MathInteractives),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.dragDrop=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff  <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f),(g=c.tabName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tabName,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'drag-drop-box" class="drag-drop-box">\r\n\r\n    \r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f),(g=c.tabName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tabName,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'graph-pane-droppable" class="graph-droppable"></div>\r\n\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f),(g=c.tabName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tabName,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'dotted-box" class="drag-drop-dotted-box"></div>\r\n    \r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f),(g=c.tabName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tabName,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'filled-dot" class="drag-drop-filled-dot draggable-items">\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f),(g=c.tabName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tabName,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'filled-helper" class="helper-image drag-drop-helper-filled"></div>\r\n    </div>\r\n    \r\n    \r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f),(g=c.tabName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tabName,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'unfilled-dot" class="drag-drop-unfilled-dot draggable-items">\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f),(g=c.tabName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tabName,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'unfilled-helper" class="helper-image drag-drop-helper-unfilled"></div>\r\n    </div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f),(g=c.tabName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tabName,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'left-indicator" class="drag-drop-left-indicator draggable-items">\r\n      <div class="drag-arrow-image"></div><div class="drag-arrow-width"></div>\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f),(g=c.tabName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tabName,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'left-helper" class="helper-image drag-drop-helper-left"></div>\r\n    </div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f),(g=c.tabName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tabName,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'right-indicator" class="drag-drop-right-indicator draggable-items">\r\n      <div class="drag-arrow-width"></div><div class="drag-arrow-image"></div>\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f),(g=c.tabName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.tabName,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'right-helper" class="helper-image drag-drop-helper-right"></div> \r\n    </div>\r\n    \r\n  </div>\r\n'})}(),function(){MathInteractives.Common.Components.Models.AudioManager=Backbone.Model.extend({defaults:function(){return{preloaderImgId:"sound-preloder",displayPreloader:!0,bufferValue:null,currentTime:null,duration:null,currentPlayingAudio:null,isMandatory:!1,workWithSound:!0,initialLoadTime:7e3,idPrefix:null,manager:null,player:null,filePath:null,audioFilePath:null,audioData:{},audioInfo:{},audioSpriteId:[]}},initialize:function(){this.setGlobalAudioData()},getIdPrefix:function(){return this.get("idPrefix")},getAudioData:function(){return this.get("audioData")},getAudioFilePath:function(){return this.get("audioFilePath")},getFilePath:function(){return this.get("filePath")},getManager:function(){return this.get("manager")},getGlobalAudioData:function(a){return this.get("audioInfo")[a]},getCurrentPlayingAudio:function(){return this.get("currentPlayingAudio")},getDuration:function(){return this.get("duration")},getCurrentTime:function(){return this.get("currentTime")},getBufferValue:function(){return this.get("bufferValue")},getPreloaderImgId:function(){return this.get("preloaderImgId")},getPreloaderImgPath:function(){var a=this.getFilePath(),b=this.getPreloaderImgId();return a.getImagePath(b)},setDuration:function(a){this.set("duration",a)},setBufferValue:function(a){this.set("bufferValue",a)},setGlobalAudioData:function(){this.parseData(this.getAudioData(),this.getAudioFilePath())},setCurrentPlayingAudio:function(a){this.set("currentPlayingAudio",a)},parseData:function(a,b){var c=this.get("audioInfo");if(this.get("audioSpriteId").length>0)for(var d=this.get("audioSpriteId"),e=0,f=d.length;f>e;e++)c[d[e]]={},c[d[e]].audioData=a,c[d[e]].pathToSrc=b;else{var g=this.get("idPrefix");c[g]={},c[g].audioData=a,c[g].pathToSrc=b}this.set("audioInfo",c)}},{})}(),function(){"use strict";MathInteractives.Common.Components.Views.AudioManager=MathInteractives.Common.Player.Views.Base.extend({$audio:null,isLoading:!1,isMuted:!1,loadingCount:0,maxLoadingTries:3,idPrefix:null,audioSpriteId:null,loadWithSound:!0,popupShown:!1,initialize:function(){var a=this;a.initializeDefaultProperties(),this.model.set("idPrefix",a.idPrefix),a.loadScreen("audio-manager-button"),0===a.model.get("audioSpriteId").length?a.audioSpriteId=a.idPrefix:a.audioSpriteId=a.model.get("audioSpriteId")[0],a.render(),a.model.on("change:bufferValue",function(){a._bufferMonitor()}),a._bindHeaderMuteEvents(),MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile&&(a.maxLoadingTries=1)},_bufferMonitor:function(){var a=this.isSoundLoaded();a===!1?this._displayPreload(!0):(this._displayPreload(!1),this.model.off("change:bufferValue"))},_displayPreload:function(a){this.model.get("player"),this.model.get("displayPreloader"),a===!0?this.isLoading||(this._showPreloader(),this.isLoading=!0,this.trigger(MathInteractives.Common.Components.Views.AudioManager.AUDIO_EVENT.LOAD_START)):(this._hidePreloader(),this.isLoading=!1,this.trigger(MathInteractives.Common.Components.Views.AudioManager.AUDIO_EVENT.LOAD_COMPLETE))},_showPreloader:function(){var a=this.model.get("player"),b=this.model.get("displayPreloader");if(b&&0===a.$el.find(".audio-mgr-modal").length){var c=$("<div/>",{"class":"audio-mgr-modal"}).css({position:"absolute",top:"0px",left:"0px",width:a.$el.width(),height:a.$el.height(),"z-index":980,opacity:.56,"background-color":"#000"}),d=$("<div/>",{"class":"audio-mgr-preloder"}).css({position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:'url("'+this.model.getPreloaderImgPath()+'") 50% 50% no-repeat'});c.append(d),a.$el.append(c),a.setModalPresent(!0)}},_hidePreloader:function(){var a=this.model.get("player");this.model.get("displayPreloader"),0!==a.$el.find(".audio-mgr-modal").length&&(a.setModalPresent(!1),a.$el.find(".audio-mgr-modal").remove())},_bindReloadAudio:function(){var a=this.model.get("initialLoadTime"),b=this;this.audioLoadTimer=setTimeout($.proxy(b._reloadAudio,b),a)},_reloadAudio:function(){this.loadingCount++;var a=this.model.get("player");this.isSoundLoading()===!1&&(this.loadingCount<this.maxLoadingTries?(clearInterval(this.afterReadyStateTimer),this.render(),this.load(),this.$(".audio-mgr-modal").remove(),this.isLoading=!1,this._bindReloadAudio()):this.model.get("isMandatory")?(clearInterval(this.afterReadyStateTimer),this.$(".audio-mgr-modal").remove(),this.isLoading=!1,a.setModalPresent(!1),this._generateNoSoundPopup()):(clearInterval(this.afterReadyStateTimer),a.setModalPresent(!1),a.$el.find(".audio-mgr-modal").remove(),this.isLoading=!1,this.loadWithSound=!1,this.trigger(MathInteractives.Common.Components.Views.AudioManager.AUDIO_EVENT.LOAD_COMPLETE)))},_bindAudioEvents:function(){var a=this;this.$audio.off("progress").on("progress",function(){a.model.set("bufferValue",a.$audio[0].buffered.end(0))}),this.$audio.on("timeupdate",function(){a._timeUpdateCheck(),a.model.set("currentTime",a.$audio[0].currentTime)})},_bindHeaderMuteEvents:function(){var a=this.model.get("player");MathInteractives.Common.Utilities.Models.BrowserCheck.isIOS||(this.listenTo(a,MathInteractives.Common.Player.Views.Player.Events.MUTE_CLICKED,this.onMuteClick),this.listenTo(a,MathInteractives.Common.Player.Views.Player.Events.UNMUTE_CLICKED,this.onUnmuteClick))},onMuteClick:function(){this.isMuted=!0,this.$audio[0].muted=!0},onUnmuteClick:function(){this.isMuted=!1,this.$audio[0].muted=!1},render:function(){var a=this.idPrefix+"audio",b=this.model.getGlobalAudioData(this.audioSpriteId).pathToSrc;0!==$("#"+a).length&&$("#"+a).remove(),$("body").append("<audio id="+a+"></audio>"),$("#"+a).append("<source src="+b+'.mp3 type="audio/mpeg"></source>'),$("#"+a).attr("src",b+".mp3").attr("type","audio/mpeg").attr("codecs","mp3"),this.$audio=$("#"+a)},load:function(){if(this.loadWithSound){var a=$.Deferred(),b=this;return this._showPreloader(),this.$audio[0].muted=!0,this.$audio[0].play(),0===this.loadingCount&&this._bindReloadAudio(),this._afterReadyState(function(){MathInteractives.Common.Utilities.Models.BrowserCheck.isIE?b.$audio[0].muted=!0:b.$audio[0].pause(),b._timerMonitor(),b._bindAudioEvents(),a.resolve()}),a}this.trigger(MathInteractives.Common.Components.Views.AudioManager.AUDIO_EVENT.LOAD_COMPLETE)},isSoundLoaded:function(){return this.model.getBufferValue()/this.model.getDuration()*100>99},isSoundLoading:function(){return this.model.getBufferValue()>0},_timerMonitor:function(){this.model.setDuration(this.$audio[0].duration),this.model.setBufferValue(this.$audio[0].buffered.end(0))},_timeUpdateCheck:function(){var a=this.model.getCurrentPlayingAudio(),b=null;null!=a&&(b=parseFloat(this.model.getGlobalAudioData(this.audioSpriteId).audioData[a].end),this.$audio[0].currentTime>b&&MathInteractives.Common.Components.Views.AudioManager.CURRENT_PLAYED_AUDIO_VIEWS[0].complete())},_afterReadyState:function(a){var b=this;this.afterReadyStateTimer=setInterval(function(){b.$audio[0].readyState>1&&"undefined"!=typeof a&&(clearInterval(b.afterReadyStateTimer),a())})},stopSound:function(){this.$audio[0].pause()},play:function(a){var b=MathInteractives.Common.Components.Views.AudioManager,c=this;if(MathInteractives.global.SpeechStream.stopReading(),MathInteractives.Common.Components.Views.AudioManager.stopAllSounds(),this.loadWithSound){this.isSoundLoaded()===!1&&this.load();var d=function(){var d=c.$audio[0],e=parseFloat(c.model.getGlobalAudioData(c.audioSpriteId).audioData[a].start);d.currentTime=e,d.muted=c.isMuted,d.play(),c.model.setCurrentPlayingAudio(a),MathInteractives.Common.Components.Views.AudioManager.CURRENT_PLAYED_AUDIO_VIEWS.push(c),c.trigger(b.AUDIO_EVENT.PLAY)},e=function(){return c.isSoundLoaded()===!1?void setTimeout(e,10):(d(),void clearTimeout(e))};e()}else c.trigger(b.AUDIO_EVENT.PLAY),c.trigger(b.AUDIO_EVENT.COMPLETE)},pause:function(){var a=MathInteractives.Common.Components.Views.AudioManager;this.loadWithSound&&$audioObj[0].pause(),"undefined"!=typeof a.AUDIO_EVENT.PAUSE&&this.trigger(a.AUDIO_EVENT.PAUSE)},resume:function(){var a=MathInteractives.Common.Components.Views.AudioManager;this.loadWithSound&&($audioObj[0].currentTime=this.model.get("currentTime"),$audioObj[0].play()),"undefined"!=typeof a.AUDIO_EVENT.RESUME&&this.trigger(a.AUDIO_EVENT.RESUME)},complete:function(){var a=MathInteractives.Common.Components.Views.AudioManager;this.loadWithSound&&(this.$audio[0].pause(),this.model.setCurrentPlayingAudio(null),this.removeAudioViewFromArray()),"undefined"!=typeof a.AUDIO_EVENT.COMPLETE&&this.trigger(a.AUDIO_EVENT.COMPLETE)},stop:function(){var a=MathInteractives.Common.Components.Views.AudioManager;this.loadWithSound&&(this.$audio[0].pause(),this.model.setCurrentPlayingAudio(null),this.removeAudioViewFromArray()),"undefined"!=typeof a.AUDIO_EVENT.STOP&&this.trigger(a.AUDIO_EVENT.STOP)},removeAudioViewFromArray:function(){for(var a=0,b=MathInteractives.Common.Components.Views.AudioManager.CURRENT_PLAYED_AUDIO_VIEWS,c=b.length;c>a;a++)if(b[a].idPrefix===this.idPrefix){b.splice(a,1);break}},_generateNoSoundPopup:function(){if(!this.popupShown)if(this.popupShown=!0,this.unloadScreen("sound-manager-popup-screen"),this.loadScreen("sound-manager-popup-screen"),MathInteractives.global.PlayerPopup){var a={text:this.getMessage("sound-manager-popup-text",0),buttons:[{id:"pop-up-retry-button",text:this.getMessage("sound-manager-popup-text",2),response:{isPositive:!0,buttonClicked:"yes-button"}}],closeCallback:{fnc:this._popupCallback,scope:this},title:this.getMessage("sound-manager-popup-text",1),manager:this.manager,player:this.player,path:this.filePath};this.soundManagerPopup=MathInteractives.global.PlayerPopup.createPopup(a)}else this.soundManagerPopup=MathInteractives.global.Theme2.PopUpBox.createPopup({text:this.getMessage("sound-manager-popup-text",0),manager:this.manager,player:this.player,path:this.filePath,idPrefix:this.idPrefix,title:this.getMessage("sound-manager-popup-text",1),buttons:[{id:"pop-up-retry-button",text:this.getMessage("sound-manager-popup-text",2),clickCallBack:{fnc:this._popupCallback,scope:this}}]})},_popupCallback:function(){this.popupShown=!1,this.loadingCount=0,this.render(),this.load(),this._bindReloadAudio()}},{AudioButton:MathInteractives.Common.Player.Views.Base.extend({containerId:null,playBtnOption:{},pauseBtnOption:{},resumeBtnOption:{},audioManagerView:null,soundId:"",model:null,idPrefix:null,filePath:null,tooltipView:null,initialize:function(){var a=this;a._initData(this.options),a._generateButtons(),a.$el.off("click.audio-mgr").on("click.audio-mgr",function(){a._clickListener()});var b=this.$el.attr("id").split(this.idPrefix)[1];a._createHackScreenForAudioBtn(b),a.focusIn(b,function(){a.tooltipView.showTooltip()}),a.focusOut(b,function(){a.tooltipView.hideTooltip()}),a.$el.on("mouseover",function(){a.tooltipView.showTooltip()}),a.$el.on("mouseout",function(){a.tooltipView.hideTooltip()})},_initData:function(a){var b=$("<div/>",{id:a.containerId+"-holder",role:"button"}).css("position","absolute");$("#"+a.containerId).append(b),this.containerId=a.containerId,this.$el=b,this._setButtonOptions(a),this.audioManagerView=a.audioManagerView,this.soundId=a.soundId,this.tabIndex=a.tabIndex,this.model=this.audioManagerView.model,this.manager=this.model.getManager(),this.idPrefix=this.model.getIdPrefix(),this.filePath=this.model.getFilePath()},_setButtonOptions:function(a){var b=MathInteractives.Common.Components.Views.AudioManager.AudioButton;a.type!==b.TYPE.CUSTOM?(this.playBtnOption=b.DEFAULT_BUTTON_OPTIONS.PLAY_BUTTON_OPTIONS,this.pauseBtnOption=b.DEFAULT_BUTTON_OPTIONS.PAUSE_BUTTON_OPTIONS,this.resumeBtnOption=b.DEFAULT_BUTTON_OPTIONS.RESUME_BUTTON_OPTIONS):(this.playBtnOption=a.playBtnOption,this.pauseBtnOption=a.pauseBtnOption,this.resumeBtnOption=a.resumeBtnOption)},_createHackScreenForAudioBtn:function(a){this.audioBtnHack_Prop={elementId:a,tabIndex:this.tabIndex,acc:this.getAccMessage("audio-button","play")},this.createAccDiv(this.audioBtnHack_Prop)},_generateButtons:function(){var a=this.audioManagerView.model.get("player");MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE,this.$el.addClass("sound-btn-holder"),this.playBtnOption.id=this.containerId+"-play-btn",this.pauseBtnOption.id=this.containerId+"-pause-btn",this.resumeBtnOption.id=this.containerId+"-resume-btn",this.playBtnOption.player=a,this.pauseBtnOption.player=a,this.resumeBtnOption.player=a,this.playBtnOption.path=this.filePath,this.pauseBtnOption.path=this.filePath,this.resumeBtnOption.path=this.filePath,this.playBtnOption.baseClass=this.playBtnOption.baseClass||"",this.pauseBtnOption.baseClass=this.pauseBtnOption.baseClass||"",this.resumeBtnOption.baseClass=this.resumeBtnOption.baseClass||"",$("<div/>",{id:this.playBtnOption.id,"class":"sound-mgr-audio-btns "+this.playBtnOption.baseClass}).appendTo(this.$el),$("<div/>",{id:this.pauseBtnOption.id,"class":"sound-mgr-audio-btns "+this.pauseBtnOption.baseClass}).appendTo(this.$el),$("<div/>",{id:this.resumeBtnOption.id,"class":"sound-mgr-audio-btns "+this.resumeBtnOption.baseClass}).appendTo(this.$el),this.playBtnView=MathInteractives.global.Button.generateButton(this.playBtnOption),this.pauseBtnView=MathInteractives.global.Button.generateButton(this.pauseBtnOption),this.resumeBtnView=MathInteractives.global.Button.generateButton(this.resumeBtnOption),this._attachTooltip(),this.showButton(MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.PLAY)},_attachTooltip:function(){this.loadScreen("tts-button-component");var a=this.$el,b=this;this.tooltip=new MathInteractives.Common.Components.Models.Tooltip({id:b.$el.prop("id")+"-tooltip",text:b.getMessage("tts-tooltip-play",0),elementOffsetPosition:a.offset(),elementDimensions:{width:a.width(),height:a.height()},path:b.model.get("filePath"),player:b.model.get("player")}),this.tooltipView=new MathInteractives.Common.Components.Views.Tooltip({model:this.tooltip})},disable:function(a){a===!0?(this.$el.addClass(MathInteractives.Common.Components.Views.AudioManager.AudioButton.DISABLED),this.currentDisplayedBtn.setButtonState(MathInteractives.global.Button.BUTTON_STATE_DISABLED)):(this.$el.removeClass(MathInteractives.Common.Components.Views.AudioManager.AudioButton.DISABLED),this.currentDisplayedBtn.setButtonState(MathInteractives.global.Button.BUTTON_STATE_ACTIVE))},showButton:function(a){switch(this.$(".sound-mgr-audio-btns").hide(),a){case MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.PLAY:this.playBtnView.$el.show(),this.currentDisplayedBtn=this.playBtnView;break;case MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.PAUSE:this.pauseBtnView.$el.show(),this.currentDisplayedBtn=this.pauseBtnView;break;case MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.RESUME:this.resumeBtnView.$el.show(),this.currentDisplayedBtn=this.resumeBtnView}this.$el.css({width:this.currentDisplayedBtn.$el.width(),height:this.currentDisplayedBtn.$el.height()}),this.$el.data("visible-btn-state",a),this.setAccMessage(a)},setAccMessage:function(a){switch(a){case MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.PLAY:this.setAccMessage(this.el.id,this.getAccMessage("audio-button","play"));break;case MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.PAUSE:this.setAccMessage(this.el.id,this.getAccMessage("audio-button","pause"));break;case MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.RESUME:this.setAccMessage(this.el.id,this.getAccMessage("audio-button","resume"))}},_getToolTipMessage:function(a){switch(a){case MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.PLAY:return this.getAccMessage("audio-button","play");case MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.PAUSE:return this.getAccMessage("audio-button","pause");case MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.RESUME:return this.getAccMessage("audio-button","play")}},_clickListener:function(){var a=this.$el;if(a.hasClass(MathInteractives.Common.Components.Views.AudioManager.AudioButton.DISABLED)===!1)switch(a.data("visible-btn-state")){case MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.PLAY:this._play();break;case MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.PAUSE:this._pause();break;case MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE.RESUME:this._resume()}},_pause:function(){var a=MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_STATE;this.audioManagerView.$audio[0].pause(),this.showButton(a.RESUME),this.tooltipView.changeTooltipText(this._getToolTipMessage(a.RESUME)),this.trigger(MathInteractives.Common.Components.Views.AudioManager.AudioButton.AUDIO_EVENT.PAUSE)},_resume:function(){var a=MathInteractives.Common.Components.Views.AudioManager.AudioButton;MathInteractives.global.SpeechStream.stopReading(),this.showButton(a.AUDIO_STATE.PAUSE),this.tooltipView.changeTooltipText(this._getToolTipMessage(a.AUDIO_STATE.PAUSE)),this.audioManagerView.resume(),this.trigger(a.AUDIO_EVENT.RESUME)},_play:function(){MathInteractives.global.SpeechStream.stopReading(),MathInteractives.Common.Components.Views.AudioManager.stopAllSounds();var a=MathInteractives.Common.Components.Views.AudioManager.AudioButton;self.showButton(a.AUDIO_STATE.PAUSE),self.tooltipView.changeTooltipText(self._getToolTipMessage(a.AUDIO_STATE.PAUSE)),this.audioManagerView.play(this.soundId),self.trigger(a.AUDIO_EVENT.PLAY)},stop:function(){var a=MathInteractives.Common.Components.Views.AudioManager.AudioButton;this.audioManagerView.pause(),this.showButton(a.AUDIO_STATE.PLAY),this.model.setCurrentPlayingAudio(null),this.removeAudioViewFromArray(),this.trigger(a.AUDIO_EVENT.STOP)},complete:function(){var a=MathInteractives.Common.Components.Views.AudioManager.AudioButton;this.audioManagerView.pause(),this.showButton(a.AUDIO_STATE.PLAY),this.tooltipView.changeTooltipText(this._getToolTipMessage(a.AUDIO_STATE.PLAY)),this.model.setCurrentPlayingAudio(null),this.removeAudioViewFromArray(),this.trigger(a.AUDIO_EVENT.COMPLETE)},removeAudioViewFromArray:function(){for(var a=0,b=MathInteractives.Common.Components.Views.AudioManager.CURRENT_PLAYED_AUDIO_VIEWS,c=b.length;c>a;a++)if(b[a].idPrefix===this.idPrefix){b.splice(a,1);break}}},{DISABLED:"disabled",AUDIO_STATE:{PLAY:"play",PAUSE:"pause",RESUME:"resume"},AUDIO_EVENT:{PLAY:"audio-manager-play",PAUSE:"audio-manager-pause",RESUME:"audio-manager-resume",STOP:"audio-manager-stop",COMPLETE:"audio-manager-complete"},DEFAULT_BUTTON_OPTIONS:{PLAY_BUTTON_OPTIONS:{containerId:null,type:MathInteractives.Common.Components.Views.Button?MathInteractives.Common.Components.Views.Button.TYPE.CUSTOM:MathInteractives.Common.Components.Theme2.Views.Button,imagePathIds:["sound-mgr-button"],baseClass:"sound-mgr-play-btn",width:29,height:32,path:null},PAUSE_BUTTON_OPTIONS:{containerId:null,type:MathInteractives.Common.Components.Views.Button?MathInteractives.Common.Components.Views.Button.TYPE.CUSTOM:MathInteractives.Common.Components.Theme2.Views.Button,imagePathIds:["sound-mgr-button"],baseClass:"sound-mgr-pause-btn",width:29,height:32,path:null},RESUME_BUTTON_OPTIONS:{containerId:null,type:MathInteractives.Common.Components.Views.Button?MathInteractives.Common.Components.Views.Button.TYPE.CUSTOM:MathInteractives.Common.Components.Theme2.Views.Button,imagePathIds:["sound-mgr-button"],baseClass:"sound-mgr-resume-btn",width:29,height:32,path:null}},TYPE:{DEFAULT:"default",CUSTOM:"custom"}}),CURRENT_PLAYED_AUDIO_VIEWS:[],AUDIO_EVENT:{LOAD_START:"audio-manager-load-start",LOAD_COMPLETE:"audio-manager-load-complete",PLAY:"audio-manager-play",PAUSE:"audio-manager-pause",RESUME:"audio-manager-resume",STOP:"audio-manager-stop",COMPLETE:"audio-manager-complete"},generateAudioButton:function(a){return new this.AudioButton(a)},stopAllSounds:function(){for(var a=MathInteractives.Common.Components.Views.AudioManager.CURRENT_PLAYED_AUDIO_VIEWS,b=a.length,c={},d=0;b>d;d++)c=a[d],c.stop();a=[]},initAudioManager:function(a){var b=new MathInteractives.Common.Components.Models.AudioManager(a),c=new MathInteractives.Common.Components.Views.AudioManager({model:b});return c}}),MathInteractives.global.AudioManager=MathInteractives.Common.Components.Views.AudioManager}(),function(){"use strict";MathInteractives.Common.Components.Models.Tooltip=Backbone.Model.extend({defaults:function(){return{id:"",text:null,tooltipPosition:null,elementOffsetPosition:null,elementDimensions:null,imagePathClasses:null}}})}(),function(){"use strict";MathInteractives.Common.Components.Views.Tooltip=Backbone.View.extend({$tooltip:null,path:null,initialize:function(){this.path=this.model.get("path"),this.render()},render:function(){var a=this.model,b=(a.get("text"),{id:a.get("id"),content:""});this._toolTipHTML=MathInteractives.Common.Components.templates.tooltip(b).trim()},showTooltip:function(){var a=this.model,b=a.get("tooltipPosition"),c=0;$(".de-mathematics-interactive-tooltip").remove(),$("body").append(this._toolTipHTML),$(".de-mathematics-interactive-tooltip.tooltip-left, .de-mathematics-interactive-tooltip.tooltip-right, .de-mathematics-interactive-tooltip.tooltip-arrow").css({"background-image":'url("'+this.path.getImagePath("player-lr")+'")'}).each(function(){c+=$(this).width()}),$(".de-mathematics-interactive-tooltip.tooltip-mid").css({"background-image":'url("'+this.path.getImagePath("player-m")+'")'}).html(a.get("text")).each(function(){c+=$(this).width()}),this.$tooltip=$("#"+a.get("id")),null===b&&(b=this._getTooltipPosition()),this.$tooltip.css({top:b.top,left:b.left,"min-width":c})},hideTooltip:function(){null!==this.$tooltip&&this.$tooltip.remove()},changeTooltipText:function(a){this.model.set("text",a),this.$tooltip&&this.$tooltip.find(".tooltip-mid").html(a)},_getTooltipPosition:function(){var a=this.model,b=a.get("elementOffsetPosition"),c=a.get("elementDimensions"),d={},e=this.$tooltip,f=e.outerWidth(),g=e.outerHeight(),h=MathInteractives.Common.Components.Views.Tooltip,i=a.get("player").$el,j=i.offset(),k=(i.width(),h.INVERTED_TOOLTIP_PADDING);return d.top=b.top-g,d.left=b.left+c.width/2-f/2,d.top<j.top&&(d.top=c.height+k+b.top,this.$tooltip.find(".tooltip-arrow").addClass("inverted-tootlip")),d},updateElementPos:function(a){this.model.set("elementOffsetPosition",a)}},{INVERTED_TOOLTIP_PADDING:6,generateTooltip:function(a){if(a){var b=new MathInteractives.Common.Components.Models.Tooltip(a),c=new MathInteractives.Common.Components.Views.Tooltip({model:b});return c}}}),MathInteractives.global.Tooltip=MathInteractives.Common.Components.Views.Tooltip}(),function(){"use strict";MathInteractives.Common.Utilities.Models.MathUtils=Backbone.Model.extend({},{isPrime:function(a){for(var b=Math.abs(Math.ceil(a/2))+1,c=2;b>c;c++)if(a%c===0)return!1;return!0},getPrimeNumbersInRange:function(a){var b,c=[2];for(b=3;a>b;b+=2)this.isPrime(b)&&c.push(b);return c},generatePrimeFactors:function(a,b){var c,d,e=this.getPrimeNumbersInRange(a),f=[],g=0;for(c=0,d=e.length;d>c;c++)if(b===e[c])return f;for(c=0,d=e.length;d>c;c++)for(;b%e[c]===0;)b/=e[c],f[g]=e[c],g+=1;return f},getGreatestMultiple:function(a){var b=[],c=Math.abs(a),d=Math.ceil(c/2),e=a/c,f=2;if(f>d)return b;for(;d>=f&&c%f!==0;f++);return f!==d+1&&(b.push(e*c/f),b.push(f)),b},isBaseCancellable:function(a,b,c,d){if(c===d){if(a*b>0)return!1}else if(0>a*b)return!1;return!0},addExponents:function(a,b){return a+b},subExponents:function(a,b){return a-b},invertSign:function(a){return-1*a}})}(),function(){"use strict";MathInteractives.Common.Utilities.Models.CanvasRasterLoader=Backbone.Model.extend({containerId:null,nameSpace:null,paperScope:null,count:0,startTime:null,endTime:null,dialogDiv:null,progressBarwidth:500,progressBarHeight:30,dialogVisible:!1,$progressDiv:null,loadedRasters:null,initialize:function(a){var b=this;this._initVariables(a),this._renderDialog(),this._bindEvents(),this._loadRasters(b.rasterSources)},_initVariables:function(a){this.paperScope=a.paperScope,this.rasterSources=a.rasterSources,this.nameSpace=MathInteractives.Interactivities.ToolTipTest.Views.CanvasRasterLoader,this.containerId="#"+a.containerId,this.dialogVisible=a.dialogVisible},_bindEvents:function(){this.listenTo(this,this.nameSpace.EVENTS._LOADING_STARTED,this._showDialog),this.listenTo(this,this.nameSpace.EVENTS._LOADING_PROGRESSED,$.proxy(this._changeProgress,this,this.count)),this.listenTo(this,this.nameSpace.EVENTS._LOADING_FINISHED,this._closeDialog)},_loadRasters:function(a){var b,c=this.paperScope;this._emitStartEvent(),this.loadedRasters=[];for(var d=0;d<a.length;d++)this._isNullOrUndefined(a[d].source)||(b=new c.Raster({source:a[d].source}),b.on("load",$.proxy(this._onLoad,this)),this.loadedRasters.push({raster:b,id:a[d].id}))},_onLoad:function(a){this._emitProgressEvent()},_emitStartEvent:function(){this.count=0,this.startTime=new Date,this.trigger(this.nameSpace.EVENTS._LOADING_STARTED,{count:this.count}),this.trigger(this.nameSpace.EVENTS.LOADING_STARTED,{count:this.count})},_emitProgressEvent:function(){this.count++,this.trigger(this.nameSpace.EVENTS._LOADING_PROGRESSED,{count:this.count}),this.trigger(this.nameSpace.EVENTS.LOADING_PROGRESSED,{count:this.count}),this.count===this.rasterSources.length&&this._emitFinishedEvent();
},_emitFinishedEvent:function(){this.endTime=new Date,this.trigger(this.nameSpace.EVENTS._LOADING_FINISHED,{count:this.count}),this.trigger(this.nameSpace.EVENTS.LOADING_FINISHED,{count:this.count})},_emitInvalidSource:function(){this.trigger(this.nameSpace.EVENTS.INVALID_SOURCE,{count:this.count})},_isNullOrUndefined:function(a){return null===a||"undefined"==typeof a},_renderDialog:function(){var a=this.nameSpace.STYLES;this.dialogDiv=$('<div style="'+a.BACKGROUND+'"></div>',{id:"paperjs-canvas-loader-popup-de-common"}),this.$progressDiv=$('<div style="'+a.PROGRESS_BAR+'"></div>',{id:"paperjs-canvas-loader-popup-de-common-progress-bar"}),this.$throbber=$('<div class="throbber-holder throbber-container throbber-active type2" style="'+a.THROBBER+'"></div>'),this.$text=$('<div style="'+a.TEXT+'"> Rasters Loading....</div>"'),this.dialogDiv.append(this.$progressDiv),this.dialogDiv.append(this.$throbber),this.dialogDiv.append(this.$text),this.dialogDiv.hide(),$(this.containerId).append(this.dialogDiv)},_showDialog:function(){this.dialogVisible&&this.dialogDiv.show()},getRasters:function(){return this.loadedRasters},_changeProgress:function(){var a=this.count/this.rasterSources.length;a*=this.progressBarwidth,this.$progressDiv.css({width:a})},_closeDialog:function(){this.dialogDiv.hide()},destroy:function(){this.dialogDiv.empty(),this.unbind(),this.dialogDiv.remove()}},{EVENTS:{_LOADING_STARTED:"private-loading-started",_LOADING_PROGRESSED:"private-loading-progressed",_LOADING_FINISHED:"private-loading-finished",_LOADING_FAILED:"private-loading-failed",_INVALID_SOURCE:"private-invalid-source",LOADING_STARTED:"loading-started",LOADING_PROGRESSED:"loading-progressed",LOADING_FINISHED:"loading-finished",LOADING_FAILED:"loading-failed",INVALID_SOURCE:"invalid-source"},STYLES:{BACKGROUND:"position:absolute;left:0;top:0;width:928px;height:599px;z-index:2000;background:#391165;",PROGRESS_BAR:"position:absolute;left:214px;bottom:150px;width:500px;height:30px;background:#391165;",THROBBER:"position:absolute;mragin:auto;left:473px;top:322px;",TEXT:"position:absolute;text-align:center;font-weight:bold;font-size:12px;font-family:Montserrat;left:436px;top:354px;"}})}(),function(){"use strict";MathInteractives.Common.Utilities.Models.SvgUtils=Backbone.Model.extend({},{elementProperty:{id:"map",className:"className",centerX:50,centerY:50,lineX:90,lineY:50,arcX:40,arcY:40,count:6,elemType:"path"},elemDefaultValue:{fill:"white",stroke:"black",strokeWidth:"1","fill-opacity":"1"},_getRequiredNameSpace:function(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"xlink":return"http://www.w3.org/1999/xlink";default:return null}},_generateSVGElement:function(a){var b=this._getRequiredNameSpace("svg");return document.createElementNS(b,a)},_setSVGAttribute:function(a,b,c,d,e){var f=this._getRequiredNameSpace(a);void 0!==d?b.setAttributeNS(f,c,d):void 0!==e&&b.setAttributeNS(f,c,e)},createCircle:function(a){var b=this._generateSVGElement("circle"),c=this.elemDefaultValue;return this._setSVGAttribute("",b,"id",a.id),this._setSVGAttribute("",b,"cx",a.cx),this._setSVGAttribute("",b,"cy",a.cy),this._setSVGAttribute("",b,"r",a.r),this._setSVGAttribute("",b,"fill",a.fill,c.fill),this._setSVGAttribute("",b,"stroke",a.stroke,c.stroke),this._setSVGAttribute("",b,"stroke-width",a.strokeWidth,c.strokeWidth),this._setSVGAttribute("",b,"class",a["class"]),this._setSVGAttribute("",b,"fill-opacity",a.fillOpacity,c["fill-opacity"]),b},createLine:function(a){var b=this._generateSVGElement("line"),c=this.elemDefaultValue;return this._setSVGAttribute("",b,"x1",a.x1),this._setSVGAttribute("",b,"y1",a.y1),this._setSVGAttribute("",b,"x2",a.x2),this._setSVGAttribute("",b,"y2",a.y2),this._setSVGAttribute("",b,"stroke",a.stroke,c.stroke),this._setSVGAttribute("",b,"stroke-width",a.strokeWidth,c.strokeWidth),this._setSVGAttribute("",b,"id",a.id),this._setSVGAttribute("",b,"class",a["class"]),b},createRect:function(a){var b=this._generateSVGElement("rect"),c=this.elemDefaultValue;return this._setSVGAttribute("",b,"x",a.x),this._setSVGAttribute("",b,"y",a.y),this._setSVGAttribute("",b,"width",a.width),this._setSVGAttribute("",b,"height",a.height),this._setSVGAttribute("",b,"fill",a.fill,c.fill),this._setSVGAttribute("",b,"stroke",a.stroke,c.stroke),this._setSVGAttribute("",b,"stroke-width",a.strokeWidth,c.strokeWidth),this._setSVGAttribute("",b,"id",a.id),this._setSVGAttribute("",b,"class",a["class"]),this._setSVGAttribute("",b,"fill-opacity",a.fillOpacity,c["fill-opacity"]),b},createSector:function(a){var b=this._generateSVGElement("path"),c=this.elemDefaultValue,d="",e=a.radius,f=a.centerX,g=a.centerY;return d="M"+f+","+g+"l0,"+-e+"a"+e+","+e+" 0 "+a.largeArcFlag+","+a.sweepFlag+(a.endX-f)+","+(a.endY-g+e)+"z",this._setSVGAttribute("",b,"d",d),this._setSVGAttribute("",b,"fill",a.fill,c.fill),this._setSVGAttribute("",b,"stroke",a.stroke,c.stroke),this._setSVGAttribute("",b,"stroke-width",a.strokeWidth,c.strokeWidth),this._setSVGAttribute("",b,"id",a.id),this._setSVGAttribute("",b,"class",a["class"]),this._setSVGAttribute("",b,"fill-opacity",a.fillOpacity,c["fill-opacity"]),b},createPattern:function(a){var b,c,d;return b=this._generateSVGElement("defs"),c=this._generateSVGElement("pattern"),d=this._generateSVGElement("image"),this._setSVGAttribute("xlink",d,"xlink:href",a.imagePath),c.appendChild(d),this._setSVGAttribute("",d,"width",100),this._setSVGAttribute("",d,"height",100),c.setAttribute("id",a.id),this._setSVGAttribute("",d,"x",3),this._setSVGAttribute("",d,"y",3),this._setSVGAttribute("",c,"width",100),this._setSVGAttribute("",c,"height",100),this._setSVGAttribute("",d,"patternContentUnits","objectBoundingBox"),b.appendChild(c),b}})}(),function(){"use strict";var a=Backbone.Model.extend({defaults:{left:0,top:0},getLeft:function(){return this.get("left")},setLeft:function(a){this.set("left",a)},getTop:function(){return this.get("top")},setTop:function(a){this.set("top",a)},setPoint:function(a){this.setLeft(a.left),this.setTop(a.top)}});MathInteractives.Common.Utilities.Models.Point=a;var b=Backbone.Model.extend({defaults:{left:0,top:0,width:0,height:0},getLeft:function(){return this.get("left")},getTop:function(){return this.get("top")},getRight:function(){return this.get("left")+this.get("width")},getBottom:function(){return this.get("top")+this.get("height")},getWidth:function(){return this.get("width")},getHeight:function(){return this.get("height")},getMiddleX:function(){var a=Math.floor(this.get("left")+this.get("width")/2);return a},getMiddleY:function(){var a=Math.floor(this.get("top")+this.get("height")/2);return a},getMiddle:function(){var b=this.getMiddleX(),c=this.getMiddleY();return new a({left:b,top:c})},isPointInRect:function(a){var b=a.getLeft(),c=a.getTop();return b>=this.getLeft()&&b<=this.getRight()&&c>=this.getTop()&&c<=this.getBottom()?!0:!1},inflateRect:function(a,c){return new b({left:this.getLeft()-a,top:this.getTop()-c,width:this.getWidth()+2*a,height:this.getHeight()+2*c})}});MathInteractives.Common.Utilities.Models.Rect=b}();var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];!function(){"use strict";MathInteractives.Common.Components.Theme2.Views.Button=MathInteractives.Common.Player.Views.Base.extend({player:null,idPrefix:null,manager:null,filePath:null,$btn:null,btnTooltipView:null,btnWidthGroup:null,_touchStartTimer:null,initialize:function(){this.player=this.model.player,this.idPrefix=this.model.idPrefix,this.manager=this.model.manager,this.filePath=this.model.filePath,this.render(),this._attachEvents(),this._attachTooltip()},render:function(){this.$btn=this.$el;var a=this.model.get("text"),b=this.model.get("type"),c=(this.model.get("baseClass"),this._getTextHeightWidth(a,"custom-btn "+this.model.get("baseClass"))),d=this.$btn.addClass(this.model.get("displayClass")),e=$("<div/>").addClass("custom-btn-text"),f=$("<div/>").addClass("custom-btn-icon"),g=$("<div/>").addClass("custom-btn-shadowHolder"),h=this.model.get("btnGroup"),i=c.width+2*this.model.get("textPadding"),j=this.model.get("borderRadius"),k=this.model.get("textColor"),l=this.model.get("borderWidth"),m=this.model.get("borderColor"),n=this.model.get("iconPadding");switch(this.$btn.empty(),i<MathInteractives.global.Theme2.Button.DEFAULT_MINWIDTH&&(i=MathInteractives.global.Theme2.Button.DEFAULT_MINWIDTH),this.model.get("width")&&(i=this.model.get("width")),this.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE),b){case MathInteractives.global.Theme2.Button.TYPE.FA_ICON:this._renderFaIcon(d,f,g);break;case MathInteractives.global.Theme2.Button.TYPE.FA_ICONTEXT:this._renderFaIconText(d,f,g,a,b,c,e,i,n);break;case MathInteractives.global.Theme2.Button.TYPE.NEXT_ICONTEXT:case MathInteractives.global.Theme2.Button.TYPE.BACK_ICONTEXT:this._renderFixedIconButtons({$divBtn:d,$divText:e,$divIcon:f,$divShadow:g,text:a,type:b,calculatedWidth:i,iconPadding:n});break;case MathInteractives.global.Theme2.Button.TYPE.TEXT:d.css({height:this.model.get("height"),width:i}).append(e),e.css({"padding-left":d.width()/2-c.width/2,height:d.height(),"line-height":d.height()+MathInteractives.global.Theme2.Button.LINEHEIGHT_ERROR+"px"}).append(a);break;case MathInteractives.global.Theme2.Button.TYPE.TTS_PLAY:case MathInteractives.global.Theme2.Button.TYPE.TTS_PAUSE:case MathInteractives.global.Theme2.Button.TYPE.TTS_SOUND:this._renderTTSButton(d,b);break;case MathInteractives.global.Theme2.Button.TYPE.DRAGGABLE_TILE:case MathInteractives.global.Theme2.Button.TYPE.ALGEBRA_TILE_ONE:case MathInteractives.global.Theme2.Button.TYPE.ALGEBRA_TILE_X:var o,p;this.$btn.css({height:this.model.get("height"),width:this.model.get("width")}),this.$btn.addClass("tile"),null===this.model.get("imagePath")?this.$btn.css({"background-color":this.model.get("colorType").backgroundColor,"box-shadow":"inset 0px -5px "+this.model.get("boxShadowColor")+", 1px 1px 5px #000"}):this.$btn.css({"background-image":'url("'+this.filePath.getImagePath(this.model.get("imagePath"))+'")'}).removeClass("custom-btn"),e.addClass("tile-font"),e.append(a),d.append(e).append(f),f.html(MathInteractives.Common.Components.templates.sliderHandle({data:_.range(6)}).trim()),o=(this.model.get("width")-this.$(".box").width())/2,f.css({"margin-left":o+"px"}),p=(this.model.get("height")-(this.model.get("type").fontSize+this.$(".box").height()))/4,e.css({"padding-top":p+"px","font-size":this.model.get("type").fontSize});break;case MathInteractives.global.Theme2.Button.TYPE.CAMERA:case MathInteractives.global.Theme2.Button.TYPE.HELP:case MathInteractives.global.Theme2.Button.TYPE.DRAWER:case MathInteractives.global.Theme2.Button.TYPE.MUTE:case MathInteractives.global.Theme2.Button.TYPE.UNMUTE:case MathInteractives.global.Theme2.Button.TYPE.SAVE:case MathInteractives.global.Theme2.Button.TYPE.FULL_SCREEN:case MathInteractives.global.Theme2.Button.TYPE.POP_OUT:default:b.icon&&("header"===b.category?this._renderHeaderBtns(a,b,c,d,e,f,i,n):this._renderNonHeaderBtns(a,b,c,d,e,f,i,n))}"undefined"!=typeof j&&null!==j&&(d.css({"border-radius":this.model.get("borderRadius")}),g.css({"border-radius":this.model.get("borderRadius")})),"undefined"!=typeof k&&null!==k&&e.css({color:k}),this.model.get("border")===!0&&("undefined"!=typeof l&&null!==l&&d.css({"border-width":l}),"undefined"!=typeof m&&null!==m&&d.css({"border-color":m})),d.addClass(b["class"]),d.addClass(h),d.append(g),h&&this._resizeBtnGroup(h)},_renderTTSButton:function(a,b){var c=null,d=null;switch(b){case MathInteractives.global.Theme2.Button.TYPE.TTS_PLAY:c="play",d="fa fa-play";break;case MathInteractives.global.Theme2.Button.TYPE.TTS_PAUSE:c="pause",d="fa fa-pause";break;case MathInteractives.global.Theme2.Button.TYPE.TTS_SOUND:c="sound",d="fa fa-volume-up"}var e=$("<div />").addClass("tts-"+c+"-wrapper-container-div tts-wrapper-container-div"),f=$("<div />").addClass("fa-wrapper-container-div"),g=$("<div />").addClass("fa-wrapper-div"),h=$("<div />").css({display:"block"}).addClass(d);e.append(f),f.append(g),g.append(h),a.addClass(b.icon.iconClass).append(e)},_renderHeaderBtns:function(a,b,c,d,e,f,g,h){if(b.icon.faClass){var i=$("<span />").addClass(b.icon.faClass),j=$("<div />").addClass("header-button-div-wrapper"),k=$("<div />").addClass("header-button-span-wrapper");k.css({width:b.icon.fontSize?b.icon.fontSize:15,height:b.icon.fontSize?b.icon.fontSize:15}),i.css({color:b.icon.fontColor?b.icon.fontColor:"#FFFFFF","font-size":b.icon.fontSize?b.icon.fontSize:15,"font-weight":b.icon.fontWeight?b.icon.fontWeight:"normal",position:"relative","line-height":"normal !important"}),k.append(i),j.append(k),f.append(j)}else f.css({"background-image":'url("'+this.filePath.getImagePath(MathInteractives.global.Theme2.Button.BUTTON_ICON_PATH)+'")'});if(f.addClass(b.icon.iconClass),b.hasText){this.manager.unloadScreen("common-button-text"),this.manager.loadScreen("common-button-text");var l=this.manager.getMessage("common-button-text",b.id+"-button");e.append(l),"left"===b.textPosition?d.append(e).append(f):d.append(f).append(e)}else d.append(f)},_renderNonHeaderBtns:function(a,b,c,d,e,f,g,h){var c,i,j=this.model.get("icon")?this.model.get("icon"):b.icon,a=this.model.get("text"),k=this.model.get("textPadding");if(b.icon.faClass){var l=$("<span />").addClass(b.icon.faClass),m=$("<div />").addClass("non-header-button-wrapper-div");m.css({height:b.icon.fontSize?b.icon.fontSize:15,width:b.icon.fontSize?b.icon.fontSize:15}),l.css({color:b.icon.fontColor?b.icon.fontColor:"#FFFFFF","font-size":b.icon.fontSize?b.icon.fontSize:15,"font-weight":b.icon.fontWeight?b.icon.fontWeight:"normal","text-align":"center"}),m.append(l),f.append(m)}else f.css({"background-image":'url("'+j.iconPath+'")'});if(f.css({height:j.height,width:j.width}),b.icon.iconClass&&f.addClass(b.icon.iconClass),b===MathInteractives.global.Theme2.Button.TYPE.ICONTEXT){var n,c=this._getTextHeightWidth(a,"custom-btn "+this.model.get("baseClass"));c.width+=1,e.css({width:c.width,"float":"left"}).append(a),f.css({"float":"left"}),this.model.get("width")&&(k=(this.model.get("width")-c.width-j.width)/2),"left"===this.model.get("textPosition")?(d.append(e).append(f),e.css({"margin-left":k})):(d.append(f).append(e),f.css({"margin-left":k})),i=c.height>j.height?c.height:j.height,this.model.get("height")&&(i=this.model.get("height")),i<MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT&&(i=MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT),e.css({height:i,"line-height":i+MathInteractives.global.Theme2.Button.LINEHEIGHT_ERROR+"px"}),f.css({"margin-top":i/2-j.height/2}),n=e.width()+f.width(),d.css({height:i,width:n+2*k})}else this.model.get("width")&&(k=(this.model.get("width")-j.width)/2),i=this.model.get("height")?this.model.get("height"):j.height,i<MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT&&(i=MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT),f.css({"margin-top":i/2-j.height/2,"margin-left":k}),d.css({height:i,width:j.width+2*k}).append(f)},_renderFaIcon:function(a,b,c){var d=this.model.get("icon"),e=this.model.get("type"),f=e.iconClass,g=$("<span />").addClass(d.faClass).addClass(d.baseClass),h=$("<div />");if(h.css({display:"table-cell","vertical-align":"middle","text-align":"center",width:"inherit",height:"inherit"}),d.applyIconButtonWrapper){var i=$("<div/>");i.addClass(d.iconButtonWrapperClass),h.append(i)}g.css({color:d.fontColor,"font-size":d.fontSize,"font-weight":d.fontWeight,margin:"auto",position:"relative"}).addClass(f),d.applyIconButtonWrapper?i.append(g):h.append(g),a.css({height:this.model.get("height"),width:this.model.get("width")}).append(h)},_renderFaIconText:function(a,b,c,d,e,f,g,h,i){var f,j,k=this.model.get("icon"),l=$("<span />").addClass(k.faClass),d=this.model.get("text"),m=this.model.get("textPadding");l.css({color:k.fontColor?k.fontColor:"#FFFFFF","font-size":k.fontSize?k.fontSize:16,"font-weight":k.fontWeight?k.fontWeight:"normal"}),a.css({height:this.model.get("height"),width:this.model.get("width")}),b.css({height:k.height,width:k.width}).append(l),e.icon.iconClass&&b.addClass(e.icon.iconClass);var n,f=this._getTextHeightWidth(d,"custom-btn "+this.model.get("baseClass"));f.width+=1,g.css({width:f.width,"float":"left"}).append(d),b.css({"float":"left"}),this.model.get("width")&&(m=(this.model.get("width")-f.width-k.width)/2),"left"===this.model.get("textPosition")?(a.append(g).append(b),g.css({"margin-left":m})):(a.append(b).append(g),b.css({"margin-left":m})),j=f.height>k.height?f.height:k.height,this.model.get("height")&&(j=this.model.get("height")),j<MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT&&(j=MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT),g.css({height:j,"line-height":j+MathInteractives.global.Theme2.Button.LINEHEIGHT_ERROR+"px"}),b.css({"margin-top":j/2-k.height/2}),n=g.width()+b.width(),a.css({height:j,width:n+2*m})},_renderFixedIconButtons:function(a){var b,c,d=$.extend(!0,{},a.type.iconDefault,a.type.icon),e=this.model.get("baseClass"),f=$("<span />").addClass(this.getFontAwesomeClass(d.faIconId)),g=MathInteractives.global.Theme2.Button.DEFAULT_MINWIDTH,h=this.model.get("textPadding")||a.type.textPadding||15,i=this.model.get("textPosition")||d.textPosition,j=a.text||this.manager.getMessage(a.type.textId,0),k=this.getChevronHeight();a.$divIcon.css({height:k,width:d.width}).append(f);var l=0,m=this._getTextHeightWidth(j,"custom-btn "+e);m.width+=1,a.$divText.css({width:m.width,"margin-right":d.textMargin,"float":"left"}).append(j),a.$divIcon.css({"float":"left"}),m.width&&(l+=m.width),d.width&&(l+=d.width),d.textMargin&&(l+=d.textMargin),this.model.get("width")?h=(this.model.get("width")-l)/2:g>l+2*h&&(h=(g-l)/2),"left"===i?(a.$divBtn.append(a.$divText).append(a.$divIcon),a.$divText.css({"margin-left":h})):(a.$divBtn.append(a.$divIcon).append(a.$divText),a.$divIcon.css({"margin-left":h})),this.model.get("height")?b=this.model.get("height"):(b=m.height>k?m.height:k,b<MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT&&(b=MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT)),a.$divText.css({height:b,"line-height":b+MathInteractives.global.Theme2.Button.LINEHEIGHT_ERROR+"px"}),a.$divIcon.css({"margin-top":b/2-k/2}),c=l+2*h,c=this.model.get("width")?this.model.get("width"):l+2*h>g?l+2*h:g,a.$divBtn.css({height:b,width:c})},getChevronHeight:function(){var a=this.model.get("type"),b=a.iconDefault.height;return MathInteractives.Common.Utilities.Models.BrowserCheck.isChrome===!0||MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile===!0?b+1:b+3},_resizeBtnGroup:function(a){for(var b=this.player?this.player.$(".custom-btn."+a):$(".de-mathematics-interactive.player-theme-2 .custom-btn."+a),c=0,d=0,e=0,f=b.length;f>e;e++)$(b[e]).height()>c&&(c=$(b[e]).height()),$(b[e]).width()>d&&(d=$(b[e]).width());for(e=0;f>e;e++)this._changeBtnsHeightWidth($(b[e]),c,d)},_changeBtnsHeightWidth:function(a,b,c){var d=a.find(".custom-btn-text"),e=a.find(".custom-btn-icon"),f=this._getTextHeightWidth(d.text(),"custom-btn"),g=f.width+e.width();a.css({height:b,width:c}),d.length>0&&e.length>0?(d.css({height:b,"line-height":b+MathInteractives.global.Theme2.Button.LINEHEIGHT_ERROR+"px"}),e.css({"margin-top":(b-e.height())/2}),a.children().first().css({"margin-left":(c-g)/2})):e.length>0?e.css({"margin-top":(b-e.height())/2,"margin-left":(c-g)/2}):d.length>0&&d.css({height:b,"line-height":b+MathInteractives.global.Theme2.Button.LINEHEIGHT_ERROR+"px","padding-left":(c-g)/2})},_onBtnClick:function(){var a=this.getButtonState();a===MathInteractives.global.Theme2.Button.BUTTON_STATE_SELECTED?this.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE):a===MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE&&this.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_SELECTED)},_getTextHeightWidth:function(a,b,c){if(this.player)return this.player.getTextHeightWidth(a,b,null,c);this.$el.parents(".de-mathematics-interactive").find("#text-dimentions-hack").css({position:"absolute",top:"0px",width:"100%"}),this.$el.parents(".de-mathematics-interactive").find("#text-dimentions-hack-holder").css({position:"absolute"});var d={height:0,width:0},e=this.$el.parents(".de-mathematics-interactive").find("#text-dimentions-hack-holder-wrapper").addClass(c),f=e.find("#text-dimentions-hack-holder").addClass(b).html(a);return a&&""!==a&&(d.height=f.getTextHeight(),d.width=f.getTextWidth()),e.removeClass(c),f.removeClass(b).html(""),d},_getImageHeightWidth:function(a){var b={height:0,width:0},c=$("<img>",{src:this.filePath.getImagePath(a)});return $("body").append(c),b.height=c.height(),b.width=c.width(),c.hide(),c.remove(),b},_attachEvents:function(){var a=this.$btn;MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile?(a.on("touchstart",$.proxy(this._touchStartEvent,this)),a.on("touchend",$.proxy(this._touchEndEvent,this)),MathInteractives.Common.Utilities.Models.Utils.addTouchAndHoldHandler(this,a,600,this._onMouseOver,this._onMouseOut,"theme2-button"),a.on("click",$.proxy(this._onMouseup,this))):(a.on("mouseenter",$.proxy(this._onMouseOver,this)),a.on("mouseleave",$.proxy(this._onMouseOut,this)),a.hover($.proxy(this._onMouseOver,this),$.proxy(this._onMouseOut,this)),a.on("mousedown",$.proxy(this._onMouseDown,this)),a.on("mouseup",$.proxy(this._removeTooltip,this)),MathInteractives.Common.Utilities.Models.Utils.EnableTouch(a)),this.model.get("isToggle")&&this.$btn.off("click.custom-button",$.proxy(this._onBtnClick,this)).on("click.custom-button",$.proxy(this._onBtnClick,this))},setButtonState:function(a,b){var c,d,e,f=MathInteractives.Common.Components.Theme2.Views.Button,g=(this.model.get("baseClass"),this.manager),h=5;this.$btn.removeClass(f.BUTTON_STATE_ACTIVE+" "+f.BUTTON_STATE_SELECTED+" "+f.BUTTON_STATE_DISABLED+" clickEnabled hover"),this.$btn.addClass(a),a===f.BUTTON_STATE_ACTIVE||a===f.BUTTON_STATE_SELECTED?(this.$btn.addClass("clickEnabled"),g&&g.enableTab(this.$btn.attr("id"),!0)):(this.$btn.removeClass("down"),g&&g.enableTab(this.$btn.attr("id"),!1),this.$btn.css("cursor","default").removeClass("hover")),this.model.set("currentState",a),b&&(b.shadow&&(h=b.shadow),c=b.$dragTile,d=b.isCenterAlign,a===f.BUTTON_STATE_ACTIVE?(c.find(".custom-btn-icon").show(),e=(c.height()-(parseInt(c.find(".custom-btn-text.tile-font").css("font-size").replace("px",""))+c.find(".box").height()))/4,c.find(".custom-btn-text.tile-font").css("padding-top",e+"px")):a===f.BUTTON_STATE_DISABLED&&(c.find(".custom-btn-icon").hide(),c.css("cursor","default"),d===!0&&(e=(c.height()-c.find(".custom-btn-text.tile-font").css("font-size").replace("px","")-h)/2,c.find(".custom-btn-text.tile-font").css("padding-top",e+"px"))))},getButtonState:function(){return this.model.get("currentState")},_bindMouseMoveForCursor:function(){var a=this;this.$btn.off("mousemove.cursor-change").on("mousemove.cursor-change",function(){a._onMouseOver(),a._unbindMouseMoveForCursor()})},_unbindMouseMoveForCursor:function(){this.$btn.off("mousemove.cursor-change")},_isBtnActive:function(){var a=!1;return(this.getButtonState()===MathInteractives.Common.Components.Theme2.Views.Button.BUTTON_STATE_ACTIVE||this.getButtonState()===MathInteractives.Common.Components.Theme2.Views.Button.BUTTON_STATE_SELECTED)&&(a=!0),a},_onMouseOver:function(a){if(this._isBtnActive()){var b=(this.model.get("toggleButton"),this.getButtonState()),c=MathInteractives.Common.Components.Theme2.Views.Button.BUTTON_STATE_DISABLED;b!==c&&this.$btn.css("cursor","pointer").addClass("hover")}},_onMouseOut:function(a){if(this.$btn.css("cursor","default").removeClass("hover"),this._isBtnActive()){var b=(this.model.get("toggleButton"),this.getButtonState()),c=MathInteractives.Common.Components.Theme2.Views.Button.BUTTON_STATE_DISABLED;b!==c&&this._removeTooltip()}},_onMouseDown:function(a){this._isBtnActive()&&($(document).one({mouseup:$.proxy(this._onMouseup,this),touchend:$.proxy(this._onMouseup,this)}),this.$btn.addClass("down"))},_onMouseup:function(a){this._isBtnActive()&&(null!==this._touchStartTimer&&window.clearTimeout(this._touchStartTimer),this.$btn.removeClass("down"))},_touchStartEvent:function(a){this._isBtnActive()&&this.$btn.addClass("down")},_touchEndEvent:function(a){this._isBtnActive()&&this.$btn.removeClass("down")},showButton:function(){this.$btn.show()},hideButton:function(){this.$btn.hide()},changeTooltipText:function(a){this.btnTooltipView.changeTooltipText(a)},changeText:function(a){var b=this._getTextHeightWidth(a,"custom-btn "+this.model.get("baseClass")),c=this.$btn;this.$btn.find(".custom-btn-text").css({"padding-left":c.width()/2-b.width/2}).html(a),this.model.set("text",a)},_removeTooltip:function(){this.btnTooltipView&&this.btnTooltipView.hideTooltip()},removeTooltip:function(){this._removeTooltip()},_attachTooltip:function(){var a,b=this.model.get("tooltipText"),c=this.model.get("tooltipType"),d=this.model.get("tooltipColorType");b&&0!==b.length&&(a={elementEl:this.$btn.attr("id"),idPrefix:this.idPrefix,manager:this.manager,_player:this.player,type:d,arrowType:c,path:this.filePath,text:b},this.btnTooltipView=MathInteractives.global.Theme2.Tooltip.generateTooltip(a))}},{DEFAULT_BORDERWIDTH:2,LINEHEIGHT_ERROR:1,DEFAULT_MINWIDTH:115,DEFAULT_MINHEIGHT:30,BUTTON_ICON_PATH:"buttons-icons",BUTTON_STATE_ACTIVE:"active",BUTTON_STATE_SELECTED:"selected",BUTTON_STATE_DISABLED:"disabled",DEFAULT_TYPE:{id:"text","class":"custom-btn-type-text",borderWidth:0,textPadding:30},DEFAULT_COLORTYPE:{id:"blue",textColor:"#FFF",borderColor:"#FFF",displayClass:"custom-btn custom-btn-blue"},DEFAULT_TTS_COLORTYPE:{id:"tts-blue",displayClass:"custom-btn custom-btn-tts-blue"},TYPE:{TEXT:{id:"text","class":"custom-btn-type-text",height:38,borderWidth:0,textPadding:30},ICON:{id:"icon","class":"custom-btn-type-icon",borderWidth:0,textPadding:15},FA_ICON:{id:"fa-icon","class":"custom-btn-type-fa-icon",iconClass:"custom-btn-type-fa-icon-span"},FA_ICONTEXT:{id:"fa-icontext","class":"custom-btn-type-fa-icon-text",textPadding:15,height:38},TTS_PLAY:{id:"tts-play","class":"custom-btn-type-tts custom-btn-type-tts-play",icon:{iconClass:"tts-play-icon"}},TTS_PAUSE:{id:"tts-pause","class":"custom-btn-type-tts custom-btn-type-tts-pause",icon:{iconClass:"tts-pause-icon"}},TTS_SOUND:{id:"tts-sound","class":"custom-btn-type-tts custom-btn-type-tts-sound",icon:{iconClass:"tts-sound-icon"}},ICONTEXT:{id:"icontext","class":"custom-btn-type-icontext",textPadding:15,height:38},CAMERA:{id:"camera","class":"custom-btn-type-camera",category:"header",icon:{iconClass:"camera-icon",faClass:"fa fa-camera",fontSize:24}},FULL_SCREEN:{id:"full-screen","class":"custom-btn-type-fullscreen",category:"header",icon:{iconClass:"full-screen-icon"}},HELP:{id:"help","class":"custom-btn-type-help",category:"header",icon:{iconClass:"help-icon",faClass:"fa fa-question-circle",fontSize:24},isToggle:!0},MUTE:{id:"mute","class":"custom-btn-type-mute",category:"header",icon:{iconClass:"mute-icon",faClass:"fa fa-volume-up",fontSize:24}},UNMUTE:{id:"mute","class":"custom-btn-type-unmute",category:"header",icon:{iconClass:"unmute-icon",faClass:"fa fa-volume-off",fontSize:24}},DRAWER:{id:"drawer","class":"custom-btn-type-drawer",category:"header",icon:{iconClass:"drawer_icon",faClass:"fa fa-bars",fontSize:24},isToggle:!0},POP_OUT:{id:"pop-out","class":"custom-btn-type-popout",category:"header",icon:{iconClass:"pop-out-icon"}},SAVE:{id:"save","class":"custom-btn-type-save",category:"header",icon:{iconClass:"save-icon",faClass:"fa fa-folder",fontSize:20},hasText:!0,textPosition:"right"},RESET:{id:"reset","class":"custom-btn-type-reset",icon:{iconClass:"reset-icon",faClass:"fa fa-undo",fontSize:20,width:38,height:20}},BACK:{id:"back","class":"custom-btn-type-back",icon:{iconClass:"back-icon",faClass:"fa fa-chevron-left",fontSize:16}},NEXT:{id:"next","class":"custom-btn-type-next",icon:{iconClass:"next-icon",faClass:"fa fa-chevron-right",fontSize:16}},DRAGGABLE_TILE:{id:"draggable","class":"custom-btn-type-draggable",height:48,width:48,fontSize:20},ALGEBRA_TILE_ONE:{id:"algebra-one","class":"custom-btn-type-draggable algebra-tile-one",height:40,width:40,fontSize:14},ALGEBRA_TILE_X:{id:"algebra-x","class":"custom-btn-type-draggable algebra-tile-x",height:40,width:100,fontSize:14},NEXT_ICONTEXT:{id:"next-icontext","class":"custom-btn-type-next-icon-text",textId:"comm16",height:38,iconDefault:{faIconId:"fixed-next",height:14,width:9,textPosition:"left",textPadding:15,textMargin:5}},BACK_ICONTEXT:{id:"back-icontext","class":"custom-btn-type-back-icon-text",textId:"comm15",height:38,iconDefault:{faIconId:"fixed-back",height:14,width:14,textPosition:"right",textPadding:15}}},COLORTYPE:{GREEN:{id:"green",textColor:"#FFF",borderColor:"#FFF",displayClass:"custom-btn custom-btn-green"},BLUE:{id:"blue",textColor:"#FFF",borderColor:"#FFF",displayClass:"custom-btn custom-btn-blue"},WHITE:{id:"white",textColor:"#2e3a3a",borderColor:"#000",displayClass:"custom-btn custom-btn-white"},DRAWER:{id:"drawer",textColor:"#FFF",borderColor:"#FFF",displayClass:"custom-btn custom-btn-drawer"},HEADER_BLUE:{id:"header-blue",textColor:"#FFF",borderColor:"#FFF",displayClass:"custom-btn custom-btn-header-blue"},HEADER_BLUE_SHADOW:{id:"header-blue-shadow",textColor:"#FFF",borderColor:"#FFF",displayClass:"custom-btn custom-btn-header-blue-shadow"},DRAGGABLE_BLUE:{id:"draggable-blue",displayClass:"custom-btn-type-draggable-blue"},DRAGGABLE_GREEN:{id:"draggable-green",displayClass:"custom-btn-type-draggable-green"},DRAGGABLE_BLACK:{id:"draggable-black",displayClass:"custom-btn-type-draggable-black"},DRAGGABLE_WITH_IMAGE:{displayClass:"custom-btn-type-draggable-image"},TTS_BLUE:{id:"tts-blue",displayClass:"custom-btn custom-btn-tts-blue"},TTS_GREEN:{id:"tts-green",displayClass:"custom-btn custom-btn-tts-green"},TTS_ORANGE:{id:"tts-orange",displayClass:"custom-btn custom-btn-tts-orange"},TTS_WHITE:{id:"tts-white",displayClass:"custom-btn custom-btn-tts-white"},ALGEBRA_NEGATIVE:{id:"algebra-negative",backgroundColor:"#b4065f",boxShadowColor:"#660336",textColor:"#FFF"}},BEHAVIOR_TYPE:{TOGGLE:"behavior-type-toggle",PUSH:"behavior-type-push",TOGGLE_AND_PUSH:"behavior-type-toggle-and-push"},setButtonBehavior:function(a){if(a.buttons&&a.buttons.length>0){var b=a.buttons,c=b.length,d=MathInteractives.Common.Components.Theme2.Views.Button;switch(a.type){case d.BEHAVIOR_TYPE.TOGGLE:
for(var e=0;c>e;e++)b[e].$el.off("click.button-behavior-click").on("click.button-behavior-click",function(b){d.handleToggleBehavior(b,a)});break;case d.BEHAVIOR_TYPE.PUSH:for(var e=0;c>e;e++)b[e].$el.off("click.button-behavior-click").on("click.button-behavior-click",function(b){d.handlePushBehavior(b,a)});break;case d.BEHAVIOR_TYPE.TOGGLE_AND_PUSH:for(var e=0;c>e;e++)b[e].$el.off("click.button-behavior-click").on("click.button-behavior-click",function(b){d.handleToggleAndPushBehavior(b,a)})}}},handleToggleBehavior:function(a,b){var c=b.buttons,d=c.length,e=a.currentTarget,f=$(e),g=MathInteractives.Common.Components.Theme2.Views.Button;if(!f.hasClass(g.BUTTON_STATE_DISABLED)&&!f.hasClass(g.BUTTON_STATE_SELECTED))for(var h=0;d>h;h++){var i=c[h];if(i.getButtonState()!==g.BUTTON_STATE_DISABLED)if(e==i.el){i.setButtonState(g.BUTTON_STATE_SELECTED);var j=h;setTimeout(function(){c[j].$el.removeClass("clickEnabled").addClass("selected-toggle-button")},1)}else i.setButtonState(g.BUTTON_STATE_ACTIVE),i.$el.removeClass("selected-toggle-button")}},handlePushBehavior:function(a,b){var c=b.buttons,d=c.length,e=a.currentTarget,f=$(e),g=MathInteractives.Common.Components.Theme2.Views.Button;if(!f.hasClass(g.BUTTON_STATE_DISABLED))for(var h=0;d>h;h++){var i=c[h];i.getButtonState()!==g.BUTTON_STATE_DISABLED&&e==i.el&&(i.getButtonState()===g.BUTTON_STATE_SELECTED?i.setButtonState(g.BUTTON_STATE_ACTIVE):i.setButtonState(g.BUTTON_STATE_SELECTED))}},handleToggleAndPushBehavior:function(a,b){var c=b.buttons,d=c.length,e=a.currentTarget,f=$(e),g=MathInteractives.Common.Components.Theme2.Views.Button;if(!f.hasClass(g.BUTTON_STATE_DISABLED))for(var h=0;d>h;h++){var i=c[h];i.getButtonState()!==g.BUTTON_STATE_DISABLED&&(e==i.el?i.getButtonState()===g.BUTTON_STATE_SELECTED?i.setButtonState(g.BUTTON_STATE_ACTIVE):i.setButtonState(g.BUTTON_STATE_SELECTED):i.setButtonState(g.BUTTON_STATE_ACTIVE))}},generateButton:function(a){var b;if(a){a.data.border===!0&&"undefined"==typeof a.data.borderWidth&&$.extend(a.data,{borderWidth:MathInteractives.global.Theme2.Button.DEFAULT_BORDERWIDTH}),(a.data.type===MathInteractives.global.Theme2.Button.TYPE.TTS_PAUSE||a.data.type===MathInteractives.global.Theme2.Button.TYPE.TTS_PLAY||a.data.type===MathInteractives.global.Theme2.Button.TYPE.TTS_SOUND)&&"undefined"==typeof a.data.colorType&&$.extend(a.data,{colorType:MathInteractives.global.Theme2.Button.DEFAULT_TTS_COLORTYPE}),"undefined"==typeof a.data.colorType&&$.extend(a.data,{colorType:MathInteractives.global.Theme2.Button.DEFAULT_COLORTYPE}),a.data.border===!0&&"undefined"==typeof a.data.borderColor&&$.extend(a.data,{borderColor:a.data.colorType.borderColor}),"undefined"==typeof a.data.type&&$.extend(a.data,{type:MathInteractives.global.Theme2.Button.DEFAULT_TYPE}),"undefined"==typeof a.data.textPadding&&$.extend(a.data,{textPadding:a.data.type.textPadding}),"undefined"==typeof a.data.isToggle&&$.extend(a.data,{isToggle:a.data.type.isToggle}),"undefined"==typeof a.data.height&&(a.data.type.height?$.extend(a.data,{height:a.data.type.height}):$.extend(a.data,{height:MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT})),"undefined"==typeof a.data.width&&a.data.type.width&&$.extend(a.data,{width:a.data.type.width}),"undefined"!=typeof a.data.icon&&$.extend(a.data.type,{icon:a.data.icon}),"undefined"==typeof a.data.iconPadding&&$.extend(a.data,{iconPadding:a.data.type.iconPadding}),"undefined"==typeof a.data.baseClass||null===a.data.baseClass?$.extend(a.data,{displayClass:a.data.colorType.displayClass}):$.extend(a.data,{displayClass:"custom-btn "+a.data.baseClass}),"undefined"==typeof a.data.textColor&&$.extend(a.data,{textColor:a.data.colorType.textColor}),"undefined"==typeof a.data.boxShadowColor&&$.extend(a.data,{boxShadowColor:a.data.colorType.boxShadowColor}),b="#"+a.data.id;var c=new MathInteractives.Common.Components.Theme2.Models.Button(a.data);c.player=a.player,c.idPrefix=a.idPrefix,c.manager=a.manager,c.filePath=a.path;var d=new MathInteractives.Common.Components.Theme2.Views.Button({el:b,model:c});return d}}}),MathInteractives.global.Theme2||(MathInteractives.global.Theme2={}),MathInteractives.global.Theme2.Button=MathInteractives.Common.Components.Theme2.Views.Button}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.Button=Backbone.Model.extend({defaults:function(){return{id:"",baseClass:"",text:null,icon:null,tooltipText:"",tooltipPosition:null,width:null,height:null,type:null,colorType:null,boxShadowColor:null,borderColor:null,textColor:null,borderWidth:null,border:!1,borderRadius:null,textPadding:null,imagePath:null,isToggle:!1,btnGroup:null,tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.BOTTOM_MIDDLE,tooltipColorType:MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.GENERAL,currentState:MathInteractives.Common.Components.Theme2.Views.Button.BUTTON_STATE_ACTIVE,paddingBetnIconText:null}}})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.ButtonExtended=MathInteractives.Common.Components.Theme2.Views.Button.extend({initialize:function(){this.constructor.__super__.initialize.apply(this,arguments)},render:function(){this.$btn=this.$el;var a=this.model.get("text"),b=this.model.get("type"),c=(this.model.get("baseClass"),this._getTextHeightWidth(a,"custom-btn "+this.model.get("baseClass"))),d=this.$btn.addClass(this.model.get("displayClass")),e=$("<div/>").addClass("custom-btn-text"),f=$("<div/>").addClass("custom-btn-icon"),g=$("<div/>").addClass("custom-btn-shadowHolder"),h=this.model.get("btnGroup"),i=c.width+2*this.model.get("textPadding"),j=this.model.get("borderRadius"),k=this.model.get("textColor"),l=this.model.get("borderWidth"),m=this.model.get("borderColor"),n=this.model.get("iconPadding"),o=this.model.get("paddingBetnIconText")?this.model.get("paddingBetnIconText"):10;switch(this.$btn.empty(),this.model.get("width")&&(i=this.model.get("width")),this.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE),b){case MathInteractives.global.Theme2.Button.TYPE.FA_ICON:this._renderFaIcon(d,f,g);break;case MathInteractives.global.Theme2.Button.TYPE.FA_ICONTEXT:i=this.getButtonWidth(i+o),this._renderFaIconText(d,f,g,a,b,c,e,i,n);break;case MathInteractives.global.Theme2.Button.TYPE.NEXT_ICONTEXT:case MathInteractives.global.Theme2.Button.TYPE.BACK_ICONTEXT:this._renderFixedIconButtons({$divBtn:d,$divText:e,$divIcon:f,$divShadow:g,text:a,type:b,calculatedWidth:i,iconPadding:n});break;case MathInteractives.global.Theme2.Button.TYPE.TEXT:i=this.getButtonWidth(i),d.css({height:this.model.get("height"),width:i}).append(e),e.css({"padding-left":d.width()/2-c.width/2,height:d.height(),"line-height":d.height()+MathInteractives.global.Theme2.Button.LINEHEIGHT_ERROR+"px"}).append(a);break;case MathInteractives.global.Theme2.Button.TYPE.TTS_PLAY:case MathInteractives.global.Theme2.Button.TYPE.TTS_PAUSE:case MathInteractives.global.Theme2.Button.TYPE.TTS_SOUND:this._renderTTSButton(d,b);break;case MathInteractives.global.Theme2.Button.TYPE.DRAGGABLE_TILE:case MathInteractives.global.Theme2.Button.TYPE.ALGEBRA_TILE_ONE:case MathInteractives.global.Theme2.Button.TYPE.ALGEBRA_TILE_X:var p,q;this.$btn.css({height:this.model.get("height"),width:this.model.get("width")}),this.$btn.addClass("tile"),null===this.model.get("imagePath")?this.$btn.css({"background-color":this.model.get("colorType").backgroundColor,"box-shadow":"inset 0px -5px "+this.model.get("boxShadowColor")+", 1px 1px 5px #aaa"}):this.$btn.css({"background-image":'url("'+this.filePath.getImagePath(this.model.get("imagePath"))+'")'}).removeClass("custom-btn"),e.addClass("tile-font"),e.append(a),d.append(e).append(f),f.html(MathInteractives.Common.Components.templates.sliderHandle({data:_.range(6)}).trim()),p=(this.model.get("width")-this.$(".box").width())/2,f.css({"margin-left":p+"px"}),q=(this.model.get("height")-(this.model.get("type").fontSize+this.$(".box").height()))/4,e.css({"padding-top":q+"px","font-size":this.model.get("type").fontSize});break;case MathInteractives.global.Theme2.Button.TYPE.CAMERA:case MathInteractives.global.Theme2.Button.TYPE.HELP:case MathInteractives.global.Theme2.Button.TYPE.DRAWER:case MathInteractives.global.Theme2.Button.TYPE.MUTE:case MathInteractives.global.Theme2.Button.TYPE.UNMUTE:case MathInteractives.global.Theme2.Button.TYPE.SAVE:case MathInteractives.global.Theme2.Button.TYPE.FULL_SCREEN:case MathInteractives.global.Theme2.Button.TYPE.POP_OUT:default:b.icon&&("header"===b.category?this._renderHeaderBtns(a,b,c,d,e,f,i,n):(i=b===MathInteractives.global.Theme2.Button.TYPE.ICONTEXT?this.getButtonWidth(i+o):this.getButtonWidth(i),this._renderNonHeaderBtns(a,b,c,d,e,f,i,n)))}"undefined"!=typeof j&&null!==j&&(d.css({"border-radius":this.model.get("borderRadius")}),g.css({"border-radius":this.model.get("borderRadius")})),"undefined"!=typeof k&&null!==k&&e.css({color:k}),this.model.get("border")===!0&&("undefined"!=typeof l&&null!==l&&d.css({"border-width":l}),"undefined"!=typeof m&&null!==m&&d.css({"border-color":m})),d.addClass(b["class"]),d.addClass(h),d.append(g),h&&this._resizeBtnGroup(h)},_renderFaIconText:function(a,b,c,d,e,f,g,h,i){var f,j,k=this.model.get("icon"),l=$("<span />").addClass(k.faClass),d=this.model.get("text"),m=this.model.get("textPadding"),n=this.model.get("paddingBetnIconText")?this.model.get("paddingBetnIconText"):10;l.css({color:k.fontColor?k.fontColor:"#FFFFFF","font-size":k.fontSize?k.fontSize:16,"font-weight":k.fontWeight?k.fontWeight:"normal"}),a.css({height:this.model.get("height"),width:this.model.get("width")}),b.css({height:k.height,width:k.width}).append(l),e.icon.iconClass&&b.addClass(e.icon.iconClass);var o,f=this._getTextHeightWidth(d,"custom-btn "+this.model.get("baseClass"));f.width+=1,g.css({width:f.width,"float":"left"}).append(d),b.css({"float":"left"}),this.model.get("width")&&(m=(this.model.get("width")-f.width-k.width-n)/2,15>=m&&(m=this.model.get(m)?this.model.get(m):15)),"left"===this.model.get("textPosition")?(a.append(g).append(b),g.css({"margin-left":m}),b.css({"margin-left":n})):(a.append(b).append(g),b.css({"margin-left":m}),g.css({"margin-left":n})),j=f.height>k.height?f.height:k.height,this.model.get("height")&&(j=this.model.get("height")),j<MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT&&(j=MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT),g.css({height:j,"line-height":j+MathInteractives.global.Theme2.Button.LINEHEIGHT_ERROR+"px"}),b.css({"margin-top":j/2-k.height/2}),o=g.width()+b.width(),a.css({height:j,width:o+2*m+n})},_renderNonHeaderBtns:function(a,b,c,d,e,f,g,h){var c,i,j=this.model.get("icon")?this.model.get("icon"):{iconPath:this.filePath.getImagePath(MathInteractives.global.Theme2.Button.BUTTON_ICON_PATH)},a=this.model.get("text"),k=this.model.get("textPadding");if(b.icon.faClass){var l=$("<span />").addClass(b.icon.faClass),m=$("<div />").addClass("non-header-button-wrapper-div");m.css({height:b.icon.fontSize?b.icon.fontSize:15,width:b.icon.fontSize?b.icon.fontSize:15}),l.css({color:b.icon.fontColor?b.icon.fontColor:"#FFFFFF","font-size":b.icon.fontSize?b.icon.fontSize:15,"font-weight":b.icon.fontWeight?b.icon.fontWeight:"normal","text-align":"center"}),m.append(l),f.append(m)}else f.css({"background-image":'url("'+j.iconPath+'")'});if(f.css({height:j.height,width:j.width}),b.icon.iconClass&&f.addClass(b.icon.iconClass),b===MathInteractives.global.Theme2.Button.TYPE.ICONTEXT){var n,c=this._getTextHeightWidth(a,"custom-btn "+this.model.get("baseClass"));c.width+=1;var o=this.model.get("paddingBetnIconText")?this.model.get("paddingBetnIconText"):10;e.css({width:c.width,"float":"left"}).append(a),f.css({"float":"left"}),this.model.get("width")&&(k=(this.model.get("width")-c.width-j.width-o)/2,15>=k&&(k=this.model.get(k)?this.model.get(k):15)),"left"===this.model.get("textPosition")?(d.append(e).append(f),e.css({"margin-left":k}),f.css({"margin-left":o})):(d.append(f).append(e),f.css({"margin-left":k}),e.css({"margin-left":o})),i=c.height>j.height?c.height:j.height,this.model.get("height")&&(i=this.model.get("height")),i<MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT&&(i=MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT),e.css({height:i,"line-height":i+MathInteractives.global.Theme2.Button.LINEHEIGHT_ERROR+"px"}),f.css({"margin-top":i/2-j.height/2}),n=e.width()+f.width();var p=n+2*k;d.css({height:i,width:p+o})}else{this.model.get("width")&&(k=(this.model.get("width")-j.width)/2,15>=k&&(k=this.model.get(k)?this.model.get(k):15)),i=this.model.get("height")?this.model.get("height"):j.height,i<MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT&&(i=MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT),f.css({"margin-top":i/2-j.height/2,"margin-left":k});var p=j.width+2*k;d.css({height:i,width:p}).append(f)}},getButtonWidth:function(a){var b=this.model.get("width");return null===b||"undefined"==typeof b?a<MathInteractives.global.Theme2.Button.DEFAULT_MINWIDTH?(this.model.set("width",MathInteractives.global.Theme2.Button.DEFAULT_MINWIDTH),MathInteractives.global.Theme2.Button.DEFAULT_MINWIDTH):(this.model.set("width",a),a):b}},{generateButton:function(a){var b;if(a){a.data.border===!0&&"undefined"==typeof a.data.borderWidth&&$.extend(a.data,{borderWidth:MathInteractives.global.Theme2.Button.DEFAULT_BORDERWIDTH}),(a.data.type===MathInteractives.global.Theme2.Button.TYPE.TTS_PAUSE||a.data.type===MathInteractives.global.Theme2.Button.TYPE.TTS_PLAY||a.data.type===MathInteractives.global.Theme2.Button.TYPE.TTS_SOUND)&&"undefined"==typeof a.data.colorType&&$.extend(a.data,{colorType:MathInteractives.global.Theme2.Button.DEFAULT_TTS_COLORTYPE}),"undefined"==typeof a.data.colorType&&$.extend(a.data,{colorType:MathInteractives.global.Theme2.Button.DEFAULT_COLORTYPE}),a.data.border===!0&&"undefined"==typeof a.data.borderColor&&$.extend(a.data,{borderColor:a.data.colorType.borderColor}),"undefined"==typeof a.data.type&&$.extend(a.data,{type:MathInteractives.global.Theme2.Button.DEFAULT_TYPE}),"undefined"==typeof a.data.textPadding&&$.extend(a.data,{textPadding:a.data.type.textPadding}),"undefined"==typeof a.data.isToggle&&$.extend(a.data,{isToggle:a.data.type.isToggle}),"undefined"==typeof a.data.height&&(a.data.type.height?$.extend(a.data,{height:a.data.type.height}):$.extend(a.data,{height:MathInteractives.global.Theme2.Button.DEFAULT_MINHEIGHT})),"undefined"==typeof a.data.width&&a.data.type.width&&$.extend(a.data,{width:a.data.type.width}),"undefined"!=typeof a.data.icon&&$.extend(a.data.type,{icon:a.data.icon}),"undefined"==typeof a.data.iconPadding&&$.extend(a.data,{iconPadding:a.data.type.iconPadding}),"undefined"==typeof a.data.baseClass||null===a.data.baseClass?$.extend(a.data,{displayClass:a.data.colorType.displayClass}):$.extend(a.data,{displayClass:"custom-btn "+a.data.baseClass}),"undefined"==typeof a.data.textColor&&$.extend(a.data,{textColor:a.data.colorType.textColor}),"undefined"==typeof a.data.boxShadowColor&&$.extend(a.data,{boxShadowColor:a.data.colorType.boxShadowColor}),b="#"+a.data.id;var c=new MathInteractives.Common.Components.Theme2.Models.Button(a.data);c.player=a.player,c.idPrefix=a.idPrefix,c.manager=a.manager,c.filePath=a.path;var d=new MathInteractives.Common.Components.Theme2.Views.ButtonExtended({el:b,model:c});return d}}}),MathInteractives.global.Theme2.ButtonExtended=MathInteractives.Common.Components.Theme2.Views.ButtonExtended}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.Tooltip||(MathInteractives.Common.Components.Theme2.Views.Tooltip=MathInteractives.Common.Player.Views.Base.extend({player:null,idPrefix:null,manager:null,_isTts:null,text:null,_tooltipType:null,elementEl:null,space:10,padding:10,baseWidthOfArrow:10,ttsSize:25,_isCloseBtnPresent:null,closeButtonView:null,ttsView:null,ttsBaseClass:null,accDivOffset:null,initialize:function(){this.player=this.model.get("_player"),this.idPrefix=this.model.get("idPrefix"),this.elementEl=this.model.get("elementEl"),this.manager=this.model.get("manager"),this._isTts=this.model.get("isTts"),this.text=this.model.get("text"),this.baseClass=this.model.get("baseClass"),this.arrowBaseClass=this.model.get("arrowBaseClass"),this.tabIndex=this.model.get("tabIndex"),this.accText=this.model.get("accText"),this.accDivOffset=this.model.get("accDivOffset"),this._tooltipType=this.model.get("type"),this.ttsBaseClass=this.model.get("ttsBaseClass"),this.closeOnDocumentClick=this.model.get("closeOnDocumentClick"),this.eleCenter={x:$("#"+this.elementEl).width()/2,y:$("#"+this.elementEl).height()/2},this.model.get("fromElementCenter")===!1&&(this.eleCenter={x:0,y:0}),this._isCloseBtnPresent=this.model.get("showCloseBtn"),this.render()},render:function(){var a=MathInteractives.global.Theme2.Tooltip.TYPE;this._generateTooltip(),(this._tooltipType===a.GENERAL_WHITE||this._tooltipType===a.GENERAL)&&this._attachEvents()},_generateTooltip:function(){var a,b,c,d,e=this.model.get("isArrow"),f=this.elementEl,g=this.$el,h=MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE,i=f+(this.model.get("isHelp")?"-help-tooltip":"-tooltip"),j=$("#"+f).parents(".activity-area-container .theme2-tabs");this.baseClass?g.addClass("theme2-tooltip tooltip-"+this._tooltipType.category+"-container "+this.baseClass).attr("id",i).addClass(this.model.get("identityClass")):g.addClass("theme2-tooltip tooltip-"+this._tooltipType.category+"-container").attr("id",i).addClass(this.model.get("identityClass")),a=$("<div>",{id:i+"-text-container","class":"text-container"}).html(this.text),b=$("<div>",{id:i+"-tts","class":"tts-container"}),d=$("<div>",{"class":"border-div"}),c=this.arrowBaseClass?$("<div>",{"class":"arrow-div "+this.arrowBaseClass}):$("<div>",{"class":"arrow-div"}),g.append(a).append(b).append(d).append(c),j.length>0?(j.find("#"+g.attr("id")).length>0&&j.find("#"+g.attr("id")).remove(),j.append(g)):this.player.$el.append(g),this._setCustomValues(),this._isTts===!1?this.hideTts():this._generateTtsForTooltip(),e===!1&&(d.hide(),c.hide()),this.hideTooltip(),this._tooltipType!==h.GENERAL&&this._tooltipType!==h.GENERAL_WHITE||this.model.get("isTooltipPermanent")===!0||g.attr("data-html2canvas-ignore","true"),this._isCloseBtnPresent&&this._createCloseBtn()},_createCloseBtn:function(){this.unloadScreen("tooltip-close-btn-screen"),this.loadScreen("tooltip-close-btn-screen");var a=this.$el,b=this.elementEl,c=b+(this.model.get("isHelp")?"-help-tooltip":"-tooltip"),d=$("<div>",{id:c+"-close-btn-wrapper","class":"close-btn-wrapper"}),e=$("<div>",{id:c+"-close-btn-container","class":"close-btn-container"});d.append(e),a.append(d);var f=this.model.get("filePath");this.filePath=f;var g={};g.faClass=this.getFontAwesomeClass("close"),g.fontColor="#ffffff",g.fontSize=16;var h={idPrefix:this.idPrefix,player:this.player,manager:this.manager,path:this.filePath,data:{id:c+"-close-btn-container",type:MathInteractives.global.Theme2.Button.TYPE.FA_ICON,icon:g,height:23,width:23,tooltipText:this.manager.getMessage("tooltip-close-btn-text",0),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_LEFT}};this.closeButtonView=new MathInteractives.global.Theme2.Button.generateButton(h)},_createHackDivForText:function(a){var b=a.replace(this.idPrefix,""),c={elementId:b+"-text-container",tabIndex:this.tabIndex,acc:this.accText?this.accText:this.text};this.accDivOffset&&(c.offsetTop=this.accDivOffset.offsetTop,c.offsetLeft=this.accDivOffset.offsetLeft),this.createAccDiv(c)},_generateTtsForTooltip:function(){var a,b=this.model.get("path"),c=this.elementEl+(this.model.get("isHelp")?"-help-tooltip":"-tooltip");a={idPrefix:this.idPrefix,containerId:c+"-tts",isEnabled:!1,tabIndex:20,manager:this.manager,player:this.player,filePath:b,messagesToPlay:[c+"-text-container"]},this.ttsBaseClass&&(a.ttsBaseClass=this.ttsBaseClass),this.ttsView=MathInteractives.global.Theme2.PlayerTTS.generateTTS(a)},renderTTSAccessibility:function(){this.ttsView.renderTTSAccessibility(this.tabIndex+2)},_attachEvents:function(){var a=this.model,b=$("#"+this.elementEl);a.get("isTooltipPermanent")!==!0&&(a.get("isShownOnClick")===!0?(b.off("click.tooltip").on("click.tooltip",$.proxy(this.showTooltip,this)),this.bindEventOnDocument()):a.get("isHelp")===!1&&b.off("mouseenter.tooltip, mouseover.tooltip").on("mouseenter.tooltip, mouseover.tooltip",$.proxy(this._elementMouseEnter,this)).off("mouseleave.tooltip").on("mouseleave.tooltip",$.proxy(this._elementMouseLeave,this)),MathInteractives.Common.Utilities.Models.Utils.EnableTouch(b),b.off("contextmenu.tooltip").on("contextmenu.tooltip",function(){return!1}))},_elementMouseEnter:function(){this.showTooltip()},_elementMouseLeave:function(){this.hideTooltip()},_setCustomValues:function(){var a=this.model.get("containerWidth"),b=this.model.get("containerHeight"),c=this.model.get("backgroundColor"),d=this.model.get("textColor"),e=this.$el,f=this.padding,g=this.model.get("borderColor"),h=e.find(".text-container");null!=g&&(e.css({"border-color":g}),e.find(".border-div").css({"border-bottom-color":g})),null!=b&&h.css({height:b-f+"px"}),null!=a&&h.css({width:a-f+"px"}),null!=c&&(e.css({background:c}),e.find(".arrow-div").css({"border-bottom-color":c})),null!=d&&e.css({color:d})},showTooltip:function(){var a,b,c,d,e,f,g,h,i,j=this.$el,k=this.model.get("playerWidth"),l=$("#"+this.elementEl),m={elementLeft:l.offset().left,elementTop:l.offset().top,elementWidth:l.outerWidth(),elementHeight:l.outerHeight(),tooltipWidth:j.outerWidth(),tooltipHeight:j.outerHeight(),boarderWidth:(j.outerWidth()-j.width())/2,space:this.space,baseWidthOfArrow:this.baseWidthOfArrow,eleCenter:this.eleCenter,positionType:this.model.get("positionType"),isArrow:this.model.get("isArrow")};if(j.find(".arrow-div"),this.displayTooltip(),this.model.trigger("show.tooltip",m),a=this.model.get("calcData"),b=a.arrowDivTop,c=a.arrowDivLeft,d=a.deg,e=a.borderDivTop,f=a.borderDivLeft,g=a.tooltipTop,h=a.tooltipLeft,i=a.tooltipHeight,this._tooltipType===MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.FORM_VALIDATION){var n=this.elementEl+(this.model.get("isHelp")?"-help-tooltip":"-tooltip");this._createHackDivForText(n),this._isTts===!0&&this.renderTTSAccessibility()}j.offset({top:g,left:h}),j.css({top:Math.floor(j.position().top),left:Math.floor(j.position().left)}),j.position().left<=10&&(h=10,j.css({left:h})),j.position().left+j.width()>928&&(h=k-10-j.width(),j.css({left:h})),j.find(".arrow-div").css({top:b+"px",left:c+"px","-webkit-transform":"rotate("+d+")","-ms-transform":"rotate("+d+")","-moz-transform":"rotate("+d+")",transform:"rotate("+d+")"}),j.find(".border-div").css({top:e+"px",left:f+"px","-webkit-transform":"rotate("+d+")","-ms-transform":"rotate("+d+")","-moz-transform":"rotate("+d+")",transform:"rotate("+d+")"}),this._isTts===!0&&this.$el.find(".tts-container").css({"margin-top":(i-this.ttsSize-2)/2+"px"}),this.closeOnDocumentClick&&this.bindEventOnDocument(),this._isCloseBtnPresent&&(this._setCloseBtnPosition(),this.bindEventOnCloseBtn())},_setCloseBtnPosition:function(){var a=this.model.get("closeBtnPosition"),b=this.$(".close-btn-wrapper");b.addClass(a)},hideTooltip:function(){this.$el.hide(),this.closeOnDocumentClick&&this.unbindEventOnDocument(),this._isCloseBtnPresent&&this.unbindEventOnCloseBtn()},displayTooltip:function(){this.$el.show()},removeTooltip:function(){this.$el.remove()},showTts:function(){this.$el.find(".tts-container").show()},hideTts:function(){this.$el.find(".tts-container").hide()},changeText:function(a,b){this.$el.find(".text-container").html(a),this.model.set("text",a),this.text=a,this.accText=b},changeContainerHeight:function(a){this.model.set("containerHeight",a),this.$el.find(".text-container").css("height",a+"px")},changeContainerWidth:function(a){a=a||null,a?(this.model.set("containerWidth",a),this.$el.find(".text-container").css("width",a+"px")):this.model.set("containerWidth",null)},adjustPosition:function(a){for(var b=0;b<a.length;b++)if(this._arrowType=a[b],this.model.set("arrowType",this._arrowType),this._checkContainment())return b;return-1},_bringInContainer:function(){if(this._checkContainment())return!1;this.displayTooltip();var a=this.$el,b=$("#"+this.elementEl),c=a.parent(),d=c.offset().left+c.width(),e=c.offset().top+c.height(),f=this.$el.find(".arrow-div"),g=parseFloat(a.css("left")),h=parseFloat(a.css("top")),i=g+a.width(),j=h+a.height(),k=i-d,l=j-e+50,m=b.offset().left,n=b.width()+m,o=b.offset().top;if(b.height()+o,i>c.width()-12&&(k+=c.offset().left+d-n,g-=k,parseFloat(f.css("left")),f.css({left:a.outerWidth()-b.width()/2-this.baseWidthOfArrow})),j>c.height()-30){l-=c.offset().top+e-o+30,h+=l;var p=parseFloat(f.css("top"));f.css({top:p-l})}if(10>=g&&(parseFloat(f.css("left")),g=m-c.offset().left,f.css({left:(b.width()-this.baseWidthOfArrow)/2})),10>=h){var p=parseFloat(f.css("top"));h=o-c.offset().top,f.css({top:(b.height()-this.baseWidthOfArrow)/2})}return a.css({left:g,top:h}),!0},_checkContainment:function(){var a=!1,b=this.$el,c=b.parent();return this.displayTooltip(),a=this._isInContainer(c,b),this.hideTooltip(),a},_isInContainer:function(a,b){var c=a.width(),d=a.height(),e=parseFloat(b.css("left")),f=parseFloat(b.css("top")),g=e+b.width(),h=f+b.height();return e>10&&f>10&&c-10>g&&d-30>h},setArrowType:function(a){this.model.set("arrowType",a)},getArrowType:function(){return this.model.get("arrowType")},isSpaceAvailable:function(a){this.showTooltip();var b=(MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE,this.getOpenDirections());return b[a]?!0:!1},getOpenDirections:function(){var a=this.$el,b=$("#"+this.elementEl),c=a.parent(),d=c.offset().left+20,e=c.offset().top+20,f=d+c.width()-30,g=e+c.height()-80,h=(this.$el.find(".arrow-div"),parseFloat(a.css("left"))),i=parseFloat(a.css("top")),j=(h+a.width(),i+a.height(),b.offset().left),k=b.width()+j,l=b.offset().top,m=b.height()+l,n=MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE,o=[],p=a.outerWidth()+this.baseWidthOfArrow,q=a.outerHeight()+this.baseWidthOfArrow;return j-d>p+this.eleCenter.x&&(o[n.LEFT_MIDDLE]=n.LEFT_MIDDLE),f-k>p+this.eleCenter.x&&(o[n.RIGHT_MIDDLE]=n.RIGHT_MIDDLE),l-e>q+this.eleCenter.y&&(o[n.TOP_MIDDLE]=n.TOP_MIDDLE),g-m>q+this.eleCenter.y&&(o[n.BOTTOM_MIDDLE]=n.BOTTOM_MIDDLE),o},bindEventOnDocument:function(){if(this.model.get("isTooltipPermanent")!==!0){var a=this;$(document).on("mousedown."+a.el.id+" touchstart."+a.el.id,function(b){if(1!=$(b.target).parents("#"+a.el.id).length){a._isTts&&a.stopReading(),a.hideTooltip();var b=MathInteractives.Common.Components.Theme2.Views.Tooltip.EVENTS.TOOLTIP_HIDE_ON_DOCUMENT_CLICK;a.trigger(b)}})}},bindEventOnCloseBtn:function(){if(this.closeButtonView){var a=this;this.closeButtonView.$el.on("mousedown",function(b){a._isTts&&a.stopReading(),a.hideTooltip();var b=MathInteractives.Common.Components.Theme2.Views.Tooltip.EVENTS.TOOLTIP_HIDE_ON_CLOSEBTN_CLICK;a.trigger(b)})}},unbindEventOnDocument:function(){var a=this;$(document).off("mousedown."+a.el.id+" touchstart."+a.el.id)},unbindEventOnCloseBtn:function(){this.closeButtonView&&this.closeButtonView.$el.off("mousedown")}},{TYPE:{CUSTOM:{id:"custom",category:"custom"},GENERAL:{id:"general",category:"general","class":"tooltip-general-container"},FORM_VALIDATION:{id:"form-validation",category:"form-validation","class":"tooltip-form-validation-container"},GENERAL_WHITE:{id:"general-white",category:"general-white","class":"tooltip-general-white-container"}},ARROW_TYPE:{TOP_LEFT:"top-left",TOP_MIDDLE:"top-middle",TOP_RIGHT:"top-right",LEFT_TOP:"left-top",LEFT_MIDDLE:"left-middle",LEFT_BOTTOM:"left-bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_MIDDLE:"bottom-middle",BOTTOM_RIGHT:"bottom-right",RIGHT_TOP:"right-top",RIGHT_MIDDLE:"right-middle",RIGHT_BOTTOM:"right-bottom",TOP_LEFT_CENTER:"top-left-center",TOP_RIGHT_CENTER:"top-right-center",BOTTOM_LEFT_CENTER:"bottom-left-center",BOTTOM_RIGHT_CENTER:"bottom-right-center"},POSITION_TYPE:{CENTER:"center",LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom"},generateTooltip:function(a){var b,c;return a?(b=new MathInteractives.Common.Components.Theme2.Models.Tooltip(a),c=new MathInteractives.Common.Components.Theme2.Views.Tooltip({model:b})):void 0},CLOSE_BTN_POSITION_TYPE:{TOP_RIGHT:"top-right",TOP_LEFT:"top-left",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right"},EVENTS:{TOOLTIP_HIDE_ON_DOCUMENT_CLICK:"tooltip_hide_on_document_click",TOOLTIP_HIDE_ON_CLOSEBTN_CLICK:"tooltip_hide_on_closebtn_click"}}),MathInteractives.global.Theme2.Tooltip=MathInteractives.Common.Components.Theme2.Views.Tooltip)}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.Tooltip=Backbone.Model.extend({defaults:function(){return{id:"",text:null,baseClass:null,arrowBaseClass:null,type:MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.GENERAL,arrowType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.BOTTOM_MIDDLE,isTts:!1,backgroundColor:null,textColor:null,containerWidth:null,containerHeight:null,borderColor:null,accText:null,elementEl:null,isArrow:!0,calcData:null,fromElementCenter:!1,isHelp:!1,positionType:MathInteractives.Common.Components.Theme2.Views.Tooltip.POSITION_TYPE.CENTER,arrowIn:1,identityClass:null,isShownOnClick:null,closeOnDocumentClick:!1,playerWidth:928,showCloseBtn:!1,isTooltipPermanent:void 0,ttsBaseClass:null,accDivOffset:null,closeBtnPosition:MathInteractives.Common.Components.Theme2.Views.Tooltip.CLOSE_BTN_POSITION_TYPE.TOP_RIGHT}},initialize:function(){this.on("show.tooltip",this._showTooltip,this)},_showTooltip:function(a){var b,c,d,e,f,g,h,h,i,j=a.tooltipHeight,k=a.boarderWidth,l=a.tooltipWidth,m=a.baseWidthOfArrow,n=a.elementTop,o=a.elementLeft,p=a.elementWidth,q=a.elementHeight,r=a.eleCenter,s=a.space,t=a.positionType,u=a.isArrow,v=this.get("arrowType"),w=this.get("arrowIn"),x=MathInteractives.Common.Components.Theme2.Views.Tooltip;switch((MathInteractives.Common.Utilities.Models.BrowserCheck.isIOS===!0||MathInteractives.Common.Utilities.Models.BrowserCheck.isNexus===!0||MathInteractives.Common.Utilities.Models.BrowserCheck.isIE11===!0||this.get("type")===MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.FORM_VALIDATION)&&(w=2),MathInteractives.Common.Utilities.Models.BrowserCheck.isIE!==!0&&MathInteractives.Common.Utilities.Models.BrowserCheck.isIE11!==!0||v!==x.ARROW_TYPE.BOTTOM&&v!==x.ARROW_TYPE.BOTTOM_LEFT&&v!==x.ARROW_TYPE.BOTTOM_RIGHT&&v!==x.ARROW_TYPE.BOTTOM_MIDDLE||(w=1),v){case x.ARROW_TYPE.TOP_MIDDLE:b=j-k-w,c=l/2-k-m,d=c,e=j-k-(w-1),f="180deg",h=Math.ceil(n-(j+m)),i=Math.ceil(o+p/2-l/2),h+=r.y;break;case x.ARROW_TYPE.TOP_LEFT:b=j-k-w,c=l-(2*m+s),d=c,e=j-k,f="180deg",h=Math.ceil(n-(j+m)),i=Math.ceil(o-l+(s+2*m)),h+=r.y;break;case x.ARROW_TYPE.TOP_LEFT_CENTER:b=j-k-w,c=l-(2*m+s),d=c,e=j-k,f="180deg",h=Math.ceil(n-(j+m)),i=Math.ceil(o+p/2-l+(s+m)),h+=r.y;break;case x.ARROW_TYPE.TOP_RIGHT:b=j-k-w,c=s,d=c,e=j-k,f="180deg",h=Math.ceil(n-(j+m)),i=Math.ceil(o+p-(s+2*m)),h+=r.y;break;case x.ARROW_TYPE.TOP_RIGHT_CENTER:b=j-k-w,c=s,d=c,e=j-k,f="180deg",h=Math.ceil(n-(j+m)),i=Math.ceil(o+p/2-(s+m)),h+=r.y;break;case x.ARROW_TYPE.BOTTOM_MIDDLE:b=-m+w,c=l/2-k-m,d=c,e=-m,f="0deg",h=Math.ceil(n+q+m),i=Math.ceil(o+p/2-l/2),h-=r.y;break;case x.ARROW_TYPE.BOTTOM_LEFT:b=-m+w,c=l-(2*m+s),d=c,e=-m,f="0deg",h=Math.ceil(n+(q+m)),i=Math.ceil(o-l+(s+2*m)),h-=r.y;break;case x.ARROW_TYPE.BOTTOM_LEFT_CENTER:b=-m+w,c=l-(2*m+s),d=c,e=-m,f="0deg",h=Math.ceil(n+(q+m)),i=Math.ceil(o-l+p/2+m+s),h-=r.y;break;case x.ARROW_TYPE.BOTTOM_RIGHT:b=-m+w,c=s,d=c,e=-m,f="0deg",h=Math.ceil(n+(q+m)),i=Math.ceil(o+p-(s+2*m)),h-=r.y;break;case x.ARROW_TYPE.BOTTOM_RIGHT_CENTER:b=-m+w,c=s,d=c,e=-m,f="0deg",h=Math.ceil(n+(q+m)),i=Math.ceil(o+p/2-(m+s)),h-=r.y;break;case x.ARROW_TYPE.LEFT_BOTTOM:b=s,c=l-m+k+w,d=c+1,e=b,f="90deg",h=Math.ceil(n+q-(s+2*m)),i=Math.ceil(o-(l+m)),i+=r.x;break;case x.ARROW_TYPE.LEFT_MIDDLE:b=Math.round(j/2-k-m/2),c=l-m+k+w-1,d=c+2,e=b,f="90deg",h=Math.ceil(n+q/2-j/2),i=Math.ceil(o-(l+m)),i+=r.x;break;case x.ARROW_TYPE.LEFT_TOP:b=Math.round(j-k-(m+s)),c=l-m+k+w,
d=c+1,e=b,f="90deg",h=Math.ceil(n-j+s+2*m),i=Math.ceil(o-(l+m)),i+=r.x;break;case x.ARROW_TYPE.RIGHT_BOTTOM:b=s,c=-m-5+w,d=-m-5,e=b,f="270deg",h=Math.ceil(n+q-(s+2*m)),i=Math.ceil(o+(p+m)),i-=r.x;break;case x.ARROW_TYPE.RIGHT_MIDDLE:b=j/2-k-m/2,c=-m-5+w,d=-m-5,e=b,f="270deg",h=Math.ceil(n+q/2-j/2),i=Math.ceil(o+p+m),i-=r.x;break;case x.ARROW_TYPE.RIGHT_TOP:b=j-k-(m+s),c=-m-5+w,d=-m-5,e=b,f="270deg",h=Math.ceil(n-j+s+2*m),i=Math.ceil(o+(p+m)),h+=r.y}if(u===!1)switch(t){case x.POSITION_TYPE.LEFT:i=Math.ceil(o);break;case x.POSITION_TYPE.RIGHT:i=Math.ceil(o+p-l);break;case x.POSITION_TYPE.TOP:h=Math.ceil(n);break;case x.POSITION_TYPE.BOTTOM:h=Math.ceil(n+q-j)}g={arrowDivTop:b,arrowDivLeft:c,borderDivLeft:d,borderDivTop:e,deg:f,tooltipTop:h,tooltipLeft:i,tooltipHeight:j},this.set("calcData",g)}})}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.sliderHandle=a(function(a,b,c,d,e){function f(a,b){return'\r\n       <div class="inside-divs" ></div>\r\n    '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i="",j=this,k="function",l=this.escapeExpression;return i+='<div class="box">\r\n    ',g=c.each.call(b,b&&b.data,{hash:{},inverse:j.noop,fn:j.program(1,f,e),data:e}),(g||0===g)&&(i+=g),i+='\r\n</div>\r\n<div id="',(h=c.idPrefix)?g=h.call(b,{hash:{},data:e}):(h=b&&b.idPrefix,g=typeof h===k?h.call(b,{hash:{},data:e}):h),i+=l(g),(h=c.sliderId)?g=h.call(b,{hash:{},data:e}):(h=b&&b.sliderId,g=typeof h===k?h.call(b,{hash:{},data:e}):h),i+=l(g)+'-dummy-slider-focus-div" class="dummy-slider-focus-div"></div>'})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.Help=Backbone.Model.extend({defaults:function(){return{currentIndex:1,totalHelpItems:0,helpElements:[],tooltipHeight:110,tooltipWidth:260,lineHeight:30,positionArray:[]}},initialize:function(){this.updateItemList(this.get("helpElements"))},updateItemList:function(a){this.set("currentIndex",0===a.length?0:1),this.set("totalHelpItems",a.length),this.set("helpElements",a)}})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.Help=MathInteractives.Common.Player.Views.Base.extend({idPrefix:null,manager:null,_player:null,filePath:null,prevButtonView:null,nextButtonView:null,tooltipView:null,visibleElements:[],toggle:!1,animationType:null,events:function(){return{"click .help-footer-prev-btn.clickEnabled":"_onPrevBtnClick","click .help-footer-next-btn.clickEnabled":"_onNextBtnClick"}},initialize:function(){this.filePath=this.model.get("filePath"),this.manager=this.model.get("manager"),this.player=this.model.get("player"),this.idPrefix=this.player.getIDPrefix(),this.$el=$("#"+this.idPrefix+"player").find(".player"),this.baseIndex=this.getTabIndex("help-btn"),this.keyCode=-1,this._setCustomValues(),this.render(),this.filterHelpItems(),this._displayHelpTooltip(),this.loadScreen("help-screen"),this._attachEvents()},_setFocusToHeaderSubtitleOnShiftTab:function(a){var b=this._isEventTabOrShiftTab(a);b.shiftTabKey===!0&&this.getTabIndex("help-btn")!==this.baseIndex+9&&(a.preventDefault(),this.setFocus("header-subtitle"))},_setFocusToHelpOnTab:function(a){var b=this._isEventTabOrShiftTab(a);b.tabKey===!0&&(a.preventDefault(),0===this.$(".custom-btn-type-save").length?this.setFocus("help-btn"):this.setFocus("save-btn"))},_isEventTabOrShiftTab:function(a){var b=a?a.which:a.keyCode,c={shiftTabKey:!1,tabKey:!1};return 9===b&&("undefined"!=typeof a.shiftKey&&a.shiftKey===!0&&(c.shiftTabKey=!0),a.shiftKey!==!0&&(c.tabKey=!0)),c},_setCustomValues:function(){var a=MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE;this.directionMapper={left:a.LEFT_MIDDLE,top:a.TOP_MIDDLE,right:a.RIGHT_MIDDLE,bottom:a.BOTTOM_MIDDLE},this.priorityArray=["left","top","right","bottom"],this.model.set("positionArray",this.priorityArray),this.animationType=[],this.animationType[a.LEFT_MIDDLE]="fadeInRight",this.animationType[a.TOP_MIDDLE]="fadeInUp",this.animationType[a.RIGHT_MIDDLE]="fadeInLeft",this.animationType[a.BOTTOM_MIDDLE]="fadeInDown"},_attachEvents:function(){var a=this;this.on(MathInteractives.Common.Player.Views.Player.Events.TOGGLE_ELEMENT_HELP,function(b){a.enableHelp(b.eleId,b.msgId,b.bEnableHelp)}),this.on(MathInteractives.Common.Player.Views.Player.Events.CHANGE_HELP_TEXT,function(b){a._changeText(b.eleId,b.msgId,b.text,b.accText)})},render:function(){var a=this.$el,b=$("<span />").addClass("fa fa-question-circle");a.append(MathInteractives.Common.Components.templates.theme2Help({idPrefix:this.idPrefix}).trim()),this.loadScreen("theme2-help"),this._generateButtons(),this.$el.find(".help-img").append(b)},_generateButtons:function(){var a={idPrefix:this.idPrefix,data:{id:this.idPrefix+"help-footer-next-btn",type:MathInteractives.global.Theme2.Button.TYPE.NEXT,colorType:MathInteractives.global.Theme2.Button.COLORTYPE.HEADER_BLUE_SHADOW,tooltipText:this.getAccMessage("help-next-btn",0),tooltipType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.TOP_MIDDLE},path:this.filePath,manager:this.manager,player:this.player};MathInteractives.Common.Components.Theme2.Views.Button,this.nextButtonView=MathInteractives.global.Theme2.Button.generateButton(a),a.data.id=this.idPrefix+"help-footer-prev-btn",a.data.type=MathInteractives.global.Theme2.Button.TYPE.BACK,a.data.tooltipText=this.getAccMessage("help-prev-btn",0),this.prevButtonView=MathInteractives.global.Theme2.Button.generateButton(a),this.$el.find("#"+this.idPrefix+"help-footer-prev-btn").css("float","right"),this.$el.find("#"+this.idPrefix+"help-footer-next-btn").css("float","right"),this.loadScreen("theme2-help-buttons"),this._bindTabEventsToButtons()},_bindTabEventsToButtons:function(){var a=this,b=(MathInteractives.Common.Components.Theme2.Views.Button,null);this.focusIn("help-progress-text",function(c){a.setTabIndex("help-btn",a.baseIndex),b=$("<span></span>"),$("body").append(b),b.remove()}),this.$("#"+this.idPrefix+"help-footer-prev-btn").on("focusin",function(c){a.setTabIndex("help-btn",a.baseIndex+9),b=$("<span></span>"),$("body").append(b),b.remove()}),this.$("#"+this.idPrefix+"help-footer-next-btn").on("focusin",function(c){a.setTabIndex("help-btn",a.baseIndex+9),b=$("<span></span>"),$("body").append(b),b.remove()})},_updateIndexText:function(){var a=this.model.get("currentIndex"),b=this.visibleElements.length,a=0===b?0:a,c=[a,b];this.changeMessage("help-progress-text",0,c),this.changeAccMessage("help-progress-text",0,c),this.model.set("currentIndex",a)},_manageButtonState:function(){var a=this.model,b=MathInteractives.Common.Components.Theme2.Views.Button,c=b.BUTTON_STATE_DISABLED,d=b.BUTTON_STATE_ACTIVE,e=this.visibleElements.length,f=a.get("currentIndex"),g=1===f||0===e?c:d,h=f===e||0===e?c:d;this.prevButtonView.setButtonState(g),this.nextButtonView.setButtonState(h),this.enableTab("help-footer-prev-btn",g===c?!1:!0),this.enableTab("help-footer-next-btn",h===c?!1:!0)},_onNextBtnClick:function(a){this._manageItemsCount(!0),this._manageButtonState(),this._displayHelpTooltip(),MathInteractives.global.SpeechStream.stopReading()},_onPrevBtnClick:function(a){this._manageItemsCount(!1),this._manageButtonState(),this._displayHelpTooltip(),MathInteractives.global.SpeechStream.stopReading()},_manageItemsCount:function(a){var b=this.model.get("currentIndex"),c=this.visibleElements.length;b=a?c>b?b+1:b:b>1?b-1:b,this.model.set("currentIndex",b),this._updateIndexText()},_displayHelpTooltip:function(){var a=this.visibleElements,b=this.model.get("currentIndex"),c=this.visibleElements.length,d=MathInteractives.Common.Components.Theme2.Views.Tooltip,e=(this.model.get("positionArray"),this.directionMapper);if(!(0===c||1>b||b>c)){b=0==c.length?0:b,null!==this.tooltipView&&"undefined"!=typeof this.tooltipView&&(this.tooltipView.hideTooltip(),this.removeTooltip());var f=a[b-1],g=f.offset?f.offset:{x:0,y:0},h=f.msgId?f.msgId:0,i=f.position?e[f.position]:e.left;f.helpId=f.helpId?f.helpId:f.elementId;var j={elementEl:this.idPrefix+f.elementId,idPrefix:this.idPrefix,manager:this.manager,_player:this.player,type:d.TYPE.GENERAL,arrowType:i,path:this.filePath,isTts:!0,text:f.text?f.text:this.getMessage(f.helpId,h),accText:f.accText?f.accText:this.getAccMessage(f.helpId,h),fromElementCenter:f.fromElementCenter,isHelp:!0};f.msgId=h,this.tooltipView=MathInteractives.global.Theme2.Tooltip.generateTooltip(j),this.tooltipView.showTooltip();var k=this.tooltipView.$el,l=f.tooltipWidth?f.tooltipWidth:this.model.get("tooltipWidth");k.find(".text-container").css({width:l,"line-height":this.model.get("lineHeight")+"px"}),k.css({"min-width":this.tooltipView.$el.find(".text-container").width()+55}),k.css({"max-height":f.tooltipHeight?f.tooltipHeight:this.model.get("tooltipHeight")}),k.find(".border-div").css({display:"none"}),k.addClass("help-tooltip").removeAttr("data-html2canvas-ignore");var m=k.find(".arrow-div");this.tooltipView.showTooltip(),this.addOffsetInTooltip(g),f.position?this.tooltipView._checkContainment()||(f.dynamicArrowPosition&&this.tooltipView.isSpaceAvailable(j.arrowType)?(this.addOffsetInTooltip(g),this.tooltipView._bringInContainer(),this.tooltipView._checkContainment()||this.managePositions(f,g)):this.managePositions(f,g)):this.managePositions(f,g),this.tooltipView.displayTooltip(),this.animateTooltip();var n,o,p=this.tooltipView.model.get("calcData"),q=p.deg;f.hideArrowDiv&&m.hide(),m.css({"-webkit-transform":"rotate(0deg)","-ms-transform":"rotate(0deg)","-moz-transform":"rotate(0deg)",transform:"rotate(0deg)"}),"180deg"===q?m.css({"border-bottom":"0","border-left":"11px solid transparent","border-right":"11px solid transparent","border-top":"10px solid #2A2A2A"}):"270deg"===q?(n=parseInt(m.css("top"),10),m.css({top:n-6}),m.css({"border-bottom":"10px solid transparent","border-top":"10px solid transparent","border-right":"11px solid #2A2A2A","border-left":"5px solid transparent"})):"90deg"===q?(o=parseInt(m.css("left"),10),n=parseInt(m.css("top"),10),m.css({left:o+5,top:n-6,"border-bottom":"11px solid transparent","border-top":"11px solid transparent","border-left":"11px solid #2A2A2A","border-right":"5px solid transparent"})):"0deg"===q&&m.css({"border-top":"0","border-left":"11px solid transparent","border-right":"11px solid transparent","border-bottom":"10px solid #2A2A2A"}),k.find(".tts-container").css({"margin-top":"10px"}),this.$el.find("#"+j.elementEl+"-help-tooltip").css("zIndex",901),this.$el.find("#"+this.tooltipView.elementEl+"-help-tooltip-tts-play-btn-tooltip").css("zIndex",902),this.$el.find("#"+this.tooltipView.elementEl+"-help-tooltip-tts-pause-btn-tooltip").css("zIndex",902),this.$el.find("#"+this.tooltipView.elementEl+"-help-tooltip-tts-sound-btn-tooltip").css("zIndex",902),this._createAccessibilityElements(f,h)}},_createAccessibilityElements:function(a,b){var c=this;this.setTabIndex("help-progress-text",this.baseIndex+2),this.stopReading(),this.setFocus("help-progress-text"),this.createAccDiv({elementId:a.elementId+"-help-tooltip-text-container",tabIndex:this.baseIndex+4,acc:a.accText?a.accText:this.getAccMessage(a.helpId,b),offsetLeft:-4,offsetTop:-3}),this.createAccDiv({elementId:a.elementId+"-help-tooltip-tts-play-btn",tabIndex:this.baseIndex+6,acc:this.getAccMessage("tts-btn",0)}),this.createAccDiv({elementId:a.elementId+"-help-tooltip-tts-pause-btn",tabIndex:this.baseIndex+6,acc:this.getAccMessage("tts-btn",0)}),this.createAccDiv({elementId:a.elementId+"-help-tooltip-tts-sound-btn",tabIndex:this.baseIndex+6,acc:this.getAccMessage("tts-btn",0)}),this.focusIn(a.elementId+"-help-tooltip-tts-sound-btn",function(a){if(this.is(":visible")){c.setTabIndex("help-btn",c.baseIndex+9);var b=$("<span></span>");$("body").append(b),b.remove()}}),this.focusIn(a.elementId+"-help-tooltip-tts-pause-btn",function(a){if(this.is(":visible")){c.setTabIndex("help-btn",c.baseIndex+9);var b=$("<span></span>");$("body").append(b),b.remove()}}),this.focusIn(a.elementId+"-help-tooltip-tts-play-btn",function(a){if(this.is(":visible")){c.setTabIndex("help-btn",c.baseIndex+9);var b=$("<span></span>");$("body").append(b),b.remove()}})},managePositions:function(a,b){var c,d;for(c=a.positionArray?this.generatePositionObject(a.positionArray):this.generatePositionObject(this.priorityArray),d=0;d<c.length;d++)if(this.tooltipView.setArrowType(c[d]),this.tooltipView.isSpaceAvailable(c[d])){this.tooltipView.setArrowType(c[d]),this.tooltipView.showTooltip(),this.addOffsetInTooltip(b),this.tooltipView._bringInContainer();break}this.addOffsetInTooltip(b),this.tooltipView._bringInContainer()},addOffsetInTooltip:function(a){this.tooltipView.showTooltip();var b=this.tooltipView.$el,c=parseInt(b.css("left")),d=parseInt(b.css("top"));c+=a.x,d+=a.y,b.css({left:c,top:d}),this.tooltipView.displayTooltip()},generatePositionObject:function(a){var b,c=[];for(b=0;b<a.length;b++)c.push(this.directionMapper[a[b]]);return c},toggleHelpView:function(){this.toggle&&this.setTabIndex("help-btn",this.baseIndex),this.toggle=!this.toggle,this.$el.find(".help-screen").css("display",this.toggle?"block":"none"),this.filterHelpItems(),this.model.set("currentIndex",1),this.toggle?this.showHelpTooltip():this.hideHelpTooltip()},hideHelpTooltip:function(){var a=this.$(".custom-btn-type-save");this.tooltipView&&(this.tooltipView.hideTooltip(),this.removeTooltip(),0===a.length?this.$(".custom-btn-type-help").off("keydown",$.proxy(this._setFocusToHeaderSubtitleOnShiftTab,this)):a.off("keydown",$.proxy(this._setFocusToHeaderSubtitleOnShiftTab,this)),this.$(".header-subtitle").off("keydown",$.proxy(this._setFocusToHelpOnTab,this))),this.toggle=!1,this.filterHelpItems(),this.model.set("currentIndex",1),this.$el.find(".help-screen").css("display","none"),MathInteractives.global.SpeechStream.stopReading()},showHelpTooltip:function(){var a=this.$(".custom-btn-type-save");this.$el.find(".help-screen").css("display","block"),this.toggle=!0,this.setTabIndex("help-footer-prev-btn",this.baseIndex+8),this.setTabIndex("help-footer-next-btn",this.baseIndex+7),this.enableTab("help-footer-prev-btn",!1),this.baseIndex=this.getTabIndex("help-btn"),this.filterHelpItems(),this.model.set("currentIndex",1),this._displayHelpTooltip(),0===a.length?this.$(".custom-btn-type-help").on("keydown",$.proxy(this._setFocusToHeaderSubtitleOnShiftTab,this)):a.on("keydown",$.proxy(this._setFocusToHeaderSubtitleOnShiftTab,this)),this.$(".header-subtitle").on("keydown",$.proxy(this._setFocusToHelpOnTab,this))},removeTooltip:function(){this.$el.find("#"+this.tooltipView.elementEl+"-help-tooltip").off().remove(),this.$el.find("#"+this.tooltipView.elementEl+"-help-tooltip-tts-play-btn-tooltip").off().remove(),this.$el.find("#"+this.tooltipView.elementEl+"-help-tooltip-tts-pause-btn-tooltip").off().remove(),this.$el.find("#"+this.tooltipView.elementEl+"-help-tooltip-tts-sound-btn-tooltip").off().remove()},enableHelp:function(a,b,c){var d,e,f=this.model.get("helpElements");for(f=this._findUniqueHelpElements(f),f.length>0&&this.model.set("helpElements",f),e=0;e<f.length;e++)if(d=f[e],d.elementId===a&&d.msgId===b){d.isHelpDisabled=c,this.filterHelpItems();break}},_findUniqueHelpElements:function(a){var b,c=[];for(b=0;b<a.length;b++)this._findTermInArray(a[b],c)===!1&&c.push(a[b]);return c},_findTermInArray:function(a,b){var c,d;for(c=0;c<b.length;c++)if(d=b[c],d.elementId===a.elementId&&d.helpId===a.helpId)return!0;return!1},_changeParams:function(a,b,c){},_changeText:function(a,b,c,d){var e,f,g=this.model.get("helpElements");for(f=0;f<g.length;f++)if(e=g[f],e.elementId===a&&e.msgId===b){e.text=c,e.accText=d;break}},animateTooltip:function(){var a=this.tooltipView.$el,b=this.tooltipView.getArrowType(),c=this.animationType;a.addClass(c[b]).addClass("animated").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).removeClass(c[b]).removeClass("animated")})},filterHelpItems:function(){var a,b,c,d=this.model.get("helpElements"),e=[];for(c=0;c<d.length;c++)a=d[c],b=!$("#"+this.idPrefix+a.elementId).is(":visible")||a.isHelpDisabled===!1,b||e.push(a);this.visibleElements=e,this._manageButtonState(),this._updateIndexText()}},{generateHelpScreen:function(a){var b=new MathInteractives.Common.Components.Theme2.Models.Help(a),c=new MathInteractives.Common.Components.Theme2.Views.Help({el:a.el,model:b});return c}}),MathInteractives.global.Theme2.Help=MathInteractives.Common.Components.Theme2.Views.Help}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.theme2Help=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff<div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'help-screen" class="help-screen">\r\n  <div id ="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'help-screen-content" class="help-screen-content"></div>\r\n  <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'help-footer" class="help-footer">\r\n    <div>\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'help-footer-help-img" class="help-img"></div>\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'help-footer-text" class="help-footer-text"></div>\r\n      <div id ="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'help-footer-next-btn-container" class="footer-next-btn">\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'help-footer-next-btn" class="help-footer-next-btn"></div>\r\n      </div>\r\n      <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'help-progress-text" class="help-footer-progress-text"></div>\r\n      <div id ="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'help-footer-prev-btn-container" class="footer-prev-btn">\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'help-footer-prev-btn" class="help-footer-prev-btn"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Models.OverviewTab=Backbone.Model.extend({defaults:{screenID:null,leftImageContainerID:null,focusOnHeader:!0},initialize:function(){}})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.OverviewTab=MathInteractives.Common.Player.Views.Base.extend({idPrefix:null,manager:null,_player:null,filePath:null,screenID:null,goButtonView:null,ttsButtonView:null,isStepTwoLoaded:!1,isLetsGoClicked:!1,throbTimer:null,_audioFileDataMap:null,initialize:function(){this.filePath=this.model.get("path"),this.manager=this.model.get("manager"),this._player=this.model.get("player"),this.idPrefix=this._player.getIDPrefix(),this.screenID=this.model.get("screenID"),this._audioFileDataMap=this._player.model.get("audioFileDataMap"),this.render(),this._attachEvents()},render:function(){this.$el.find(".lets-go-btn").remove(),this.$el.append(MathInteractives.Common.Components.templates.theme2OverviewTab({idPrefix:this.idPrefix}).trim()),this.loadScreen(this.screenID),(MathInteractives.Common.Utilities.Models.BrowserCheck.isIE||MathInteractives.Common.Utilities.Models.BrowserCheck.isIE11)&&this.$(".overview-horizontal-rule").addClass("overview-horizontal-rule-ie"),this._generateButtons(),this._setBackgroundImages(),this._setupAccDivs()},_attachEvents:function(){var a=MathInteractives.Common.Components.Theme2.Views.OverviewTab.Events;this.off(a.SECOND_STEP_LOAD).on(a.SECOND_STEP_LOAD,$.proxy(this._secondStepLoad,this)),this.off(a.SECOND_STEP_PROGRESS).on(a.SECOND_STEP_PROGRESS,$.proxy(this._secondStepProgress,this)),this.off(a.SECOND_STEP_COMPLETE).on(a.SECOND_STEP_COMPLETE,$.proxy(this._secondStepComplete,this)),this.off(a.SECOND_STEP_ERROR).on(a.SECOND_STEP_ERROR,$.proxy(this._secondStepError,this))},events:{"click .overview-submit-button":"submitButtonClicked"},submitButtonClicked:function(a){this.isLetsGoClicked=!0,this.triggerGoButtonClickedEvent(),this.isStepTwoLoaded&&this.model.get("focusOnHeader")&&this.setFocus("header-subtitle",0)},_secondStepLoad:function(a){var b=this.$(".overview-throbber"),c=this.$(".overview-preloader-text");this._showPreloader(),this.throbTimer=MathInteractives.Common.Player.Views.InteractivityPreloader.SHOW_THROBBER(b,c)},_secondStepProgress:function(a){},_secondStepComplete:function(a){this._showPreloader(!1),MathInteractives.Common.Player.Views.InteractivityPreloader.STOP_THROBBER(this.throbTimer,this.$(".overview-preloader-text")),this.isStepTwoLoaded=!0,this.isLetsGoClicked&&(this.isLetsGoClicked=!1,this.model.get("focusOnHeader")&&this.setFocus("header-subtitle",0))},_secondStepError:function(a){MathInteractives.Common.Player.Views.InteractivityPreloader.STOP_THROBBER(this.throbTimer,this.$(".overview-preloader-text"))},_showPreloader:function(a){return a===!1?(this.$(".overview-submit-button").removeClass("no-display"),this.$(".overview-preloader-container").addClass("no-display"),void this.loadScreen("overview-preloader-screen")):(this.$(".overview-submit-button").addClass("no-display"),this.$(".overview-preloader-container").removeClass("no-display"),void this.loadScreen("overview-preloader-screen"))},triggerGoButtonClickedEvent:function(){this._player.onGoButtonClicked(this)},_setBackgroundImages:function(){var a=this.model.get("leftImageContainerID");this.$(".overview-image-region").css({"background-image":'url("'+this.filePath.getImagePath(a)+'")'})},_generateButtons:function(){this.loadScreen("overviewTabPlayerScreen");var a=this.getMessage("overview-button-text",0);(null===a||void 0===a||""===a)&&(a=this.getMessage("overview-submit-button-text",0));var b={idPrefix:this.idPrefix,data:{id:this.idPrefix+"overview-submit-button",type:MathInteractives.global.Theme2.Button.TYPE.FA_ICONTEXT,text:a,textPosition:"left",width:115,icon:{faClass:this.filePath.getFontAwesomeClass("next"),fontSize:16,fontColor:"#FFFFFF",fontWeight:"normal",height:15,width:9}},path:this.filePath,manager:this.manager,player:this._player};this.goButtonView=MathInteractives.global.Theme2.Button.generateButton(b),this.generateTTSButton()},generateTTSButton:function(){var a={containerId:this.idPrefix+"overview-header-tts",messagesToPlay:[this.idPrefix+"overview-readable-text-region"],isEnabled:!0,manager:this.manager,player:this._player,filePath:this.filePath,idPrefix:this.idPrefix};this.ttsButtonView=MathInteractives.global.Theme2.PlayerTTS.generateTTS(a),this.ttsButtonView.renderTTSAccessibility(270)},_setupAccDivs:function(){this.loadScreen("overviewTabScreen"),this.setAccMessage("overview-readable-text-region",this.getAccMessage("overview-header",0)+". "+this.getAccMessage("overview-text",0));var a=this.getAccMessage("overview-button-text",0);null!==a&&void 0!==a&&""!==a&&this.setAccMessage("overview-submit-button",a)}},{generateOverviewTab:function(a){var b;if(a){b="#"+a.id;var c=new MathInteractives.Common.Components.Theme2.Models.OverviewTab(a),d=new MathInteractives.Common.Components.Theme2.Views.OverviewTab({el:b,model:c});return d}},Events:{GO_BUTTON_CLICKED:"go-button-clicked",SECOND_STEP_LOAD:"second-step-load",SECOND_STEP_PROGRESS:"second-step-progress",SECOND_STEP_COMPLETE:"second-step-complete",SECOND_STEP_ERROR:"second-step-error"}}),MathInteractives.global.Theme2.OverviewTab=MathInteractives.Common.Components.Theme2.Views.OverviewTab}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.theme2OverviewTab=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff<div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-tab" class="overview-tab overview-container">\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-image-region" class="overview-image-region"></div>\r\n    <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-text-region" class="overview-text-region">\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-readable-text-region" class="overview-readable-text-region">\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-header-container" class="overview-header-container">\r\n                <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-header" class="overview-header"></div>\r\n                <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-header-tts" class="overview-header-tts"></div>\r\n            </div>\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-text" class="overview-text"></div>\r\n        </div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-horizontal-rule" class="overview-horizontal-rule"></div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-submit-button" class="overview-submit-button"></div>\r\n        <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-preloader-container" class="overview-preloader-container no-display">\r\n            <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-preloader-image-container" class="overview-preloader-image-container">\r\n                <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-throbber" class="overview-throbber"></div>\r\n                <div id="',(g=c.idPrefix)?f=g.call(b,{hash:{},data:e}):(g=b&&b.idPrefix,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'overview-preloader-text" class="overview-preloader-text  typography-label"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'})}(),function(a){"use strict";a.Common.Components.Views.DOMTooltipView=a.Common.Player.Views.Base.extend({tooltipViews:null,initialize:function(){this.idPrefix=this.model.get("idPrefix"),this.player=this.model.get("player"),this.manager=this.model.get("manager"),this.filePath=this.model.get("filePath"),this.generateTooltipViews()},generateTooltipViews:function(){var b=this.getElements();if(!this._isNullOrUndefined(b)){for(var c,d,e,f=a.Interactivities.ToolTipTest.Views.BoundedTooltip,g={},h=0;h<b.length;h++)c=b[h],d=c.data.elementEl,e=this._generateTooltipData(c),g[d]=f.generateBoundedTooltip(e);this.tooltipViews=g}},_generateTooltipData:function(a){var b=a.data,c=b.padding,d=b.template;return b._player=this.player,b.manager=this.manager,b.filePath=this.filePath,b.elementEl=this.idPrefix+b.elementEl,d&&(b.text=d,b.containerWidth=$(d).width()+(c?c:0),b.containerHeight=$(d).height()+(c?c:0)),b.containerPadding=this.model.get("containerPadding"),b.idPrefix=this.idPrefix,b.containerEleId=this.model.get("containerEleId"),b},getTooltipView:function(a){return this._isNullOrUndefined(a)?null:this.tooltipViews[a]},getModel:function(){return this.model},getElements:function(){return this.model.get("elements")},setElements:function(a){this.model.set("elements",a)},_isNullOrUndefined:function(a){return null===a||"undefined"==typeof a}},{generateDOMTooltip:function(b){var c=a.Interactivities.ToolTipTest.Models.DOMTooltipModel,d=a.Interactivities.ToolTipTest.Views.DOMTooltipView,e=new c(b),f=new d({model:e});return f}})}(window.MathInteractives),function(a){"use strict";a.Common.Components.Views.BoundedTooltip=a.Common.Components.Theme2.Views.Tooltip.extend({initialize:function(){this._superwrapper("initialize",arguments);var b=a.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE;this.model.set("priorityArray",[b.LEFT_MIDDLE,b.TOP_MIDDLE,b.RIGHT_MIDDLE,b.BOTTOM_MIDDLE])},_isInContainer:function(a,b){var c=this.model.get("containerPadding"),d=a.left,e=a.top,f=d+a.width,g=e+a.height,h=parseFloat(b.offset().left),i=parseFloat(b.offset().top),j=h+b.width(),k=i+b.height();return c=this._isNullOrUndefined(c)?{left:0,top:0,right:0,bottom:0}:c,h>d+c.left&&i>e+c.top&&j<f-c.right&&k<g-c.bottom},showTooltip:function(){this._superwrapper("showTooltip",arguments);var a=this.model.get("position"),b=this.model.get("dynamicArrowPosition"),c=(this.model.get("containerHeight"),this.model.get("containerWidth"),this.model.get("positionArray")),d=this.model.get("containerEleId"),e=$(this.$el),f=this._calculateContainment(d);e.css({width:e.width(),height:e.height()}),a&&(this._applyPosition(a),b&&this.isSpaceAvailable(a)&&(this._bringInContainer(),this._isInContainer(f,e)||this._applyPositions(c))),this._isInContainer(f,$(this.$el))||(this._applyPositions(c),this._isInContainer(f,$(this.$el))||this._superwrapper("showTooltip",arguments)),this.closeOnDocumentClick&&(this.unbindEventOnDocument(),this.bindEventOnDocument()),this._isCloseBtnPresent&&(this.unbindEventOnCloseBtn(),this.bindEventOnCloseBtn())},_applyPositions:function(a){for(var b=this.model.get("containerEleId"),c=$(this.$el),d=this._calculateContainment(b),e=this._isInContainer(d,c),f=this._isNullOrUndefined(a)?this.model.get("priorityArray"):a,g=0;g<f.length&&(this.setArrowType(f[g]),!(this.isSpaceAvailable(f[g])&&(this.setArrowType(f[g]),this._superwrapper("showTooltip",arguments),this._applyPosition(f[g]),this._bringInContainer(),c=$(this.$el),e=this._isInContainer(d,c))));g++);return this._bringInContainer(),e},_applyPosition:function(a){if(!this._isNullOrUndefined(a)){this.setArrowType(a),this._superwrapper("showTooltip",arguments);var b=this.model.get("containerEleId"),c=$(this.$el),d=this._calculateContainment(b),e=this._isInContainer(d,c);return e}},_bringInContainer:function(){var a=this.model.get("containerEleId"),b=$(this.$el),c=this._calculateContainment(a);if(!this._isInContainer(c,b)){this.displayTooltip();var d=this.model.get("containerPadding"),e=this.$el,f=$("#"+this.elementEl),g=this.player.$("#"+this.idPrefix+this.model.get("containerEleId")),h=g.offset().left,i=g.offset().top,j=h+g.width(),k=i+g.height(),l=this.$el.find(".arrow-div"),m=e.find(".border-div"),n=e.offset().left,o=e.offset().top,p=n+e.width(),q=o+e.height(),r=f.offset().left,s=f.outerWidth()+r,t=f.offset().top,u=f.outerHeight()+t,v=parseFloat(m.css("left")),w=parseFloat(m.css("top")),x=parseFloat(l.css("left")),y=parseFloat(l.css("top"));return d=this._isNullOrUndefined(d)?{left:0,top:0,right:0,bottom:0}:d,p>j-d.right&&(n-=p-s,x=e.width()-f.width()/2-this.baseWidthOfArrow,v=x),q>k-d.bottom&&(o-=q-u,y=e.height()-f.height()/2-this.baseWidthOfArrow,w=y-1),n<=h+d.left&&(x=(f.width()-this.baseWidthOfArrow)/2,n=r,v=x),o<=i+d.top&&(y=(f.height()-this.baseWidthOfArrow)/2,o=t,w=y+1),l.css({left:x,top:y}),m.css({left:v,
top:w}),e.offset({left:n,top:o}),!0}},isSpaceAvailable:function(a){this._superwrapper("showTooltip",arguments);var b=this.getOpenDirections();return b[a]?!0:!1},getOpenDirections:function(){var b=this.$el,c=$("#"+this.elementEl),d=this.player.$("#"+this.idPrefix+this.model.get("containerEleId")),e=d.offset().left,f=d.offset().top,g=e+d.width(),h=f+d.height(),i=c.offset().left,j=c.outerWidth()+i,k=c.offset().top,l=c.outerHeight()+k,m=a.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE,n=[],o=b.outerWidth()+this.baseWidthOfArrow,p=b.outerHeight()+this.baseWidthOfArrow;return i-e>o+this.eleCenter.x&&(n[m.LEFT_MIDDLE]=m.LEFT_MIDDLE),g-j>o+this.eleCenter.x&&(n[m.RIGHT_MIDDLE]=m.RIGHT_MIDDLE),k-f>p+this.eleCenter.y&&(n[m.TOP_MIDDLE]=m.TOP_MIDDLE),h-l>p+this.eleCenter.y&&(n[m.BOTTOM_MIDDLE]=m.BOTTOM_MIDDLE),n},_isNullOrUndefined:function(a){return null===a||"undefined"==typeof a},_calculateContainment:function(a){var b={},c=this.player.$("#"+this.idPrefix+a);return b.height=c.height(),b.width=c.width(),b.left=c.offset().left,b.top=c.offset().top,b}},{generateBoundedTooltip:function(b){var c,d;return b?(c=new a.Common.Components.Models.BoundedTooltip(b),d=new a.Common.Components.Views.BoundedTooltip({model:c})):void 0},EVENTS:{}}),a.global.Theme2.BoundedTooltip=a.Common.Components.Theme2.Views.BoundedTooltip}(window.MathInteractives),function(a){"use strict";a.Common.Components.Models.DOMTooltipModel=Backbone.Model.extend({idPrefix:null,containerEleId:null,containmentArea:null,elements:null,player:null,initialize:function(a){this.options=a,this._fillData()},_fillData:function(){var a=this.options;this.player=a.player,this.idPrefix=a.idPrefix,this._setContainment(a)},_setContainment:function(a){a.containerEleId?this.set("containerEleId",a.containerEleId):(a.containerEleId="activity-area-0",this.set("containerEleId",a.containerEleId)),this._isNullOrUndefiend(this.get("containmentArea"))&&this.set("containmentArea",this._calculateContainment(a.containerEleId))},_calculateContainment:function(a){var b={},c=this.player.$("#"+this.idPrefix+a);return b.height=c.height(),b.width=c.width(),b.left=c.offset().left,b.top=c.offset().top,b},_setTooltipElements:function(a){this.set("elements",a)},_isNullOrUndefiend:function(a){return null===a||"undefined"==typeof a}})}(window.MathInteractives),function(){"use strict";MathInteractives.Common.Components.Models.BoundedTooltip=MathInteractives.Common.Components.Theme2.Models.Tooltip.extend({defaults:function(){return{id:"",text:null,baseClass:null,arrowBaseClass:null,type:MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.GENERAL,arrowType:MathInteractives.Common.Components.Theme2.Views.Tooltip.ARROW_TYPE.BOTTOM_MIDDLE,isTts:!1,backgroundColor:null,textColor:null,containerWidth:null,containerHeight:null,borderColor:null,accText:null,elementEl:null,isArrow:!0,calcData:null,fromElementCenter:!1,isHelp:!1,positionType:MathInteractives.Common.Components.Theme2.Views.Tooltip.POSITION_TYPE.CENTER,arrowIn:1,identityClass:null,isShownOnClick:null,closeOnDocumentClick:!1,playerWidth:928,showCloseBtn:!1,isTooltipPermanent:void 0,closeBtnPosition:MathInteractives.Common.Components.Theme2.Views.Tooltip.CLOSE_BTN_POSITION_TYPE.TOP_RIGHT,positionArray:null,priorityArray:null,position:null,containmentArea:null,containerEleId:null,padding:null,dynamicArrowPosition:null,isBaseTooltip:!1}},initialize:function(){this._superwrapper("initialize",arguments)}})}(),function(){"use strict";MathInteractives.Common.Components.Views.CanvasTooltip=MathInteractives.Common.Components.Views.BoundedTooltip.extend({$pseudoElement:null,initialize:function(){this.createDummyElement(),this._superwrapper("initialize",arguments)},createDummyElement:function(){var a=this.model,b=a.get("idPrefix"),c=a.get("elementEl"),d=$("#"+b+a.get("containerEleId")),e=a.get("paperObject");this.$pseudoElement=$("<div></div>",{id:c}),this.setElGeometry(e),d.append(this.$pseudoElement)},setElGeometry:function(a){if(this._isNullOrUndefined(a))return!1;var b=a.clone(),c=b.bounds,d=30,e=20,f=c.height<e?e:c.height,g=c.height<e?a.position.y-e/2:c.top,h=c.width<d?d:c.width,i=c.width<d?a.position.x-d/2:c.left;return this.$pseudoElement.css({width:h,height:f,left:i,top:g,position:"absolute",zIndex:-1}),b.remove(),!0},deleteElement:function(){this.$pseudoElement.remove()},_isNullOrUndefined:function(a){return null===a||"undefined"==typeof a}},{generateCanvasTooltip:function(a){var b,c;return a&&(b=new MathInteractives.Common.Components.Models.CanvasTooltip(a),c=new MathInteractives.Common.Components.Views.CanvasTooltip({model:b})),c}})}(),function(){"use strict";MathInteractives.Common.Components.Models.CanvasTooltip=MathInteractives.Common.Components.Models.BoundedTooltip.extend({initialize:function(){this._superwrapper("initialize",arguments)}})}();