var Cango3D,Obj3D,Group3D,svgToCgo3D,calcNormal,calcIncAngle,shapes3D;!function(){"use strict";function a(a){var b,c,d,e,f,g,h={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",transparent:"rgba(0,0,0,0)",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},i=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((1(\.0)?)|0?(\.\d*)?)\)$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1)"],process:function(a){return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),parseFloat(a[4],10)]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}];if(this.ok=!1,"string"==typeof a){"#"===a.charAt(0)&&(a=a.substr(1,6)),a=a.replace(/ /g,""),a=a.toLowerCase();for(g in h)a===g&&(a=h[g]);for(b=0;b<i.length;b++)c=i[b].re,d=i[b].process,e=c.exec(a),e&&(f=d(e),this.r=f[0],this.g=f[1],this.b=f[2],e.length>3?this.a=f[3]:this.a=1,this.ok=!0);this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.a=this.a<0||isNaN(this.a)?1:this.a>1?1:this.a,this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.a+")"},this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),b=this.g.toString(16),c=this.b.toString(16);return 1===a.length&&(a="0"+a),1===b.length&&(b="0"+b),1===c.length&&(c="0"+c),"#"+a+b+c}}}function b(a,b,c){var d=this;this.cgo=null,this.target=null,this.parent=null,this.grabCallback=a||null,this.dragCallback=b||null,this.dropCallback=c||null,this.grabCsrPos={x:0,y:0,z:0},this.dwgOrg={x:0,y:0,z:0},this.dwgOrgOfs={x:0,y:0,z:0},this.grabOfs={x:0,y:0,z:0},this.grab=function(a,b){var c,e=a||window.event;return"ontouchstart"in document||1===e.which?null===b.dragNdrop?!0:(this.parent=b,document.addEventListener("mouseup",function f(a){d.drop(a),document.removeEventListener("mouseup",f,!1)}),this.cgo.cnvs.onmouseup=function(a){d.drop(a)},this.cgo.cnvs.onmouseout=function(a){null===d.cgo.cnvs.onmouseup&&d.drop(a)},this.cgo.cnvs.addEventListener("touchend",this.touchEndHandler),c=this.cgo.getCursorPosWC(e),this.grabCsrPos.x=c.x,this.grabCsrPos.y=c.y,this.grabCsrPos.z=0,this.dwgOrg={x:this.target.dwgOrg.tx,y:this.target.dwgOrg.ty,z:this.target.dwgOrg.tz},this.target.parent?this.dwgOrgOfs={x:this.target.dwgOrg.tx-this.target.parent.dwgOrg.tx,y:this.target.dwgOrg.ty-this.target.parent.dwgOrg.ty,z:this.target.dwgOrg.tz-this.target.parent.dwgOrg.tz}:this.dwgOrgOfs={x:this.target.dwgOrg.tx,y:this.target.dwgOrg.ty,z:this.target.dwgOrg.tz},this.grabOfs={x:c.x-this.dwgOrgOfs.x,y:c.y-this.dwgOrgOfs.y,z:c.z-this.dwgOrgOfs.z},this.grabCallback&&this.grabCallback(c),this.cgo.cnvs.onmousemove=function(a){d.drag(a)},this.cgo.cnvs.addEventListener("touchmove",this.touchMoveHandler),e.preventDefault?e.preventDefault():window.event.returnValue=!1,!1):void 0},this.drag=function(a){if("ontouchstart"in document||1===a.which){var b=this.cgo.getCursorPosWC(a);return this.dragCallback&&this.dragCallback(b),!1}},this.drop=function(a){var b=this.cgo.getCursorPosWC(a);this.cgo.cnvs.onmouseup=null,this.cgo.cnvs.onmousemove=null,this.cgo.cnvs.removeEventListener("touchmove",this.touchMoveHandler,!1),this.cgo.cnvs.removeEventListener("touchend",this.touchEndHandler,!1),this.dropCallback&&this.dropCallback(b)},this.cancelDrag=function(a){this.cgo.cnvs.onmouseup=null,this.cgo.cnvs.onmouseout=null,this.cgo.cnvs.onmousemove=null,this.cgo.cnvs.removeEventListener("touchmove",this.touchMoveHandler,!1),this.cgo.cnvs.removeEventListener("touchend",this.touchEndHandler,!1),this.dropCallback&&this.dropCallback(a)},this.touchMoveHandler=function(a){l(a),d.drag(a)},this.touchEndHandler=function(a){l(a),d.drop(a)}}function c(a,b,c){var d=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[a,b,c,1]];return d}function d(a,b,c,d){var e=Math.PI/180,f=Math.sqrt(a*a+b*b+c*c),g=a/f,h=b/f,i=c/f,j=Math.sin(-d*e),k=Math.cos(-d*e),l=1-k,m=[[g*g*l+k,h*g*l-i*j,i*g*l+h*j,0],[g*h*l+i*j,h*h*l+k,i*h*l-g*j,0],[g*i*l-h*j,h*i*l+g*j,i*i*l+k,0],[0,0,0,1]];return m}function e(a,b,c,d){var e=Math.PI/180,f=Math.sqrt(a*a+b*b+c*c),g=a/f,h=b/f,i=c/f,j=Math.sin(-d*e),k=Math.cos(-d*e),l=1-k,m=[[g*g*l+k,h*g*l-i*j,i*g*l+h*j,0],[g*h*l+i*j,h*h*l+k,i*h*l-g*j,0],[g*i*l-h*j,h*i*l+g*j,i*i*l+k,0],[0,0,0,1]];return m}function f(a){var b=Math.abs(a),c=[[b,0,0,0],[0,b,0,0],[0,0,b,0],[0,0,0,1]];return c}function g(a){void 0!==a?this.matrix=a:this.matrix=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]}function h(a){var b=this;this.parent=a,this.translate=function(a,d,e){var f=a||0,g=d||0,h=e||0,i=c(f,g,h);b.parent.ofsTfmAry.push(i)},this.scale=function(a){var c=a||1,d=f(c);b.parent.ofsTfmAry.unshift(d),b.parent.lineWidth*=c},this.rotate=function(a,c,e,f){var g,h=f||0;q(a)&&q(c)&&q(e)&&(g=d(a,c,e,h),b.parent.ofsTfmAry.unshift(g))},this.revolve=function(a,c,d,f){var g,h=f||0;q(a)&&q(c)&&q(d)&&(g=e(a,c,d,h),b.parent.ofsTfmAry.push(g))},this.reset=function(){b.parent.ofsTfmAry=[],b.parent.ofsTfm.reset()}}function i(a,b,c){this.x=a||0,this.y=b||0,this.z=c||0,this.tx=this.x,this.ty=this.y,this.tz=this.z,this.fx=0,this.fy=0}function j(a,b,c){this.drawFn=a,this.cPts=b||[],this.ep=c,this.parms=[],this.parmsPx=[]}function k(a,b,c,d){function e(a){var e,f,g,h,k,l,m,n,o,p,q,r,s,t=0,u=0,v=0,w=[],x=1,y=1,z=1,A=b||0,B=c||0,C=d||0;for(r=0;r<a.length;r++)switch(o=a[r],p=o[0],0===r&&"M"!==p&&(p="M"),s=o.slice(1),s&&(s=s.map(parseFloat)),p){case"M":for(t=A+x*s[0],u=B+y*s[1],v=C+z*s[2],g=h=k=null,e=[],f=new i(t,u,v),q=new j("moveTo",e,f),w.push(q),s.splice(0,3);s.length>0;)t=A+x*s[0],u=B+y*s[1],v=C+z*s[2],e=[],f=new i(t,u,v),q=new j("lineTo",e,f),w.push(q),s.splice(0,3);break;case"m":for(t+=x*s[0],u+=y*s[1],v+=z*s[2],g=h=k=null,e=[],f=new i(t,u,v),q=new j("moveTo",e,f),w.push(q),s.splice(0,3);s.length>0;)t+=x*s[0],u+=y*s[1],v+=z*s[2],e=[],f=new i(t,u,v),q=new j("lineTo",e,f),w.push(q),s.splice(0,3);break;case"L":for(;s.length>0;)t=A+x*s[0],u=B+y*s[1],v=C+z*s[2],e=[],f=new i(t,u,v),q=new j("lineTo",e,f),w.push(q),s.splice(0,3);g=h=null;break;case"l":for(;s.length>0;)t+=x*s[0],u+=y*s[1],v+=z*s[2],e=[],f=new i(t,u,v),q=new j("lineTo",e,f),w.push(q),s.splice(0,3);g=h=null;break;case"C":for(;s.length>0;)l=A+x*s[0],m=B+y*s[1],n=C+z*s[2],g=A+x*s[3],h=B+y*s[4],k=C+z*s[5],t=A+x*s[6],u=B+y*s[7],v=C+z*s[8],e=[],e[0]=new i(l,m,n),e[1]=new i(g,h,k),f=new i(t,u,v),q=new j("bezierCurveTo",e,f),w.push(q),s.splice(0,9);break;case"c":for(;s.length>0;)l=t+x*s[0],m=u+y*s[1],n=v+z*s[2],g=t+x*s[3],h=u+y*s[4],k=v+z*s[5],t+=x*s[6],u+=y*s[7],v+=z*s[8],e=[],e[0]=new i(l,m,n),e[1]=new i(g,h,k),f=new i(t,u,0),q=new j("bezierCurveTo",e,f),w.push(q),s.splice(0,9);break;case"Q":g=A+x*s[0],h=B+y*s[1],k=C+z*s[2],t=A+x*s[3],u=B+y*s[4],v=C+z*s[5],e=[],e[0]=new i(g,h,k),f=new i(t,u,v),q=new j("quadraticCurveTo",e,f),w.push(q);break;case"q":e=[],e[0]=new i(t+x*s[0],u+y*s[1],v+z*s[2]),f=new i(t+x*s[3],u+y*s[4],v+z*s[5]),q=new j("quadraticCurveTo",e,f),w.push(q),g=t+x*s[0],h=u+y*s[1],k=v+z*s[2],t+=x*s[3],u+=y*s[4],v+=z*s[5];break;case"Z":q=new j("closePath"),w.push(q);break;case"z":q=new j("closePath"),w.push(q)}return w}var f,g,h=[],k=[];if(a instanceof Array){for(g=0,f=1;f<a.length;f++)"string"==typeof a[f]&&(h.push(a.slice(g,f)),g=f);h.push(a.slice(g,f)),k=e(h)}return k}function l(a){switch(a.type){case"touchstart":case"touchmove":a.clientX=a.touches[0].clientX,a.clientY=a.touches[0].clientY;break;case"touchend":a.clientX=a.changedTouches[0].clientX,a.clientY=a.changedTouches[0].clientY}return a}function m(a){function b(b){function c(b){var c=a.cnvs.getBoundingClientRect();return{x:b.clientX-c.left,y:b.clientY-c.top}}function d(b,c,d){var e;if(a.ctx.beginPath(),"TEXT"===b.type)for(e=0;e<b.bBoxCmds.length;e++)a.ctx[b.bBoxCmds[e].drawFn].apply(a.ctx,b.bBoxCmds[e].parmsPx);else for(e=0;e<b.drawCmds.length;e++)a.ctx[b.drawCmds[e].drawFn].apply(a.ctx,b.drawCmds[e].parmsPx);return a.ctx.isPointInPath(c,d)}var e,f,g,h,i=b||window.event;for(b=l(b),e=c(i),g=a.cnvs.dragObjects.length,h=a.cnvs.dragObjects.length-1;h>=0;h--)if(f=a.cnvs.dragObjects[h],d(f,e.x,e.y)&&f.dragNdrop){f.dragNdrop.grab(i,f);break}}a.cnvs.onmousedown=b,a.cnvs.addEventListener("touchstart",b)}function n(a){function b(a){return Math.round(1e3*a)/1e3}function c(a,c){switch(a.drawFn){case"moveTo":c.push("M"),c.push(b(a.ep.x),b(a.ep.y),b(a.ep.z));break;case"lineTo":c.push("L"),c.push(b(a.ep.x),b(a.ep.y),b(a.ep.z));break;case"bezierCurveTo":c.push("C"),c.push(b(a.cPts[0].x),b(a.cPts[0].y),b(a.cPts[0].z)),c.push(b(a.cPts[1].x),b(a.cPts[1].y),b(a.cPts[1].z)),c.push(b(a.ep.x),b(a.ep.y),b(a.ep.z));break;case"quadraticCurveTo":c.push("Q"),c.push(b(a.cPts[0].x),b(a.cPts[0].y),b(a.cPts[0].z)),c.push(b(a.ep.x),b(a.ep.y),b(a.ep.z));break;case"closePath":c.push("Z")}}var d,e=[];if(p(a))for(d=0;d<a.length;d++)c(a[d],e);else c(a,e);return e}var o={};Date.now||(Date.now=function(){return(new Date).getTime()});var p=function(a){return"[object Array]"===Object.prototype.toString.call(a)},q=function(a){return!isNaN(a)&&null!==a&&""!==a&&a!==!1};Array.prototype.contains||Object.defineProperty(Array.prototype,"contains",{value:function(a){for(var b=this.length;b--;)if(this[b]===a)return!0;return!1},configurable:!0,writable:!0}),Array.prototype.map||Object.defineProperty(Array.prototype,"map",{value:function(a,b){var c,d=this.length,e=b,f=[];if("function"!=typeof a)throw new TypeError;for(c=0;d>c;c++)this.hasOwnProperty(c)&&(f[c]=a.call(e,this[c],c,this));return f},configurable:!0,writable:!0}),void 0===shapes3D&&(shapes3D={circle:function(a){var b=a||1;return["M",-.5*b,0,0,"C",-.5*b,-.27614*b,0,-.27614*b,-.5*b,0,0,-.5*b,0,"C",.27614*b,-.5*b,0,.5*b,-.27614*b,0,.5*b,0,0,"C",.5*b,.27614*b,0,.27614*b,.5*b,0,0,.5*b,0,"C",-.27614*b,.5*b,0,-.5*b,.27614*b,0,-.5*b,0,0]},ellipse:function(a,b){var c=a||1,d=c;return"number"==typeof b&&b>0&&(d=b),["M",-.5*c,0,0,"C",-.5*c,-.27614*d,0,-.27614*c,-.5*d,0,0,-.5*d,0,"C",.27614*c,-.5*d,0,.5*c,-.27614*d,0,.5*c,0,0,"C",.5*c,.27614*d,0,.27614*c,.5*d,0,0,.5*d,0,"C",-.27614*c,.5*d,0,-.5*c,.27614*d,0,-.5*c,0,0]},square:function(a){var b=a||1;return["M",.5*b,-.5*b,0,"l",0,b,0,-b,0,0,0,-b,0,"z"]},triangle:function(a){var b=a||1;return["M",.5*b,-.289*b,0,"l",-.5*b,.866*b,0,-.5*b,-.866*b,0,"z"]},cross:function(a){var b=a||1;return["M",-.5*b,0,0,"l",b,0,0,"M",0,-.5*b,0,"l",0,b,0]},ex:function(a){var b=a||1;return["M",-.3535*b,-.3535*b,0,"L",.3535*b,.3535*b,0,"M",-.3535*b,.3535*b,0,"L",.3535*b,-.3535*b,0]}}),g.prototype.translate=function(a,b,d){var e=a||0,f=b||0,g=d||0,h=c(e,f,g);this.applyTransform(h)},g.prototype.rotate=function(a,b,c,e){var f,g=e||0;q(a)&&q(b)&&q(c)&&(a||b||c)&&(f=d(a,b,c,g),this.applyTransform(f))},g.prototype.scale=function(a){var b=a||1,c=f(b);this.applyTransform(c)},g.prototype.reset=function(){this.matrix[0][0]=1,this.matrix[0][1]=0,this.matrix[0][2]=0,this.matrix[0][3]=0,this.matrix[1][0]=0,this.matrix[1][1]=1,this.matrix[1][2]=0,this.matrix[1][3]=0,this.matrix[2][0]=0,this.matrix[2][1]=0,this.matrix[2][2]=1,this.matrix[2][3]=0,this.matrix[3][0]=0,this.matrix[3][1]=0,this.matrix[3][2]=0,this.matrix[3][3]=1},g.prototype.applyTransform=function(a){var b=this.matrix[0][0],c=this.matrix[0][1],d=this.matrix[0][2],e=this.matrix[0][3],f=this.matrix[1][0],g=this.matrix[1][1],h=this.matrix[1][2],i=this.matrix[1][3],j=this.matrix[2][0],k=this.matrix[2][1],l=this.matrix[2][2],m=this.matrix[2][3],n=this.matrix[3][0],o=this.matrix[3][1],p=this.matrix[3][2],q=this.matrix[3][3],r=a[0][0],s=a[0][1],t=a[0][2],u=a[0][3],v=a[1][0],w=a[1][1],x=a[1][2],y=a[1][3],z=a[2][0],A=a[2][1],B=a[2][2],C=a[2][3],D=a[3][0],E=a[3][1],F=a[3][2],G=a[3][3];this.matrix[0][0]=b*r+c*v+d*z+e*D,this.matrix[0][1]=b*s+c*w+d*A+e*E,this.matrix[0][2]=b*t+c*x+d*B+e*F,this.matrix[0][3]=b*u+c*y+d*C+e*G,this.matrix[1][0]=f*r+g*v+h*z+i*D,this.matrix[1][1]=f*s+g*w+h*A+i*E,this.matrix[1][2]=f*t+g*x+h*B+i*F,this.matrix[1][3]=f*u+g*y+h*C+i*G,this.matrix[2][0]=j*r+k*v+l*z+m*D,this.matrix[2][1]=j*s+k*w+l*A+m*E,this.matrix[2][2]=j*t+k*x+l*B+m*F,this.matrix[2][3]=j*u+k*y+l*C+m*G,this.matrix[3][0]=n*r+o*v+p*z+q*D,this.matrix[3][1]=n*s+o*w+p*A+q*E,this.matrix[3][2]=n*t+o*x+p*B+q*F,this.matrix[3][3]=n*u+o*y+p*C+q*G},g.prototype.matrixMult=function(a,b){var c=a[0][0],d=a[0][1],e=a[0][2],f=a[0][3],g=a[1][0],h=a[1][1],i=a[1][2],j=a[1][3],k=a[2][0],l=a[2][1],m=a[2][2],n=a[2][3],o=a[3][0],p=a[3][1],q=a[3][2],r=a[3][3],s=b[0][0],t=b[0][1],u=b[0][2],v=b[0][3],w=b[1][0],x=b[1][1],y=b[1][2],z=b[1][3],A=b[2][0],B=b[2][1],C=b[2][2],D=b[2][3],E=b[3][0],F=b[3][1],G=b[3][2],H=b[3][3];this.matrix[0][0]=c*s+d*w+e*A+f*E,this.matrix[0][1]=c*t+d*x+e*B+f*F,this.matrix[0][2]=c*u+d*y+e*C+f*G,this.matrix[0][3]=c*v+d*z+e*D+f*H,this.matrix[1][0]=g*s+h*w+i*A+j*E,this.matrix[1][1]=g*t+h*x+i*B+j*F,this.matrix[1][2]=g*u+h*y+i*C+j*G,this.matrix[1][3]=g*v+h*z+i*D+j*H,this.matrix[2][0]=k*s+l*w+m*A+n*E,this.matrix[2][1]=k*t+l*x+m*B+n*F,this.matrix[2][2]=k*u+l*y+m*C+n*G,this.matrix[2][3]=k*v+l*z+m*D+n*H,this.matrix[3][0]=o*s+p*w+q*A+r*E,this.matrix[3][1]=o*t+p*x+q*B+r*F,this.matrix[3][2]=o*u+p*y+q*C+r*G,this.matrix[3][3]=o*v+p*z+q*D+r*H},i.prototype.hardTransform=function(a){var b=this.x,c=this.y,d=this.z,e=1,f=a[0][0],g=a[0][1],h=a[0][2],i=a[1][0],j=a[1][1],k=a[1][2],l=a[2][0],m=a[2][1],n=a[2][2],o=a[3][0],p=a[3][1],q=a[3][2];this.x=this.tx=b*f+c*i+d*l+e*o,this.y=this.ty=b*g+c*j+d*m+e*p,this.z=this.tz=b*h+c*k+d*n+e*q},i.prototype.softTransform=function(a){var b=this.x,c=this.y,d=this.z,e=1,f=a[0][0],g=a[0][1],h=a[0][2],i=a[1][0],j=a[1][1],k=a[1][2],l=a[2][0],m=a[2][1],n=a[2][2],o=a[3][0],p=a[3][1],q=a[3][2];this.tx=b*f+c*i+d*l+e*o,this.ty=b*g+c*j+d*m+e*p,this.tz=b*h+c*k+d*n+e*q},calcNormal=function(a,b,c){var d=new i(0,0,1),e=new i(b.x-a.x,b.y-a.y,b.z-a.z),f=new i(c.x-a.x,c.y-a.y,c.z-a.z),g=e.y*f.z-e.z*f.y,h=e.z*f.x-e.x*f.z,j=e.x*f.y-e.y*f.x,k=Math.sqrt(g*g+h*h+j*j);return k&&(d=new i(g/k,h/k,j/k)),d},calcIncAngle=function(a,b,c){var d=0,e=new i(b.x-a.x,b.y-a.y,b.z-a.z),f=new i(c.x-a.x,c.y-a.y,c.z-a.z),g=e.x*f.x+e.y*f.y+e.z*f.z,h=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)*Math.sqrt(f.x*f.x+f.y*f.y+f.z*f.z);return h&&(d=Math.acos(g/h)),180*d/Math.PI},Group3D=function(){this.type="GROUP",this.parent=null,this.children=[],this.dwgOrg=new i(0,0,0),this.ofsTfmAry=[],this.ofsTfm=new g,this.grpTfm=new g,this.netTfm=new g,this.centroid=new i,this.transform=new h(this),this.addObj.apply(this,arguments)},Group3D.prototype.deleteObj=function(a){for(var b=this.children.indexOf(a);-1!==b;)this.children.splice(b,1),b=this.children.indexOf(a)},Group3D.prototype.addObj=function(){var a,b,c=Array.prototype.slice.call(arguments),d=0,e=0,f=0,g=0;for(a=0;a<c.length;a++)if(p(c[a]))for(b=0;b<c[a].length;b++)c[a][b].type&&(null!==c[a][b].parent&&c[a][b].parent.deleteObj(c[a][b]),c[a][b].parent=this,this.children.push(c[a][b]),!c[a][b].dragNdrop&&this.dragNdrop&&(c[a][b].dragNdrop=this.dragNdrop));else c[a].type&&(null!==c[a].parent&&c[a].parent.deleteObj(c[a]),c[a].parent=this,this.children.push(c[a]),!c[a].dragNdrop&&this.dragNdrop&&(c[a].dragNdrop=this.dragNdrop));for(b=0;b<this.children.length;b++)d+=this.children[b].centroid.x,e+=this.children[b].centroid.y,f+=this.children[b].centroid.z,g++;g&&(this.centroid.x=d/g,this.centroid.y=e/g,this.centroid.z=f/g)},Group3D.prototype.translate=function(a,b,d){function e(a){"GROUP"!==a.type&&a.translate(g,h,i)}function f(a,b){var c,d;for(c=0;c<b.children.length;c++)d=b.children[c],a(d),"GROUP"===d.type&&f(a,d)}var g=a||0,h=b||0,i=d||0,j=c(g,h,i);f(e,this),this.centroid.hardTransform(j)},Group3D.prototype.rotate=function(a,b,c,e){function f(d){"GROUP"!==d.type&&d.rotate(a,b,c,e)}function g(a,b){var c,d;for(c=0;c<b.children.length;c++)d=b.children[c],a(d),"GROUP"===d.type&&g(a,d)}var h,i=e||0;q(a)&&q(b)&&q(c)&&(h=d(a,b,c,i),g(f,this),this.centroid.hardTransform(h))},Group3D.prototype.scale=function(a){function b(a){"GROUP"!==a.type&&a.scale(d)}function c(a,b){var d,e;for(d=0;d<b.children.length;d++)e=b.children[d],a(e),"GROUP"===e.type&&c(a,e)}var d=a||1,e=f(d);c(b,this),this.centroid.hardTransform(e)},Group3D.prototype.enableDrag=function(a,b,c){function d(f){var g,h;for(g=0;g<f.children.length;g++)h=f.children[g],"GROUP"===h.type?d(h):null===h.dragNdrop&&(h.enableDrag(a,b,c),h.dragNdrop.target=e)}var e=this;d(this)},Group3D.prototype.disableDrag=function(){function a(b){var c,d;for(c=0;c<b.children.length;c++)d=b.children[c],"GROUP"===d.type?a(d):d.disableDrag()}a(this)},Obj3D=function(a,b,c){var d,e,f,j=0,l=0,m=0,n=0;this.type="SHAPE",this.parent=null,this.drawCmds=[],this.bBoxCmds=[],this.dwgOrg=new i(0,0,0),this.centroid=new i(0,0,0),this.normal=new i(0,0,0),this.dragNdrop=null,this.hardOfsTfm=new g,this.ofsTfmAry=[],this.ofsTfm=new g,this.grpTfm=new g,this.netTfm=new g,this.lorgTfm=new g,this.transform=new h(this),this.strokeColor=null,this.fillColor=null,this.backColor=null,this.backHidden=!1,this.lineWidth=1,this.strokeCap="butt",this.fontSize=null,this.fontWeight=null,this.lorg=7,"string"==typeof b&&-1!==["PATH","SHAPE","TEXT"].indexOf(b)&&(this.type=b),a&&(this.drawCmds=k(a)),d="object"==typeof c?c:{};for(e in d)d.hasOwnProperty(e)&&this.setProperty(e,d[e]);if("SHAPE"===this.type&&(this.strokeCol=this.fillCol),"TEXT"===this.type&&(this.strokeCap="round"),this.drawCmds.length){for(f=0;f<this.drawCmds.length;f++)void 0!==this.drawCmds[f].ep&&(j+=this.drawCmds[f].ep.x,l+=this.drawCmds[f].ep.y,m+=this.drawCmds[f].ep.z,n++);if(this.centroid.x=j/n,this.centroid.y=l/n,this.centroid.z=m/n,this.drawCmds.length>2)this.normal=calcNormal(this.centroid,this.drawCmds[1].ep,this.drawCmds[2].ep);else{if(2!==this.drawCmds.length)return;this.drawCmds[1].cPts.length?this.normal=calcNormal(this.centroid,this.drawCmds[1].ep,this.drawCmds[1].cPts[0]):this.normal.z=1}this.normal.x+=this.centroid.x,this.normal.y+=this.centroid.y,this.normal.z+=this.centroid.z}},Obj3D.prototype.translate=function(a,b,d){var e,f,g=a||0,h=b||0,i=d||0,j=c(g,h,i);if("TEXT"===this.type)this.hardOfsTfm.translate(g,h,i);else for(e=0;e<this.drawCmds.length;e++){for(f=0;f<this.drawCmds[e].cPts.length;f++)this.drawCmds[e].cPts[f].hardTransform(j);void 0!==this.drawCmds[e].ep&&this.drawCmds[e].ep.hardTransform(j)}this.centroid.hardTransform(j),this.normal.hardTransform(j)},Obj3D.prototype.rotate=function(a,b,c,e){var f,g,h,i=e||0;if(q(a)&&q(b)&&q(c)){if(f=d(a,b,c,i),"TEXT"===this.type)this.hardOfsTfm.rotate(a,b,c,i);else for(g=0;g<this.drawCmds.length;g++){for(h=0;h<this.drawCmds[g].cPts.length;h++)this.drawCmds[g].cPts[h].hardTransform(f);void 0!==this.drawCmds[g].ep&&this.drawCmds[g].ep.hardTransform(f)}this.centroid.hardTransform(f),this.normal.hardTransform(f)}},Obj3D.prototype.scale=function(a){var b,c,d=a||1,e=f(d);if("TEXT"===this.type)this.hardOfsTfm.scale(d);else for(b=0;b<this.drawCmds.length;b++){for(c=0;c<this.drawCmds[b].cPts.length;c++)this.drawCmds[b].cPts[c].hardTransform(e);void 0!==this.drawCmds[b].ep&&this.drawCmds[b].ep.hardTransform(e)}this.centroid.hardTransform(e),this.normal.hardTransform(e)},Obj3D.prototype.flipNormal=function(){var a=this.normal.x,b=this.normal.y,c=this.normal.z;this.normal.x=2*this.centroid.x-a,this.normal.y=2*this.centroid.y-b,this.normal.z=2*this.centroid.z-c},Obj3D.prototype.enableDrag=function(a,c,d){this.dragNdrop=new b(a,c,d),this.dragNdrop.target=this},Obj3D.prototype.disableDrag=function(){var a;this.dragNdrop&&this.dragNdrop.cgo&&(a=this.dragNdrop.cgo.dragObjects.indexOf(this),this.dragNdrop.cgo.dragObjects.splice(a,1),this.dragNdrop=null)},Obj3D.prototype.setProperty=function(b,c){var d;if("string"==typeof b&&void 0!==c&&null!==c)switch(b.toLowerCase()){case"fillcolor":d=new a(c),d.ok&&(this.fillColor=d);break;case"backcolor":d=new a(c),d.ok&&(this.backColor=d);break;case"strokecolor":d=new a(c),d.ok&&(this.strokeColor=d);break;case"linewidth":case"strokewidth":this.lineWidth=c;break;case"linecap":case"strokecap":if("string"!=typeof c)return;("butt"===c||"round"===c||"square"===c)&&(this.strokeCap=c);break;case"fontsize":this.fontSize=c;break;case"fontweight":("string"==typeof c||"number"==typeof c&&c>=100&&900>=c)&&(this.fontWeight=c);break;case"lorg":-1!==[1,2,3,4,5,6,7,8,9].indexOf(c)&&(this.lorg=c);break;case"width":this.width=c;break;case"height":this.height=c;break;default:return}},Obj3D.prototype.dup=function(){function a(b){var c,d=b instanceof Array?[]:{};for(c in b)b[c]&&"object"==typeof b[c]?d[c]=a(b[c]):d[c]=b[c];return d}var b=new Obj3D;return b.parent=this.parent,b.type=this.type,b.drawCmds=a(this.drawCmds),b.bBoxCmds=a(this.bBoxCmds),b.dwgOrg=a(this.dwgOrg),b.centroid=a(this.centroid),b.normal=a(this.normal),b.hardOfsTfm=a(this.hardOfsTfm),b.strokeColor=a(this.strokeColor),b.fillColor=a(this.fillColor),b.backColor=a(this.backColor),b.backHidden=this.backHidden,b.lineWidth=this.lineWidth,b.strokeCap=this.strokeCap,b.fontSize=this.fontSize,b.fontWeight=this.fontWeight,b.lorg=this.lorg,b.width=this.width,b.height=this.height,b},o.letters={" ":{width:16,cdata:[]},"!":{width:10,cdata:["M",5,21,0,"L",5,7,0,"M",5,2,0,"L",4,1,0,5,0,0,6,1,0,5,2,0]},'"':{width:16,cdata:["M",4,21,0,"L",4,14,0,"M",12,21,0,"L",12,14,0]},"#":{width:21,cdata:["M",11,25,0,"L",4,-7,0,"M",17,25,0,"L",10,-7,0,"M",4,12,0,"L",18,12,0,"M",3,6,0,"L",17,6,0]},$:{width:20,cdata:["M",8,25,0,"L",8,-4,0,"M",12,25,0,"L",12,-4,0,"M",17,18,0,"L",15,20,0,12,21,0,8,21,0,5,20,0,3,18,0,3,16,0,4,14,0,5,13,0,7,12,0,13,10,0,15,9,0,16,8,0,17,6,0,17,3,0,15,1,0,12,0,0,8,0,0,5,1,0,3,3,0]},"%":{width:24,cdata:["M",21,21,0,"L",3,0,0,"M",8,21,0,"L",10,19,0,10,17,0,9,15,0,7,14,0,5,14,0,3,16,0,3,18,0,4,20,0,6,21,0,8,21,0,10,20,0,13,19,0,16,19,0,19,20,0,21,21,0,"M",17,7,0,"L",15,6,0,14,4,0,14,2,0,16,0,0,18,0,0,20,1,0,21,3,0,21,5,0,19,7,0,17,7,0]},"&":{width:26,cdata:["M",23,12,0,"L",23,13,0,22,14,0,21,14,0,20,13,0,19,11,0,17,6,0,15,3,0,13,1,0,11,0,0,7,0,0,5,1,0,4,2,0,3,4,0,3,6,0,4,8,0,5,9,0,12,13,0,13,14,0,14,16,0,14,18,0,13,20,0,11,21,0,9,20,0,8,18,0,8,16,0,9,13,0,11,10,0,16,3,0,18,1,0,20,0,0,22,0,0,23,1,0,23,2,0]},"'":{width:10,cdata:["M",5,19,0,"L",4,20,0,5,21,0,6,20,0,6,18,0,5,16,0,4,15,0]},"(":{width:14,cdata:["M",11,25,0,"L",9,23,0,7,20,0,5,16,0,4,11,0,4,7,0,5,2,0,7,-2,0,9,-5,0,11,-7,0]},")":{width:14,cdata:["M",3,25,0,"L",5,23,0,7,20,0,9,16,0,10,11,0,10,7,0,9,2,0,7,-2,0,5,-5,0,3,-7,0]},"*":{width:16,cdata:["M",8,15,0,"L",8,3,0,"M",3,12,0,"L",13,6,0,"M",13,12,0,"L",3,6,0]},"+":{width:26,cdata:["M",13,18,0,"L",13,0,0,"M",4,9,0,"L",22,9,0]},",":{width:8,cdata:["M",5,4,0,"L",4,3,0,3,4,0,4,5,0,5,4,0,5,2,0,3,0,0]},"-":{width:26,cdata:["M",4,9,0,"L",22,9,0]},".":{width:8,cdata:["M",4,5,0,"L",3,4,0,4,3,0,5,4,0,4,5,0]},"/":{width:22,cdata:["M",20,25,0,"L",2,-7,0]},0:{width:20,cdata:["M",9,21,0,"L",6,20,0,4,17,0,3,12,0,3,9,0,4,4,0,6,1,0,9,0,0,11,0,0,14,1,0,16,4,0,17,9,0,17,12,0,16,17,0,14,20,0,11,21,0,9,21,0]},1:{width:20,cdata:["M",6,17,0,"L",8,18,0,11,21,0,11,0,0]},2:{width:20,cdata:["M",4,16,0,"L",4,17,0,5,19,0,6,20,0,8,21,0,12,21,0,14,20,0,15,19,0,16,17,0,16,15,0,15,13,0,13,10,0,3,0,0,17,0,0]},3:{width:20,cdata:["M",5,21,0,"L",16,21,0,10,13,0,13,13,0,15,12,0,16,11,0,17,8,0,17,6,0,16,3,0,14,1,0,11,0,0,8,0,0,5,1,0,4,2,0,3,4,0]},4:{width:20,cdata:["M",13,21,0,"L",3,7,0,18,7,0,"M",13,21,0,"L",13,0,0]},5:{width:20,cdata:["M",15,21,0,"L",5,21,0,4,12,0,5,13,0,8,14,0,11,14,0,14,13,0,16,11,0,17,8,0,17,6,0,16,3,0,14,1,0,11,0,0,8,0,0,5,1,0,4,2,0,3,4,0]},6:{width:20,cdata:["M",16,18,0,"L",15,20,0,12,21,0,10,21,0,7,20,0,5,17,0,4,12,0,4,7,0,5,3,0,7,1,0,10,0,0,11,0,0,14,1,0,16,3,0,17,6,0,17,7,0,16,10,0,14,12,0,11,13,0,10,13,0,7,12,0,5,10,0,4,7,0]},7:{width:20,cdata:["M",17,21,0,"L",7,0,0,"M",3,21,0,"L",17,21,0]},8:{width:20,cdata:["M",8,21,0,"L",5,20,0,4,18,0,4,16,0,5,14,0,7,13,0,11,12,0,14,11,0,16,9,0,17,7,0,17,4,0,16,2,0,15,1,0,12,0,0,8,0,0,5,1,0,4,2,0,3,4,0,3,7,0,4,9,0,6,11,0,9,12,0,13,13,0,15,14,0,16,16,0,16,18,0,15,20,0,12,21,0,8,21,0]},9:{width:20,cdata:["M",16,14,0,"L",15,11,0,13,9,0,10,8,0,9,8,0,6,9,0,4,11,0,3,14,0,3,15,0,4,18,0,6,20,0,9,21,0,10,21,0,13,20,0,15,18,0,16,14,0,16,9,0,15,4,0,13,1,0,10,0,0,8,0,0,5,1,0,4,3,0]},":":{width:8,cdata:["M",4,12,0,"L",3,11,0,4,10,0,5,11,0,4,12,0,"M",4,5,0,"L",3,4,0,4,3,0,5,4,0,4,5,0]},";":{width:8,cdata:["M",4,12,0,"L",3,11,0,4,10,0,5,11,0,4,12,0,"M",5,4,0,"L",4,3,0,3,4,0,4,5,0,5,4,0,5,2,0,3,0,0]},"<":{width:24,cdata:["M",20,18,0,"L",4,9,0,20,0,0]},"=":{width:26,cdata:["M",4,12,0,"L",22,12,0,"M",4,6,0,"L",22,6,0]},">":{width:24,cdata:["M",4,18,0,"L",20,9,0,4,0,0]},"?":{width:18,cdata:["M",3,16,0,"L",3,17,0,4,19,0,5,20,0,7,21,0,11,21,0,13,20,0,14,19,0,15,17,0,15,15,0,14,13,0,13,12,0,9,10,0,9,7,0,"M",9,2,0,"L",8,1,0,9,0,0,10,1,0,9,2,0]},"@":{width:27,cdata:["M",18,13,0,"L",17,15,0,15,16,0,12,16,0,10,15,0,9,14,0,8,11,0,8,8,0,9,6,0,11,5,0,14,5,0,16,6,0,17,8,0,"M",12,16,0,"L",10,14,0,9,11,0,9,8,0,10,6,0,11,5,0,"M",18,16,0,"L",17,8,0,17,6,0,19,5,0,21,5,0,23,7,0,24,10,0,24,12,0,23,15,0,22,17,0,20,19,0,18,20,0,15,21,0,12,21,0,9,20,0,7,19,0,5,17,0,4,15,0,3,12,0,3,9,0,4,6,0,5,4,0,7,2,0,9,1,0,12,0,0,15,0,0,18,1,0,20,2,0,21,3,0,"M",19,16,0,"L",18,8,0,18,6,0,19,5,0]},A:{width:18,cdata:["M",9,21,0,"L",1,0,0,"M",9,21,0,"L",17,0,0,"M",4,7,0,"L",14,7,0]},B:{width:21,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",13,21,0,16,20,0,17,19,0,18,17,0,18,15,0,17,13,0,16,12,0,13,11,0,"M",4,11,0,"L",13,11,0,16,10,0,17,9,0,18,7,0,18,4,0,17,2,0,16,1,0,13,0,0,4,0,0]},C:{width:21,cdata:["M",18,16,0,"L",17,18,0,15,20,0,13,21,0,9,21,0,7,20,0,5,18,0,4,16,0,3,13,0,3,8,0,4,5,0,5,3,0,7,1,0,9,0,0,13,0,0,15,1,0,17,3,0,18,5,0]},D:{width:21,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",11,21,0,14,20,0,16,18,0,17,16,0,18,13,0,18,8,0,17,5,0,16,3,0,14,1,0,11,0,0,4,0,0]},E:{width:19,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",17,21,0,"M",4,11,0,"L",12,11,0,"M",4,0,0,"L",17,0,0]},F:{width:18,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",17,21,0,"M",4,11,0,"L",12,11,0]},G:{width:21,cdata:["M",18,16,0,"L",17,18,0,15,20,0,13,21,0,9,21,0,7,20,0,5,18,0,4,16,0,3,13,0,3,8,0,4,5,0,5,3,0,7,1,0,9,0,0,13,0,0,15,1,0,17,3,0,18,5,0,18,8,0,"M",13,8,0,"L",18,8,0]},H:{width:22,cdata:["M",4,21,0,"L",4,0,0,"M",18,21,0,"L",18,0,0,"M",4,11,0,"L",18,11,0]},I:{width:8,cdata:["M",4,21,0,"L",4,0,0]},J:{width:16,cdata:["M",12,21,0,"L",12,5,0,11,2,0,10,1,0,8,0,0,6,0,0,4,1,0,3,2,0,2,5,0,2,7,0]},K:{width:21,cdata:["M",4,21,0,"L",4,0,0,"M",18,21,0,"L",4,7,0,"M",9,12,0,"L",18,0,0]},L:{width:17,cdata:["M",4,21,0,"L",4,0,0,"M",4,0,0,"L",16,0,0]},M:{width:24,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",12,0,0,"M",20,21,0,"L",12,0,0,"M",20,21,0,"L",20,0,0]},N:{width:22,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",18,0,0,"M",18,21,0,"L",18,0,0]},O:{width:22,cdata:["M",9,21,0,"L",7,20,0,5,18,0,4,16,0,3,13,0,3,8,0,4,5,0,5,3,0,7,1,0,9,0,0,13,0,0,15,1,0,17,3,0,18,5,0,19,8,0,19,13,0,18,16,0,17,18,0,15,20,0,13,21,0,9,21,0]},P:{width:21,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",13,21,0,16,20,0,17,19,0,18,17,0,18,14,0,17,12,0,16,11,0,13,10,0,4,10,0]},Q:{width:22,cdata:["M",9,21,0,"L",7,20,0,5,18,0,4,16,0,3,13,0,3,8,0,4,5,0,5,3,0,7,1,0,9,0,0,13,0,0,15,1,0,17,3,0,18,5,0,19,8,0,19,13,0,18,16,0,17,18,0,15,20,0,13,21,0,9,21,0,"M",12,4,0,"L",18,-2,0]},R:{width:21,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",13,21,0,16,20,0,17,19,0,18,17,0,18,15,0,17,13,0,16,12,0,13,11,0,4,11,0,"M",11,11,0,"L",18,0,0]},S:{width:20,cdata:["M",17,18,0,"L",15,20,0,12,21,0,8,21,0,5,20,0,3,18,0,3,16,0,4,14,0,5,13,0,7,12,0,13,10,0,15,9,0,16,8,0,17,6,0,17,3,0,15,1,0,12,0,0,8,0,0,5,1,0,3,3,0]},T:{width:16,cdata:["M",8,21,0,"L",8,0,0,"M",1,21,0,"L",15,21,0]},U:{width:22,cdata:["M",4,21,0,"L",4,6,0,5,3,0,7,1,0,10,0,0,12,0,0,15,1,0,17,3,0,18,6,0,18,21,0]},V:{width:18,cdata:["M",1,21,0,"L",9,0,0,"M",17,21,0,"L",9,0,0]},W:{width:24,cdata:["M",2,21,0,"L",7,0,0,"M",12,21,0,"L",7,0,0,"M",12,21,0,"L",17,0,0,"M",22,21,0,"L",17,0,0]},X:{width:20,cdata:["M",3,21,0,"L",17,0,0,"M",17,21,0,"L",3,0,0]},Y:{width:18,cdata:["M",1,21,0,"L",9,11,0,9,0,0,"M",17,21,0,"L",9,11,0]},Z:{width:20,cdata:["M",17,21,0,"L",3,0,0,"M",3,21,0,"L",17,21,0,"M",3,0,0,"L",17,0,0]},"[":{width:14,cdata:["M",4,25,0,"L",4,-7,0,"M",5,25,0,"L",5,-7,0,"M",4,25,0,"L",11,25,0,"M",4,-7,0,"L",11,-7,0]},"\\":{width:14,cdata:["M",0,21,0,"L",14,-3,0]},"]":{width:14,cdata:["M",9,25,0,"L",9,-7,0,"M",10,25,0,"L",10,-7,0,"M",3,25,0,"L",10,25,0,"M",3,-7,0,"L",10,-7,0]},"^":{width:16,cdata:["M",8,23,0,"L",0,9,0,"M",8,23,0,"L",16,9,0]},_:{width:18,cdata:["M",0,-7,0,"L",18,-7,0]},"`":{width:8,cdata:["M",5,16,0,"L",3,14,0,3,12,0,4,11,0,5,12,0,4,13,0,3,12,0]},a:{width:19,cdata:["M",15,14,0,"L",15,0,0,"M",15,11,0,"L",13,13,0,11,14,0,8,14,0,6,13,0,4,11,0,3,8,0,3,6,0,4,3,0,6,1,0,8,0,0,11,0,0,13,1,0,15,3,0]},b:{width:19,cdata:["M",4,21,0,"L",4,0,0,"M",4,11,0,"L",6,13,0,8,14,0,11,14,0,13,13,0,15,11,0,16,8,0,16,6,0,15,3,0,13,1,0,11,0,0,8,0,0,6,1,0,4,3,0]},c:{width:18,cdata:["M",15,11,0,"L",13,13,0,11,14,0,8,14,0,6,13,0,4,11,0,3,8,0,3,6,0,4,3,0,6,1,0,8,0,0,11,0,0,13,1,0,15,3,0]},d:{width:19,cdata:["M",15,21,0,"L",15,0,0,"M",15,11,0,"L",13,13,0,11,14,0,8,14,0,6,13,0,4,11,0,3,8,0,3,6,0,4,3,0,6,1,0,8,0,0,11,0,0,13,1,0,15,3,0]},e:{width:18,cdata:["M",3,8,0,"L",15,8,0,15,10,0,14,12,0,13,13,0,11,14,0,8,14,0,6,13,0,4,11,0,3,8,0,3,6,0,4,3,0,6,1,0,8,0,0,11,0,0,13,1,0,15,3,0]},f:{width:12,cdata:["M",10,21,0,"L",8,21,0,6,20,0,5,17,0,5,0,0,"M",2,14,0,"L",9,14,0]
},g:{width:19,cdata:["M",15,14,0,"L",15,-2,0,14,-5,0,13,-6,0,11,-7,0,8,-7,0,6,-6,0,"M",15,11,0,"L",13,13,0,11,14,0,8,14,0,6,13,0,4,11,0,3,8,0,3,6,0,4,3,0,6,1,0,8,0,0,11,0,0,13,1,0,15,3,0]},h:{width:19,cdata:["M",4,21,0,"L",4,0,0,"M",4,10,0,"L",7,13,0,9,14,0,12,14,0,14,13,0,15,10,0,15,0,0]},i:{width:8,cdata:["M",3,21,0,"L",4,20,0,5,21,0,4,22,0,3,21,0,"M",4,14,0,"L",4,0,0]},j:{width:10,cdata:["M",5,21,0,"L",6,20,0,7,21,0,6,22,0,5,21,0,"M",6,14,0,"L",6,-3,0,5,-6,0,3,-7,0,1,-7,0]},k:{width:17,cdata:["M",4,21,0,"L",4,0,0,"M",14,14,0,"L",4,4,0,"M",8,8,0,"L",15,0,0]},l:{width:8,cdata:["M",4,21,0,"L",4,0,0]},m:{width:30,cdata:["M",4,14,0,"L",4,0,0,"M",4,10,0,"L",7,13,0,9,14,0,12,14,0,14,13,0,15,10,0,15,0,0,"M",15,10,0,"L",18,13,0,20,14,0,23,14,0,25,13,0,26,10,0,26,0,0]},n:{width:19,cdata:["M",4,14,0,"L",4,0,0,"M",4,10,0,"L",7,13,0,9,14,0,12,14,0,14,13,0,15,10,0,15,0,0]},o:{width:19,cdata:["M",8,14,0,"L",6,13,0,4,11,0,3,8,0,3,6,0,4,3,0,6,1,0,8,0,0,11,0,0,13,1,0,15,3,0,16,6,0,16,8,0,15,11,0,13,13,0,11,14,0,8,14,0]},p:{width:19,cdata:["M",4,14,0,"L",4,-7,0,"M",4,11,0,"L",6,13,0,8,14,0,11,14,0,13,13,0,15,11,0,16,8,0,16,6,0,15,3,0,13,1,0,11,0,0,8,0,0,6,1,0,4,3,0]},q:{width:19,cdata:["M",15,14,0,"L",15,-7,0,"M",15,11,0,"L",13,13,0,11,14,0,8,14,0,6,13,0,4,11,0,3,8,0,3,6,0,4,3,0,6,1,0,8,0,0,11,0,0,13,1,0,15,3,0]},r:{width:13,cdata:["M",4,14,0,"L",4,0,0,"M",4,8,0,"L",5,11,0,7,13,0,9,14,0,12,14,0]},s:{width:17,cdata:["M",14,11,0,"L",13,13,0,10,14,0,7,14,0,4,13,0,3,11,0,4,9,0,6,8,0,11,7,0,13,6,0,14,4,0,14,3,0,13,1,0,10,0,0,7,0,0,4,1,0,3,3,0]},t:{width:12,cdata:["M",5,21,0,"L",5,4,0,6,1,0,8,0,0,10,0,0,"M",2,14,0,"L",9,14,0]},u:{width:19,cdata:["M",4,14,0,"L",4,4,0,5,1,0,7,0,0,10,0,0,12,1,0,15,4,0,"M",15,14,0,"L",15,0,0]},v:{width:16,cdata:["M",2,14,0,"L",8,0,0,"M",14,14,0,"L",8,0,0]},w:{width:22,cdata:["M",3,14,0,"L",7,0,0,"M",11,14,0,"L",7,0,0,"M",11,14,0,"L",15,0,0,"M",19,14,0,"L",15,0,0]},x:{width:17,cdata:["M",3,14,0,"L",14,0,0,"M",14,14,0,"L",3,0,0]},y:{width:16,cdata:["M",2,14,0,"L",8,0,0,"M",14,14,0,"L",8,0,0,6,-4,0,4,-6,0,2,-7,0,1,-7,0]},z:{width:17,cdata:["M",14,14,0,"L",3,0,0,"M",3,14,0,"L",14,14,0,"M",3,0,0,"L",14,0,0]},"{":{width:14,cdata:["M",9,25,0,"L",7,24,0,6,23,0,5,21,0,5,19,0,6,17,0,7,16,0,8,14,0,8,12,0,6,10,0,"M",7,24,0,"L",6,22,0,6,20,0,7,18,0,8,17,0,9,15,0,9,13,0,8,11,0,4,9,0,8,7,0,9,5,0,9,3,0,8,1,0,7,0,0,6,-2,0,6,-4,0,7,-6,0,"M",6,8,0,"L",8,6,0,8,4,0,7,2,0,6,1,0,5,-1,0,5,-3,0,6,-5,0,7,-6,0,9,-7,0]},"|":{width:8,cdata:["M",4,25,0,"L",4,-7,0]},"}":{width:14,cdata:["M",5,25,0,"L",7,24,0,8,23,0,9,21,0,9,19,0,8,17,0,7,16,0,6,14,0,6,12,0,8,10,0,"M",7,24,0,"L",8,22,0,8,20,0,7,18,0,6,17,0,5,15,0,5,13,0,6,11,0,10,9,0,6,7,0,5,5,0,5,3,0,6,1,0,7,0,0,8,-2,0,8,-4,0,7,-6,0,"M",8,8,0,"L",6,6,0,6,4,0,7,2,0,8,1,0,9,-1,0,9,-3,0,8,-5,0,7,-6,0,5,-7,0]},"~":{width:24,cdata:["M",3,6,0,"L",3,8,0,4,11,0,6,12,0,8,12,0,10,11,0,14,8,0,16,7,0,18,7,0,20,8,0,21,10,0,"M",3,8,0,"L",4,10,0,6,11,0,8,11,0,10,10,0,14,7,0,16,6,0,18,6,0,20,7,0,21,10,0,21,12,0]},"Α":{width:18,cdata:["M",9,21,0,"L",1,0,0,"M",9,21,0,"L",17,0,0,"M",4,7,0,"L",14,7,0]},"Β":{width:21,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",13,21,0,16,20,0,17,19,0,18,17,0,18,15,0,17,13,0,16,12,0,13,11,0,"M",4,11,0,"L",13,11,0,16,10,0,17,9,0,18,7,0,18,4,0,17,2,0,16,1,0,13,0,0,4,0,0]},"Χ":{width:20,cdata:["M",3,21,0,"L",17,0,0,"M",3,0,0,"L",17,21,0]},"Δ":{width:18,cdata:["M",9,21,0,"L",1,0,0,"M",9,21,0,"L",17,0,0,"M",1,0,0,"L",17,0,0]},"Ε":{width:19,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",17,21,0,"M",4,11,0,"L",12,11,0,"M",4,0,0,"L",17,0,0]},"Φ":{width:20,cdata:["M",10,21,0,"L",10,0,0,"M",8,16,0,"L",5,15,0,4,14,0,3,12,0,3,9,0,4,7,0,5,6,0,8,5,0,12,5,0,15,6,0,16,7,0,17,9,0,17,12,0,16,14,0,15,15,0,12,16,0,8,16,0]},"Γ":{width:17,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",16,21,0]},"Η":{width:22,cdata:["M",4,21,0,"L",4,0,0,"M",18,21,0,"L",18,0,0,"M",4,11,0,"L",18,11,0]},"Ι":{width:8,cdata:["M",4,21,0,"L",4,0,0]},"·":{width:5,cdata:["M",2,10,0,"L",2,9,0,3,9,0,3,10,0,2,10,0]},"Κ":{width:21,cdata:["M",4,21,0,"L",4,0,0,"M",18,21,0,"L",4,7,0,"M",9,12,0,"L",18,0,0]},"Λ":{width:18,cdata:["M",9,21,0,"L",1,0,0,"M",9,21,0,"L",17,0,0]},"Μ":{width:24,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",12,0,0,"M",20,21,0,"L",12,0,0,"M",20,21,0,"L",20,0,0]},"Ν":{width:22,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",18,0,0,"M",18,21,0,"L",18,0,0]},"Ο":{width:22,cdata:["M",9,21,0,"L",7,20,0,5,18,0,4,16,0,3,13,0,3,8,0,4,5,0,5,3,0,7,1,0,9,0,0,13,0,0,15,1,0,17,3,0,18,5,0,19,8,0,19,13,0,18,16,0,17,18,0,15,20,0,13,21,0,9,21,0]},"Π":{width:22,cdata:["M",4,21,0,"L",4,0,0,"M",18,21,0,"L",18,0,0,"M",4,21,0,"L",18,21,0]},"Θ":{width:22,cdata:["M",9,21,0,"L",7,20,0,5,18,0,4,16,0,3,13,0,3,8,0,4,5,0,5,3,0,7,1,0,9,0,0,13,0,0,15,1,0,17,3,0,18,5,0,19,8,0,19,13,0,18,16,0,17,18,0,15,20,0,13,21,0,9,21,0,"M",8,11,0,"L",14,11,0]},"Ρ":{width:21,cdata:["M",4,21,0,"L",4,0,0,"M",4,21,0,"L",13,21,0,16,20,0,17,19,0,18,17,0,18,14,0,17,12,0,16,11,0,13,10,0,4,10,0]},"Σ":{width:18,cdata:["M",2,21,0,"L",9,11,0,2,0,0,"M",2,21,0,"L",16,21,0,"M",2,0,0,"L",16,0,0]},"Τ":{width:16,cdata:["M",8,21,0,"L",8,0,0,"M",1,21,0,"L",15,21,0]},"Υ":{width:18,cdata:["M",2,16,0,"L",2,18,0,3,20,0,4,21,0,6,21,0,7,20,0,8,18,0,9,14,0,9,0,0,"M",16,16,0,"L",16,18,0,15,20,0,14,21,0,12,21,0,11,20,0,10,18,0,9,14,0]},"°":{width:14,cdata:["M",6,21,0,"L",4,20,0,3,18,0,3,16,0,4,14,0,6,13,0,8,13,0,10,14,0,11,16,0,11,18,0,10,20,0,8,21,0,6,21,0]},"Ω":{width:20,cdata:["M",3,0,0,"L",7,0,0,4,7,0,3,11,0,3,15,0,4,18,0,6,20,0,9,21,0,11,21,0,14,20,0,16,18,0,17,15,0,17,11,0,16,7,0,13,0,0,17,0,0]},"Ξ":{width:18,cdata:["M",2,21,0,"L",16,21,0,"M",6,11,0,"L",12,11,0,"M",2,0,0,"L",16,0,0]},"Ψ":{width:22,cdata:["M",11,21,0,"L",11,0,0,"M",2,15,0,"L",3,15,0,4,14,0,5,10,0,6,8,0,7,7,0,10,6,0,12,6,0,15,7,0,16,8,0,17,10,0,18,14,0,19,15,0,20,15,0]},"Ζ":{width:20,cdata:["M",17,21,0,"L",3,0,0,"M",3,21,0,"L",17,21,0,"M",3,0,0,"L",17,0,0]},"α":{width:21,cdata:["M",9,14,0,"L",7,13,0,5,11,0,4,9,0,3,6,0,3,3,0,4,1,0,6,0,0,8,0,0,10,1,0,13,4,0,15,7,0,17,11,0,18,14,0,"M",9,14,0,"L",11,14,0,12,13,0,13,11,0,15,3,0,16,1,0,17,0,0,18,0,0]},"β":{width:19,cdata:["M",12,21,0,"L",10,20,0,8,18,0,6,14,0,5,11,0,4,7,0,3,1,0,2,-7,0,"M",12,21,0,"L",14,21,0,16,19,0,16,16,0,15,14,0,14,13,0,12,12,0,9,12,0,"M",9,12,0,"L",11,11,0,13,9,0,14,7,0,14,4,0,13,2,0,12,1,0,10,0,0,8,0,0,6,1,0,5,2,0,4,5,0]},"χ":{width:18,cdata:["M",2,14,0,"L",4,14,0,6,12,0,12,-5,0,14,-7,0,16,-7,0,"M",17,14,0,"L",16,12,0,14,9,0,4,-2,0,2,-5,0,1,-7,0]},"δ":{width:18,cdata:["M",11,14,0,"L",8,14,0,6,13,0,4,11,0,3,8,0,3,5,0,4,2,0,5,1,0,7,0,0,9,0,0,11,1,0,13,3,0,14,6,0,14,9,0,13,12,0,11,14,0,9,16,0,8,18,0,8,20,0,9,21,0,11,21,0,13,20,0,15,18,0]},"ε":{width:16,cdata:["M",13,12,0,"L",12,13,0,10,14,0,7,14,0,5,13,0,5,11,0,6,9,0,9,8,0,"M",9,8,0,"L",5,7,0,3,5,0,3,3,0,4,1,0,6,0,0,9,0,0,11,1,0,13,3,0]},"φ":{width:22,cdata:["M",8,13,0,"L",6,12,0,4,10,0,3,7,0,3,4,0,4,2,0,5,1,0,7,0,0,10,0,0,13,1,0,16,3,0,18,6,0,19,9,0,19,12,0,17,14,0,15,14,0,13,12,0,11,8,0,9,3,0,6,-7,0]},"γ":{width:19,cdata:["M",1,11,0,"L",3,13,0,5,14,0,6,14,0,8,13,0,9,12,0,10,9,0,10,5,0,9,0,0,"M",17,14,0,"L",16,11,0,15,9,0,9,0,0,7,-4,0,6,-7,0]},"η":{width:20,cdata:["M",1,10,0,"L",2,12,0,4,14,0,6,14,0,7,13,0,7,11,0,6,7,0,4,0,0,"M",6,7,0,"L",8,11,0,10,13,0,12,14,0,14,14,0,16,12,0,16,9,0,15,4,0,12,-7,0]},"ι":{width:11,cdata:["M",6,14,0,"L",4,7,0,3,3,0,3,1,0,4,0,0,6,0,0,8,2,0,9,4,0]},"×":{width:22,cdata:["M",4,16,0,"L",18,2,0,"M",18,16,0,"L",4,2,0]},"κ":{width:18,cdata:["M",6,14,0,"L",2,0,0,"M",16,13,0,"L",15,14,0,14,14,0,12,13,0,8,9,0,6,8,0,5,8,0,"M",5,8,0,"L",7,7,0,8,6,0,10,1,0,11,0,0,12,0,0,13,1,0]},"λ":{width:16,cdata:["M",1,21,0,"L",3,21,0,5,20,0,6,19,0,14,0,0,"M",8,14,0,"L",2,0,0]},"μ":{width:21,cdata:["M",7,14,0,"L",1,-7,0,"M",6,10,0,"L",5,5,0,5,2,0,7,0,0,9,0,0,11,1,0,13,3,0,15,7,0,"M",17,14,0,"L",15,7,0,14,3,0,14,1,0,15,0,0,17,0,0,19,2,0,20,4,0]},"ν":{width:18,cdata:["M",3,14,0,"L",6,14,0,5,8,0,4,3,0,3,0,0,"M",16,14,0,"L",15,11,0,14,9,0,12,6,0,9,3,0,6,1,0,3,0,0]},"ο":{width:17,cdata:["M",8,14,0,"L",6,13,0,4,11,0,3,8,0,3,5,0,4,2,0,5,1,0,7,0,0,9,0,0,11,1,0,13,3,0,14,6,0,14,9,0,13,12,0,12,13,0,10,14,0,8,14,0]},"π":{width:22,cdata:["M",9,14,0,"L",5,0,0,"M",14,14,0,"L",15,8,0,16,3,0,17,0,0,"M",2,11,0,"L",4,13,0,7,14,0,20,14,0]},"ϑ":{width:21,cdata:["M",1,10,0,"L",2,12,0,4,14,0,6,14,0,7,13,0,7,11,0,6,6,0,6,3,0,7,1,0,8,0,0,10,0,0,12,1,0,14,4,0,15,6,0,16,9,0,17,14,0,17,17,0,16,20,0,14,21,0,12,21,0,11,19,0,11,17,0,12,14,0,14,11,0,16,9,0,19,7,0]},"ρ":{width:18,cdata:["M",4,8,0,"L",4,5,0,5,2,0,6,1,0,8,0,0,10,0,0,12,1,0,14,3,0,15,6,0,15,9,0,14,12,0,13,13,0,11,14,0,9,14,0,7,13,0,5,11,0,4,8,0,0,-7,0]},"σ":{width:20,cdata:["M",18,14,0,"L",8,14,0,6,13,0,4,11,0,3,8,0,3,5,0,4,2,0,5,1,0,7,0,0,9,0,0,11,1,0,13,3,0,14,6,0,14,9,0,13,12,0,12,13,0,10,14,0]},"τ":{width:20,cdata:["M",11,14,0,"L",8,0,0,"M",2,11,0,"L",4,13,0,7,14,0,18,14,0]},"υ":{width:20,cdata:["M",1,10,0,"L",2,12,0,4,14,0,6,14,0,7,13,0,7,11,0,5,5,0,5,2,0,7,0,0,9,0,0,12,1,0,14,3,0,16,7,0,17,11,0,17,14,0]},"÷":{width:26,cdata:["M",13,18,0,"L",12,17,0,13,16,0,14,17,0,13,18,0,"M",4,9,0,"L",22,9,0,"M",13,2,0,"L",12,1,0,13,0,0,14,1,0,13,2,0]},"ω":{width:23,cdata:["M",8,14,0,"L",6,13,0,4,10,0,3,7,0,3,4,0,4,1,0,5,0,0,7,0,0,9,1,0,11,4,0,"M",12,8,0,"L",11,4,0,12,1,0,13,0,0,15,0,0,17,1,0,19,4,0,20,7,0,20,10,0,19,13,0,18,14,0]},"ξ":{width:16,cdata:["M",10,21,0,"L",8,20,0,7,19,0,7,18,0,8,17,0,11,16,0,14,16,0,"M",11,16,0,"L",8,15,0,6,14,0,5,12,0,5,10,0,7,8,0,10,7,0,12,7,0,"M",10,7,0,"L",6,6,0,4,5,0,3,3,0,3,1,0,5,-1,0,9,-3,0,10,-4,0,10,-6,0,8,-7,0,6,-7,0]},"ψ":{width:23,cdata:["M",16,21,0,"L",8,-7,0,"M",1,10,0,"L",2,12,0,4,14,0,6,14,0,7,13,0,7,11,0,6,6,0,6,3,0,7,1,0,9,0,0,11,0,0,14,1,0,16,3,0,18,6,0,20,11,0,21,14,0]},"ζ":{width:15,cdata:["M",10,21,0,"L",8,20,0,7,19,0,7,18,0,8,17,0,11,16,0,14,16,0,"M",14,16,0,"L",10,14,0,7,12,0,4,9,0,3,6,0,3,4,0,4,2,0,6,0,0,9,-2,0,10,-4,0,10,-6,0,9,-7,0,7,-7,0,6,-5,0]},"θ":{width:21,cdata:["M",12,21,0,"L",9,20,0,7,18,0,5,15,0,4,13,0,3,9,0,3,5,0,4,2,0,5,1,0,7,0,0,9,0,0,12,1,0,14,3,0,16,6,0,17,8,0,18,12,0,18,16,0,17,19,0,16,20,0,14,21,0,12,21,0,"M",4,11,0,"L",18,11,0]}},o.strWidth=function(a,b){var c,d,e=0;for(c=0;c<b.length;c++)d=o.letters[b.charAt(c)],d&&(e+=d.width*a/25);return e},o.stringToCgo3D=function(a){function b(a,b){for(var c,d,e,f=[],g=0;g<a.length;)"string"==typeof a[g]&&f.push(a[g++]),c=a[g++]+b,d=a[g++],e=a[g++],f.push(c,d,e);return f}var c,d,e,f=0,g=0,h=[];for(c=0;c<a.length;c++)d=o.letters[a.charAt(c)],d&&(e=b(d.cdata,f),f+=d.width,h=h.concat(e));return g=22,{cgoData:h,width:f,height:g}},Cango3D=function(b){return this.cId=b,this.cnvs=document.getElementById(b),null===this.cnvs?void alert("can't find canvas "+b):(this.rawWidth=this.cnvs.offsetWidth,this.rawHeight=this.cnvs.offsetHeight,this.aRatio=this.rawWidth/this.rawHeight,this.cnvs.hasOwnProperty("dragObjects")||(this.cnvs.dragObjects=[]),this.cnvs.hasOwnProperty("resized")||(this.cnvs.setAttribute("width",this.rawWidth),this.cnvs.setAttribute("height",this.rawHeight),this.cnvs.resized=!0),this.ctx=this.cnvs.getContext("2d"),this.vpW=this.rawWidth,this.vpH=this.rawHeight,this.vpLLx=0,this.vpLLy=this.rawHeight,this.xscl=1,this.yscl=-1,this.xoffset=0,this.yoffset=0,this.ctx.textAlign="left",this.ctx.textBaseline="top",this.penCol=new a("black"),this.penWid=1,this.lineCap="butt",this.paintCol=new a("steelblue"),this.backCol=new a("gray"),this.fontSize=10,this.fontWeight=400,this.fov=45,this.viewpointDistance=this.rawWidth/(this.xscl*Math.tan(this.fov*Math.PI/360)),this.lightSource={x:0,y:100,z:500},this.plotNormals=!1,void m(this))},Cango3D.prototype.toPixelCoords3D=function(a,b,c){var d=this.vpLLx+this.xoffset+a*this.xscl,e=this.vpLLy+this.yoffset+b*this.yscl,f=c*this.xscl;return{x:d,y:e,z:f}},Cango3D.prototype.toWorldCoords3D=function(a,b,c){var d=(a-this.vpLLx-this.xoffset)/this.xscl,e=(b-this.vpLLy-this.yoffset)/this.yscl,f=c/this.xscl;return{x:d,y:e,z:f}},Cango3D.prototype.getCursorPos=function(a){var b=a||window.event,c=this.cnvs.getBoundingClientRect();return{x:b.clientX-c.left,y:b.clientY-c.top,z:0}},Cango3D.prototype.getCursorPosWC=function(a){var b=a||window.event,c=this.cnvs.getBoundingClientRect(),d=(b.clientX-c.left-this.vpLLx-this.xoffset)/this.xscl,e=(b.clientY-c.top-this.vpLLy-this.yoffset)/this.yscl;return{x:d,y:e,z:0}},Cango3D.prototype.clearCanvas=function(a){void 0!==a?(this.ctx.save(),this.ctx.fillStyle=a,this.ctx.fillRect(0,0,this.rawWidth,this.rawHeight),this.ctx.restore()):this.ctx.clearRect(0,0,this.rawWidth,this.rawHeight),this.cnvs.dragObjects.length=0},Cango3D.prototype.setWorldCoords3D=function(a,b,c){c>0?(this.xscl=this.vpW/c,this.yscl=-this.xscl,this.xoffset=-a*this.xscl,this.yoffset=-b*this.yscl):(this.xscl=this.rawWidth/100,this.yscl=-this.rawWidth/100,this.xoffset=0,this.yoffset=0),this.setFOV(this.fov)},Cango3D.prototype.setPropertyDefault=function(b,c){var d;if("string"==typeof b&&void 0!==c&&null!==c)switch(b.toLowerCase()){case"backgroundcolor":d=new a(c),d.ok&&(this.cnvs.style.backgroundColor=d.toRGBA());break;case"fillcolor":d=new a(c),d.ok&&(this.paintCol=d);break;case"backcolor":d=new a(c),d.ok&&(this.backCol=d);break;case"strokecolor":d=new a(c),d.ok&&(this.penCol=d);break;case"strokewidth":case"linewidth":this.penWid=c,this.ctx.lineWidth=this.penWid;break;case"linecap":if("string"!=typeof c)return;("butt"===c||"round"===c||"square"===c)&&(this.lineCap=c),this.ctx.lineCap=this.lineCap;break;case"fontsize":q(c)&&c>=6&&60>=c&&(this.fontSize=c);break;case"fontweight":q(c)&&c>=100&&900>=c&&(this.fontWeight=c);break;default:return}},Cango3D.prototype.setFOV=function(a){function b(a){var b,d,e=c.rawWidth,f=c.xoffset;return 0>f&&(f=0),f>e&&(f=e),b=Math.abs(e/2-f)+e/2,b/=c.xscl,d=Math.PI*a/360,b/Math.tan(d)}var c=this;60>=a&&a>=20&&(this.fov=a,this.viewpointDistance=b(this.fov))},Cango3D.prototype.setLightSource=function(a,b,c){void 0!==a&&void 0!==b&&void 0!==c&&(this.lightSource.x=a,this.lightSource.y=b,this.lightSource.z=c)},Cango3D.prototype.createGroup3D=function(){var a=new Group3D;return a.addObj.apply(a,arguments),a},Cango3D.prototype.compilePath3D=function(a,b,c){var d=c||this.penWid,e=new Obj3D(a,"PATH",{strokeColor:b,lineWidth:d});return e},Cango3D.prototype.compileShape3D=function(a,b,c){var d=new Obj3D(a,"SHAPE",{fillColor:b,backColor:c});return d},Cango3D.prototype.compileText3D=function(a,b,c,d,e){var f,g,h,k,l,m,n=this.fontSize,p=this.fontWeight;return q(c)&&c>=6&&60>=c&&(n=c),q(d)&&d>99&&901>d&&(p=d),f=o.stringToCgo3D(a),g=new Obj3D(f.cgoData,"TEXT",{strokeColor:b,fontSize:n,fontWeight:p,lorg:e,width:f.width,height:f.height,lineWidth:1}),h=new i(0,0,0),l=new i(g.width,0,0),k=new i(0,g.height,0),m=new i(g.width,g.height,0),g.bBoxCmds[0]=new j("moveTo",[],k),g.bBoxCmds[1]=new j("lineTo",[],h),g.bBoxCmds[2]=new j("lineTo",[],l),g.bBoxCmds[3]=new j("lineTo",[],m),g.bBoxCmds[4]=new j("closePath",[]),g},Cango3D.prototype.tagShape3D=function(a,b,c,d){var e=c||0,f=d||0;return"SHAPE"!==a.type?null:(b.translate(e,f,0),b.backHidden=!0,b.centroid.x=a.centroid.x,b.centroid.y=a.centroid.y,b.centroid.z=a.centroid.z,b.normal.x=a.normal.x,b.normal.y=a.normal.y,b.normal.z=a.normal.z,new Group3D(a,b))},Cango3D.prototype.appendTag=function(a,b,c,d){var e=a.children[0],f=c||0,g=d||0;"SHAPE"===e.type&&(b.translate(f,g,0),b.backHidden=!0,b.centroid.x=e.centroid.x,b.centroid.y=e.centroid.y,b.centroid.z=e.centroid.z,b.normal.x=e.normal.x,b.normal.y=e.normal.y,b.normal.z=e.normal.z,a.addObj(b))},Cango3D.prototype.JSONtoObj3D=function(b){function c(b){var c,d=b.fillColor?new a(b.fillColor):null,e=b.strokeColor?new a(b.strokeColor):null,f=b.backColor?new a(b.backColor):null,g=b.lineWidth||1;return"GROUP"===b.type?c=new Group3D:"PATH"===b.type?c=new Obj3D(b.pathData,"PATH"):"SHAPE"===b.type?c=new Obj3D(b.pathData,"SHAPE"):"TEXT"===b.type&&(c=new Obj3D(b.pathData,"TEXT"),c.bBoxCmds=k(b.textBoxData)),b.hardOfsTfm&&(c.hardOfsTfm=b.hardOfsTfm),b.name&&(c.name=b.name.slice(0)),b.centroid&&(c.centroid=new i(b.centroid[0],b.centroid[1],b.centroid[2])),b.normal&&(c.normal=new i(b.normal[0],b.normal[1],b.normal[2])),"GROUP"!==c.type&&(c.fillColor=d,c.strokeColor=e,c.backColor=f,c.lineWidth=g,c.backHidden=b.backHidden||!1,c.fontSize=b.fontSize||null,c.fontWeight=b.fontWeight||null,c.width=b.width||null,c.height=b.height||null,c.lorg=b.lorg||7,c.strokeCap=b.strokeCap||"butt"),c}function d(a,b,c){var e,f,g;for(e=0;e<b.children.length;e++)g=b.children[e],f=a(g),c.addObj(f),"GROUP"===g.type&&d(a,g,f)}var e,f;return f=b.ComponentData,"GROUP"===f.type?(e=this.createGroup3D(),d(c,f,e)):e=c(f),e},Cango3D.prototype.Obj3DtoJSON=function(a,b){function c(a){return Math.round(1e3*a)/1e3}function d(a){var b={};return"GROUP"===a.type?(b.type="GROUP",b.children=[],b):(b.type=a.type,a.fillColor&&(b.fillColor=a.fillColor.toRGBA()),a.strokeColor&&(b.strokeColor=a.strokeColor.toRGBA()),a.backColor&&(b.backColor=a.backColor.toRGBA()),b.backHidden=a.backHidden,b.hardOfsTfm=a.hardOfsTfm,a.lineWidth&&(b.lineWidth=a.lineWidth),a.strokeCap&&(b.strokeCap=a.strokeCap.slice(0)),a.fontSize&&(b.fontSize=a.fontSize),a.fontWeight&&(b.fontWeight=a.fontWeight),a.lorg&&(b.lorg=a.lorg),a.width&&(b.width=a.width),a.height&&(b.height=a.height),a.name&&(b.name=a.name.slice(0)),b.pathData=n(a.drawCmds),"TEXT"===a.type&&(b.textBoxData=n(a.bBoxCmds)),b.centroid=[],b.centroid.push(c(a.centroid.x),c(a.centroid.y),c(a.centroid.z)),b.normal=[],b.normal.push(c(a.normal.x),c(a.normal.y),c(a.normal.z)),b)}function e(a,b,c){var d,f,g;for(d=0;d<b.children.length;d++)g=b.children[d],f=a(g),c.push(f),"GROUP"===g.type&&e(a,g,f.children)}var f={type:"Component",name:b||"Object1",ComponentData:{}};return"GROUP"===a.type?(f.ComponentData.type="GROUP",f.ComponentData.children=[],e(d,a,f.ComponentData.children)):f.ComponentData=d(a),JSON.stringify(f)},Cango3D.prototype.renderFrame=function(a){function b(){c.render(a)}var c=this;window.requestAnimationFrame(b)},Cango3D.prototype.render=function(a){function b(a){var b,d,e,g,h=0,i=0,j=a.width,k=a.height,m=j/2,n=k/2,o=[0,[0,k],[m,k],[j,k],[0,n],[m,n],[j,n],[0,0],[m,0],[j,0]];void 0!==o[a.lorg]&&(h=-o[a.lorg][0],i=-o[a.lorg][1]),b=c(h,i,0),e=a.fontSize||l.fontSize,e/=l.xscl,g=e/25,d=f(g),a.lorgTfm.matrixMult(b,d)}function d(a){var b,c;if("TEXT"===a.type){for(a.lorgTfm.applyTransform(a.netTfm.matrix),b=0;b<a.drawCmds.length;b++){for(c=0;c<a.drawCmds[b].cPts.length;c++)a.drawCmds[b].cPts[c].softTransform(a.lorgTfm.matrix);void 0!==a.drawCmds[b].ep&&a.drawCmds[b].ep.softTransform(a.lorgTfm.matrix)}for(b=0;b<a.bBoxCmds.length;b++)void 0!==a.bBoxCmds[b].ep&&a.bBoxCmds[b].ep.softTransform(a.lorgTfm.matrix)}else for(b=0;b<a.drawCmds.length;b++){for(c=0;c<a.drawCmds[b].cPts.length;c++)a.drawCmds[b].cPts[c].softTransform(a.netTfm.matrix);void 0!==a.drawCmds[b].ep&&a.drawCmds[b].ep.softTransform(a.netTfm.matrix)}}function e(a){function c(a,c){var e;if("GROUP"===a.type){for(a.grpTfm=c.netTfm,e=0;e<a.ofsTfmAry.length;e++)a.ofsTfm.applyTransform(a.ofsTfmAry[e]);a.ofsTfmAry.length=0,a.netTfm.matrixMult(a.ofsTfm.matrix,a.grpTfm.matrix),a.dwgOrg=new i,a.dwgOrg.softTransform(a.netTfm.matrix),a.centroid.softTransform(a.netTfm.matrix)}else{for("TEXT"===a.type&&b(a),a.grpTfm=c.netTfm,a.ofsTfm.reset(),e=0;e<a.ofsTfmAry.length;e++)a.ofsTfm.applyTransform(a.ofsTfmAry[e]);a.ofsTfmAry.length=0,a.ofsTfm.applyTransform(a.grpTfm.matrix),a.centroid.softTransform(a.ofsTfm.matrix),a.normal.softTransform(a.ofsTfm.matrix),a.netTfm.matrixMult(a.hardOfsTfm.matrix,a.ofsTfm.matrix),a.dwgOrg=new i,"TEXT"===a.type&&a.dwgOrg.hardTransform(a.lorgTfm.matrix),a.dwgOrg.softTransform(a.netTfm.matrix),d(a)}}function e(a,b){var c,d;for(c=0;c<b.children.length;c++)d=b.children[c],a(d,b),"GROUP"===d.type&&e(a,d)}e(c,a)}function g(a){function b(a){var b=l.viewpointDistance/(l.viewpointDistance-a.tz);a.fx=a.tx*b,a.fy=a.ty*b}var c,d;for(c=0;c<a.drawCmds.length;c++){for(d=0;d<a.drawCmds[c].cPts.length;d++)b(a.drawCmds[c].cPts[d]),a.drawCmds[c].parms[2*d]=a.drawCmds[c].cPts[d].fx,a.drawCmds[c].parms[2*d+1]=a.drawCmds[c].cPts[d].fy;void 0!==a.drawCmds[c].ep&&(b(a.drawCmds[c].ep),a.drawCmds[c].parms[2*d]=a.drawCmds[c].ep.fx,a.drawCmds[c].parms[2*d+1]=a.drawCmds[c].ep.fy)}if("TEXT"===a.type)for(c=0;4>c;c++)b(a.bBoxCmds[c].ep),a.bBoxCmds[c].parms[0]=a.bBoxCmds[c].ep.fx,a.bBoxCmds[c].parms[1]=a.bBoxCmds[c].ep.fy;b(a.centroid),b(a.normal)}function h(a){function b(a,b){return a.centroid.tz-b.centroid.tz}var c,d;for(a.children.sort(b),c=0;c<a.children.length;c++)d=a.children[c],"GROUP"===d.type&&d.children.length>0?h(d):o.push(d)}var j,k,l=this,m=!0,n=!1,o=[];for(null!=a.data&&(m=a.data.clear),j=Array.prototype.slice.call(arguments),k=0;k<arguments.length;k++)"string"==typeof j[k]&&"wireframe"===j[k].toLowerCase()&&(n=!0),"string"==typeof j[k]&&"noclear"===j[k].toLowerCase()&&(m=!1);if(m===!0&&this.clearCanvas(),"GROUP"===a.type){for(k=0;k<a.ofsTfmAry.length;k++)a.ofsTfm.applyTransform(a.ofsTfmAry[k]);for(a.ofsTfmAry.length=0,a.netTfm.matrixMult(a.ofsTfm.matrix,a.grpTfm.matrix),a.dwgOrg=new i,a.dwgOrg.softTransform(a.netTfm.matrix),a.centroid.softTransform(a.netTfm.matrix),e(a),h(a),k=0;k<o.length;k++)g(o[k]),(n||this.frontFacing(o[k])||!o[k].backHidden)&&this.paintObj3D(o[k],n)}else{for("TEXT"===a.type&&b(a),k=0;k<a.ofsTfmAry.length;k++)a.ofsTfm.applyTransform(a.ofsTfmAry[k]);a.ofsTfmAry.length=0,a.netTfm.matrixMult(a.hardOfsTfm.matrix,a.ofsTfm.matrix),a.dwgOrg=new i,"TEXT"===a.type&&a.dwgOrg.hardTransform(a.lorgTfm.matrix),a.dwgOrg.softTransform(a.ofsTfm.matrix),a.centroid.softTransform(a.netTfm.matrix),a.normal.softTransform(a.netTfm.matrix),d(a),g(a),(n||this.frontFacing(a)||!a.backHidden)&&this.paintObj3D(a,n)}},Cango3D.prototype.paintObj3D=function(a,b){var c,d,e,f,g,h,i;for(this.ctx.save(),this.ctx.beginPath(),c=0;c<a.drawCmds.length;c++){for(d=0;d<a.drawCmds[c].parms.length;d+=2)a.drawCmds[c].parmsPx[d]=this.vpLLx+this.xoffset+a.drawCmds[c].parms[d]*this.xscl,a.drawCmds[c].parmsPx[d+1]=this.vpLLy+this.yoffset+a.drawCmds[c].parms[d+1]*this.yscl;this.ctx[a.drawCmds[c].drawFn].apply(this.ctx,a.drawCmds[c].parmsPx)}if("TEXT"===a.type)for(c=0;c<a.bBoxCmds.length;c++)for(d=0;d<a.bBoxCmds[c].parms.length;d+=2)a.bBoxCmds[c].parmsPx[d]=this.vpLLx+this.xoffset+a.bBoxCmds[c].parms[d]*this.xscl,a.bBoxCmds[c].parmsPx[d+1]=this.vpLLy+this.yoffset+a.bBoxCmds[c].parms[d+1]*this.yscl;"SHAPE"===a.type?(this.ctx.closePath(),this.ctx.lineWidth=1,b?(i=a.strokeColor||this.penCol,this.ctx.strokeStyle=i.toRGBA(),this.ctx.lineCap=this.lineCap,this.ctx.stroke()):(this.ctx.fillStyle=this.calcShapeShade(a),this.ctx.strokeStyle=this.ctx.fillStyle,this.ctx.fill(),a.fillColor.a>.9&&this.ctx.stroke())):(i=a.strokeColor||this.penCol,this.ctx.strokeStyle=i.toRGBA(),this.ctx.lineWidth=a.lineWidth,"TEXT"===a.type&&(this.ctx.lineWidth*=.08*a.fontSize*a.fontWeight/400),this.ctx.lineCap=a.strokeCap,this.ctx.stroke()),this.plotNormals&&(e=this.vpLLx+this.xoffset+a.centroid.fx*this.xscl,f=this.vpLLy+this.yoffset+a.centroid.fy*this.yscl,g=this.vpLLx+this.xoffset+a.normal.fx*this.xscl,h=this.vpLLy+this.yoffset+a.normal.fy*this.yscl,a.centroid.tz<a.normal.tz?this.ctx.strokeStyle="green":this.ctx.strokeStyle="red",this.ctx.beginPath(),this.ctx.moveTo(e,f),this.ctx.lineTo(g,h),this.ctx.stroke()),this.ctx.restore(),null!==a.dragNdrop&&(a.dragNdrop.cgo=this,this.cnvs.dragObjects.contains(a)||this.cnvs.dragObjects.push(a))},Cango3D.prototype.frontFacing=function(a){var b=a.normal.tx-a.centroid.tx,c=a.normal.ty-a.centroid.ty,d=a.normal.tz-a.centroid.tz,e=-a.centroid.tx,f=-a.centroid.ty,g=this.viewpointDistance-a.centroid.tz;return b*e+c*f+d*g>0},Cango3D.prototype.calcShapeShade=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o;return d=this.lightSource.x,e=this.lightSource.y,f=this.lightSource.z,g=Math.sqrt(d*d+e*e+f*f),d/=g,e/=g,f/=g,h=a.normal.tx-a.centroid.tx,i=a.normal.ty-a.centroid.ty,j=a.normal.tz-a.centroid.tz,k=Math.sqrt(h*h+i*i+j*j),h/=k,i/=k,j/=k,c=.6*(d*h+e*i+f*j),c=Math.abs(c),c+=.4,this.frontFacing(a)?(b=a.fillColor||this.paintCol,0>h*d+i*e+j*f&&(c=.4)):(b=a.backColor||this.backCol,h*d+i*e+j*f>0&&(c=.4)),l=Math.round(c*b.r),m=Math.round(c*b.g),n=Math.round(c*b.b),o=b.a,"rgba("+l+","+m+","+n+","+o+")"},Cango3D.prototype.objectOfRevolution3D=function(a,b,c,d,e,f){function g(a,b,c,d,e,f){var g,h,i,j,k=d*Math.PI/180,l=e*Math.PI/180,m=.55228475,n=b+c*Math.sin(k),o=a+c*Math.cos(k),p=b+c*Math.sin(l),q=a+c*Math.cos(l),r=f?1:0;return i=1-r,g=r?l-k:k-l,0>g&&(g+=2*Math.PI),g>2*Math.PI&&(g-=2*Math.PI),h=g>Math.PI?1:0,j=Math.abs(g)<.01||Math.abs(g)>2*Math.PI-.01?["M",a,b-c,"C",a+m*c,b-c,a+c,b-m*c,a+c,b,a+c,b+m*c,a+m*c,b+c,a,b+c,a-m*c,b+c,a-c,b+m*c,a-c,b,a-c,b-m*c,a-m*c,b-c,a,b-c]:["M",o,n,"A",c,c,0,h,i,q,p],svgToCgo3D(j)}var h,i,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this.compilePath3D(a),E=this.createGroup3D(),F=0,G=0,H=0,I=0,J=c||6,K=360/J,L=K*Math.PI/180,M=d||this.paintCol.toRGBA(),N=e||M;if(t=1,u=D.drawCmds.length,(D.drawCmds[0].ep.x+b)*this.xscl<3&&D.drawCmds[0].ep.y===D.drawCmds[1].ep.y){if(s=D.drawCmds[1].ep.x,f){for(x=["M",s,0,0],r=1;c>r;r++)x.push("L",s*Math.cos(r*L),s*Math.sin(r*L),0);x.push("Z"),v=this.compileShape3D(x,M,N)}else v=this.compileShape3D(shapes3D.circle(2*s),M,N);v.rotate(1,0,0,-90),v.translate(0,D.drawCmds[0].ep.y,0),E.addObj(v),t=2}if((D.drawCmds[u-1].ep.x+b)*this.xscl<3&&D.drawCmds[u-1].ep.y===D.drawCmds[u-2].ep.y){if(s=D.drawCmds[u-2].ep.x,f){for(y=["M",s,0,0],r=1;c>r;r++)y.push("L",s*Math.cos(r*L),s*Math.sin(r*L),0);y.push("Z"),w=this.compileShape3D(y,M,N)}else w=this.compileShape3D(shapes3D.circle(2*s),M,N);w.rotate(1,0,0,90),w.translate(0,D.drawCmds[u-1].ep.y,0),E.addObj(w),u-=1}for(z=D.dup(),A=D.dup(),z.translate(b,0,0),A.translate(b,0,0),A.rotate(0,1,0,K),B=0;J>B;B++){for(C=t;u>C;C++)z.drawCmds[C-1].ep.x*this.xscl<3&&(z.drawCmds[C-1].ep.x=0,A.drawCmds[C-1].ep.x=0),F=z.drawCmds[C-1].ep.x,G=z.drawCmds[C-1].ep.y,H=z.drawCmds[C].ep.x,I=z.drawCmds[C].ep.y,F*this.xscl>=3?(l=f?["M",F*Math.cos(L),F*Math.sin(L),0,"L",F,0,0]:g(0,0,F,K,0,0),o=this.compilePath3D(l,M),o.rotate(1,0,0,-90),o.translate(0,G,0),h=o.drawCmds):(q=new j("moveTo",[],z.drawCmds[C-1].ep),h=[q]),h.push(z.drawCmds[C]),H>3&&(m=f?["M",H,0,0,"L",H*Math.cos(-L),H*Math.sin(-L),0]:g(0,0,H,0,-K,0),p=this.compilePath3D(m,M),p.rotate(1,0,0,90),p.translate(0,I,0),h.push(p.drawCmds[1])),i=new j(A.drawCmds[C].drawFn.slice(0),[],A.drawCmds[C-1].ep),1===A.drawCmds[C].cPts.length&&i.cPts.push(A.drawCmds[C].cPts[0]),2===A.drawCmds[C].cPts.length&&(i.cPts.push(A.drawCmds[C].cPts[1]),i.cPts.push(A.drawCmds[C].cPts[0])),h.push(i),k=new Obj3D(n(h),"SHAPE",{fillColor:M,backColor:N}),E.addObj(k);E.rotate(0,1,0,K)}return E},svgToCgo3D=function(a,b,c){function d(a,b,c,d,e,f,g,h){var i=h*e,j=-g*f,k=g*e,l=h*f,m=.5*(d-c),n=8/3*Math.sin(.5*m)*Math.sin(.5*m)/Math.sin(m),o=a+Math.cos(c)-n*Math.sin(c),p=b+Math.sin(c)+n*Math.cos(c),q=a+Math.cos(d),r=b+Math.sin(d),s=q+n*Math.sin(d),t=r-n*Math.cos(d);return[i*o+j*p,k*o+l*p,i*s+j*t,k*s+l*t,i*q+j*r,k*q+l*r]}function e(a,b,c,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=f*(Math.PI/180),I=Math.sin(H),J=Math.cos(H),K=[];for(c=Math.abs(c),e=Math.abs(e),k=J*(a-i)*.5+I*(b-j)*.5,l=J*(b-j)*.5-I*(a-i)*.5,m=k*k/(c*c)+l*l/(e*e),m>1&&(m=Math.sqrt(m),c*=m,e*=m),n=J/c,o=I/c,p=-I/e,q=J/e,r=n*a+o*b,s=p*a+q*b,t=n*i+o*j,u=p*i+q*j,v=(t-r)*(t-r)+(u-s)*(u-s),x=1/v-.25,0>x&&(x=0),w=Math.sqrt(x),h===g&&(w=-w),y=.5*(r+t)-w*(u-s),z=.5*(s+u)+w*(t-r),A=Math.atan2(s-z,r-y),B=Math.atan2(u-z,t-y),C=B-A,0>C&&1===h?C+=2*Math.PI:C>0&&0===h&&(C-=2*Math.PI),D=Math.ceil(Math.abs(C/(.5*Math.PI+.001))),E=0;D>E;E++)F=A+E*C/D,G=A+(E+1)*C/D,K.push(d(y,z,F,G,c,e,I,J));return K}function f(a,b,c,d,f){var g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=0,y=0,z=0,A=[],B=d||1,C=f||B,D=b||0,E=c||0;for(u=0;u<a.length;u++){switch(r=a[u],s=r[0],0===u&&"M"!==s&&(s="M"),w=r.slice(1),w&&(w=w.map(parseFloat)),s){case"M":for(x=D+B*w[0],y=E+C*w[1],z=0,j=k=null,A.push("M",x,y,z),w.splice(0,2);w.length>0;)x=D+B*w[0],y=E+C*w[1],z=0,A.push("L",x,y,z),w.splice(0,2);break;case"m":for(x+=B*w[0],y+=C*w[1],z=0,j=k=null,A.push("M",x,y,z),w.splice(0,2);w.length>0;)x+=B*w[0],y+=C*w[1],z=0,A.push("L",x,y,z),w.splice(0,2);break;case"L":for(;w.length>0;)x=D+B*w[0],y=E+C*w[1],z=0,A.push("L",x,y,z),w.splice(0,2);j=k=null;break;case"l":for(;w.length>0;)x+=B*w[0],y+=C*w[1],z=0,A.push("L",x,y,z),w.splice(0,2);j=k=null;break;case"H":x=D+B*w[0],j=k=null,A.push("L",x,y,z);break;case"h":x+=B*w[0],j=k=null,A.push("L",x,y,z);break;case"V":y=E+C*w[0],j=k=null,A.push("L",x,y,z);break;case"v":y+=C*w[0],j=k=null,A.push("L",x,y,z);break;case"C":for(;w.length>0;)g=D+B*w[0],i=E+C*w[1],j=D+B*w[2],k=E+C*w[3],x=D+B*w[4],y=E+C*w[5],z=0,A.push("C",g,i,0,j,k,0,x,y,z),w.splice(0,6);break;case"c":for(;w.length>0;)g=x+B*w[0],i=y+C*w[1],j=x+B*w[2],k=y+C*w[3],x+=B*w[4],y+=C*w[5],z=0,A.push("C",g,i,0,j,k,0,x,y,z),w.splice(0,6);break;case"S":null!==j&&t.match(/[sc]/i)||(j=x,k=y),A.push("C",x-(j-x),y-(k-y),0,D+B*w[0],E+C*w[1],0,D+B*w[2],E+C*w[3],0),j=D+B*w[0],k=E+C*w[1],x=D+B*w[2],y=E+C*w[3];break;case"s":null!==j&&t.match(/[sc]/i)||(j=x,k=y),A.push("C",x-(j-x),y-(k-y),0,x+D+B*w[0],y+E+C*w[1],0,x+D+B*w[2],y+E+C*w[3],0),j=x+B*w[0],k=y+C*w[1],x+=B*w[2],y+=C*w[3];break;case"Q":j=D+B*w[0],k=E+C*w[1],x=D+B*w[2],y=E+C*w[3],z=0,A.push("Q",j,k,0,x,y,z);break;case"q":A.push("Q",x+B*w[0],y+C*w[1],0,x+B*w[2],y+C*w[3],0),j=x+B*w[0],k=y+C*w[1],x+=B*w[2],y+=C*w[3];break;case"T":null!==j&&t.match(/[qt]/i)?(j=x-(j-x),k=y-(k-y)):(j=x,k=y),A.push("Q",j,k,0,D+B*w[0],E+C*w[1],0),j=x-(j-x),k=y-(k-y),x=D+B*w[0],y=E+C*w[1];break;case"t":null!==j&&t.match(/[qt]/i)?(j=x-(j-x),k=y-(k-y)):(j=x,k=y),A.push("Q",j,k,0,x+B*w[0],y+C*w[1],0),x+=B*w[0],y+=C*w[1];break;case"A":for(;w.length>0;){for(j=x,k=y,l=B*w[0],m=B*w[1],n=-w[2],o=w[3],p=1-w[4],x=D+B*w[5],y=E+C*w[6],z=0,q=e(j,k,l,m,n,o,p,x,y),v=0;v<q.length;v++)A.push("C",q[v][0],q[v][1],0,q[v][2],q[v][3],0,q[v][4],q[v][5],0);w.splice(0,7)}break;case"a":for(;w.length>0;){for(j=x,k=y,l=B*w[0],m=B*w[1],n=-w[2],o=w[3],p=1-w[4],x+=B*w[5],y+=C*w[6],q=e(j,k,l,m,n,o,p,x,y),v=0;v<q.length;v++)A.push("C",q[v][0],q[v][1],0,q[v][2],q[v][3],0,q[v][4],q[v][5],0);w.splice(0,7)}break;case"Z":A.push("Z");break;case"z":A.push("Z")}t=h}return A}var g,h,i,j,k,l,m,n,o=[],q=1,r=-1,s=b||0,t=c||0;if("string"==typeof a){for(g=[],l=a.split(/(?=[a-df-z])/i),n=0;n<l.length;n++){if(i=l[n],j=i.match(/[a-z]/i),!j)return[];h=j.slice(0,1),0===n&&"M"!==h[0]&&(h[0]="M"),k=i.match(/[\-\+]?[0-9]*\.?[0-9]+([eE][\-\+]?[0-9]+)?/gi),k&&(k=k.map(parseFloat)),g.push(h.concat(k))}o=f(g,s,-t,q,r)}else if(p(a)){for(g=[],m=0,n=1;n<a.length;n++)"string"==typeof a[n]&&(g.push(a.slice(m,n)),m=n);g.push(a.slice(m,n)),o=f(g,0,0,1,1)}return o}}(),function(){"use strict";var a,b=0,c=["webkit","moz"];for(a=0;a<c.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var c=(new Date).getTime(),d=Math.max(0,16-(c-b)),e=window.setTimeout(function(){a(c+d)},d);return b=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),function(){MathInteractives.Common.Components.Theme2.Models.Cango3DWrapper=Backbone.Model.extend({defaults:{canvasId:null},cangoObj:null,canvasObjs:{},initialize:function(){this.on("change: canvasId",this.initializeCangoObj),this.get("canvasId")&&this._initializeCangoObj()},_initializeCangoObj:function(){this.cangoObj=new Cango3D(this.get("canvasId"))},setWorldCoordinates:function(a,b,c){this.cangoObj&&this.cangoObj.setWorldCoords3D(a,b,c)},toWorldCoordinates3D:function(a,b,c){return this.cangoObj?this.cangoObj.toWorldCoords3D(a,b,c):void 0},createGroup3D:function(a){if(this.cangoObj){var b=this.cangoObj.createGroup3D();b.id=a,this.canvasObjs[a]=b}},addObjToGroup:function(a,b){var c=this.canvasObjs[b],d=this.canvasObjs[a];c&&"GROUP"==c.type&&d&&c.addObj(d)},deleteObjFromGroup:function(a,b){var c=this.canvasObjs[b],d=this.canvasObjs[a];if(d&&"GROUP"===d.type){for(var e=d.children,f=e.length,g=0;f>g;g++)this.deleteObjFromGroup(e[0].id,a);c.deleteObj(d),delete this.canvasObjs[a]}else c.deleteObj(d),delete this.canvasObjs[a];
},deleteGroup:function(a){var b=this.canvasObjs[a];if(b&&"GROUP"===b.type)for(var c=b.children,d=c.length,e=0;d>e;e++)this.deleteObjFromGroup(c[0].id,a);delete this.canvasObjs[a]},create3DPath:function(a,b,c,d){if(this.cangoObj){var e=this.cangoObj.compilePath3D(b,c,d);e.id=a,this.canvasObjs[a]=e}},create3DShape:function(a,b,c,d){if(this.cangoObj){var e=this.cangoObj.compileShape3D(b,c,d);e.id=a,this.canvasObjs[a]=e}},enableDrag:function(a,b,c,d){var e=this.canvasObjs[a];e&&e.enableDrag(b,c,d)},disableDrag:function(a){var b=this.canvasObjs[a];b&&b.disableDrag()},renderObj:function(a,b){for(var c,d={clear:!1},e=a?a.length:0,f=0;e>f;f++)c=this.canvasObjs[a[f]],c&&(0!==f&&(c.data=d),b?this.cangoObj.render(c):this.cangoObj.renderFrame(c))},translate:function(a,b,c,d,e){var f=this.canvasObjs[a];f&&(e?f.transform.translate(b,c,d):f.translate(b,c,d))},rotate:function(a,b,c,d,e,f){var g=this.canvasObjs[a];g&&(f?g.transform.rotate(b,c,d,e):g.rotate(b,c,d,e))},clearCanvas:function(){this.cangoObj&&this.cangoObj.clearCanvas()}},{calculateNormal:function(a,b,c){return calcNormal(a,b,c)},calculateIncAngle:function(a,b,c){return calcIncAngle(a,b,c)},getCircleShapeCmds:function(a){return shapes3D.circle(a)}})}();