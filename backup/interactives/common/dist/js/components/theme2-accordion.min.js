!function(){"use strict";MathInteractives.Common.Components.Theme2.Views.Accordion=MathInteractives.Common.Player.Views.Base.extend({scrolled:0,noOfRows:null,initialize:function(){var a=this.options.options;this.player=a.player,this._initialiseProperties(a),this.initializeDefaultProperties(),this._render()},_initialiseProperties:function(a){this.options=a,this.icon=a.icon,this.icon&&(this.icon.header=this.icon.header+" inactive-accordion-header",this.icon.activeHeader=this.icon.activeHeader+" active-accordion-header")},_render:function(){this._generateTts(),this._createAccordion()},_generateTts:function(){var a,b=($("<div></div>").attr({id:this.idPrefix+"theme2-accordion-tts-container","class":"theme2-accordion-tts-container"}).appendTo(this.$el),this.options.tooltipColorType);if(this.options.isTts){var c={containerId:this.idPrefix+"theme2-accordion-tts-container",isEnabled:!1,manager:this.manager,idPrefix:this.idPrefix,player:this.player,filePath:this.filePath,messagesToPlay:[this.idPrefix+"accordion"],tooltipColorType:b?b:MathInteractives.Common.Components.Theme2.Views.Tooltip.TYPE.GENERAL_WHITE};a=MathInteractives.global.Theme2.PlayerTTS.generateTTS(c)}},_createAccordion:function(){var a=$("<div></div>"),b=$("<div></div>"),c=17;this.$el.addClass("accordion-wrapper-container"),a.attr({id:this.options.containerId+"-accordion","class":"accordion"}),b.attr({id:this.options.containerId+"-scrollbar","class":"scrollbar"}),a.appendTo(b),b.appendTo(this.$el),this._appendHeadersAndContents(a),this._bindScrollingEvent(b),a.css({width:b.width()-c})},_bindScrollingEvent:function(a){var b=this;a.scroll(function(){b.scrolled=this.scrollTop})},_convertToAccordion:function(a){var b,c=this.options.accordionSetting,d=this,e=null,f=this.options.isHeaderClickDisable,g=$.fn.jquery;e={active:c.active,animated:c.animate,collapsible:!0,icons:!1,autoHeight:!1,heightStyle:"fill",header:"h3"},f&&(e.disabled=!0),b=parseFloat(g.substring(0,g.lastIndexOf("."))),e.change=function(a,b){d._onAccordionChange(a,b)},e.activate=function(a,b){d._onAccordionChange(a,b)},a.accordion(e),this.$(".ui-accordion-content").css({height:"",overflow:""})},_onAccordionChange:function(a,b){var c=MathInteractives.Common.Components.Theme2.Views.Accordion;this.options.isHeaderClickDisable&&this.disableAccordion(a,b),this.scrolled=this.$(".scrollbar")[0].scrollTop,this._scrollToElement(b.newHeader),this.icon&&this._changeIconOnClick(b.newHeader.find(".accordion-header-icon")),this.trigger(c.ACCORDION_CHANGE_EVENT,a,b)},_appendHeadersAndContents:function(a){var b,c,d,e,f,g,h=this.options.data,i=0,j=h.length,k=j,l=j,m=this.icon,n=this.options.headerBaseClass,o=this.options.contentBaseClass,p=MathInteractives.Common.Components.Theme2.Views.Accordion;for(this.noOfRows=k,this.trigger(p.ADD_ROW,k,l);j>i;i++)b=$("<h3></h3>").attr({"class":n+" headers"}).appendTo(a),c=$("<div></div>").attr({"class":"accordion-header-content",id:this.idPrefix+"header-content-"+i}).html(h[i].header).appendTo(b),m&&(g=this.idPrefix+"accordion-header-icon-containr-"+i,f=$("<div></div>").attr({"class":"accordion-header-icon-container",id:g}).appendTo(c),$icon=$("<div></div>").attr({"class":"accordion-header-icon",id:this.idPrefix+"accordion-header-icon-"+i}).appendTo(f)),d=$("<div></div>").attr({"class":o+" contents"}).appendTo(a),e=$("<div></div>").attr({"class":"accordion-panel-content",id:this.idPrefix+"panel-content-"+i}).html(h[i].content).appendTo(d),m&&this._bindEventOnIcon(h[i].content,g,i);this._convertToAccordion(a),this._autoScrollToLastRow()},_bindEventOnIcon:function(a,b,c){var d,e=this,f=this.icon,g=this.$("#"+b);a?(d=!1,g.removeClass("disabled")):(d=!0,g.addClass("disabled")),g.off("click").on("click",null,{isEmpty:d,headerNo:c},function(a){e._onClickIcon(a)}),this._attachHoverEvents(g,d),this.$(".accordion-header-icon").addClass(f.header)},_onClickIcon:function(a){var b=a.data.isEmpty;MathInteractives.Common.Components.Theme2.Views.Accordion;b===!1&&this.enableAccordion()},_attachHoverEvents:function(a,b){var c,d,e;c="mouseenter",d="mouseleave",a.off(c).on(c,null,{isEmpty:b},function(a){e=a.data.isEmpty,e||$(this).addClass("hover")}),a.off(d).on(d,function(a){$(this).removeClass("hover")}),MathInteractives.Common.Utilities.Models.Utils.EnableTouch(a)},_changeIconOnClick:function(a){var b=this.icon;a.hasClass("inactive-accordion-header")?(this.$(".active-accordion-header").removeClass(b.activeHeader).addClass(b.header),a.removeClass(b.header).addClass(b.activeHeader)):this.$(".active-accordion-header").removeClass(b.activeHeader).addClass(b.header)},_autoScrollToLastRow:function(){var a=this.$(".scrollbar")[0];a.scrollTop=a.scrollHeight},_scrollToElement:function(a){if(a.length){var b=new MathInteractives.Common.Utilities.Models.Rect(a[0].getBoundingClientRect()),c=this.$(".accordion"),d=this.$(".scrollbar"),e=(new MathInteractives.Common.Utilities.Models.Rect(c[0].getBoundingClientRect()),new MathInteractives.Common.Utilities.Models.Rect(d[0].getBoundingClientRect())),f=b.getTop()-e.getTop(),g=this;d.animate({scrollTop:f+g.scrolled},"slow")}},disableAccordion:function(a,b){this.$(".accordion").accordion("disable")},enableAccordion:function(a,b){this.$(".accordion").accordion("enable")},refreshAccordion:function(){this.$(".accordion").accordion("destroy"),this._convertToAccordion(this.$(".accordion")),this.$(".accordion").find("h3").removeAttr("role")},destroyAccordion:function(){this.$(".accordion").accordion("destroy")},addAccordion:function(a,b){var c,d,e,f,g,h,i,j=this.$(".accordion h3").length,k=this.icon,l=this.options.headerBaseClass,m=this.options.contentBaseClass,n=(this.$(".accordion"),MathInteractives.Common.Components.Theme2.Views.Accordion);this.noOfRows+=1,this.trigger(n.ADD_ROW,1,this.noOfRows),c=$("<h3></h3>").attr({"class":l+" headers"}),d=$("<div></div>").attr({"class":"accordion-header-content",id:this.idPrefix+"header-content-"+j}).html(a.header).appendTo(c),k&&(i=this.idPrefix+"accordion-header-icon-container"+j,g=$("<div></div>").attr({"class":"accordion-header-icon-container",id:i}).appendTo(d),h=$("<div></div>").attr({"class":"accordion-header-icon",id:this.idPrefix+"accordion-header-icon"+j}).appendTo(g)),e=$("<div></div>").attr({"class":m+" contents"}),f=$("<div></div>").attr({"class":"accordion-panel-content",id:this.idPrefix+"panel-content-"+j}).html(a.content).appendTo(e),this._insertAtIndex(c,e,b),this.refreshAccordion(),k&&this._bindEventOnIcon(a.content,i,j),this._autoScrollToLastRow()},_insertAtIndex:function(a,b,c){if(void 0===c||c>=this.$(".accordion h3").length)this.$(".accordion").append(a).append(b);else{if(0===c)return void this.$(".accordion").prepend(b).prepend(a);this.$(".accordion > div:nth-child("+2*c+")").after(b).after(a)}},removeAccordion:function(a){var b=this.$(".accordion"),c=b.length;return void 0===a?(this.$(".accordion > h3:nth-child("+(2*c+1)+")").remove(),void this.$(".accordion > div:nth-child("+(2*c+1)+")").remove()):0===a?(this.$(".accordion > h3:nth-child(1)").remove(),void this.$(".accordion > div:nth-child(1)").remove()):(this.$(".accordion > h3:nth-child("+(2*a+1)+")").remove(),this.$(".accordion > div:nth-child("+(2*a+1)+")").remove(),void this._autoScrollToLastRow())},activeAccordion:function(a){var b;this.options.isHeaderClickDisable?(b=this.$(".accordion .accordion-header-icon")[a],$(b).click()):this.$(".accordion").accordion({active:a})},collapseAccordion:function(){this.options.isHeaderClickDisable?this.$(".active-accordion-header").click():$(".accordion").accordion({active:!1}).click()}},{ACCORDION_CHANGE_EVENT:"accordion-change-event",ADD_ROW:"add-row",ACCORDION_HEADER_ICON_CLICK:"accordion-header-icon-click",createAccordion:function(a){var b=null;return a&&(b=new MathInteractives.Common.Components.Theme2.Views.Accordion({el:"#"+a.containerId,options:a})),b}}),MathInteractives.global.Theme2.Accordion=MathInteractives.Common.Components.Theme2.Views.Accordion}(window.MathInteractives);