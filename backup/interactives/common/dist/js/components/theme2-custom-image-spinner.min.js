!function(){"use strict";MathInteractives.Common.Components.Theme2.Models.CustomImageSpinner=Backbone.Model.extend({defaults:function(){return{spinId:null,manager:null,path:null,screenId:null,idPrefix:null,height:35,width:50,alignType:null,buttonFontColor:"#FFFFFF",buttonFontSize:14}},initialize:function(){}},{CUSTOM_IMAGE_STEPPER_COUNTER:0,BUTTON_WIDTH:43,BUTTON_HEIGHT:31,IMAGE_HOLDER_WIDTH:39,IMAGE_HOLDER_HEIGHT:34,UP_BUTTON_FONT_AWESOME_CLASS:"sort-down",DOWN_BUTTON_FONT_AWESOME_CLASS:"sort-up"})}(),function(){"use strict";MathInteractives.Common.Components.Theme2.Views.CustomImageSpinner=MathInteractives.Common.Player.Views.Base.extend({manager:null,spinBoxId:null,filePath:null,screenId:null,idPrefix:null,player:null,spinnerHeight:null,spinnerWidth:null,upBtn:null,downBtn:null,btnInterval:null,buttonWidth:null,buttonHeight:null,imageHolderWidth:null,imageHolderHeight:null,customImageStepperCounter:null,initialImageCounter:null,initialize:function(){var a,b=this.model,c=MathInteractives.Common.Components.Theme2.Models.CustomImageSpinner,d=(MathInteractives.global.Theme2.CustomImageSpinner,b.get("buttonWidth")),e=b.get("buttonHeight"),f=b.get("imageHolderHeight"),g=b.get("imageHolderWidth");this.initializeDefaultProperties(),this.customImageStepperCounter=this.initialImageCounter=b.get("currentImageCounter")||c.CUSTOM_IMAGE_STEPPER_COUNTER,this.upFontAwesomeClass=b.get("upFontAwesomeClass")||c.UP_BUTTON_FONT_AWESOME_CLASS,this.downFontAwesomeClass=b.get("downFontAwesomeClass")||c.DOWN_BUTTON_FONT_AWESOME_CLASS,this.customImageStepperImageId=b.get("customImageStepperImageId"),this.stepperClass=b.get("stepperClass"),this.numberOfImages=b.get("numberOfImages"),this.spinBoxId=b.get("spinId"),this.alignType=a=b.get("alignType"),this.buttonWidth=null!==d&&"undefined"!=typeof d?d:c.BUTTON_WIDTH,this.buttonHeight=null!==e&&"undefined"!=typeof e?e:c.BUTTON_HEIGHT,this.imageHolderWidth=null!==g&&"undefined"!=typeof g?g:c.IMAGE_HOLDER_WIDTH,this.imageHolderHeight=null!==f&&"undefined"!=typeof f?f:c.IMAGE_HOLDER_HEIGHT,this.topButtonBaseClass=b.get("topButtonBaseClass"),this.bottomButtomBaseClass=b.get("bottomButtomBaseClass"),this.spinnerHeight=b.get("height"),this.spinnerWidth=b.get("width"),this.applyTopIconButtonWrapper=b.get("applyTopIconButtonWrapper"),this.applyBottomIconButtonWrapper=b.get("applyBottomIconButtonWrapper"),this.topIconButtonWrapperClass=b.get("topIconButtonWrapperClass"),this.bottomIconButtonWrapperClass=b.get("bottomIconButtonWrapperClass"),this.screenId=b.get("screenId");var h={spinBoxId:this.spinBoxId},i=MathInteractives.Common.Components.templates.theme2CustomImageSpinner(h);this._render(i),this._setAlignments(),this.screenId&&this.loadScreen(this.screenId),this.customImageStepperCounter>0&&this._changeSpinnerAcc(this.initialImageCounter)},_render:function(a){var b=this.imageHolderHeight;this.$el.append(a.trim()),this.$(".spinbox,.spin-content-container,.spin-down-arrow,.spin-up-arrow").addClass(this.alignType+"-aligned");var c=$("<div></div>",{"class":"custom-image-stepper-image-holder"}),d=$("<div></div>",{"class":"custom-image-stepper-image-container"});this.$(".spin-content-container").css({height:b,width:this.imageHolderWidth}).append(d),d.append(c),c.css({"background-image":'url("'+this.filePath.getImagePath(this.customImageStepperImageId)+'")'}).addClass(this.stepperClass+"-"+this.customImageStepperCounter)},_setAlignments:function(){var a=this,b=this.$el.find(".spin-up-arrow"),c=this.$el.find(".spin-down-arrow");this._generateButtons();var d=0,e=0;clearInterval(d),clearInterval(e),c.mousedown(function(b){clearInterval(a.btnInterval),a.downBtn.getButtonState()!=MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED?(c.unbind("click"),(void 0!==b&&"undefined"!=typeof b.which&&1===b.which||MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile)&&(a.btnInterval=setInterval($.proxy(a.spinDownArrowClick,a),500))):c.unbind("click").bind("click",$.proxy(a.spinDownArrowClick,a))}).on("touchstart",function(){clearInterval(a.btnInterval),a.downBtn.getButtonState()!=MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED?(c.unbind("click"),a.btnInterval=setInterval($.proxy(a.spinDownArrowClick,a),500)):a.$el.find(".spin-down-arrow").unbind("click").bind("click",$.proxy(a.spinDownArrowClick,a))}).mouseup(function(){clearInterval(a.btnInterval),c.unbind("click").bind("click",$.proxy(a.spinDownArrowClick,a))}).mouseout(function(){clearInterval(a.btnInterval),c.unbind("click").bind("click",$.proxy(a.spinDownArrowClick,a))}).on("touchend",function(){clearInterval(a.btnInterval),c.unbind("click").bind("click",$.proxy(a.spinDownArrowClick,a))}),b.mousedown(function(c){clearInterval(a.btnInterval),a.upBtn.getButtonState()!=MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED?(b.unbind("click"),(void 0!==c&&"undefined"!=typeof c.which&&1===c.which||MathInteractives.Common.Utilities.Models.BrowserCheck.isMobile)&&(a.btnInterval=setInterval($.proxy(a.spinUpArrowClick,a),500))):b.unbind("click").bind("click",$.proxy(a.spinUpArrowClick,a))}).on("touchstart",function(){clearInterval(a.btnInterval),a.upBtn.getButtonState()!=MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED?(b.unbind("click"),a.btnInterval=setInterval($.proxy(a.spinUpArrowClick,a),500)):b.unbind("click").bind("click",$.proxy(a.spinUpArrowClick,a))}).mouseup(function(){clearInterval(a.btnInterval),b.unbind("click").bind("click",$.proxy(a.spinUpArrowClick,a))}).mouseout(function(){clearInterval(a.btnInterval),b.unbind("click").bind("click",$.proxy(a.spinUpArrowClick,a))}).on("touchend",function(){clearInterval(a.btnInterval),b.unbind("click").bind("click",$.proxy(a.spinUpArrowClick,a))})},_generateButtons:function(){var a,b=this,c=this.model,d=MathInteractives.global.Theme2.Button.TYPE,e=MathInteractives.global.Theme2.Button,f=this.buttonWidth,g=this.buttonHeight,h=c.get("buttonFontColor"),i=c.get("buttonFontSize");a=function(a,c,j,k,l){var m=e.generateButton({player:b.player,manager:b.manager,path:b.filePath,idPrefix:b.idPrefix,data:{id:b.spinBoxId+a,type:d.FA_ICON,icon:{faClass:b.filePath.getFontAwesomeClass(c),fontSize:i,fontColor:h,fontWeight:"normal",applyIconButtonWrapper:j,iconButtonWrapperClass:k},width:f,height:g,baseClass:l}});return m},this.upBtn=a("-up-arrow",this.upFontAwesomeClass,this.applyTopIconButtonWrapper,this.topIconButtonWrapperClass,this.topButtonBaseClass),this.downBtn=a("-down-arrow",this.downFontAwesomeClass,this.applyBottomIconButtonWrapper,this.bottomIconButtonWrapperClass,this.bottomButtomBaseClass)},spinUpArrowClick:function(a){var b=this.$(".custom-image-stepper-image-holder"),c=this.stepperClass,d=this.numberOfImages;b.removeClass(c+"-"+this.customImageStepperCounter),this.customImageStepperCounter===d-1?this.customImageStepperCounter=0:this.customImageStepperCounter++;var e=this.customImageStepperCounter%d;this.screenId&&(this.changeAccMessage(this.$(".spin-down-arrow").attr("id").replace(this.idPrefix,""),e),this.changeAccMessage(this.$(".spin-up-arrow").attr("id").replace(this.idPrefix,""),e)),b.addClass(c+"-"+e),this.trigger(MathInteractives.global.Theme2.CustomImageSpinner.VALUE_CHANGED,{actionPerformed:MathInteractives.global.Theme2.CustomImageSpinner.BUTTON_CLICK,buttonType:"spinner-up",currentImageCounter:e})},spinDownArrowClick:function(a){var b=this.$(".custom-image-stepper-image-holder"),c=this.stepperClass,d=this.numberOfImages;b.removeClass(c+"-"+this.customImageStepperCounter),0===this.customImageStepperCounter?this.customImageStepperCounter=d-1:this.customImageStepperCounter--;var e=this.customImageStepperCounter%d;b.addClass(c+"-"+e),this.screenId&&(this.changeAccMessage(this.$(".spin-down-arrow").attr("id").replace(this.idPrefix,""),e),this.changeAccMessage(this.$(".spin-up-arrow").attr("id").replace(this.idPrefix,""),e)),this.trigger(MathInteractives.global.Theme2.CustomImageSpinner.VALUE_CHANGED,{actionPerformed:MathInteractives.global.Theme2.CustomImageSpinner.BUTTON_CLICK,buttonType:"spinner-down",currentImageCounter:e})},_enableBtn:function(a,b){a.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE),null!==b&&"undefined"!==b&&this.enableTab(b,!0)},_disableBtn:function(a,b){a.setButtonState(MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED),null!==b&&"undefined"!==b&&this.enableTab(b,!1)},getUpButtonState:function(){return this.upBtn.getButtonState()},getDownButtonState:function(){return this.downBtn.getButtonState()},getModel:function(){return this.model},setImage:function(a){var b=this.$(".custom-image-stepper-image-holder"),c=this.stepperClass,d=this.numberOfImages;if(d>a){b.removeClass(c+"-"+this.customImageStepperCounter),this.customImageStepperCounter=a;var e=this.customImageStepperCounter%d;b.addClass(c+"-"+e),this.trigger(MathInteractives.global.Theme2.CustomImageSpinner.VALUE_CHANGED,{actionPerformed:MathInteractives.global.Theme2.CustomImageSpinner.SET_IMAGE,currentImageCounter:e})}},changeTabIndex:function(a){this.setTabIndex(this.$(".spin-down-arrow").attr("id").replace(this.idPrefix,""),a),this.setTabIndex(this.$(".spin-up-arrow").attr("id").replace(this.idPrefix,""),a+2)},resetAcc:function(){this._changeSpinnerAcc(this.initialImageCounter)},_changeSpinnerAcc:function(a){this.changeAccMessage(this.$(".spin-down-arrow").attr("id").replace(this.idPrefix,""),a),this.changeAccMessage(this.$(".spin-up-arrow").attr("id").replace(this.idPrefix,""),a)}},{generateCustomImageSpinner:function(a){if(a){var b=new MathInteractives.Common.Components.Theme2.Models.CustomImageSpinner(a),c=new MathInteractives.Common.Components.Theme2.Views.CustomImageSpinner({model:b,el:"#"+a.spinId});return c}},VALUE_CHANGED:"value-changed",BUTTON_CLICK:"button-click",SET_IMAGE:"set-image",CUSTOM_IMAGE_STEPPER:"custom-image-stepper"}),MathInteractives.global.Theme2.CustomImageSpinner=MathInteractives.Common.Components.Theme2.Views.CustomImageSpinner}(),function(){var a=Handlebars.template,b=MathInteractives.Common.Components.templates=MathInteractives.Common.Components.templates||{};b.theme2CustomImageSpinner=a(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='\ufeff<div id="',(g=c.spinBoxId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.spinBoxId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-content-holder" class="spinbox">\r\n  <div id ="',(g=c.spinBoxId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.spinBoxId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"-down-arrow\" class='spin-down-arrow arrowbutton'></div>\r\n  <div id=\"",(g=c.spinBoxId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.spinBoxId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'-content-container"  class="spin-content-container"></div>\r\n  <div id="',(g=c.spinBoxId)?f=g.call(b,{hash:{},data:e}):(g=b&&b.spinBoxId,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"-up-arrow\" class='spin-up-arrow arrowbutton'></div>\r\n</div>"})}();