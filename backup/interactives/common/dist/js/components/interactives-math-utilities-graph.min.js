!function(a){"use strict";a.Common.Components.Models.MathUtilitiesGraphNew.GridGraphModel=Backbone.Model.extend({defaults:{_points:null,_plots:null,_images:null,circleDrag:null,positionBox:null,xCoOrdinateBase:null,xCoOrdinatePower:null,yCoOrdinatePower:null,yCoOrdinateBase:null,coOrdinateSeparator:null,path:null,markerBounds:null,_graphDisplayValues:null},initialize:function(){var a,b=this.attributes;b._points=[],b._plots=[],b._images=[],b.markerBounds={max:{x:null,y:null,"\\theta":null},min:{x:null,y:null,"\\theta":null}},b._graphDisplayValues={_graphDisplay:null,_graphsAxisLimits:null,_graphOrigin:null,_graphParameters:null,_zoomingFactor:null,_graphLimitTextBoxDomElement:null,_symbols:null},a=b._graphDisplayValues,a._graphDisplay={isCartesionCurrentGraphType:!0,isLabelShown:!0,isGridLineShown:!0,isAxisLinesShown:!0,isProjectorModeOn:!1,isXmarkerInRadians:!1,isYmarkerInRadians:!1,isPolarAngleInRadian:!0},a._graphsAxisLimits={defaultLimits:{xLower:null,xUpper:null,yLower:null,yUpper:null},currentLimits:{xLower:null,xUpper:null,yLower:null,yUpper:null},isXLastChangedLimit:null},a._graphOrigin={currentOrigin:null,defaultOrigin:null,doubleClickedPoint:null,isOriginPositionChanged:null},a._graphParameters={graphGridLine:null,yGridLine:null,xGridLine:null,totalVerticalLines:null,distanceBetweenTwoVerticalLines:null,currentDistanceBetweenTwoVerticalLines:null,totalHorizontalLines:null,distanceBetweenTwoHorizontalLines:null,currentDistanceBetweenTwoHorizontalLines:null},a._zoomingFactor={previousZoomAngle:null,zoomLevel:null,zoomFactorForGraphParameterModification:null,xZoomFactorForGraphParameterModification:null,yZoomFactorForGraphParameterModification:null,zoomAngle:null,zoomDistance:null,doubleClickZoomAllow:!0,xCurrentFactor:null,yCurrentFactor:null,xZoomMultiplier:null,yZoomMultiplier:null,xTotalMultiplier:null,yTotalMultiplier:null,xZoomLevel:null,currentXZoomLevel:null,yZoomLevel:null,currentYZoomLevel:null,zoomCounter:null},a._graphLimitTextBoxDomElement={xLower:null,xUpper:null,yLower:null,yUpper:null},a._symbols={xAxis:null,yAxis:null,xMarkerLines:null,yMarkerLines:null,xInnerGridLines:null,yInnerGridLines:null}},setModelAttribute:function(a){var b=this.attributes;b._points=[],b._plots=[],b.markerBounds=a.markerBounds,b._graphDisplayValues._graphDisplay=a.graphDisplay,b._graphDisplayValues._graphsAxisLimits.currentLimits.xLower=a.currentLimits.xLower,b._graphDisplayValues._graphsAxisLimits.currentLimits.xUpper=a.currentLimits.xUpper,b._graphDisplayValues._graphsAxisLimits.currentLimits.yLower=a.currentLimits.yLower,b._graphDisplayValues._graphsAxisLimits.currentLimits.yUpper=a.currentLimits.yUpper,b.markerBounds.max.x=a.currentLimits.xUpper,b.markerBounds.max.y=a.currentLimits.yUpper,b.markerBounds.min.x=a.currentLimits.xLower,b.markerBounds.min.y=a.currentLimits.yLower,b._graphDisplayValues._graphOrigin.currentOrigin.x=a.graphOrigin.currentOrigin.x,b._graphDisplayValues._graphOrigin.currentOrigin.y=a.graphOrigin.currentOrigin.y,b._graphDisplayValues._graphOrigin.defaultOrigin.x=a.graphOrigin.defaultOrigin.x,b._graphDisplayValues._graphOrigin.defaultOrigin.y=a.graphOrigin.defaultOrigin.y,b._graphDisplayValues._graphOrigin.isOriginPositionChanged=a.graphOrigin.isOriginPositionChanged,b._graphDisplayValues._graphParameters=a.graphParameters,b._graphDisplayValues._zoomingFactor=a.zoomingFactor}},{})}(window.MathInteractives),function(a){"use strict";a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.MathFunctions=Backbone.Model.extend({},{checkIfNotADecimalNumber:function(a){return"number"==typeof a&&a%1===0},performMathematicalCalculations:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(void 0===b||void 0===c)return null;switch(e=NaN,f=c.length,g=0,h=null,h=void 0!==d&&"rad"===d.angle?1:0,b){case"+":for(e=0,g;f>g;g++){if(l=c[g],"number"!=typeof l){e=NaN;break}e+=l}break;case"-":if("number"!=typeof c[0])break;for(e=c[0],g=1;f>g;g++){if(l=c[g],"number"!=typeof l){e=NaN;break}e-=l}break;case"^":case"pow":if("number"!=typeof c[0]||"number"!=typeof c[1])break;if(0===c[0]&&0===c[1])break;if(!r.MathFunctions.checkIfNotADecimalNumber(c[1])){if(q=1/c[1],o=Math.abs(c[0]),p=c[0]>=0?1:-1,q%2===0&&-1===p)break;e=p*Math.pow(o,c[1]);break}e=Math.pow(c[0],c[1]);break;case"*":case"\\cdot":for(e=1,g;f>g;g++){if(l=c[g],"number"!=typeof l){e=NaN;break}e*=l}break;case"/":case"\\frac":if("number"!=typeof c[0]||"number"!=typeof c[1])break;e=c[0]/c[1];break;case"\\sqrt":if("number"!=typeof c[0]||"number"!=typeof c[1])break;if(0===c[0]||c[0]%2===0&&c[1]<0)break;if(0===c[0]){e=0;break}e=c[0]<0?1/Math.pow(Math.abs(c[1]),1/(-1*c[0])):Math.pow(Math.abs(c[1]),1/c[0]),c[1]<0&&(e=-e);break;case"\\ln":if("number"!=typeof c[0])break;e=Math.log(c[0]);break;case"\\log":if("number"!=typeof c[0])break;e=Math.log(c[0])/Math.LN10;break;case"\\log_":if("number"!=typeof c[0]||"number"!=typeof c[1])break;e=Math.log(c[1])/Math.log(c[0]);break;case"\\sin":if("number"!=typeof c[0])break;if(0===h){k=c[0]*Math.PI/180,e=Math.sin(k);break}e=Math.sin(c[0]);break;case"\\cos":if("number"!=typeof c[0])break;if(0===h){k=c[0]*Math.PI/180,e=Math.cos(k);break}e=Math.cos(c[0]);break;case"\\tan":if("number"!=typeof c[0])break;e=r.MathFunctions.performMathematicalCalculations("\\sin",c,d)/r.MathFunctions.performMathematicalCalculations("\\cos",c,d);break;case"\\sec":if("number"!=typeof c[0])break;e=1/r.MathFunctions.performMathematicalCalculations("\\cos",c,d);break;case"\\csc":if("number"!=typeof c[0])break;e=1/r.MathFunctions.performMathematicalCalculations("\\sin",c,d);break;case"\\cot":if("number"!=typeof c[0])break;e=1/r.MathFunctions.performMathematicalCalculations("\\tan",c,d);break;case"\\arcsin":if("number"!=typeof c[0])break;e=Math.asin(c[0]),0===h&&(e=180*e/Math.PI);break;case"\\arccos":if("number"!=typeof c[0])break;e=Math.acos(c[0]),0===h&&(e=180*e/Math.PI);break;case"\\arctan":if("number"!=typeof c[0])break;e=Math.atan(c[0]),0===h&&(e=180*e/Math.PI);break;case"\\arccsc":if("number"!=typeof c[0])break;e=Math.asin(1/c[0]),0===h&&(e=180*e/Math.PI);break;case"\\arcsec":if("number"!=typeof c[0])break;e=Math.acos(1/c[0]),0===h&&(e=180*e/Math.PI);break;case"\\arccot":if("number"!=typeof c[0])break;e=Math.PI/2-Math.atan(c[0]),0===h&&(e=180*e/Math.PI);break;case"\\sinh":if("number"!=typeof c[0])break;if(0===h){k=c[0]*Math.PI/180,e=(Math.pow(Math.E,k)-Math.pow(Math.E,-k))/2;break}e=(Math.pow(Math.E,c[0])-Math.pow(Math.E,-c[0]))/2;break;case"\\cosh":if("number"!=typeof c[0])break;if(0===h){k=c[0]*Math.PI/180,e=(Math.pow(Math.E,k)+Math.pow(Math.E,-k))/2;break}e=(Math.pow(Math.E,c[0])+Math.pow(Math.E,-c[0]))/2;break;case"\\tanh":if("number"!=typeof c[0])break;if(0===h){k=c[0]*Math.PI/180,e=(Math.pow(Math.E,2*k)-1)/(Math.pow(Math.E,2*k)+1);break}e=(Math.pow(Math.E,2*c[0])-1)/(Math.pow(Math.E,2*c[0])+1);break;case"\\csch":if("number"!=typeof c[0])break;if(0===h){k=c[0]*Math.PI/180,e=2/(Math.pow(Math.E,k)-Math.pow(Math.E,-k));break}e=2/(Math.pow(Math.E,c[0])-Math.pow(Math.E,-c[0]));break;case"\\sech":if("number"!=typeof c[0])break;if(0===h){k=c[0]*Math.PI/180,e=2/(Math.pow(Math.E,k)+Math.pow(Math.E,-k));break}e=2/(Math.pow(Math.E,c[0])+Math.pow(Math.E,-c[0]));break;case"\\coth":if("number"!=typeof c[0])break;if(0===h){k=c[0]*Math.PI/180,e=(Math.pow(Math.E,2*k)+1)/(Math.pow(Math.E,2*k)-1);break}e=(Math.pow(Math.E,2*c[0])+1)/(Math.pow(Math.E,2*c[0])-1);break;case"\\arsinh":if("number"!=typeof c[0])break;e=r.MathFunctions.performMathematicalCalculations("\\sqrt",[2,r.MathFunctions.performMathematicalCalculations("^",[c[0],2],d)+1],d),e=r.MathFunctions.performMathematicalCalculations("\\ln",[c[0]+e],d),0===h&&(e=180*e/Math.PI);break;case"\\arcosh":if("number"!=typeof c[0])break;e=r.MathFunctions.performMathematicalCalculations("\\sqrt",[2,r.MathFunctions.performMathematicalCalculations("^",[c[0],2],d)-1],d),e=r.MathFunctions.performMathematicalCalculations("\\ln",[c[0]+e],d),0===h&&(e=180*e/Math.PI);break;case"\\artanh":if("number"!=typeof c[0])break;e=r.MathFunctions.performMathematicalCalculations("\\frac",[1+c[0],1-c[0]],d),e=.5*r.MathFunctions.performMathematicalCalculations("\\ln",[e],d),0===h&&(e=180*e/Math.PI);break;case"\\arcsch":if("number"!=typeof c[0])break;e=1/c[0]+r.MathFunctions.performMathematicalCalculations("\\sqrt",[2,1/r.MathFunctions.performMathematicalCalculations("^",[c[0],2],d)+1],d),e=r.MathFunctions.performMathematicalCalculations("\\ln",[e],d),0===h&&(e=180*e/Math.PI);break;case"\\arsech":if("number"!=typeof c[0])break;e=1/c[0]+r.MathFunctions.performMathematicalCalculations("\\sqrt",[2,1/r.MathFunctions.performMathematicalCalculations("^",[c[0],2],d)-1],d),e=r.MathFunctions.performMathematicalCalculations("\\ln",[e],d),0===h&&(e=180*e/Math.PI);break;case"\\arcoth":if("number"!=typeof c[0])break;e=r.MathFunctions.performMathematicalCalculations("\\frac",[c[0]+1,c[0]-1],d),e=.5*r.MathFunctions.performMathematicalCalculations("\\ln",[e],d),0===h&&(e=180*e/Math.PI);break;case"!":if("number"!=typeof c[0]||c[0]<0)break;if(c[0]>170||!isFinite(c[0])){e=1/0;break}if(0===c[0]){e=1;break}e=r.MathFunctions.checkIfNotADecimalNumber(c[0])&&c[0]>0?r.MathFunctions.findFactorial(c[0]):c[0]*r.MathFunctions._gammaFunction(c[0]);break;case"\\%":if(1===c.length){if("number"!=typeof c[0]){e=NaN;break}e=c[0]/100}else{if("number"!=typeof c[0]||"number"!=typeof c[1]){e=NaN;break}e=c[1]*(c[0]/100)}break;case"\\gcd":if("number"!=typeof c[0]||"number"!=typeof c[1])break;if(c[0]=Math.floor(Math.abs(c[0])),c[1]=Math.floor(Math.abs(c[1])),0===c[0]){e=c[1],0===c[1]&&(e=0);break}if(0===c[1]){e=c[0];break}e=r.MathFunctions._calculateGcd(c[0],c[1]);break;case"\\lcm":if("number"!=typeof c[0]||"number"!=typeof c[1])break;if(c[0]=Math.floor(Math.abs(c[0])),c[1]=Math.floor(Math.abs(c[1])),0===c[0]){if(0===c[1]){e=NaN;break}e=0;break}if(0===c[1]){e=0;break}e=c[0]*c[1]/r.MathFunctions._calculateGcd(c[0],c[1]);break;case"\\ceil":if("number"!=typeof c[0])break;e=Math.ceil(c[0]);break;case"\\floor":if("number"!=typeof c[0])break;e=Math.floor(c[0]);break;case"\\round":if("number"!=typeof c[0])break;e=Math.round(c[0]);break;case"\\abs":if("number"!=typeof c[0])break;e=Math.abs(c[0]);break;case"\\min":if("number"!=typeof c[0]||"number"!=typeof c[1])break;e=Math.min(c[0],c[1]);break;case"\\max":if("number"!=typeof c[0]||"number"!=typeof c[1])break;e=Math.max(c[0],c[1]);break;case"\\mod":if(e=NaN,"number"!=typeof c[0]||"number"!=typeof c[1]||0===c[1])break;if(c[0]%c[1]===0){e=0;break}if(c[0]>0&&c[1]>0||c[0]<0&&c[1]<0){e=c[0]%c[1];break}if(c[0]<0&&c[1]>0||c[0]>0&&c[1]<0){e=c[1]+c[0]%c[1];break}break;case"\\nCr":if("number"!=typeof c[0]||"number"!=typeof c[1])break;if(c[0]<0||c[1]<0){e=0;break}if(c[0]=Math.floor(Math.abs(c[0])),c[1]=Math.floor(Math.abs(c[1])),c[0]<c[1]){e=0;break}e=r.MathFunctions.findFactorial(c[0])/(r.MathFunctions.findFactorial(c[1])*r.MathFunctions.findFactorial(c[0]-c[1]));break;case"\\nPr":if("number"!=typeof c[0]||"number"!=typeof c[1])break;if(c[0]<0||c[1]<0){e=0;break}if(c[0]=Math.floor(Math.abs(c[0])),c[1]=Math.floor(Math.abs(c[1])),c[0]<c[1]){e=0;break}e=r.MathFunctions.findFactorial(c[0])/r.MathFunctions.findFactorial(c[0]-c[1]);break;case"\\prod_":if("number"!=typeof c[1]||"number"!=typeof c[2])break;if(c[1]>c[2]){e=1;break}if(0===c[3]){e=0;break}if(i=Math.round(c[2])-Math.round(c[1])+1,j=1,"number"==typeof c[3])for(var s=Math.round(c[1]);s<=Math.round(c[2]);s++)j*=c[3];else for(var s=Math.round(c[1]);s<=Math.round(c[2]);s++)j*=c[3];for(;0!==i;)j*=c[3],i--;e=j;break;case"\\sum_":if("number"!=typeof c[1]||"number"!=typeof c[2])break;if(c[1]>c[2]||0===c[3]){e=0;break}for(m=Math.round(c[1])-Math.round(c[0])+1,n=0;0!==m;)n+=c[2],m--;e=n;break;case"\\exp":if("number"!=typeof c[0])break;e=Math.exp(c[0])}return e=r.MathFunctions._processResultForTrignometricFunctions(b,e)},getGUID:function(){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return(a()+a()+"-"+a()+"-4"+a().substr(0,3)+"-"+a()+"-"+a()+a()+a()).toLowerCase()},findFactorialString:"function findFactorial(number) {            var factorial = 1,                input_value;    if (number === 0 || number === 1) {        return factorial;    }    input_value = number;    while (input_value !== 1) {        factorial = factorial * input_value;        input_value--;    }    return factorial;};",findFactorial:function(a){var b,c=1;if(0===a||1===a)return c;for(b=a;1!==b;)c*=b,b--;return c},_calculateGcd:function(b,c){var d=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return c?d.MathFunctions._calculateGcd(c,b%c):b},whileInOneLine:function(a,b,c,d){var c=a+"while("+b+"){"+c+"} return "+d,e=new Function("",c);return e()},_gammaFunctionString:"function gammaFunction(value) { var gammaCounter,gammaSum,gamma,arbitaryCounter = 7,gammaArray = [0.99999999999980993, 676.5203681218851, -1259.1392167224028, 771.32342877765313, -176.61502916214059, 12.507343278686905,-0.13857109526572012, 9.9843695780195716e-6, 1.5056327351493116e-7];    if (value < 0.5) {        return Math.PI / (Math.sin(Math.PI * value) * gammaFunction(1 - value));    }    else {        value -= 1;        gamma = gammaArray[0];        for (gammaCounter = 1; gammaCounter < arbitaryCounter + 2; gammaCounter++) {            gamma += gammaArray[gammaCounter] / (value + gammaCounter);        }        gammaSum = value + arbitaryCounter + 0.5;        return Math.sqrt(2 * Math.PI) * Math.pow(gammaSum, (value + 0.5)) * Math.exp(-gammaSum) * gamma;    }};",_gammaFunction:function(b){var c,d,e,f=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,g=7,h=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];if(.5>b)return Math.PI/(Math.sin(Math.PI*b)*f.MathFunctions._gammaFunction(1-b));for(b-=1,e=h[0],c=1;g+2>c;c++)e+=h[c]/(b+c);return d=b+g+.5,Math.sqrt(2*Math.PI)*Math.pow(d,b+.5)*Math.exp(-d)*e},getSumString:function(){return"function sum(pivot, start, end, expression, param, constants) {var findFactorialString = '"+a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.MathFunctions.findFactorialString+"';var gammaFunctionString='"+New.EquationEngine.MathFunctions._gammaFunctionString+"'; function addStringFunctionDependency(functionCode) {            if (functionCode.search('findFactorial') > -1) {                functionCode = findFactorialString + functionCode;            }    if (functionCode.search('gammaFunction') > -1) {        functionCode = gammaFunctionString + functionCode;    }  return functionCode;}; start = addStringFunctionDependency(start) + '; return ' +start;            end = addStringFunctionDependency(end) + '; return ' + end;    expression = addStringFunctionDependency(expression) + '; return ' + expression;    var funcStartRange = new Function('param,constants', start);            var funcEndRange = new Function('param,constants', end);            var funcExpression = new Function(pivot+',param,constants', expression);            var startValue = funcStartRange(param, constants);            var endValue = funcEndRange(param, constants);           var result = 0;    if (!isFinite(startValue) || !isFinite(endValue)) {            return;        }        for(i = startValue;i<=endValue;i+= 1){                result +=funcExpression(i,param, constants);                if (!isFinite(result)) {                    return;                }            }         return result;        };"},getProdString:function(){return"function prod(pivot, start, end, expression, param, constants) {var findFactorialString = '"+a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.MathFunctions.findFactorialString+"';var gammaFunctionString='"+a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.MathFunctions._gammaFunctionString+"'; function addStringFunctionDependency(functionCode) {            if (functionCode.search('findFactorial') > -1) {                functionCode = findFactorialString + functionCode;            }    if (functionCode.search('gammaFunction') > -1) {        functionCode = gammaFunctionString + functionCode;    }  return functionCode;}; start = addStringFunctionDependency(start) + '; return ' +start;            end = addStringFunctionDependency(end) + '; return ' + end;    expression = addStringFunctionDependency(expression) + '; return ' + expression;  var funcStartRange = new Function('param,constants', start);            var funcEndRange = new Function('param,constants', end);            var funcExpression = new Function(pivot+',param,constants', expression);            var startValue = funcStartRange(param, constants);            var endValue = funcEndRange(param, constants);           var result = 1;   if (!isFinite(startValue) || !isFinite(endValue)) {            return;        }         for(i = startValue;i<=endValue;i+= 1){                result *=funcExpression(i,param, constants);                if (!isFinite(result)) {                    return;                }            }         return result;        };"},addStringFunctionDependency:function(a){return a.search("findFactorial")>-1&&(a=nameSpace.MathFunctions.findFactorialString+a),a.search("gammaFunction")>-1&&(a=nameSpace.MathFunctions._gammaFunctionString+a),a},sumProductPrototype:function(a,b,c,d,e,f){b=nameSpace.MathFunctions.addStringFunctionDependency(b)+"return "+b,c=nameSpace.MathFunctions.addStringFunctionDependency(c)+"return "+c,d=nameSpace.MathFunctions.addStringFunctionDependency(d)+"return "+d;var g=new Function("param,constants",b),h=new Function("param,constants",c),j=new Function(a+",param,constants",d),k=g(e,f),l=h(e,f),m=0;if(isFinite(k)&&isFinite(l)){for(i=k;i<l;i+=1)if(m+=j(i,e,f),!isFinite(m))return;return m}},decToFrac:function(a,b){},_processResultForTrignometricFunctions:function(a,b){var c=["\\sin","\\cos","\\tan","\\cot","\\sec","\\csc","\\sinh","\\cosh","\\tanh","\\coth","\\sech","\\csch"];return-1!==c.indexOf(a)&&(isNaN(b)||(b=Number(b.toFixed(10)))),b}})}(window.MathInteractives),function(a){"use strict";a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Productions=Backbone.Model.extend({},{_terminalProductions:null,_nonTerminalProductions:null,productionTable:null,productionRules:null,_seperatedTokens:null,treeGenerationRules:null,_nonTerminalRules:null,_operatorsInPrecedenceOrder:null,_terminalRules:null,init:function(){null===a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Productions.productionRules&&a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Productions._populateProductionData()},getMaximumParameters:function(a){switch(a){case"^":case"\\log_":case"\\sqrt":case"\\gcd":case"\\lcm":case"\\min":case"\\max":case"\\mod":case"\\nCr":case"\\nPr":case"\\frac":return 2;case"+":case"-":case"\\cdot":case".":return 1/0;case"!":case"\\%":case"\\sin":case"\\cos":case"\\tan":case"\\csc":case"\\sec":case"\\cot":case"\\sinh":case"\\cosh":case"\\tanh":case"\\arcsin":case"\\arccos":case"\\arctan":case"\\log":case"\\ln":case"\\ceil":case"\\floor":case"\\round":case"\\abs":case"\\exp":case"do":return 1;case"\\sum":case"\\prod":return 4}},_populateProductionData:function(){var b,c,d,e,f,g,h,i,j,k,l,m,n=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;for(n.Productions._terminalProductions=["\\frac","(","[","var","const","digit","\\theta","{","\\sin","\\cos","\\tan","\\csc","\\sec","\\cot","\\arcsin","\\arccos","\\arctan","\\arccsc","\\arcsec","\\arccot","\\sinh","\\cosh","\\tanh","\\csch","\\sech","\\coth","\\log_","\\ln","\\log","\\sqrt","\\gcd","\\lcm","\\ceil","\\floor","\\round","\\abs","\\min","\\max","\\mod","\\nPr","\\nCr","\\exp","\\sum","\\prod"],n.Productions._terminalRules=["node.\\frac","node.do","node.do","terminal.var","terminal.const","terminal.digit","terminal.\\theta","node.do","node.\\sin","node.\\cos","node.\\tan","node.\\csc","node.\\sec","node.\\cot","node.\\arcsin","node.\\arccos","node.\\arctan","node.\\arccsc","node.\\arcsec","node.\\arccot","node.\\sinh","node.\\cosh","node.\\tanh","node.\\csch","node.\\sech","node.\\coth","node.\\log_","node.\\ln","node.\\log","node.\\sqrt","node.\\gcd","node.\\lcm","node.\\ceil","node.\\floor","node.\\round","node.\\abs","node.\\min","node.\\max","node.\\mod","node.\\nPr","node.\\nCr","node.\\exp","node.\\sum terminal.const","node.\\prod terminal.const"],n.Productions._seperatedTokens={"\\frac":["\\frac","{","E","}","{","E","}"],"(":["(","E",")"],"[":["[","E","]"],"var":["var"],"const":["const"],digit:["digit"],"\\theta":["\\theta"],"{":["{","E","}"],"\\sin":["\\sin","(","E",")"],"\\cos":["\\cos","(","E",")"],"\\tan":["\\tan","(","E",")"],"\\csc":["\\csc","(","E",")"],"\\sec":["\\sec","(","E",")"],"\\cot":["\\cot","(","E",")"],"\\arcsin":["\\arcsin","(","E",")"],"\\arccos":["\\arccos","(","E",")"],"\\arctan":["\\arctan","(","E",")"],"\\arccsc":["\\arccsc","(","E",")"],"\\arcsec":["\\arcsec","(","E",")"],"\\arccot":["\\arccot","(","E",")"],"\\sinh":["\\sinh","(","E",")"],"\\cosh":["\\cosh","(","E",")"],"\\tanh":["\\tanh","(","E",")"],"\\csch":["\\csch","(","E",")"],"\\sech":["\\sech","(","E",")"],"\\coth":["\\coth","(","E",")"],"\\log_":["\\log_","{","E","}","(","E",")"],"\\ln":["\\ln","(","E",")"],"\\log":["\\log","(","E",")"],"\\sqrt":["\\sqrt","[","E","]","{","E","}"],"\\gcd":["\\gcd","(","E",",","E",")"],"\\lcm":["\\lcm","(","E",",","E",")"],"\\ceil":["\\ceil","(","E",")"],"\\floor":["\\floor","(","E",")"],"\\round":["\\round","(","E",")"],"\\abs":["\\abs","(","E",")"],"\\min":["\\min","(","E",",","E",")"],"\\max":["\\max","(","E",",","E",")"],"\\mod":["\\mod","(","E",",","E",")"],"\\nPr":["\\nPr","(","E",",","E",")"],"\\nCr":["\\nCr","(","E",",","E",")"],"\\exp":["\\exp","(","E",")"],"\\sum":["\\sum","{","const","}","{","E","}","{","E","}","{","E","}"],"\\prod":["\\prod","{","const","}","{","E","}","{","E","}","{","E","}"]},n.Productions._operatorsInPrecedenceOrder=["+","\\cdot","^","!","\\%"],n.Productions._nonTerminalRules=["node.+","node.\\cdot","node.^","node.!","node.\\%"],n.Productions.productionTable={E:{}},b=0,c=n.Productions._terminalProductions.length,b;c>b;b++)n.Productions.productionTable.E[n.Productions._terminalProductions[b]]=[];for(n.Productions.treeGenerationRules=[],n.Productions.productionRules=[],e=0,f=n.Productions._operatorsInPrecedenceOrder.length,b=0,c=n.Productions._terminalProductions.length,g=Math.pow(2,f)-1,b=0;c>b;b++)for(k=n.Productions._terminalProductions[b],l=n.Productions._seperatedTokens[k][0],j=0;g>j;j++){for(h=[],m="",d="",e=0;f>e;e++)(j&Math.pow(2,e))>0&&("!"===n.Productions._operatorsInPrecedenceOrder[e]||"\\%"===n.Productions._operatorsInPrecedenceOrder[e]?h.unshift("("+n.Productions._operatorsInPrecedenceOrder[e]+")+"):h.unshift("("+n.Productions._operatorsInPrecedenceOrder[e]+",E)+"),m=m+"node."+n.Productions._operatorsInPrecedenceOrder[e]+" ");if(i=n.Productions._seperatedTokens[k].concat.apply(n.Productions._seperatedTokens[k],[h]),d=m+n.Productions._terminalRules[b],n.Productions.treeGenerationRules.push(d),n.Productions.productionRules.push(i),n.Productions.productionTable.E[l].push(n.Productions.productionRules.length-1),"{"===k||"["===k)break}n.Productions._getProductionTableAsString()},_getProductionTableAsString:function(){var b=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,c="",d=0,e=b.Productions.productionRules.length;for(d=0;e>d;d++)c+=d+" : "+b.Productions.productionRules[d].join("")+"   >>    "+b.Productions.treeGenerationRules[d]+"\n";$("#rules").text(c)}}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationAnalysis=Backbone.Model.extend({_A:null,_B:null,_C:null,_canBeSolved:!0,_freeVars:null,_functionVariable:null,_paramVariable:null,_equationParameters:null,_pivot:null,_accText:null,_rhsAuto:null,_order:null,_FDFlag:null,_functionCode:null,_paramVariableOrder:null,_inEquatlityType:null,initialize:function(){this._A={},this._B={},this._C={},this._freeVars={},this._inEquatlityType="equal"},getA:function(){return this._A},getB:function(){return this._B},getC:function(){return this._C},isCanBeSolved:function(){return this._canBeSolved},getFreeVars:function(){return this._freeVars},getFunctionVariable:function(){return this._functionVariable},getParamVariable:function(){return this._paramVariable},getPivot:function(){return this._pivot},getAccText:function(){return this._accText},getRhsAuto:function(){return this._rhsAuto},getOrder:function(){return this._order},getFdFlag:function(){return this._FDFlag},getFunctionCode:function(){return this._functionCode},getParamVariableOrder:function(){return this._paramVariableOrder},setParamVariableOrder:function(a){this._paramVariableOrder=a},setA:function(a){this._A=a},setB:function(a){this._B=a},setC:function(a){this._C=a},setCanBeSolved:function(a){this._canBeSolved=a},setFreeVars:function(a){this._freeVars=a},setFunctionVariable:function(a){this._functionVariable=a},setParamVariable:function(a){this._paramVariable=a},setPivot:function(a){this._pivot=a},setAccText:function(a){this._accText=a},setRhsAuto:function(a){this._rhsAuto=a},setOrder:function(a){this._order=a},setFdFlag:function(a){this._FDFlag=a},setFunctionCode:function(a){this._functionCode=a},addToAccText:function(a){this._accText+=a},setInEqualityType:function(a){switch(a){case"\\le":this._inEquatlityType="ltequal";break;case"\\ge":this._inEquatlityType="gtequal";break;case">":this._inEquatlityType="greater";break;case"<":this._inEquatlityType="lesser";break;case"=":this._inEquatlityType="equal";break;default:this._inEquatlityType=a}},getInEqualityType:function(){return this._inEquatlityType},flush:function(){this._A={},this._B={},this._C={},this._freeVars={},this._canBeSolved=!0,this._functionVariable=null,this._paramVariable=null,this._accText=null,this._rhsAuto=null,this._order=null,this._FDFlag=null,this._functionCode=null,this._inEquatlityType="equal"}},{}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.PlotData=Backbone.Model.extend({_bannerData:{},_draggable:!1,_labelData:null,_pathGroup:null,_pointsGroup:null,_plotSessionCount:0,_bestFit:null,_raster:null,_rayPolygon:null,_plot:null,_inEqualititesPathGroup:null,getBannerData:function(){return this._bannerData},isDraggable:function(){return this._draggable},getLabelData:function(){return this._labelData},getPathGroup:function(){return this._pathGroup},removePathGroup:function(){delete this._pathGroup},getPointsGroup:function(){return this._pointsGroup},getPlotSessionCount:function(){return this._plotSessionCount},getBestFit:function(){return this._bestFit},getRaster:function(){return this._raster},getRayPolygon:function(){return this._rayPolygon},setRayPolygon:function(a){this._rayPolygon=a},setBannerData:function(a){this._bannerData=a},setDraggable:function(a){this._draggable=a},setLabelData:function(a){this._labelData=a},setPathGroup:function(a){this._pathGroup=a},setPointsGroup:function(a){this._pointsGroup=a},setPlotSessionCount:function(a){this._plotSessionCount=a},setBestFit:function(a){this._bestFit=a},setRaster:function(a){this._raster=a},setPlot:function(a){this._plot=a},getPlot:function(){return this._plot},setInEqualititesPathGroup:function(a){this._inEqualititesPathGroup=a},getInEqualititesPathGroup:function(){return this._inEqualititesPathGroup},initialize:function(){this._labelData={labelObject:null}},flush:function(){this._bannerData={},this._draggable=null,this._labelData={labelObject:null},this._pathGroup=null,this._pointsGroup=null,this._plotSessionCount=null,this._bestFit,this._raster=null}},{}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.ParserData=Backbone.Model.extend({_constants:null,_leftExpression:null,_leftRoot:null,_rightExpression:null,_rightRoot:null,getConstants:function(){return this._constants},getLeftExpression:function(){return this._leftExpression},getLeftRoot:function(){return this._leftRoot},getRightExpression:function(){return this._rightExpression},getRightRoot:function(){return this._rightRoot},setConstants:function(a){this._constants=a},setLeftExpression:function(a){this._leftExpression=a},setLeftRoot:function(a){this._leftRoot=a},setRightExpression:function(a){this._rightExpression=a},setRightRoot:function(a){this._rightRoot=a},getLeftEquationParameters:function(){return this._leftExpression.equationParameters},getRightEquationParameters:function(){return this._rightExpression.equationParameters},initialize:function(){this._setInitialStates()},_setInitialStates:function(){this._leftExpression={constants:{},freevars:{},expression:null,equationParameters:{operatorsList:[],variablesList:[],digitsList:[],constantsList:[],functionsList:[]}},this._rightExpression={constants:{},freevars:{},expression:null,equationParameters:{operatorsList:[],variablesList:[],digitsList:[],constantsList:[],functionsList:[]}}},flush:function(){this._constants=null,this._leftRoot=null,this._rightRoot=null,this._setInitialStates()}},{}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationStyleData=Backbone.Model.extend({_color:null,_dragHitThickness:null,_dragHitColor:null,_opacity:null,_thickness:null,_thicknessOnFocus:null,_visible:null,_dashArray:null,_closedPolygon:null,_smoothPolygon:null,_dragHitAlpha:null,initialize:function(){this._setInitialStyles()},flush:function(){this._setInitialStyles()},getColor:function(){return this._color},getDragHitThickness:function(){return this._dragHitThickness},getDragHitColor:function(){return this._dragHitColor},getOpacity:function(){return this._opacity},getThickness:function(){return this._thickness},getThicknessOnFocus:function(){return this._thicknessOnFocus},getVisible:function(){return this._visible},getPointVisibility:function(){return this._visible.point},getCurveVisibility:function(){return this._visible.curve},getDashArray:function(){return this._dashArray},isClosedPolygon:function(){return this._closedPolygon},isSmoothPolygon:function(){return this._smoothPolygon},getDragHitAlpha:function(){return this._dragHitAlpha},setColor:function(a){this._color=a},setDragHitThickness:function(a){this._dragHitThickness=a},setDragHitColor:function(a){this._dragHitColor=a},setOpacity:function(a){this._opacity=a},setThickness:function(a){this._thickness=a},setThicknessOnFocus:function(a){this._thicknessOnFocus=a},setVisible:function(a){"object"==typeof a?this._visible=a:(this._visible.point=a,this._visible.curve=a)},setPointVisibility:function(a){this._visible.point=a},setCurveVisibility:function(a){this._visible.curve=a},setDashArray:function(a){this._dashArray=a},setClosedPolygon:function(a){this._closedPolygon=a},setSmoothPolygon:function(a){this._smoothPolygon=a},setDragHitAlpha:function(a){this._dragHitAlpha=a},_setInitialStyles:function(){this._color="#000000",this._dragHitThickness=15,this._dragHitColor="#ff0000",this._opacity=1,this._thickness=1,this._thicknessOnFocus=3,this._visible={point:!0,curve:!0},this._dashArray=[],this._closedPolygon=!1,this._smoothPolygon=!1,this._dragHitAlpha=0}},{}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationPointsData=Backbone.Model.extend({_leftArray:null,_points:null,_rightArray:null,_criticalPoints:null,_intersectionPoints:null,_inEqualityPlots:null,getLeftArray:function(){return this._leftArray},getPoints:function(){return this._points},getRightArray:function(){return this._rightArray},setLeftArray:function(a){this._leftArray=a},setPoints:function(a){this._points=a},setRightArray:function(a){this._rightArray=a},getCriticalPoints:function(){return this._criticalPoints},setCriticalPoints:function(a){this._criticalPoints=a},getIntersectionPoints:function(){return this._intersectionPoints},setIntersectionPoints:function(a){this._intersectionPoints=a},getInEqualityPlots:function(){return this._inEqualityPlots},setInEqualityPlots:function(a){this._inEqualityPlots=a},flush:function(){this._leftArray=null,this._points=null,this._rightArray=null}},{}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationErrorData=Backbone.Model.extend({
_errorCode:null,_errorData:null,_errorString:null,getErrorCode:function(){return this._errorCode},getErrorData:function(){return this._errorData},getErrorString:function(){return this._errorString},setErrorCode:function(a){this._errorCode=a},setErrorData:function(a){this._errorData=a},setErrorString:function(a){this._errorString=a},initialize:function(){this._errorData=[]},flush:function(){this._errorCode=null,this._errorData=null,this._errorString=null}},{}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationData=Backbone.Model.extend({_units:null,_latex:null,_style:null,_plotData:null,_parserData:null,_error:null,_pointsData:null,_analysis:null,_blind:!1,_autonomous:void 0,_specie:null,_parent:void 0,_solution:null,_debugging:null,_id:null,_isSaveRestoreData:!1,_directives:void 0,_prevLatex:null,_constants:null,initialize:function(){this._units={angle:"rad"},this._debugging={profiles:[]},this._autonomous=!1,this._specie="error",this._id=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.MathFunctions.getGUID(),this._analysis=new a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationAnalysis,this._style=new a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationStyleData,this._plotData=new a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.PlotData,this._parserData=new a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.ParserData,this._error=new a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationErrorData,this._pointsData=new a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationPointsData,this._directives={FDFlagMethod:"calculator",definedConstant:null,range:null}},toString:function(){return this.getLatex()},setLatex:function(a,b){this._latex=a,b||this.trigger("change-equation")},getLatex:function(){return this._latex},getAccText:function(){return this._analysis.getAccText()},setAccText:function(a){this._analysis.setAccText(a)},addToAccText:function(a){this._analysis.addToAccText(a)},getFreeVars:function(){return this._analysis.getFreeVars()},setFreeVars:function(a){this._analysis.setFreeVars(a)},getFunctionVariable:function(){return this._analysis.getFunctionVariable()},setFunctionVariable:function(a){this._analysis.setFunctionVariable(a)},getParamVariable:function(){return this._analysis.getParamVariable()},setParamVariable:function(a){this._analysis.setParamVariable(a)},setFdFlag:function(a){this._analysis.setFdFlag(a)},getFdFlag:function(){return this._analysis.getFdFlag()},getLeftRoot:function(){return this._parserData.getLeftRoot()},getRightRoot:function(){return this._parserData.getRightRoot()},setLeftRoot:function(a){return this._parserData.setLeftRoot(a)},setRightRoot:function(a){return this._parserData.setRightRoot(a)},setFunctionCode:function(a){this._analysis.setFunctionCode(a)},getFunctionCode:function(){return this._analysis.getFunctionCode()},getA:function(){return this._analysis.getA()},getB:function(){return this._analysis.getB()},getC:function(){return this._analysis.getC()},setA:function(a){this._analysis.setA(a)},setB:function(a){this._analysis.setB(a)},setC:function(a){this._analysis.setC(a)},getParamVariableOrder:function(){return this._analysis.getParamVariableOrder()},setParamVariableOrder:function(a){this._analysis.setParamVariableOrder(a)},getLeftEquationParameters:function(){return this._parserData.getLeftEquationParameters()},getRightEquationParameters:function(){return this._parserData.getRightEquationParameters()},getAllConstants:function(){var a,b=this._parserData.getLeftEquationParameters().constantsList,c=this._parserData.getRightEquationParameters().constantsList;return a=_.union(b,c)},setPlot:function(a){this._plotData.setPlot(a)},getPlot:function(){return this._plotData.getPlot()},getBestFit:function(){return this._plotData.getBestFit()},setBestFit:function(a){return this._plotData.setBestFit(a)},getThicknessOnFocus:function(){return this._style.getThicknessOnFocus()},setThicknessOnFocus:function(a){return this._style.setThicknessOnFocus(a)},setInEqualityType:function(a){this._analysis.setInEqualityType(a)},getInEqualityType:function(){return this._analysis.getInEqualityType()},getInEqualityPlots:function(){return this._pointsData.getInEqualityPlots()},setInEqualityPlots:function(a){this._pointsData.setInEqualityPlots(a)},setInEqualititesPathGroup:function(a){this._plotData.setInEqualititesPathGroup(a)},getInEqualititesPathGroup:function(){return this._plotData.getInEqualititesPathGroup()},getDefinedConstant:function(){return this._directives.definedConstant},setDefinedConstant:function(a){this._directives.definedConstant=a},reverseInequality:function(){var a=this.getInEqualityType();switch(a){case"lesser":this.setInEqualityType(">");break;case"greater":this.setInEqualityType("<");break;case"ltequal":this.setInEqualityType("\\ge");break;case"gtequal":this.setInEqualityType("\\le")}},setConstants:function(a,b){this._constants=a,b||this.trigger("change-constants")},getConstants:function(){return this._constants},getProfiles:function(){return this._debugging.profiles},getEquationParameters:function(){return this._analysis.getEquationParameters()},setCanBeSolved:function(a){this._analysis.setCanBeSolved(a)},isCanBeSolved:function(){return this._analysis.isCanBeSolved()},setPivot:function(a){this._analysis.setPivot(a)},getPivot:function(){return this._analysis.getPivot()},setErrorCode:function(a){this._error.setErrorCode(a)},getErrorCode:function(){return this._error.getErrorCode()},setErrorData:function(a){this._error.setErrorData(a)},getErrorData:function(){return this._error.getErrorData()},setErrorString:function(a){this._error.setErrorString(a)},getErrorString:function(){return this._error.getErrorString()},getLeftExpression:function(){return this._parserData.getLeftExpression()},getRightExpression:function(){return this._parserData.getRightExpression()},getRange:function(){return this._directives.range},setRange:function(a){this._directives.range=a},setUnits:function(a){var b=null;for(b in a)this._units[b]=a[b]},getUnits:function(){return this._units},setAnalysis:function(a){this._analysis=a},getAnalysis:function(){return this._analysis},setSpecie:function(a){this._specie=a},getSpecie:function(){return this._specie},setBlind:function(a){this._blind=a},getBlind:function(){return this._blind},setAutonomous:function(a){this._autonomous=a},getAutonomous:function(){return this._autonomous},setParent:function(a){this._parent=a},getParent:function(){return this._parent},setSolution:function(a){this._solution=a},getSolution:function(){return this._solution},setDebugging:function(a){this._debugging=a},getDebugging:function(){return this._debugging},setId:function(a){this._id=a},getId:function(){return this._id},setIsSaveRestoreData:function(a){this._isSaveRestoreData=a},getIsSaveRestoreData:function(){return this._isSaveRestoreData},setDirectives:function(a){this._directives=a},getDirectives:function(){return this._directives},setStyle:function(a){this._style=a},getStyle:function(){return this._style},setPlotData:function(a){this._plotData=a},getPlotData:function(){return this._plotData},setParserData:function(a){this._parserData=a},getParserData:function(){return this._parserData},setError:function(a){this._error=a},getError:function(){return this._error},setPointsData:function(a){this._pointsData=a},getPointsData:function(){return this._pointsData},getCid:function(){return this.cid},setColor:function(a){this._style.setColor(a)},getColor:function(){return this._style.getColor()},setThickness:function(a){this._style.setThickness(a)},getThickness:function(){return this._style.getThickness()},setOpacity:function(a){this._style.setOpacity(a)},getOpacity:function(){return this._style.getOpacity()},setDashArray:function(a){this._style.setDashArray(a)},getDashArray:function(){return this._style.getDashArray()},setVisible:function(a){this._style.setVisible(a)},getVisible:function(){return this._style.getVisible()},setDraggable:function(a){this._plotData.setDraggable(a)},isDraggable:function(){return this._plotData.isDraggable()},setDragHitThickness:function(a){this._style.setDragHitThickness(a)},getDragHitThickness:function(){return this._style.getDragHitThickness()},getDragHitColor:function(){return this._style.getDragHitColor()},getDragHitAlpha:function(){return this._style.getDragHitAlpha()},getPointsGroup:function(){return this._plotData.getPointsGroup()},setPointsGroup:function(a){this._plotData.setPointsGroup(a)},setLabelData:function(a){this._plotData.setLabelData(a)},getLabelData:function(){return this._plotData.getLabelData()},getBannerData:function(){return this._plotData.getBannerData()},setBannerData:function(a){this._plotData.setBannerData(a)},getPathGroup:function(){return this._plotData.getPathGroup()},setPathGroup:function(a){this._plotData.setPathGroup(a)},getRaster:function(){return this._plotData.getRaster()},setRaster:function(a){this._plotData.setRaster(a)},getLeftArray:function(){return this._pointsData.getLeftArray()},setLeftArray:function(a){this._pointsData.setLeftArray(a)},getRightArray:function(){return this._pointsData.getRightArray()},setRightArray:function(a){this._pointsData.setRightArray(a)},getPoints:function(){return this._pointsData.getPoints()},setPoints:function(a){this._pointsData.setPoints(a)},getRayPolygon:function(){return this._plotData.getRayPolygon()},setRayPolygon:function(a){this._plotData.setRayPolygon(a)},setClosedPolygon:function(a){this._style.setClosedPolygon(a)},isClosedPolygon:function(){return this._style.isClosedPolygon()},setSmoothPolygon:function(a){this._style.setSmoothPolygon(a)},isSmoothPolygon:function(){return this._style.isSmoothPolygon()},getRhsAuto:function(){return this._analysis.getRhsAuto()},setRhsAuto:function(a){this._analysis.setRhsAuto(a)},getPlotSessionCount:function(){return this._plotData.getPlotSessionCount()},setPlotSessionCount:function(a){this._plotData.setPlotSessionCount(a)},getPointVisibility:function(){return this._style.getPointVisibility()},getCurveVisibility:function(){return this._style.getCurveVisibility()},setPointVisibility:function(a){this._style.setPointVisibility(a)},setCurveVisibility:function(a){this._style.setCurveVisibility(a)},getCriticalPoints:function(){return this._pointsData.getCriticalPoints()},setCriticalPoints:function(a){this._pointsData.setCriticalPoints(a)},getIntersectionPoints:function(){return this._pointsData.getIntersectionPoints()},setIntersectionPoints:function(a){this._pointsData.setIntersectionPoints(a)},setPrevLatex:function(a){this._prevLatex=a},getPrevLatex:function(){return this._prevLatex},flushAnalysis:function(){this._analysis.flush()},flushError:function(){this._error.flush()},flushParserData:function(){this._parserData.flush()},flushPlotData:function(){this._plotData.flush()},changePointsColor:function(a,b){this._style.setColor(a),b||this.trigger("change-points-color")},changeColor:function(a,b){this._style.setColor(a),b||this.trigger("change-color")},changeThickness:function(a,b){this._style.setThickness(a),this._style.setThicknessOnFocus(a+1),b||this.trigger("change-thickness")},changeVisibility:function(a){this.setVisible(a),this.trigger("change-visibility")},removePathGroup:function(){this._plotData.removePathGroup()},hideGraph:function(){var a,b,c=this.getPathGroup(),d=this.getPointsGroup(),e=this.getCriticalPoints();if(null!==c&&(c.visible=!1),null!==d){for(a=d.children.length,b=0;a>b;b++)d.children[b].visible=!1;d.visible=!1}if(null!==e&&null!==e.getPointsGroup()){for(d=e.getPointsGroup(),a=d.children.length,b=0;a>b;b++)d.children[b].visible=!1;d.visible=!1}this.setVisible(!1)},showGraph:function(){var a,b,c=this.getPathGroup(),d=this.getPointsGroup(),e=this.getCriticalPoints();if(this.setVisible(!0),null!==c&&(c.visible=!0),null!==d){for(b=d.children.length,a=0;b>a;a++)d.children[a].visible=!0;d.visible=!0}if(null!==e&&null!==e.getPointsGroup()){for(d=e.getPointsGroup(),b=d.children.length,a=0;b>a;a++)d.children[a].visible=!0;d.visible=!0}},toggleGraphView:function(){this.getCurveVisibility()?this.hideGraph():this.showGraph()},dashedGraph:function(){if("point"===this.getSpecie()){this.getPointsGroup();this.pointsGroup.strokeColor=this.getColor(),this.pointsGroup.fillColor="#ffffff"}else this.getPathGroup().dashArray=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationData.DASHED_ARRAY;this.setDashArray(a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationData.DASHED_ARRAY)},normalGraph:function(){if("point"===this.getSpecie()){this.getPointsGroup().fillColor=this.getColor();var a=this.getLabelData();a.labelObject&&(a.labelObject.fillColor=this.getColor())}else this.getPathGroup().dashArray=[];this.setDashArray([])},toggleDashedGraph:function(){0!==this.getDashArray().length?this.normalGraph():this.dashedGraph()},getData:function(){var a={};return a.equation=this.getLatex(),a.color=this.getColor(),a.thickness=this.getThickness(),a.styleType=this.styleType,a.visible=this.getVisible(),a.points=this.getPoints(),a},setData:function(a){this.setLatex(a.equation),this.setColor(a.color),this.setThickness(a.thickness),this.styleType=a.styleType,this.setVisible(a.visible),this.setPoints(a.points),this.isSaveRestoreData=!0,this.labelData={},this.labelData.text=a.labelText,this.labelData.position=a.position,this.labelData.visible=a.labelVisibility},removePlottedGraph:function(){this.pathGroup&&this.pathGroup.remove()},flushData:function(){delete this.A,delete this.B,delete this.C,delete this.errorCode,delete this.errorData,delete this.errorString,delete this.freeVars,delete this.functionVariable,delete this.isPolar,delete this.leftExpresstion,delete this.leftRoot,delete this.rightExpresstion,delete this.rightRoot,delete this.points,delete this.solution,delete this.type}},{DASHED_ARRAY:[10,4],minThickness:1,maxThickness:8}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.ParserAssist=Backbone.Model.extend({},{getEquationAccessibility:function(b){a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Productions.init();var c,d=new a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationData;return d.setLatex(b,!0),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Parser.parseEquation(d),c=d.getAccText(),d=null,c}}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Parser=Backbone.Model.extend({},{_deploy:!0,_constants:{"\\pi":Math.PI,e:Math.E},_debugFlag:{tokens:!1,rules:!1,tree:!1,power:!1,simplify:!1,expand:!1,convert2q:!1,solve:!1,plot:!1,info:!1,common:!1,error:!1},_INVERSIBLE_FUNCTIONS:["\\sin^{-1}","\\cos^{-1}","\\tan^{-1}","\\cot^{-1}","\\csc^{-1}","\\sec^{-1}","\\sinh^{-1}","\\cosh^{-1}","\\tanh^{-1}","\\coth^{-1}","\\csch^{-1}","\\sech^{-1}"],_INVERT_FUNCTIONS_IN_ORDER:["\\arcsin","\\arccos","\\arctan","\\arccot","\\arccsc","\\arcsec","\\arsinh","\\arcosh","\\artanh","\\arcoth","\\arcsch","\\arsech"],_productions:a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Productions,_mathFunctions:a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.MathFunctions,_NSTYLE:"background: #c00; color: #fff",_HSTYLE:"background: #cc0; color: #fff",_BLUE_STYLE:"background: #004; color: #fff",_YSTYLE:"background: #0c0; color: #fff",_borderColor:"#C1C1C1",_isBlank:function(a){return void 0===a?!1:(a=a.trim(),""===a)},_preProcessLatexSumProduct:function(a,b,c,d,e,f,g){var h,i,j=0;for(h=0;h<a.length;h++)if(")"===a.charAt(h)){if(0===j){if("("===a.charAt(0)){b=a.substring(1,h-1);break}b=a.substring(0,h);break}j--}else"("===a.charAt(h)&&j++;return void 0===g||""===g?((-1!==e.indexOf(d)||-1!==f.indexOf(d))&&(i=!0),c+"{"+d+"}{"+e+"}{"+f+"}{"+b+"}"+a.substring(h,a.length)):((-1!==e.indexOf(d)||-1!==g.indexOf(d))&&(i=!0),c+"{"+d+"}{"+e+"}{"+g+"}{"+b+"}"+a.substring(h,a.length))},_preProcessSumProductCase:function(b,c){if(void 0!==b&&null!==b){var d,e,f,g,h,i,j,k=/(\\sum)|(\\prod)/g,l=/^[a|b|c|d|e|f|g|h|i|j|k|l|m|n|o|p|q|r|s|t|u|v|w|z|A-Z]$/,m=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,n=!1,o=/(\\sum|\\prod)[\_][\{]([A-Za-z])[\=]([0-9a-zA-Z\+\_\.\-\\{}()\[\]\^\!]+)([\}])[\^]([0-9A-Za-z]|[\{](([\{][0-9a-zA-Z\+\_\.\-\\()\[\]\^\!][\}])+|[0-9a-zA-Z\+\_\.\-\\()\[\]\^\!]+)[\}])([\(]([0-9a-zA-Z\s\+\_\.\-\\{}()\[\]\^\!]+)[\)])/g,p=/(\\sum|\\prod)[\_][\{]([A-Za-z])[\=]([0-9a-zA-Z\+\_\.\-\\{}()\[\]\^\!]+)([\}])[\^]([0-9A-Za-z]|[\{](([\{][0-9a-zA-Z\+\_\.\-\\()\[\]\^][\}])+|[0-9a-zA-Z\+\_\.\-\\()\[\]\^\!]+)[\}])([0-9a-zA-Z\s\+\_\.\-\\{}()\[\]\^\!]+)/g,q=/(\\sum|\\prod)[\^]([0-9A-Za-z]|[\{](([\{][0-9a-zA-Z\+\_\.\-\\()\[\]\^\!][\}])+|[0-9a-zA-Z\+\_\.\-\\()\[\]\^\!]+)[\}])[\_][\{]([A-Za-z])[\=]([0-9a-zA-Z\+\_\.\-\\{}()\[\]\^\!]+)([\}])([\(]([0-9a-zA-Z\+\_\.\-\\{}()\[\]\^]+)[\)])[^\^]/g,r=/(\\sum|\\prod)[\^]([0-9A-Za-z]|[\{](([\{][0-9a-zA-Z\+\_\.\-\\()\[\]\^\!][\}])+|[0-9a-zA-Z\+\_\.\-\\()\[\]\^\!]+)[\}])[\_][\{]([A-Za-z])[\=]([0-9a-zA-Z\+\_\.\-\\{}()\[\]\^\!]+)([\}])([0-9a-zA-Z\+\_\.\-\\{}()\[\]\^]+)/g,s=function(a,b,f,g,h,i,j,k,l,n){return n=null,c.setPivot(f),d=l,e=d.substring(1,d.length-1),m.Parser._preProcessLatexSumProduct(d,e,b,f,g,i,j)},t=function(a,b,f,g,h,i,j,k,l){return c.setPivot(f),d=l,e=d,m.Parser._preProcessLatexSumProduct(d,e,b,f,g,i,j)},u=function(a,b,f,g,h,i,j,k,l,n){return c.setPivot(i),d=n,e=d.substring(0,d.length),m.Parser._preProcessLatexSumProduct(d,e,b,i,j,f,g)},v=function(a,b,f,g,h,i,j,k,l){return c.setPivot(i),d=l,e=d.substring(0,d.length),m.Parser._preProcessLatexSumProduct(d,e,b,i,j,f,g)};for(g=null!==b.match(k)?b.match(k).length:0,f=0;g>f;f++)b=b.replace(o,s),b=b.replace(p,t),b=b.replace(q,u),b=b.replace(r,v);if(n)return c.setCanBeSolved(!1),void c.setErrorCode("CannotUnderstandThis");if(null===c.getPivot()&&(h=b.indexOf("\\sum"),-1!==h?(j="\\sum",j=j.length):(h=b.indexOf("\\prod"),-1!==h&&(j="\\prod",j=j.length+1)),-1!==h))for(i=b.length,f=h+j;i>f;f++)if(null!==b.charAt(f).match(l)&&"="===b.charAt(f+1)){c.setPivot(b.charAt(f));break}return b}},_checkSumProductCase:function(b,c){var d,e,f,g,h=b.length,i=!1,j=!1,k=!1,l=!1,m=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,n=0,o="",p="",q=!1,r=!1,s="",t="",u="";for(d=0;h>d;d++)if(e=b.charAt(d),i===!0)if(0===n&&r===!1&&"_"===e)j=!0,k=!1;else if(0===n&&q===!1&&"^"===e)j=!1,k=!0;else if(m.ParsingProcedures._isOpeningBracket(e)?n++:m.ParsingProcedures._isClosingBracket(e)&&n--,j===!0)o+=e,0===n&&(r=!0,j=!1);else if(k===!0)p+=e,0===n&&(q=!0,k=!1);else{if(0===n&&"+"===e){i=!1,l=!1,s=e;continue}if(-1===n){i=d===h-1?!0:!1,l=!1,s=e;continue}if(t+=e,f=t.lastIndexOf("\\sum"),-1!==f&&f===t.length-4)return c.setCanBeSolved(!1),void c.setErrorCode("CannotUnderstandThis");if(g=t.lastIndexOf("\\prod"),-1!==g&&g===t.length-5)return c.setCanBeSolved(!1),void c.setErrorCode("CannotUnderstandThis")}else""!==t&&(u+=m.Parser._prepareSumProductLatex(p,o,t,c),t="",o="",p="",j=!1,q=!1,r=!1,k=!1,n=0),""!==s&&(u+=s,s=""),u+=e,l===!1&&m.Parser._checkSumProductCondition(u)&&(i=!0,l=!0);return i===!0&&(u+=m.Parser._prepareSumProductLatex(p,o,t,c),""!==s&&(u+=s,s="")),u},_checkSumProductCondition:function(a){var b=a.lastIndexOf("\\sum"),c=a.lastIndexOf("\\prod"),d=a.length;return-1===b&&-1===c?!1:-1!==b&&b===d-4?!0:-1!==c&&c===d-5?!0:!1},_prepareSumProductLatex:function(a,b,c,d){var e,f="";return"{"===b.charAt(0)&&(b=b.substring(1,b.length-1)),e=b.split("="),f+="{"+e[0]+"}{"+e[1]+"}",d.setPivot(e[0]),"{"===a.charAt(0)&&(a=a.substring(1,a.length-1)),f+="{"+a+"}",f+="{"+c+"}",-1!==e[1].indexOf(d.getPivot())||-1!==a.indexOf(d.getPivot())?(d.setCanBeSolved(!1),void d.setErrorCode("CannotUnderstandThis")):f},parseEquation:function(b){if(!b.getBlind()){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=b.getDirectives(),I=b.getProfiles();if(c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,c.Parser._deploy||paper.install(window),b.setSpecie("error"),b.setRange(null),b.setSolution(null),b.flushError(),b.flushAnalysis(),b.flushParserData(),b.setCanBeSolved(!0),c.Parser._isBlank(b.getLatex()))return b.setCanBeSolved(!1),b.setSpecie("error"),b.setErrorCode("Blank"),void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);if(B=b.getLeftExpression(),C=b.getRightExpression(),d=b.getLatex(),c.Parser._showConsole(c.Parser._debugFlag.common,"Processing equation "+d,[]),d=d.replace(/\\space/gi,""),d=d.replace(/\\left/gi,""),d=d.replace(/\\right/gi,""),d=d.replace(/\\:/gi,""),d=d.replace(/\$/gi,""),d=d.replace(/\s/gi,""),d=d.replace(/\\cdot/gi,"\\cdot "),d=d.replace(/\\pi/gi,"\\pi "),d=d.replace(/\\le/gi,"\\le "),d=d.replace(/\\ge/gi,"\\ge "),d=d.replace(/\\theta/gi,"\\theta "),d=c.Parser._splitRangeFromSolution(d,b),b.isCanBeSolved()!==!1){if(d=c.Parser._checkSumProductCase(d,b),b.isCanBeSolved()===!1)return void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured in sum pivot case",["#ff0000"]);if(c.Parser._preProcessLatexForErrors(d,b),b.isCanBeSolved()===!1)return void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured in syntax of latex",["#ff0000"]);if(e=/(.*?)(=|<|>|\\le|\\ge)(.*)/gi,f=e.exec(d),c.Parser._showConsole(c.Parser._debugFlag.common,d,[]),null===f)b.setInEqualityType("="),B.expression=d,c.Parser._showConsole(c.Parser._debugFlag.common,"Eqaution is an expression",[]);else{if(""===f[1]||""===f[3])return""===f[3]?(B.expression=f[1],c.Parser._preProcessExpression(B),c.Parser._parseExpression(B,b)):(C.expression=f[3],c.Parser._preProcessExpression(C),c.Parser._parseExpression(C,b)),b.setCanBeSolved(!1),void b.setErrorCode("CannotUnderstandThis");b.setInEqualityType(f[2]),B.expression=f[1],C.expression=f[3]}if(c.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("leftPreProcess"),c.Parser._preProcessExpression(B),c.Parser._deploy||(I[0]=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("leftPreProcess"),D=$("#pre-process-latex-left"),E=$("<div></div>"),D.append(E),E.attr("id","left-preprocess-latex-expression").append(B.expression).css({border:"1px solid","border-color":c.Parser._borderColor,padding:"5px 5px 5px 5px"}),D.parent().css({border:"1px solid black"})),c.Parser._showConsole(c.Parser._debugFlag.tokens,"Left expression after preprocessing :: ",[]),c.Parser._showConsole(c.Parser._debugFlag.tokens,B,[]),c.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("leftTokenGeneration"),c.Parser._parseExpression(B,b),c.Parser._deploy||(A=b.getLeftEquationParameters(),c.Parser._displayArrayOfObjects(A.operatorsList,"operators-display-container-left","#777700","white"),c.Parser._displayArrayOfObjects(A.constantsList,"constants-display-container-left","#777700","white"),c.Parser._displayArrayOfObjects(A.variablesList,"variables-display-container-left","#777700","white"),c.Parser._displayArrayOfObjects(A.digitsList,"digits-display-container-left","#777700","white"),c.Parser._displayArrayOfObjects(A.functionsList,"functions-display-container-left","#777700","white")),c.Parser._deploy||(I[1]=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("leftTokenGeneration")),b.isCanBeSolved()===!1)return void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);if("point"!==b.getSpecie()){if(c.Parser._displayArrayOfObjects(B.tokens,"tokens-display-container-left","#777700","white"),null===C.expression)if(3===B.tokens.length){if("digit"===B.tokens[1].type&&"("===B.tokens[0].value&&")"===B.tokens[2].value)return b.setSpecie("number"),void("-"===B.tokens[1].sign?b.setSolution(-1*Number(B.tokens[1].value)):b.setSolution(Number(B.tokens[1].value)))}else if(1===B.tokens.length&&"digit"===B.tokens[0].type)return b.setSpecie("number"),"-"===B.tokens[0].sign?(b.setAccText("-"+c.TreeProcedures._getAccessibleStringForNumber(B.tokens[0].value)),b.setSolution(-1*Number(B.tokens[0].value))):(b.setAccText(c.TreeProcedures._getAccessibleStringForNumber(B.tokens[0].value)),b.setSolution(Number(B.tokens[0].value))),void $("#accessibility-display").html("The Accesibility string is "+b.getAccText());g=[],h=null;for(h in B.freevars)-1===g.indexOf(h)&&g.push(h);if(null!==C.expression){if(b.setRhsAuto(!1),c.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("rightPreProcess"),c.Parser._preProcessExpression(C),c.Parser._deploy||(I[0]+=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("rightPreProcess")),c.Parser._showConsole(c.Parser._debugFlag.tokens,"right expression after preprocessing :: ",[]),c.Parser._showConsole(c.Parser._debugFlag.tokens,C,[]),c.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("rightTokenGeneration"),c.Parser._parseExpression(C,b),c.Parser._deploy||(I[1]+=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("rightTokenGeneration")),b.isCanBeSolved()===!1)return void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);h=null;for(h in C.freevars)-1===g.indexOf(h)&&g.push(h)}else{if(0===g.length)b.setRhsAuto(!0),C.expression="0";else{if(1!==g.length)return b.setCanBeSolved(!1),b.setErrorCode("Cant understand this"),b.setErrorString("Complicated"),void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);if("x"!==g[0])return b.setCanBeSolved(!1),b.setErrorCode("Complicated"),b.setErrorString("Cant understand this"),void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);g.push("y"),b.setRhsAuto(!0),C.expression="y"}if(c.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("rightPreProcess"),c.Parser._preProcessExpression(C),c.Parser._deploy||(I[0]+=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("rightPreProcess"),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("rightTokenGeneration")),c.Parser._parseExpression(C,b),c.Parser._deploy||(I[1]+=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("rightTokenGeneration")),b.isCanBeSolved()===!1)return void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"])}if("graphing"===H.FDFlagMethod&&c.Parser._getFracDecAnalysis(b),b.isCanBeSolved()===!1)return void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);if(c.Parser._deploy||(F=$("#pre-process-latex-right"),G=$("<div></div>"),F.append(G),G.attr("id","right-preprocess-latex-expression").append(C.expression).css({border:"1px solid","border-color":c.Parser._borderColor,padding:"5px 5px 5px 5px"})),r=-1!==g.indexOf("r"),s=-1!==g.indexOf("x")||-1!==g.indexOf("y"),t=[],r&&s){for(u=0,v=g.length,u;v>u;u++)"r"!==g[u]&&t.push(g[u]);for(g=t,x=0,y=B.tokens.length,z=null,x;y>x;x++)z=B.tokens[x],"r"===z.value&&(z.type="const");for(y=C.tokens.length,x=0;y>x;x++)z=C.tokens[x],"r"===z.value&&(z.type="const")}if(c.Parser._displayArrayOfObjects(C.tokens,"tokens-display-container-right","#777700","white"),g.length>2&&(b.setCanBeSolved(!1),b.setErrorCode("MoreFreeVariables"),b.setErrorString(c.EquationEnums.ERROR_TOO_MANY_FREE_VARIABLES),c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"])),c.Parser._showConsole(c.Parser._debugFlag.common,"%c[READY]Final equation is "+b,[c.Parser._YSTYLE]),c.Parser._showConsole(c.Parser._debugFlag.common,b,[]),i=!1,null===b.getConstants()&&(i=!0),c.Parser._checkIfOnlyNumbersAndConstantsPresent(b),b.isCanBeSolved()!==!1){if(c.Parser._substituteConstants(B,b,i),c.Parser._substituteConstants(C,b,i),!b.isCanBeSolved())return this._mergeConstantsErrorData(b),void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);if(c.Parser._printTokens(B,"Left expression "),c.Parser._printTokens(C,"Right expression "),c.Parser._showConsole(c.Parser._debugFlag.common,"%c[STAGE1 - Success]Token Generation Complete",[c.Parser._YSTYLE]),$("#production-rules-display").html(""),$.isEmptyObject(B.freevars)&&$.isEmptyObject(C.freevars)&&b.setSpecie("expression"),c.Parser._generateAnalysis(b),b.isCanBeSolved()===!1)return b.setSpecie("error"),void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);if("expression"===b.getSpecie())return c.Parser._showConsole(c.Parser._debugFlag.common,"The equation is solved",[]),void c.Parser._showConsole(c.Parser._debugFlag.common,b.getSolution(),[]);if(c.Parser._calculateMaxPowerOfVariable(b),b.isCanBeSolved()===!1)return b.setSpecie("error"),void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);j=[],k=null,w=b.getFreeVars(),l=0;for(k in w)l++,c.Parser._showConsole(c.Parser._debugFlag.common,"checking complexity of freevar "+k+">> "+w[k],[]),"number"==typeof w[k]&&w[k]<=2&&j.push(k);if(1===l){if(0===j.length)return b.setCanBeSolved(!1),b.setErrorCode("Complicated"),c.Parser._showConsole(c.Parser._debugFlag.error,"%c ERROR: complicated equation. Cant solve"),void b.setSpecie("error");c.Parser._showConsole(c.Parser._debugFlag.info,"%c INFO %c: Equation will yield solutions",[c.Parser._BLUE_STYLE,void 0]),w[j[0]]>1?b.setSpecie("quadratic"):(b.setSpecie("linear"),(1===w.x||1===w.y)&&b.setSpecie("plot"))}else b.setSpecie("plot");if(j.length<=2){for(o=!1,p=0,q=j.length,p;q>p;p++)c.Parser._showConsole(c.Parser._debugFlag.common,c.Parser._getFunctionVariablePrecedenceIndex(n)+">>"+c.Parser._getFunctionVariablePrecedenceIndex(j[p]),[]),o=void 0===n?!0:c.Parser._getFunctionVariablePrecedenceIndex(n)<c.Parser._getFunctionVariablePrecedenceIndex(j[p])?!0:!1,o===!0&&(n=j[p]);b.setFunctionVariable(n),m=b.getRange(),j.length>1&&null!==m&&-1!==j.indexOf(m.variable)&&("y"===m.variable?(n="x",b.setFunctionVariable(n)):(n="y",b.setFunctionVariable(n))),"y"===n?b.setParamVariable("x"):b.setParamVariable("y"),null!==m&&b.getParamVariable()!==m.variable&&(b.setCanBeSolved(!1),b.setErrorCode("ComplicatedRange")),c.Parser._showConsole(c.Parser._debugFlag.common,"%c[STAGE5 - SUCCESS] Chosen function variable is "+n,[c.Parser._YSTYLE])}else b.setCanBeSolved(!1),b.setErrorCode("MoreFreeVariables"),b.setErrorString(c.EquationEnums.ERROR_TOO_MANY_FREE_VARIABLES),c.Parser._showConsole(c.Parser._debugFlag.error,"%c[STAGE5 - FAIL]TOO many free variables...it should NOT have been be detected so late",[c.Parser._NSTYLE])}}}}},processTokensWithRules:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,d=b.getLeftExpression(),e=b.getRightExpression(),f=d.tokens,g=e.tokens,h=(b.getUnits(),b.getProfiles());b.getDirectives();return c.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("leftProductionRules"),d.validPredictionStack=c.Parser._recursiveDescentParser(b,f,0,0,[void 0],!1),c.Parser._deploy||(h[2]=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("leftProductionRules")),b.isCanBeSolved()!==!1&&(c.Parser._displayArrayOfObjects(d.validPredictionStack,"production-rules-display-left","#777700","white"),c.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("rightProductionRules"),e.validPredictionStack=c.Parser._recursiveDescentParser(b,g,0,0,[void 0],!1),c.Parser._deploy||(h[2]+=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("rightProductionRules")),b.isCanBeSolved()!==!1)?(c.Parser._displayArrayOfObjects(e.validPredictionStack,"production-rules-display-right","#777700","white"),void 0===d.validPredictionStack||void 0===e.validPredictionStack?(b.setCanBeSolved(!1),b.setErrorCode("CannotUnderstandThis"),void c.Parser._showConsole(c.Parser._debugFlag.common,"%c[STAGE2 - FAIL]Left Prediction Rules Failed",[c.Parser._NSTYLE])):void c.Parser._showConsole(c.Parser._debugFlag.common,"%c[STAGE2 - Success]Prediction rules Generated Left:"+d.validPredictionStack,[c.Parser._YSTYLE])):void 0;
},generateTreeFromRules:function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,p=b.getLeftExpression(),q=b.getRightExpression(),r=(p.tokens,q.tokens,b.getUnits()),s=b.getDirectives(),t=b.getProfiles();o.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("generateTree"),b.setLeftRoot(o.TreeProcedures.generateTree(p.validPredictionStack,0,r)),b.setRightRoot(o.TreeProcedures.generateTree(q.validPredictionStack,0,r)),o.Parser._deploy||(t[3]=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("generateTree")),d=b.getLeftRoot(),e=b.getRightRoot();var u=o.TreeProcedures._toAccessible(d).expression;if(b.getRhsAuto()!==!0&&(u+=" equal to "+o.TreeProcedures._toAccessible(e).expression),b.setAccText(u),$("#accessibility-display").html("The Accesibility string is "+u),"graphing"===s.FDFlagMethod&&"frac"===b.getFdFlag()&&("\\frac"===d.name||"do"===d.name&&"\\frac"===d.params[0].name)&&(b.setFdFlag("decimal"),"do"===d.name?o.Parser._checkIfFracHasNonFracChilds(d.params[0],b):o.Parser._checkIfFracHasNonFracChilds(d,b)),"calculator"===s.FDFlagMethod&&b.setFdFlag(0===o.Parser._getAnalysisForFD(d)?"frac":"decimal"),o.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("simplify"),d.isTerminal||d.simplify(b),e&&!e.isTerminal&&e.simplify(b),o.Parser._deploy||(t[4]=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("simplify")),d.isTerminal&&"digit"===d.type&&null!==e&&!b.getRhsAuto()&&e.isTerminal&&"digit"===e.type)return b.setCanBeSolved(!1),b.setErrorString("Try adding some free variables"),void b.setErrorCode("CannotUnderstandThis");if(o.Parser._showConsole(o.Parser._debugFlag.common,"%c[STAGE4 - SUCCESS]Tree Simplified",[o.Parser._YSTYLE]),o.Parser._deploy||o.Parser._printLatex(d,4,!0),"expression"!==b.getSpecie()&&o.TreeProcedures.combineLeftRightTree(b),c=d,void 0===d)return b.setCanBeSolved(!1),b.setErrorCode("CannotUnderstandThis"),void o.Parser._showConsole(o.Parser._debugFlag.common,"%c[STAGE3 - FAIL]Left Equation Tree Generation Failed",[o.Parser._NSTYLE]);if(o.Parser._showConsole(o.Parser._debugFlag.common,"%c[STAGE3 - Success]Equation Tree Generated",[o.Parser._YSTYLE]),o.Parser._deploy||o.Parser._printLatex(c,3,!0),"expression"===b.getSpecie()&&b.setSolution(o.TreeProcedures._substituteParamVariableAndGetValue(b.getLeftRoot(),b.getConstants())),o.Parser._deploy||o.TreeProcedures._toLatex(c),b.isCanBeSolved()===!1)return b.setSpecie("error"),void o.Parser._showConsole(o.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);if("expression"===b.getSpecie())return o.Parser._showConsole(o.Parser._debugFlag.common,"The equation is solved",[]),void o.Parser._showConsole(o.Parser._debugFlag.common,b.getSolution(),[]);if(o.Parser._calculateMaxPowerOfVariable(b),b.isCanBeSolved()===!1)return b.setSpecie("error"),void o.Parser._showConsole(o.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);f=[],g=null,n=b.getFreeVars(),h=0;for(g in n)h++,o.Parser._showConsole(o.Parser._debugFlag.common,"checking complexity of freevar "+g+">> "+n[g],[]),"number"==typeof n[g]&&n[g]<=2&&f.push(g);if(1===h){if(0===f.length)return b.setCanBeSolved(!1),b.setErrorCode("Complicated"),o.Parser._showConsole(o.Parser._debugFlag.error,"%c ERROR: complicated equation. Cant solve"),void b.setSpecie("error");o.Parser._showConsole(o.Parser._debugFlag.info,"%c INFO %c: Equation will yield solutions",[o.Parser._BLUE_STYLE,void 0]),n[f[0]]>1?b.setSpecie("quadratic"):(b.setSpecie("linear"),(1===n.x||1===n.y)&&b.setSpecie("plot"))}else b.setSpecie("plot");if(f.length<=2){for(k=!1,l=0,m=f.length,l;m>l;l++)o.Parser._showConsole(o.Parser._debugFlag.common,o.Parser._getFunctionVariablePrecedenceIndex(j)+">>"+o.Parser._getFunctionVariablePrecedenceIndex(f[l]),[]),k=void 0===j?!0:o.Parser._getFunctionVariablePrecedenceIndex(j)<o.Parser._getFunctionVariablePrecedenceIndex(f[l])?!0:!1,k===!0&&(j=f[l]);b.setFunctionVariable(j),i=b.getRange(),f.length>1&&null!==i&&-1!==f.indexOf(i.variable)&&("y"===i.variable?(j="x",b.setFunctionVariable(j)):(j="y",b.setFunctionVariable(j))),"y"===j?b.setParamVariable("x"):b.setParamVariable("y"),null!==i&&b.getParamVariable()!==i.variable&&(b.setCanBeSolved(!1),b.setErrorCode("ComplicatedRange")),o.Parser._showConsole(o.Parser._debugFlag.common,"%c[STAGE5 - SUCCESS] Chosen function variable is "+j,[o.Parser._YSTYLE])}else b.setCanBeSolved(!1),b.setErrorCode("MoreFreeVariables"),b.setErrorString(o.EquationEnums.ERROR_TOO_MANY_FREE_VARIABLES),o.Parser._showConsole(o.Parser._debugFlag.error,"%c[STAGE5 - FAIL]TOO many free variables...it should NOT have been be detected so late",[o.Parser._NSTYLE])},parseEquationToGetTokens:function(b){if(!b.getBlind()){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=b.getDirectives(),z=b.getProfiles();if(c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,c.Parser._deploy||paper.install(window),b.setSpecie("error"),b.setRange(null),b.setSolution(null),b.flushError(),b.flushAnalysis(),b.flushParserData(),b.setCanBeSolved(!0),c.Parser._isBlank(b.getLatex()))return b.setCanBeSolved(!1),b.setSpecie("error"),b.setErrorCode("Blank"),void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);if(s=b.getLeftExpression(),t=b.getRightExpression(),d=b.getLatex(),c.Parser._showConsole(c.Parser._debugFlag.common,"Processing equation "+d,[]),d=d.replace(/\\space/gi,""),d=d.replace(/\\left/gi,""),d=d.replace(/\\right/gi,""),d=d.replace(/\\:/gi,""),d=d.replace(/\$/gi,""),d=d.replace(/\s/gi,""),d=d.replace(/\\cdot/gi,"\\cdot "),d=d.replace(/\\pi/gi,"\\pi "),d=d.replace(/\\le/gi,"\\le "),d=d.replace(/\\ge/gi,"\\ge "),d=d.replace(/\\theta/gi,"\\theta "),d=c.Parser._splitRangeFromSolution(d,b),b.isCanBeSolved()!==!1){if(d=c.Parser._checkSumProductCase(d,b),b.isCanBeSolved()===!1)return void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured in sum pivot case",["#ff0000"]);if(c.Parser._preProcessLatexForErrors(d,b),b.isCanBeSolved()===!1)return void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured in syntax of latex",["#ff0000"]);if(e=/(.*?)(=|<|>|\\le|\\ge)(.*)/gi,f=e.exec(d),c.Parser._showConsole(c.Parser._debugFlag.common,d,[]),null===f)b.setInEqualityType("="),s.expression=d,c.Parser._showConsole(c.Parser._debugFlag.common,"Eqaution is an expression",[]);else{if(""===f[1]||""===f[3])return""===f[3]?(s.expression=f[1],c.Parser._preProcessExpression(s),c.Parser._parseExpression(s,b)):(t.expression=f[3],c.Parser._preProcessExpression(t),c.Parser._parseExpression(t,b)),b.setCanBeSolved(!1),void b.setErrorCode("CannotUnderstandThis");b.setInEqualityType(f[2]),s.expression=f[1],t.expression=f[3]}if(c.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("leftPreProcess"),c.Parser._preProcessExpression(s),c.Parser._deploy||(z[0]=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("leftPreProcess"),u=$("#pre-process-latex-left"),v=$("<div></div>"),u.append(v),v.attr("id","left-preprocess-latex-expression").append(s.expression).css({border:"1px solid","border-color":c.Parser._borderColor,padding:"5px 5px 5px 5px"}),u.parent().css({border:"1px solid black"})),c.Parser._showConsole(c.Parser._debugFlag.tokens,"Left expression after preprocessing :: ",[]),c.Parser._showConsole(c.Parser._debugFlag.tokens,s,[]),c.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("leftTokenGeneration"),c.Parser._parseExpression(s,b),c.Parser._deploy||(r=b.getLeftEquationParameters(),c.Parser._displayArrayOfObjects(r.operatorsList,"operators-display-container-left","#777700","white"),c.Parser._displayArrayOfObjects(r.constantsList,"constants-display-container-left","#777700","white"),c.Parser._displayArrayOfObjects(r.variablesList,"variables-display-container-left","#777700","white"),c.Parser._displayArrayOfObjects(r.digitsList,"digits-display-container-left","#777700","white"),c.Parser._displayArrayOfObjects(r.functionsList,"functions-display-container-left","#777700","white")),c.Parser._deploy||(z[1]=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("leftTokenGeneration")),b.isCanBeSolved()===!1)return void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);if("point"!==b.getSpecie()){if(c.Parser._displayArrayOfObjects(s.tokens,"tokens-display-container-left","#777700","white"),null===t.expression)if(3===s.tokens.length){if("digit"===s.tokens[1].type&&"("===s.tokens[0].value&&")"===s.tokens[2].value)return b.setSpecie("number"),void("-"===s.tokens[1].sign?b.setSolution(-1*Number(s.tokens[1].value)):b.setSolution(Number(s.tokens[1].value)))}else if(1===s.tokens.length&&"digit"===s.tokens[0].type)return b.setSpecie("number"),"-"===s.tokens[0].sign?(b.setAccText(c.TreeProcedures.OPERATOR_TEXT.NEGATIVE+" "+c.TreeProcedures._getAccessibleStringForNumber(s.tokens[0].value)),b.setSolution(-1*Number(s.tokens[0].value))):(b.setAccText(c.TreeProcedures._getAccessibleStringForNumber(s.tokens[0].value)),b.setSolution(Number(s.tokens[0].value))),void $("#accessibility-display").html("The Accesibility string is "+b.getAccText());g=[],h=null;for(h in s.freevars)-1===g.indexOf(h)&&g.push(h);if(null!==t.expression){if(b.setRhsAuto(!1),c.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("rightPreProcess"),c.Parser._preProcessExpression(t),c.Parser._deploy||(z[0]+=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("rightPreProcess")),c.Parser._showConsole(c.Parser._debugFlag.tokens,"right expression after preprocessing :: ",[]),c.Parser._showConsole(c.Parser._debugFlag.tokens,t,[]),c.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("rightTokenGeneration"),c.Parser._parseExpression(t,b),c.Parser._deploy||(z[1]+=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("rightTokenGeneration")),b.isCanBeSolved()===!1)return void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);h=null;for(h in t.freevars)-1===g.indexOf(h)&&g.push(h)}else{if(0===g.length)b.setRhsAuto(!0),t.expression="0";else{if(1!==g.length)return b.setCanBeSolved(!1),b.setErrorCode("Cant understand this"),b.setErrorString("Complicated"),void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);if("x"!==g[0])return b.setCanBeSolved(!1),b.setErrorCode("Complicated"),b.setErrorString("Cant understand this"),void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);g.push("y"),b.setRhsAuto(!0),t.expression="y"}if(c.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("rightPreProcess"),c.Parser._preProcessExpression(t),c.Parser._deploy||(z[0]+=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("rightPreProcess"),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("rightTokenGeneration")),c.Parser._parseExpression(t,b),c.Parser._deploy||(z[1]+=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("rightTokenGeneration")),b.isCanBeSolved()===!1)return void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"])}if("graphing"===y.FDFlagMethod&&c.Parser._getFracDecAnalysis(b),b.isCanBeSolved()===!1)return void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);if(c.Parser._deploy||(w=$("#pre-process-latex-right"),x=$("<div></div>"),w.append(x),x.attr("id","right-preprocess-latex-expression").append(t.expression).css({border:"1px solid","border-color":c.Parser._borderColor,padding:"5px 5px 5px 5px"})),j=-1!==g.indexOf("r"),k=-1!==g.indexOf("x")||-1!==g.indexOf("y"),l=[],j&&k){for(m=0,n=g.length,m;n>m;m++)"r"!==g[m]&&l.push(g[m]);for(g=l,o=0,p=s.tokens.length,q=null,o;p>o;o++)q=s.tokens[o],"r"===q.value&&(q.type="const");for(p=t.tokens.length,o=0;p>o;o++)q=t.tokens[o],"r"===q.value&&(q.type="const")}if(c.Parser._displayArrayOfObjects(t.tokens,"tokens-display-container-right","#777700","white"),g.length>2&&(b.setCanBeSolved(!1),b.setErrorCode("MoreFreeVariables"),b.setErrorString(c.EquationEnums.ERROR_TOO_MANY_FREE_VARIABLES),c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"])),c.Parser._showConsole(c.Parser._debugFlag.common,"%c[READY]Final equation is "+b,[c.Parser._YSTYLE]),c.Parser._showConsole(c.Parser._debugFlag.common,b,[]),i=!1,null===b.getConstants()&&(i=!0),c.Parser._checkIfOnlyNumbersAndConstantsPresent(b),b.isCanBeSolved()!==!1){if(c.Parser._substituteConstants(s,b,i),c.Parser._substituteConstants(t,b,i),!b.isCanBeSolved())return this._mergeConstantsErrorData(b),void c.Parser._showConsole(c.Parser._debugFlag.error,"%cError occured :: ",["#ff0000"]);c.Parser._printTokens(s,"Left expression "),c.Parser._printTokens(t,"Right expression "),c.Parser._showConsole(c.Parser._debugFlag.common,"%c[STAGE1 - Success]Token Generation Complete",[c.Parser._YSTYLE]),$("#production-rules-display").html(""),$.isEmptyObject(s.freevars)&&$.isEmptyObject(t.freevars)&&b.setSpecie("expression")}}}}},_checkIfOnlyNumbersAndConstantsPresent:function(b){var c,d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,f=b.getLeftExpression(),g=b.getRightExpression();c=e.Parser._containsOnlyNumbersAndConstants(f.tokens),d=e.Parser._containsOnlyNumbersAndConstants(g.tokens),c===!0&&d===!0&&-1!==b.getLatex().indexOf("=")&&(b.setCanBeSolved(!1),e.Parser._substituteConstants(f,b,!1),e.Parser._substituteConstants(g,b,!1),this._mergeConstantsErrorData(b),b.setErrorCode("OnlyNumbers"))},_getFracDecAnalysis:function(b){var c,d,e,f=b.getLeftExpression(),g=b.getRightExpression(),h=function(d){var e,f,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,h=["\\pi","e","x","y"],i=1,j=[],k=!1,l="Syntax Error in FracDec",m=d.length,n=!1;if(void 0!==d&&0!==m){if(2>m)return void c(d);if("\\fracdec"!==d[0].value){for(e=0;m>e;e++)if(f=d[e],"\\fracdec"!==f.value){if(g.ParsingProcedures._isValidBracket(f.value))n&&g.ParsingProcedures.recordBracket(j,f.value);else if(j.length>0&&-1!==h.indexOf(f.value))return b.setCanBeSolved(!1),b.setErrorString(l),void b.setErrorCode("FracDecError")}else n=!0;return"decimal"}for(;m>i;){if(1===i&&!g.ParsingProcedures._isValidBracket(d[i].value)){k=!0;break}if(g.ParsingProcedures.recordBracket(j,d[i].value),-1!==h.indexOf(d[i].value)){k=!0,l="No π or e allowed in fracdec";break}if(i++,0===j.length)break}return k=k?k:j.length>0?l="No π or e allowed in fracdec":!1,k?(b.setCanBeSolved(!1),b.setErrorString(l),void b.setErrorCode("FracDecError")):i<d.length?"decimal":"frac"}};c=function(a){var c=0;if(a)for(;c<a.length;)if("\\fracdec"!==a[c].value)c++;else{if(a.length>c+1){if("("!==a[c+1].value)return b.setCanBeSolved(!1),void b.setErrorCode("CannotUnderstandThis");a[c+1].sign=a[c].sign}a.splice(c,1)}},d=h(f.tokens),"frac"===d&&g&&g.tokens&&(e=h(g.tokens)),c(f.tokens),c(g.tokens),b.setFdFlag(e?e:d)},_mergeConstantsErrorData:function(a){var b,c,d,e,f=a.getLeftExpression(),g=a.getRightExpression();if(a.setErrorData([]),d=a.getErrorData(),void 0!==f.errorData)for(b=0,c=f.errorData.length,b;c>b;b++)e=f.errorData[b],-1===d.indexOf(e)&&d.push(e);if(void 0!==g.errorData)for(b=0,c=g.errorData.length,b;c>b;b++)e=g.errorData[b],-1===d.indexOf(e)&&d.push(e)},_containsOnlyNumbersAndConstants:function(a){var b,c,d=a.length,e=!0;for(b=0;d>b;b++)if(c=a[b],"digit"!==c.type&&"opr"!==c.type){if("const"!==c.type){e=!1;break}if("e"===c.value||"\\pi"===c.value){e=!1;break}}return e},_isCommaFunction:function(a){var b=["\\lcm","\\gcd","\\min","\\nPr","\\nCr","\\mod"];return-1!==b.indexOf(a)},_parseAndSetRange:function(b,c){var d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return b.length<2?(c.setCanBeSolved(!1),void c.setErrorCode("ComplicatedRange")):(e.RangeProductionRules.generateRules(),d=e.Parser._recursiveDescentParser(c,b,0,0,[void 0],!0),void 0===d&&c.setCanBeSolved(!1),c.isCanBeSolved()===!1?void c.setErrorCode("ComplicatedRange"):void c.setRange(e.Parser._setRangeFromSequenceString(d,b,c)))},_setRangeFromSequenceString:function(b,c,d){var e,f,g,h,i,j,k=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,l={min:null,max:null,variable:null};return e=k.RangeProductionRules.solution[b[0]],f=e.split(" "),g=f.length,2===g?(-1===f[0].indexOf("var")?(l.variable=f[1],h=f[0],i=-1!==f[0].indexOf("min")):(l.variable=f[0],h=f[1],i=-1!==f[1].indexOf("min")),i?l.min=k.Parser._createMinMaxObject(h,c):l.max=k.Parser._createMinMaxObject(h,c)):(l.variable=f[1],-1!==f[0].indexOf("min")?(l.min=k.Parser._createMinMaxObject(f[0],c),l.max=k.Parser._createMinMaxObject(f[2],c)):(l.min=k.Parser._createMinMaxObject(f[2],c),l.max=k.Parser._createMinMaxObject(f[0],c)),l.min.value>=l.max.value&&d.setCanBeSolved(!1)),j=l.variable.split("."),l.variable=c[Number(j[j.length-1])].value,l},_createMinMaxObject:function(a,b){var c,d,e={include:-1!==a.indexOf("equal"),value:null};return c=a.split("."),d=b[c[c.length-1]],e.value=Number(d.value),"-"===d.sign&&(e.value*=-1),e},_splitRangeFromSolution:function(b,c){var d,e=/(\\\})/,f=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,g=b.split("\\{");if(g[1]){if(g[1].indexOf("\\}")!==g[1].length-2||b.indexOf("\\}")!==b.length-2)return c.setCanBeSolved(!1),void c.setErrorCode("CannotUnderstandThis");if(g[1]=g[1].replace(e,""),d=f.Parser._generateTokens(g[1],c),c.isCanBeSolved()===!1)return;f.Parser._parseAndSetRange(d,c)}return""===g[0]&&(c.setCanBeSolved(!1),c.setErrorCode("CannotUnderstandThis")),g[0]},_preProcessLatexForErrors:function(a,b){var c,d,e,f,g,h=/[\\a-zA-Z0-9]*[\^][a-zA-Z0-9](([0-9]+)|([\.]))/g;if(-1!==a.indexOf("---"))return b.setCanBeSolved(!1),void b.setErrorCode("CannotUnderstandThis");if(c=a.match(h),null!==c)for(e=c.length,g=/\\[a-zA-Z0-9]+[\^][a-zA-Z0-9][0-9]+(([\.]?[0-9])*)/g,d=0;e>d;d++)if(f=g.exec(c[d]),null===f)return b.setCanBeSolved(!1),void b.setErrorCode("CannotUnderstandThis");return-1!==a.indexOf("!!")?(b.setCanBeSolved(!1),void b.setErrorCode("CannotUnderstandThis")):void 0},_getFunctionVariablePrecedenceIndex:function(a){switch(a){case"y":return 3;case"x":return 2;default:return 0}},_shiftAllRightTokensToLeft:function(b){var c,d,e,f=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,g=b.getRightExpression(),h=g.tokens,i=b.getLeftExpression(),j=h.length,k=0;for(k;j>k;k++)c=h[k],d=f.Parser._getFactoryToken(),d.value="+",d.isValid=!0,d.type="opr",d.sign="+",i.tokens.push(d),"-"===c.sign?c.sign="+":c.sign="-",i.tokens.push(c);e=f.Parser._getFactoryToken(),e.value="0",e.isValid=!0,e.type="digit",e.sign="+",g.tokens=[],g.tokens.push(e),f.Parser._showConsole(f.Parser._debugFlag.common,"Shifted all right tokens to left ----------------------------------------------",[]),f.Parser._showConsole(f.Parser._debugFlag.common,b,[])},_preProcessExpression:function(a){if(void 0!==a){a.expression=a.expression.replace(/\\times/g,"\\cdot ");var b,c,d="\\cdot ",e=(d.length,/\\text\{fracdec}/g),f=/\\text\{abs}/g,g=/\\l((ceil)|(floor))/g,h=/\\r(ceil|floor)/g,i=/(\\sin\^\{\-1\}|\\cos\^\{\-1\}|\\tan\^\{\-1\}|\\cot\^\{\-1\}|\\csc\^\{\-1\}|\\sec\^\{\-1\}|\\sinh\^\{\-1\}|\\cosh\^\{\-1\}|\\tanh\^\{\-1\}|\\coth\^\{\-1\}|\\csch\^\{\-1\}|\\sech\^\{\-1\})/g,j=/\\prod_\{[A-Za-z]=(([\-]?[0-9]+[\.]?[0-9]*)|([\-]?[\.][0-9]+)|([\-]?\\theta|[\-]?\\pi|[\-]?[A-Za-z])[A-Za-z]*(\\theta)*(\\pi)*|[\-]?\\theta|[\-]?\\pi|[\-]?[a-zA-Z])\}\^([0-9]|[A-Za-z])/g,k=/\\sum_\{[A-Za-z]=(([\-]?[0-9]+[\.]?[0-9]*)|([\-]?[\.][0-9]+)|([\-]?\\theta|[\-]?\\pi|[\-]?[A-Za-z])[A-Za-z]*(\\theta)*(\\pi)*|[\-]?\\theta|[\-]?\\pi|[\-]?[a-zA-Z])\}\^([0-9]|[A-Za-z])/g,l=/(([\-]?[0-9]*[\.]?[0-9]*[A-Za-z]*(\\theta)*(\\pi\s)*)[\^][\{]([\-]?[0-9]*[\.]?[0-9]*[A-Za-z]*(\\theta)*(\\pi\s)*)[\}])([\\][\%])/g,m=/(([0-9]*[\.]?[0-9]*[A-Za-z]*(\\theta)*(\\pi\s)*)[\^]([0-9]+[\.]?[0-9]*[A-Za-z]*(\\theta)*(\\pi\s)*))([\\][\%])/g,n=/([\(|\)|\{|\}|\[|\]|\+|\-|\/|\%|\*|\^|])?((([\-]?[\.][0-9]+)|([\-]?[A-Za-z])|([\-]?(\\theta))|([\-]?(\\pi\s))|([\-]?[0-9]+[\.]?[0-9]*)))[\\][\%]([\\][\%])/g,o=/([\(|\)|\{|\}|\[|\]|\+|\-|\/|\%|\*|\^])?([\(]+(([\-]?[\.][0-9]+)|([\-]?[0-9]+[\.]?[0-9]*)|([\-]?[A-Za-z])|([\-]?(\\theta))|([\-]?(\\pi\s)))([\\][\%][\)])+)([\\][\%]([\\][\%]+))/g,p=/((([\-]?[0-9]+[\.]?[0-9]*)|([\-]?(\\theta))|([\-]?(\\pi\s))|([\-]?[\.][0-9]+)|([\-]?[a-zA-Z]))[\!])([\/^]([\{]|[0-9A-Za-z]))/g,q=/(\\log_)(([0-9A-Za-z])|[\{]([0-9a-zA-Z\+\_\.\-\\{}()\[\]\^]+|(?:[\-]?(\\pi\s)))[\}])[\^](([0-9A-Za-z])|[\{]([0-9a-zA-Z\+\_\.\-\\{}()\[\]\^]+|(?:[\-]?(\\pi\s)))[\}])(([\-]?[\.][0-9]+)|([\-]?[0-9]+[\.]?[0-9]*)|([\-]?[A-Za-z])|([\-]?(\\theta))|([\-]?(\\pi\s)))/g,r=this;for(a.expression=a.expression.replace(i,function(a){var b=r._INVERSIBLE_FUNCTIONS.indexOf(a);return r._INVERT_FUNCTIONS_IN_ORDER[b]}),a.expression=a.expression.replace(e,"\\fracdec"),a.expression=a.expression.replace(f,"\\abs"),a.expression=a.expression.replace(g,function(a,b){return"\\"+b+"("}),a.expression=a.expression.replace(h,")"),a.expression=a.expression.replace(j,function(a,b,c,d,e,f,g,h){return"\\prod_{n="+b+"}^{"+h+"}"}),a.expression=a.expression.replace(k,function(a,b,c,d,e,f,g,h){return"\\sum_{n="+b+"}^{"+h+"}"}),a.expression=a.expression.replace(l,function(a,b,c){return c=null,"("+b+")\\%"}),a.expression=a.expression.replace(m,function(a,b,c){return c=null,"("+b+")\\%"}),a.expression=a.expression.replace(n,function(a,b,c){return void 0===b||""===b?"("+c+"\\%)\\%":b+"("+c+"\\%)\\%"}),b=1,c=function(a,c,d,e,f,g,h,i,j,k,l,m,n,o){return o.length>b&&(b=o.length),void 0===c||""===c?"("+d+"\\%)\\%":c+"("+d+"\\%)\\%"};0!==b;)a.expression=a.expression.replace(o,c),b--;a.expression=a.expression.replace(p,function(a,b,c,d,e,f,g,h,i,j,k){return"("+b+")"+k}),a.expression=a.expression.replace(q,function(a,b,c,d,e,f,g,h,i,j,k){var l="";return l=void 0===e||""===e?b+"{"+c+"}^{":b+"{"+e+"}^{",void 0===i||""===i?l+g+"}("+k+")":l+i+"}("+k+")"})}},_processError:function(a){var b=window.open("","","width=200,height=200"),c=b.document;c.write("The error is :: <strong>"+a.getErrorString()+"</strong>\n"),c.write("The error data is :: <strong>"+a.getErrorData()+"</strong>\n")},_getValueOfConstantFromEquationData:function(a,b){if(null===a||void 0===a)return null;var c=a.getConstants();return null===c?null:void 0===c[b]?null:c[b]},_calculateMaxPowerOfVariable:function(b){var c,d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,f=null,g=null,h=null,i=b.getLeftExpression(),j=b.getLeftRoot(),k=!1,l=!1;f=e.Parser._getFreeVarPower(j,i.freevars);for(g in i.freevars)i.freevars[g]=f[g];h=null,b.setFreeVars({}),c=b.getFreeVars();for(h in i.freevars)h in c?"c"!==c[h]&&(c[h]<i.freevars[h]||"c"===i.freevars[h])&&(c[h]=i.freevars[h]):c[h]=i.freevars[h];g=null;for(g in c)if(d=c[g],"c"!==d&&d!==1/0&&!isNaN(d)){l=!0;break}if(l!==!0)return b.setCanBeSolved(!1),b.setErrorCode("Complicated"),void b.setErrorString(e.EquationEnums.ERROR_COMPLICATED);g=null;for(g in c)if(d=c[g],"c"!==d&&d!==1/0&&!isNaN(d)&&2>=d&&0!==d){k=!0;break}return e.Parser._showConsole(e.Parser._debugFlag.common,"Max power",[]),e.Parser._showConsole(e.Parser._debugFlag.common,b.freeVars,[]),k===!1?(b.setCanBeSolved(!1),b.setErrorCode("NoneVariablesQuadratic"),void b.setErrorString(e.EquationEnums.ERROR_VARIABLE_HAS_TO_BE_QUADRATIC)):void 0},_substituteConstants:function(b,c,d){var e,f,g,h=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,i=[],j=!1,k=c.getConstants();for(f=0;f<b.tokens.length;f++)e=void 0,g=!1,"const"===b.tokens[f].type&&(h.Parser._showConsole(h.Parser._debugFlag.common,"substituting value of constant "+b.tokens[f].value,[]),void 0===e&&(e=h.Parser._constants[b.tokens[f].value],b.tokens[f].constantSubstituted=b.tokens[f].value),void 0===e?(null===k||d||void 0===k[b.tokens[f].value])&&b.tokens[f].value!==c.getPivot()&&(g=!0,j=!0):(b.tokens[f].value=e,b.tokens[f].type="digit")),g&&-1===i.indexOf(b.tokens[f].value)&&i.push(b.tokens[f].value);j&&(b.errorData=i,MathUtilities.Components.EquationEngine.Models.Parser.processTokensWithRules(c),c.isCanBeSolved()===!1?c.setErrorCode("CannotUnderstandThis"):c.setErrorCode("ConstantDeclaration"),c.setCanBeSolved(!1),c.setErrorString(h.EquationEnums.ERROR_CONSTANTS_NOT_DEFINED),h.Parser._showConsole(h.Parser._debugFlag.common,"I found a constant that didnt have value specified ",[]),h.Parser._showConsole(h.Parser._debugFlag.common,c.getErrorData(),[]))},_getBracketBounds:function(b,c){var d,e,f,g,h=b[c].value,i=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(null===b||void 0===b)return-1;if(0===b.length)return i.Parser._showConsole(i.Parser._debugFlag.common,"Empty tokens",[]),-1;if(b.length<c+1)return i.Parser._showConsole(i.Parser._debugFlag.common,"invalid start index "+c,[]),-1;for(i.Parser._showConsole(i.Parser._debugFlag.common,"Finding end token for "+h,[]),"{"===h?d="}":"("===h?d=")":i.Parser._showConsole(i.Parser._debugFlag.common,"Invalid Start Token "+h,[]),e=0,f=b.length,g=null,g=c+1;f>g;g++)if(i.Parser._showConsole(i.Parser._debugFlag.common,b[g].value+" >> "+h,[]),b[g].value===h)e++;else if(b[g].value===d&&(e--,-1===e))return g;return i.Parser._showConsole(i.Parser._debugFlag.common,"Cant find end token",[]),-1},_getFactoryToken:function(){var a={};return a.toString=function(){return"("+this.value+" "+this.type+" "+this.sign+" "+this.negativeCaseType+")"},a},_processFunctionPowers:function(b){var c,d,e,f,g,h,i,j,k,l,m=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,n=null;for(c=0;c<b.length;c++)l=!1,d=b[c],0!==c&&(e=b[c-1],"func"===e.type?l=!0:(n=m.Parser._checkLogToBasePowerCase(b.slice(0,c)),null!==n&&(l=!0)),"^"===d.value&&l&&(f=m.Parser._getFunctionTokens(b.slice(c+1)),g=m.Parser._getFunctionTokens(b.slice(c+1+f.length)),h=m.Parser._getFactoryToken(),i=m.Parser._getFactoryToken(),h.type=i.type="delim",h.isValid=i.isValid=!0,h.sign=i.sign="+",h.value="(",i.value=")",j=b.slice(0,c-1),k=b.slice(c+f.length+1+g.length,b.length),null!==n?(b=j.slice(0,j.length-n.length-2),b.push(h),b=b.concat(n)):(b=j,b.push(h),b.push(e)),b=b.concat(g),b.push(i),b.push(d),b=b.concat(f),b=b.concat(k)));return b},_checkLogToBasePowerCase:function(b){var c,d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,f=b.length,g=0,h=null;for(c=f-1;c>=0;c--)if(d=b[c],e.ParsingProcedures._isOpeningBracket(d.value))g++;else if(e.ParsingProcedures._isClosingBracket(d.value))g--;else if(0===g){"\\log_"===d.value&&(h=b.slice(c,f));break}return h},_getFunctionTokens:function(b){var c,d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,f=b.length,g=0,h=[];for(c=0;f>c&&(d=b[c],h.push(d),e.ParsingProcedures._isOpeningBracket(d.value)?g++:e.ParsingProcedures._isClosingBracket(d.value)&&g--,0!==g);c++);return h},_isFunctionSupported:function(a){var b=["\\cdot","\\pi","\\sqrt","\\fracdec","\\gcd","\\lcm","\\theta","\\min","\\max","\\mod","\\nCr","\\nPr","\\frac","\\%","\\sin","\\cos","\\tan","\\csc","\\sec","\\cot","\\arccot","\\arccsc","\\arcsin","\\arcsec","\\arccos","\\arctan","\\log","\\ln","\\ceil","\\floor","\\round","\\abs","\\exp","\\sum","\\prod"];return-1!==b.indexOf(a)?!0:!1},_createToken:function(b,c,d,e){var f=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,g=f.Parser._getFactoryToken();return g.value=b,g.isValid=c,g.type=d,g.sign=e,g},_generateTokens:function(b,c){var d,e,f,g,h,i,j=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,k=[],l="",m=0,n=["func","delim","var","opr","digit","const"],o=!1,p=!1,q=[/^\\[a-z|\%|\_]+[\s]?$/i,/^[\[|\]|\}|\{|\(|\)|\,|\{|\}]$/i,/^[x|y]{1}$/,/^[\+|\-|\^|\!|<|\>|\_]{1}$/,/^(([\.][0-9]+)|([0-9]+[\.]?[0-9]*))$/,/^[a|b|c|d|e|f|g|h|i|j|k|l|m|n|o|p|q|r|s|t|u|v|w|z|A-Z]$/],r=0,s=q.length;for("string"==typeof b?(d=b,f=!0):(d=b.expression,f=!1),d=d.trim(),h=d.length,j.Parser._showConsole(j.Parser._debugFlag.common,"parse expression called",[]);h>m;){for(p=!1,j.Parser._showConsole(j.Parser._debugFlag.tokens,">>"+d.charAt(m)+"<<",[])," "===l&&(l=""),l+=d.charAt(m),j.Parser._showConsole(j.Parser._debugFlag.tokens,"Analysing token "+l,[]),r=0;s>r;r++)if(g=q[r].test(l),g!==!1){if(m++,"func"===n[r]){if(j.Parser._isFunctionSupported(l)){"\\frac"===l&&d.charAt(m)+d.charAt(m+1)+d.charAt(m+2)==="dec"&&(l="\\fracdec",m+=3),e&&(i=e.index),e=j.Parser._createToken(l,!0,n[r],"+"),j.Parser._showConsole(j.Parser._debugFlag.tokens,">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>TOKEN FOUND "+e.value,[]),k.push(e),p=!0,void 0!==i?e.index=d.indexOf(l,i+1):e.index=d.indexOf(l),l="";break}o=!1;break}if("digit"!==n[r]){e&&(i=e.index),e=j.Parser._createToken(l,!0,n[r],"+"),j.Parser._showConsole(j.Parser._debugFlag.tokens,">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>TOKEN FOUND "+e.value,[]),k.push(e),p=!0,void 0!==i?e.index=d.indexOf(l,i+1):e.index=d.indexOf(l),l="";break}if(e&&"opr"===e.type&&("_"===e.value||"^"===e.value)){e&&(i=e.index),e=j.Parser._createToken(l,!0,n[r],"+"),j.Parser._showConsole(j.Parser._debugFlag.tokens,">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>TOKEN FOUND "+e.value,[]),k.push(e),p=!0,void 0!==i?e.index=d.indexOf(l,i+1):e.index=d.indexOf(l),l="";break}for(;;){if(""!==d.charAt(m)){if(l+=d.charAt(m),j.Parser._showConsole(j.Parser._debugFlag.tokens,"Digit found",[]),j.Parser._showConsole(j.Parser._debugFlag.tokens,"Analysing token "+l,[]),q[4].test(l)){m++;continue}m--,1!==l.length&&(l=l.substring(0,l.length-1))}e&&(i=e.index),e=j.Parser._createToken(l,!0,n[r],"+"),j.Parser._showConsole(j.Parser._debugFlag.tokens,">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>TOKEN FOUND "+e.value,[]),k.push(e),p=!0,void 0!==i?e.index=d.indexOf(l,i+1):e.index=d.indexOf(l),l="";break}}else j.Parser._showConsole(j.Parser._debugFlag.tokens,"NO!! match "+q[r]+" >>"+l,[]);r===s&&m++}return p?k=j.Parser._processTokens(k,b,c,f):(c.setCanBeSolved(!1),void c.setErrorCode("Complicated"))},_processTokens:function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,s=0,t=0,u=0,v=0,w=0;for(q=b.length,f=0;q>f;f++)switch(m=f+1,g=b[f],h=b[m],g.type){case"func":switch(g.value){case"\\cdot":g.value="\\cdot",g.type="opr",f--;break;case"\\pi":g.value="\\pi",g.type="const";break;case"\\%":g.value="\\%",g.type="opr";break;case"\\theta ":case"\\theta":g.value="\\theta",g.type="const"}if("func"===g.type&&"\\frac"!==g.value&&(0!==u&&(k=r.Parser._createToken(")",!0,"delim","+"),b.splice(f,0,k),u--,q++),h)){if("\\log"===g.value)if(g.value="\\log_","_"===h.value)if(b.splice(++f,1),q--,"{"!==b[f].value)k=r.Parser._createToken("{",!0,"delim","+"),b.splice(f++,0,k),k=r.Parser._createToken("}",!0,"delim","+"),b.splice(++f,0,k);else{for(t=1,f++,j=f;0!==t;)"{"===b[f].value&&t++,"}"===b[f].value&&t--,f++;for(f--,n=b.splice(j,f-j),n.length>1&&(n=r.Parser._processTokens(n,c,d)),o=n.length,p=0;o>p;p++)b.splice(j,0,n[p]),j++;f=j}else k=r.Parser._createToken("{",!0,"delim","+"),b.splice(++f,0,k),k=r.Parser._createToken("10",!0,"digit","+"),b.splice(++f,0,k),k=r.Parser._createToken("}",!0,"delim","+"),b.splice(++f,0,k),q+=3;else"\\sqrt"===g.value&&"{"===h.value&&(k=r.Parser._createToken("[",!0,"delim","+"),b.splice(++f,0,k),k=r.Parser._createToken("2",!0,"digit","+"),b.splice(++f,0,k),k=r.Parser._createToken("]",!0,"delim","+"),b.splice(++f,0,k),q+=3,v++);if("^"===h.value)if("{"===b[f+2].value){for(t=1,f+=3,j=f;0!==t;)"{"===b[f].value&&t++,"}"===b[f].value&&t--,f++;for(f--,n=b.splice(j,f-j),n.length>1&&(n=r.Parser._processTokens(n,c,d)),o=n.length,p=0;o>p;p++)b.splice(j,0,n[p]),j++;f=j}else f+=2;h=b[f+1],h&&"delim"!==h.type&&"func"!==h.type?(0!==v&&w++,k=r.Parser._createToken("(",!0,"delim","+"),b.splice(f+1,0,k),u++,q=b.length):h&&"\\frac"===h.value&&(k=r.Parser._createToken("(",!0,"delim","+"),b.splice(f+1,0,k),u++,
q=b.length,f++)}break;case"var":e===!1&&(void 0===c.freevars&&(c.freevars={}),void 0===c.freevars[g.value]&&(r.Parser._showConsole(r.Parser._debugFlag.tokens,"---------------------recording var "+g.value+"-------------------------",[]),c.freevars[g.value]=0));break;case"const":if(e===!1){void 0===c.constants&&(c.constants={}),void 0===c.constants[g.value]&&(r.Parser._showConsole(r.Parser._debugFlag.tokens,"------------------ recording constant "+g.value+"--------------------",[]),c.constants[g.value]=1),d.containsConstant=!0;break}case"delim":"}"!==g.value&&")"!==g.value||!u?"{"===g.value&&v++:0===v||0!==w?(k=r.Parser._createToken(")",!0,"delim","+"),b.splice(f,0,k),u--,q++,0!==w&&w--):v--;break;case"opr":if("+"!==g.value&&"-"!==g.value||0===u){if("_"===g.value&&(j=f-1,i=b[f-1],"var"===i.type||"const"===i.type))if("delim"!==h.type)k=r.Parser._createToken(i.value+g.value+h.value,!0,"const","+"),b.splice(f-1,3),b.splice(f-1,0,k),f--,q=b.length;else{for(l=i.value+g.value+h.value,s=3,f++;;){if(f++,"delim"===b[f].type)break;l+=b[f].value,s++}f++,s++,l=l.replace("{",""),k=r.Parser._createToken(l,!0,"const","+"),b.splice(j,s),b.splice(j,0,k),q=b.length,f=j}}else k=r.Parser._createToken(")",!0,"delim","+"),b.splice(f,0,k),u--,q++}for(;0!==u;)k=r.Parser._createToken(")",!0,"delim","+"),b.splice(f+1,0,k),u--,q++;return b},_checkIfFunctionParanthesis:function(b){var c,d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,f=b.length,g=0,h=!1;for(c=f-1;c>=0;c--)if(d=b[c],e.ParsingProcedures._isClosingBracket(d.value))g++;else if(e.ParsingProcedures._isOpeningBracket(d.value)&&(g--,0===g&&0!==c)){if("^"===b[c-1].value&&"func"===b[c-2].type){h=!0;break}if("func"===b[c-1].type)h=!0;else if("delim"===b[c-1].type)continue;break}return h},_processPointEquation:function(b,c){var d,e,f,g,h=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,i=[],j=b.length;if("("===b[0].value&&")"===b[j-1].value){for(c.setSolution([]),i.push(b[0]),d=1;j>d;d++)if(f=b[d-1],e=b[d],")"===f.value&&","===e.value||")"===e.value&&d===j-1){if(d===j-1)i.push(e);else if(h.Parser._checkIfFunctionParanthesis(b.slice(0,d))){i.push(e);continue}if(g=h.Parser._checkIfPoint(i,c),c.isCanBeSolved()===!1||void 0===g)return;c.getSolution().push(g),i=[]}else i.push(e);return i.length>0&&c.getSolution().length>0?(c.setCanBeSolved(!1),void c.setErrorCode("CannotUnderstandThis")):void(c.getSolution().length>0&&c.setSpecie("point"))}},_checkIfPoint:function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=[],w=[],x=!0,y=b.length,z=0,A=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,B=-1,C=!1;if("("===b[0].value&&")"===b[y-1].value){for(d=1;y-1>d;d++){if(e=b[d],"func"===e.type)A.Parser._isCommaFunction(e.value)&&z++;else if(","===e.value){if(0===z){B=e.index,x=!1;continue}z--}x?v.push(e):w.push(e)}if(!x){if(p=new a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationData,q=new a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationData,p.setLatex(c.getLeftExpression().expression.substring(b[0].index+1,B),!0),f=c.getPivot(),null!==f&&(q.setPivot(f),p.setPivot(f)),g=c.getConstants(),q.setConstants(g,!0),p.setConstants(g,!0),h=c.getUnits(),q.setUnits(h,!0),p.setUnits(h,!0),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Parser.parseEquationToGetTokens(p),p.isCanBeSolved()===!1)return;if("number"!==p.getSpecie()&&"point"!==p.getSpecie()){if(a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Parser.processTokensWithRules(p),p.isCanBeSolved()===!1)return;a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Parser.generateTreeFromRules(p)}if(j=p.getSpecie(),i=p.getErrorCode(),"number"===j||"ConstantDeclaration"===i||"expression"===j){if("ConstantDeclaration"===i&&(C=!0),q.setLatex(c.getLeftExpression().expression.substring(B+1,b[y-1].index),!0),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Parser.parseEquationToGetTokens(q),q.isCanBeSolved()===!1)return;if("number"!==q.getSpecie()&&"point"!==q.getSpecie()){if(a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Parser.processTokensWithRules(q),q.isCanBeSolved()===!1)return;a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Parser.generateTreeFromRules(q)}l=q.getSpecie(),"number"===l||"expression"===l?(u=[p.getSolution(),q.getSolution()],c.setAccText("Point of "+p.getSolution()+" and "+q.getSolution()),$("#accessibility-display").html("The Accesibility string is "+c.getAccText())):(k=q.getErrorCode(),"ConstantDeclaration"===k?C=!0:(c.setCanBeSolved(!1),c.setErrorCode("CannotUnderstandThis")))}else c.setCanBeSolved(!1),c.setErrorCode("CannotUnderstandThis");if(C){if(c.setCanBeSolved(!1),c.setErrorCode("ConstantDeclaration"),c.setErrorData([]),m=c.getErrorData(),n=p.getErrorData(),null!==n)for(r=0,s=n.length,r;s>r;r++)t=n[r],-1===m.indexOf(t)&&m.push(t);if(o=q.getErrorData(),null!==o)for(r=0,s=o.length,r;s>r;r++)t=o[r],-1===m.indexOf(t)&&m.push(t)}}return u}},_parseExpression:function(b,c){var d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(d=e.Parser._generateTokens(b,c),c.isCanBeSolved()!==!1){if(d=e.Parser._processNegativeTokens(d,c,b.equationParameters),d.length<1)return c.setCanBeSolved(!1),void c.setErrorCode("CannotUnderstandThis");e.Parser._processPointEquation(d,c),c.isCanBeSolved()!==!1&&"point"!==c.getSpecie()&&(d=e.Parser._processFunctionPowers(d),d=e.Parser._addInvisibleCdotToTokens(d),e.Parser._adjustPostFixOperatorPowers(d),$("#left-column-container").width($("#button-container").width()+$("#equation").width()+$(".mathquill-editable").width()+50),b.tokens=d)}},_NEGATIVE_CASE_TYPES:{NONE:0,SINGLE:1,DOUBLE:2,PLUS_SINGLE:3,NEGATIVE:4},_processNegativeTokens:function(b,c,d){var e,f,g,h=[],i=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,j=/(\(|\[|\{|\+|\\cdot|,)/,k=b.length,l=i.Parser._NEGATIVE_CASE_TYPES.NONE,m=null;for(e=0;k>e;e++){if(f=b[e],"-"===f.value)null!==m?l===i.Parser._NEGATIVE_CASE_TYPES.NONE?"+"===m.value?l=i.Parser._NEGATIVE_CASE_TYPES.PLUS_SINGLE:null!==m&&null!==m.value.match(j)?l=i.Parser._NEGATIVE_CASE_TYPES.NEGATIVE:(d.operatorsList.push(f.value),l=i.Parser._NEGATIVE_CASE_TYPES.SINGLE,g=i.Parser._getFactoryToken(),g.value="+",g.isValid=!0,g.type="opr",g.sign="+",g.negativeCaseType=i.Parser._NEGATIVE_CASE_TYPES.NONE,h.push(g)):l=i.Parser._NEGATIVE_CASE_TYPES.DOUBLE:l=i.Parser._NEGATIVE_CASE_TYPES.NEGATIVE;else{switch(f.type){case"var":l===i.Parser._NEGATIVE_CASE_TYPES.NONE||l!==i.Parser._NEGATIVE_CASE_TYPES.DOUBLE&&l!==i.Parser._NEGATIVE_CASE_TYPES.PLUS_SINGLE&&l!==i.Parser._NEGATIVE_CASE_TYPES.NEGATIVE?d.variablesList.push(f.value):d.variablesList.push("-"+f.value);break;case"const":f.value!==c.getPivot()&&(l===i.Parser._NEGATIVE_CASE_TYPES.NONE||l!==i.Parser._NEGATIVE_CASE_TYPES.DOUBLE&&l!==i.Parser._NEGATIVE_CASE_TYPES.PLUS_SINGLE&&l!==i.Parser._NEGATIVE_CASE_TYPES.NEGATIVE?d.constantsList.push(f.value):d.constantsList.push("-"+f.value));break;case"digit":l===i.Parser._NEGATIVE_CASE_TYPES.NONE||l!==i.Parser._NEGATIVE_CASE_TYPES.DOUBLE&&l!==i.Parser._NEGATIVE_CASE_TYPES.PLUS_SINGLE&&l!==i.Parser._NEGATIVE_CASE_TYPES.NEGATIVE?d.digitsList.push(f.value):d.digitsList.push("-"+f.value);break;case"opr":d.operatorsList.push(f.value);break;case"func":d.functionsList.push(f.value)}h.push(f),f.negativeCaseType=l,l!==i.Parser._NEGATIVE_CASE_TYPES.NONE&&l!==i.Parser._NEGATIVE_CASE_TYPES.DOUBLE&&("+"===f.sign?f.sign="-":f.sign="+"),l=i.Parser._NEGATIVE_CASE_TYPES.NONE}m=f}return h},_adjustPostFixOperatorPowers:function(b){var c,d,e,f,g,h,i=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,j=["^","!","\\%"];for(c=0;c<b.length;c++)if(e=b[c],f=[],-1!==j.indexOf(e.value)&&0!==c)for(i.Parser._showConsole(i.Parser._debugFlag.common,"Checking for power sign at "+c,[]),d=c-1;d>=0;d--)if(g=b[d],"delim"!==g.type){if(i.Parser._showConsole(i.Parser._debugFlag.common,"Current left token is "+g+" stack is "+f,[]),!(f.length>0||"var"!==g.type&&"const"!==g.type&&"digit"!==g.type)){i.Parser._showConsole(i.Parser._debugFlag.common,"terminal found ignoring the sign "+g,[]),e.sign=g.sign,e.negativeCaseType=g.negativeCaseType,g.sign="+",g.negativeCaseType=0;break}}else if(0===f.length&&(h=!0),i.Parser._showConsole(i.Parser._debugFlag.common,"Recording bracket "+g.value,[]),i.ParsingProcedures.recordBracket(f,g.value),h===!0&&0===f.length){i.Parser._showConsole(i.Parser._debugFlag.common,"stealing the sign of "+g,[]),e.sign=g.sign,g.sign="+";break}},_printTokens:function(b,c){var d=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;d.Parser._showConsole(d.Parser._debugFlag.common,"******************************************************************",[]),d.Parser._showConsole(d.Parser._debugFlag.common,c+" All Tokens Are "+b.tokens,[]),d.Parser._showConsole(d.Parser._debugFlag.common,"******************************************************************",[])},_addInvisibleCdotToTokens:function(b){var c,d,e,f,g,h,i,j,k=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,l=["var","const","func"],m=["("],n={"var":{tokenTypes:["var","const","digit"],tokenValues:[")","!","}"]},"const":{tokenTypes:["var","const","digit"],tokenValues:["}",")","!","\\%"]},func:{tokenTypes:["var","const","digit"],tokenValues:[")","!","}","\\%"]},"(":{tokenTypes:["var","const","digit"],tokenValues:[")","!","}"]}},o=0,p=/^([0-9]+[\.])$/,q=k.Parser._getFactoryToken();for(q.type="opr",q.value="\\cdot",q.sign="+",q.isValid=!0,o=1;o<b.length;o++)if(c=b[o-1],d=b[o],e=-1!==l.indexOf(d.type),f=-1!==m.indexOf(d.value),(e||f)&&(i=e?d.type:d.value,-1!==n[i].tokenTypes.indexOf(c.type)||-1!==n[i].tokenValues.indexOf(c.value))){if("digit"===c.type&&null!==c.value.match(p))continue;if("("===d.value&&"}"===c.value){if(j=k.Parser._isFractionBrace(b.slice(0,o)),!j)continue;if(null!==k.Parser._checkLogToBasePowerCase(b.slice(0,o)))continue}g=b.slice(0,o),g.push(q),h=b.slice(o,b.length),b=g.concat(h),o++}return b},_isFractionBrace:function(b){var c,d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,f=b.length,g=0;for(c=f-1;c>=0;c--)if(d=b[c],e.ParsingProcedures._isOpeningBracket(d.value))g++;else if(e.ParsingProcedures._isClosingBracket(d.value))g--;else if(0===g&&("\\frac"===d.value||"\\sqrt"===d.value))return!0;return!1},_getFreeVarPower:function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,r={};if(b.isTerminal){j=null;for(j in c)o=0,b.value===j&&(o=1),r[j]=o}else{for(d=[],e=0,f=b.params.length,e;f>e;e++)d.push(q.Parser._getFreeVarPower(b.params[e],c));switch(b.name){case"+":for(g=0,h=d.length,g;h>g;g++){i=d[g],j=null;for(j in i)j in r?"c"!==r[j]&&("c"===i[j]||r[j]<i[j])&&(r[j]=i[j]):r[j]=i[j]}break;case"\\cdot":for(g=0,h=d.length,g;h>g;g++){i=d[g],j=null;for(j in i)j in r?"c"!==r[j]&&("c"===i[j]?r[j]=i[j]:r[j]+=i[j]):r[j]=i[j]}break;case"^":case"\\frac":j=null;for(j in d[1])0!==d[1][j]?r[j]="c":r[j]=d[0][j];k=!1,j=null;for(j in r)"c"===r[j]&&(k=!0),"^"===b.name&&r[j]<0&&(k=!0);if("^"===b.name){j=null;for(j in d[0])k&&d[1][j]>0?r[j]="c":d[0][j]>0&&(b.params[1].isTerminal===!0&&"digit"===b.params[1].type?(p=Number(q.TreeProcedures._getValueFromParam(b.params[1])),r[j]=0>p?"c":0===r[j]?p:r[j]*p):r[j]="c")}else{j=null;for(j in d[0])"c"!==r[j]&&(r[j]=d[0][j])}break;default:for(l=0,m=d.length,l;m>l;l++){n=d[l],j=null;for(j in n)n[j]>0||"c"===n[j]?r[j]="c":"c"!==r[j]&&(r[j]=0)}}}return r},_displayArrayOfObjects:function(b,c,d,e){var f,g,h,i,j,k=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(k.Parser._deploy!==!0)if(void 0!==b){for(void 0===e&&(e="black"),void 0===d&&(d="#777700"),f=$("#"+c),f.parent().css({border:"1px solid black"}),f.css({border:"1px solid","border-color":k.Parser._borderColor,position:"relative","overflow-x":"hidden"}),g=0,h=b.length,g;h>g;g++)i=b[g],j=$("<div>"+i+"</div>"),j.attr("class","tokens"),f.append(j);$(".tokens").css({"float":"left",border:"1px solid black",margin:"5px",padding:"5px","background-color":d,color:e,"font-weight":"bold"})}else k.Parser._showConsole(k.Parser._debugFlag.common,"The objects provided is undefined",[])},_generateAnalysis:function(b){var c,d,e,f,g,h=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,i=b.getLeftExpression().tokens,j=b.getRightExpression().tokens,k=b.getUnits(),l=b.getProfiles(),m=b.getDirectives();if(h.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("leftProductionRules"),g=h.Parser._recursiveDescentParser(b,i,0,0,[void 0],!1),h.Parser._deploy||(l[2]=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("leftProductionRules")),b.isCanBeSolved()!==!1&&(h.Parser._displayArrayOfObjects(g,"production-rules-display-left","#777700","white"),h.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("rightProductionRules"),c=h.Parser._recursiveDescentParser(b,j,0,0,[void 0],!1),h.Parser._deploy||(l[2]+=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("rightProductionRules")),b.isCanBeSolved()!==!1)){if(h.Parser._displayArrayOfObjects(c,"production-rules-display-right","#777700","white"),void 0===g||void 0===c)return b.setCanBeSolved(!1),b.setErrorCode("CannotUnderstandThis"),void h.Parser._showConsole(h.Parser._debugFlag.common,"%c[STAGE2 - FAIL]Left Prediction Rules Failed",[h.Parser._NSTYLE]);h.Parser._showConsole(h.Parser._debugFlag.common,"%c[STAGE2 - Success]Prediction rules Generated Left:"+g,[h.Parser._YSTYLE]),h.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("generateTree"),b.setLeftRoot(h.TreeProcedures.generateTree(g,0,k)),b.setRightRoot(h.TreeProcedures.generateTree(c,0,k)),h.Parser._deploy||(l[3]=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("generateTree")),e=b.getLeftRoot(),f=b.getRightRoot();var n=h.TreeProcedures._toAccessible(e).expression;if(b.getRhsAuto()!==!0&&(n+=" equal to "+h.TreeProcedures._toAccessible(f).expression),b.setAccText(n),$("#accessibility-display").html("The Accesibility string is "+n),"graphing"===m.FDFlagMethod&&"frac"===b.getFdFlag()&&("\\frac"===e.name||"do"===e.name&&"\\frac"===e.params[0].name)&&(b.setFdFlag("decimal"),"do"===e.name?h.Parser._checkIfFracHasNonFracChilds(e.params[0],b):h.Parser._checkIfFracHasNonFracChilds(e,b)),"calculator"===m.FDFlagMethod&&b.setFdFlag(0===h.Parser._getAnalysisForFD(e)?"frac":"decimal"),h.Parser._deploy||a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("simplify"),e.isTerminal||e.simplify(b),f&&!f.isTerminal&&f.simplify(b),h.Parser._deploy||(l[4]=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getProcessingTime("simplify")),e.isTerminal&&"digit"===e.type&&null!==f&&!b.getRhsAuto()&&f.isTerminal&&"digit"===f.type)return b.setCanBeSolved(!1),b.setErrorString("Try adding some free variables"),void b.setErrorCode("CannotUnderstandThis");if(h.Parser._showConsole(h.Parser._debugFlag.common,"%c[STAGE4 - SUCCESS]Tree Simplified",[h.Parser._YSTYLE]),h.Parser._deploy||h.Parser._printLatex(e,4,!0),"expression"!==b.getSpecie()&&h.TreeProcedures.combineLeftRightTree(b),d=e,void 0===e)return b.setCanBeSolved(!1),b.setErrorCode("CannotUnderstandThis"),void h.Parser._showConsole(h.Parser._debugFlag.common,"%c[STAGE3 - FAIL]Left Equation Tree Generation Failed",[h.Parser._NSTYLE]);h.Parser._showConsole(h.Parser._debugFlag.common,"%c[STAGE3 - Success]Equation Tree Generated",[h.Parser._YSTYLE]),h.Parser._deploy||h.Parser._printLatex(d,3,!0),"expression"===b.getSpecie()&&b.setSolution(h.TreeProcedures._substituteParamVariableAndGetValue(b.getLeftRoot(),b.getConstants())),h.Parser._deploy||h.TreeProcedures._toLatex(d)}},_checkIfFracHasNonFracChilds:function(b,c){if("frac"!==c.getFdFlag()){var d,e,f,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(!b.isTerminal)if("\\frac"===b.name){for(f=b.params,e=f.length,d=0;e>d;d++)if(g.Parser._checkIfFracHasNonFracChilds(f[d],c),"frac"===c.getFdFlag())return}else c.setFdFlag("frac")}},_getAnalysisForFD:function(b){var c,d,e,f=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,g=1;if(b.isTerminal)return"digit"===b.type?-1!==b.value.toString().indexOf(".")?NaN:1:"const"===b.type&&("e"===b.value||"\\pi"===b.value)?NaN:1;if(f.TreeProcedures.isOperator(b.name)||"do"===b.name){for(d=b.params.length,c=0;d>c;c++)if(e=f.Parser._getAnalysisForFD(b.params[c]),g=e*g,isNaN(g))return NaN;return g}return"\\frac"===b.name?0:NaN},_showRules:function(){var a=window.open("","","width=700,height=700"),b=$("<textarea>"+$("#rules").text()+"</textarea>");b.css({width:"600px",height:"600px"}),$(a.document.body).append(b)},_printLatex:function(b,c,d){var e,f,g,h,i,j,k,l,m=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;m.Parser._deploy!==!0&&(e={0:"Preprocessing",1:"Token Generation",2:"Create Production Rules",3:"Generate Equation Tree",4:"Simplify",5:"Find Equation Solvability",6:"Expand Equation",7:"Convert to Quadratic Form",8:"Solve"},f=$("<div></div>"),h=$("#display-outter-container"),h.append(f),g=$("<div></div>"),g.attr("id","header"+c).css({"font-weight":"bold"}).html(e[c]),f.attr("id","stage-number"+c).append(g).css({border:"1px solid black",padding:"10px 5px 5px 10px",margin:"25px 5px 5px 5px"}),i=m.TreeProcedures._toLatex(b),j=$("<span></span>"),j.attr("id","stage"+c).css({border:"1px solid","border-color":m.Parser._borderColor,margin:"5px 5px 5px 5px",padding:"5px 5px 5px 5px"}),f.append(j),$("#stage"+c).append(i).mathquill(),f.append("<br/>"),d&&(k=$("<canvas></canvas>"),k.attr("id","canvas-stage"+c).css({border:"1px solid","border-color":m.Parser._borderColor}),f.append(k),l=["canvas-stage"+c],m.Parser._displayTree(b,l),m.Parser._showConsole(m.Parser._debugFlag.common,"The latex string is "+i,[])))},_recursiveDescentParser:function(b,c,d,e,f,g){if(b.isCanBeSolved()!==!1&&0!==c.length){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,B=c[d],C=d,D=A.ParsingProcedures.getPredictionStacksForToken(B,"E",g);if(void 0===D)return A.Parser._showConsole(A.Parser._debugFlag.common,"############################### ERROR ##########################",[]),A.Parser._showConsole(A.Parser._debugFlag.common,"no rules found for E ->"+B.value,[]),b.setCanBeSolved(!1),void b.setErrorCode("CannotUnderstandThis");for(h=d,i=0,l=0,p=[],q=[],y=D.length,A.Parser._showConsole(A.Parser._debugFlag.rules,"----------------------Begin recursion "+e+"------------------ with lookahead "+f,[]),k=0;y>k;k++)if(x=D[k],r=[],j=[],g?(A.ParsingProcedures.cloneStringStack(A.RangeProductionRules.rangeRules[x],j),A.Parser._showConsole(A.Parser._debugFlag.rules,"for "+x+" rules are "+A.RangeProductionRules.rangeRules[x],[])):(A.ParsingProcedures.cloneStringStack(A.Parser._productions.productionRules[x],j),A.Parser._showConsole(A.Parser._debugFlag.rules,"for "+x+" rules are "+A.Parser._productions.productionRules[D[k]],[])),r.push(x),A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[Predict "+e+"] Level "+e+" by rule "+x+" Processing prediction "+j,[A.Parser._HSTYLE]),h=d,i=0,o=!0,s=!1,u=A.ParsingProcedures.isStackInfinite(j),u!==!0||A.ParsingProcedures.verifyStackWithLookahead(j,f)!==!1){for(;i<j.length;){if(n=A.ParsingProcedures.peekInPredictionStack(j,i),B=c[h],A.Parser._showConsole(A.Parser._debugFlag.rules,B+" <> "+n+" >> "+A.ParsingProcedures.isTokenSame(B,n),[]),A.ParsingProcedures.isTokenSame(B,n))r.push(B);else if(A.ParsingProcedures.isNonTerminal(n)){if(A.Parser._showConsole(A.Parser._debugFlag.rules,"TErminal Node...going in...stack so far "+r,[]),w=A.ParsingProcedures.pushAllLookAheads(f,j,i+1),A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[PAUSE "+e+"]",[A.Parser._BLUE_STYLE]),t=A.Parser._recursiveDescentParser(b,c,h,e+1,f,g),b.isCanBeSolved()===!1)return;for(m=0;w>m;m++)f.pop();if(A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[RESUME "+e+"]>>>>Recursion level "+e+" resumes with solution "+t,[A.Parser._BLUE_STYLE]),void 0===t){A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[FAIL "+e+"] prediction "+j+" is invalid...REJECTING at "+r,[A.Parser._NSTYLE]),o=!1;break}for(A.Parser._showConsole(A.Parser._debugFlag.rules," recursion will resume from index "+t.tokenPointer,[]),h=t.tokenPointer,l=0;l<t.length;l++)r.push(t[l])}else{if(!(u&&s&&A.ParsingProcedures.isTermInfinite(j[i]))){o=!1,A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[FAIL "+e+"] STack match failed...DISCARDING stack!!! "+j,[A.Parser._NSTYLE]);break}v=j[i],i>=j.length?(A.Parser._showConsole(A.Parser._debugFlag.rules,"Finished chasing recursive term "+v+" from total stack :"+j,[]),s=!1):(o=!0,A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[ACCEPT "+e+"]Stack matched so far...dumping ALL infinite term and breaking: "+j+" recursionIndex :: "+e,[A.Parser._YSTYLE]))}if(i++,h++,u&&A.ParsingProcedures.isTermInfinite(j[i]))if(z=c[h],A.Parser._showConsole(A.Parser._debugFlag.rules,"trying to match peek from "+j[i]+" >> "+A.ParsingProcedures._getPeekValue(j[i])+" with next token "+z,[]),void 0!==z)if(A.ParsingProcedures._getPeekValue(j[i])!==c[h].value){if(s===!1){o=!1,A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[FAIL "+e+"] "+j[i]+" is NOT used...DISCARDING stack!!! "+j,[A.Parser._NSTYLE]);break}if(i+1>=j.length){if(A.ParsingProcedures.checkWithLookAhead(c[h],f)){o=!0;break}o=!1,A.Parser._showConsole(A.Parser._debugFlag.rules," All recursive terms are used and exhausted...breaking the chain for stack "+j+" and lookahead "+f,[]);break}A.Parser._showConsole(A.Parser._debugFlag.rules,"match FAILED so moving on to "+j[i+1],[]),s=!0,A.ParsingProcedures.expandRecursiveStack(j,i+1),i++}else A.Parser._showConsole(A.Parser._debugFlag.rules,"match success expanding "+j[i],[]),s=!0,A.ParsingProcedures.expandRecursiveStack(j,i);else A.Parser._showConsole(A.Parser._debugFlag.rules,"All tokens are over...No need to expand stack "+j,[]);if(h>=c.length&&i<j.length){A.Parser._showConsole(A.Parser._debugFlag.common,"Checking when tokens are over and stack is not: recursive is "+u,[]),u?s&&i===j.length-1?(A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[ACCEPT "+e+"] prediction accepted "+j,[A.Parser._YSTYLE]),o=!0):(o=!1,A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[FAIL "+e+"]Tokens are finished but there are unexpanded recursive terms...rejecting the prediction "+j+" at index "+i,[A.Parser._NSTYLE]),A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[FAIL]There was an error in syntax of equation. We could not find "+j[i],[A.Parser._NSTYLE])):(A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[FAIL "+e+"]Tokens are finished when prediction stack is NOT...REJECTING the prediction",[A.Parser._NSTYLE]),o=!1);break}if(i>=j.length&&h<c.length){A.Parser._showConsole(A.Parser._debugFlag.rules,"Prediction Stack over: Checking with lookahead "+c[h]+" <> "+f,[]),A.ParsingProcedures.checkWithLookAhead(c[h],f)?(A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[ACCEPT "+e+"]Prediction stack finished and lookahead matches...ACCEPTING the prediction by rule "+D[k],[A.Parser._YSTYLE]),o=!0):(A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[FAIL "+e+"]Prediction stack finished and lookahead doesnt match...REJECTING the prediction by rule "+D[k],[A.Parser._NSTYLE]),o=!1);break}}if(o===!0){A.Parser._showConsole(A.Parser._debugFlag.rules,"checking if the accepted solution is final :: "+A.ParsingProcedures.checkWithLookAhead(B,f),[]),A.Parser._showConsole(A.Parser._debugFlag.rules,"checking if the accepted solution is final :: "+A.ParsingProcedures.checkWithLookAhead(B,f),[]),A.Parser._showConsole(A.Parser._debugFlag.rules,"Prediction accepted is "+r,[]),r.tokenPointer=h-1,q.push(r);break}}else A.Parser._showConsole(A.Parser._debugFlag.rules,"%c[FAIL "+e+"]Rejecting STACk "+j+" because we cant pursue same GOAL again...",[A.Parser._NSTYLE]);if(A.Parser._showConsole(A.Parser._debugFlag.rules,q.length+" Solutions found ....",[]),A.Parser._showConsole(A.Parser._debugFlag.rules,"----------------------End recursion "+e+"------------------"),q.length>1)for(A.Parser._showConsole(A.Parser._debugFlag.common,"=================================ACCEPTED PREDICTIONS ARE MORE THAN ONE!!!!==================================after "+C,[]),m=0;m<q.length;m++)A.Parser._showConsole(A.Parser._debugFlag.common,"Prediction is "+q[m],[]);else if(1===q.length)return q[0]}},_displayTree:function(b,c){var d,e,f,g,h=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,i=0,j=[],k=null;if(d=window.innerWidth-($("#button-container").width()+$("#equation").width()+$(".mathquill-editable").width()+100),$("#canvasContainer").width(d),e=[],"object"==typeof c)e=c;else for(f=1;f<arguments.length;f++)e[f-1]=arguments[f];for(g=e.length;g>i;i++)"string"==typeof e[i]&&(j[i]=new paper.PaperScope,k=document.getElementById(e[i]),j[i].setup(k),h.Parser._nodeDisplay(b,!0,j[i],k))},_nodeDisplay:function(b,c,d,e){var f,g,h,i,j,k,l=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,m=0,n=0,o=l.Parser._getTextWidth($("<div></div>").html(b.toString()),!0),p=[0],q=0;if(c){for(g=[],b.isTerminal||(n=b.params.length),l.Parser._nodeCounter(b,q.toString(),g,p),l.Parser._totalNodeCounter(g),h=null,f=0;n>f;f++)h=l.Parser._getTextWidth($("<div></div>").html(b.params[f].toString()),!0),h>o&&(o=h);for(i=1,f=0;f<g.length;f++)2===g[f].name.length&&(i+=g[f].totalNode);j=p[0]*(100+o)+100,k=30*i,$(e).height(k),$(e).width(j),paper=d,paper.view.viewSize=[j,k],l.Parser._textOnCanvas(b.toString(),m.toString(),o,g),l.Parser._subnodeDisplay(b,m.toString(),o,g),l.Parser._textOnCanvas(b.toString(),m.toString(),o,g),l.Parser._arrowGenerator(),paper.view.draw()}},_nodeCounter:function(b,c,d,e){var f,g,h=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,i=0;if(b.isTerminal)f={name:c,childNode:0,totalNode:0},d.push(f);else{for(i=0,g=b.params.length;g>i;i++)h.Parser._nodeCounter(b.params[i],c+i,d,e);"0"!==c&&(f={name:c,childNode:g,totalNode:0},d.push(f)),e[0]++}},_totalNodeCounter:function(a){for(var b,c,d,e,f,g=0,h=a.length;h>g;g++){for(b=a[g].name,e=b.length,d=b.substring(0,e-1),c=g+1;h>c;c++)if(a[c].name===d){0!==a[g].totalNode?a[c].totalNode+=a[g].totalNode:(f=a[g].childNode,0===f&&(f=1),a[c].totalNode=a[c].totalNode+f);break}0===a[g].childNode&&(a[g].totalNode=1)}},_subnodeDisplay:function(b,c,d,e){var f,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,h=0,i=0;if(!b.isTerminal&&(f=b.params.length,0!==f))for(;f>h;h++)g.Parser._subnodeDisplay(b.params[h],c+h,d,e),i=b.params[h].toString(),g.Parser._textOnCanvas(i,c+h,d,e)},_textOnCanvas:function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,u=c.length,v=0;for(h=(u-1)*(100+d);u>v;v++)switch(v){case 0:i=20;break;default:for(k=c.substring(0,v+1),l=k.length,o=k[l-1],p=parseInt(o,10),f=0,f=p-1;f>=0;f--)for(m=k.split(""),m[l-1]=f.toString(),n=m.join(""),g=0,g=0;g<e.length;g++)if(e[g].name===n){i+=30*e[g].totalNode;break}}j=d+30,q=new Path.Rectangle({point:[h,i-12],size:[j,20],strokeWidth:2,strokeColor:"#000000"}),q.subNodeRoot=c,r=t.Parser._getTextWidth($("<div></div>").html(b),!0),s=(j-r)/2,b=new PointText({point:[h+s,i],content:b,fontSize:12,fillColor:"black"})},_arrowGenerator:function(){for(var a,b,c,d=paper.project.activeLayer.children,e=d.length,f=0,g=new Point,h=new Point,i=new Point;e>f;f++)if(f%2===0)for(a=d[f].subNodeRoot,a=a.substring(0,a.length-1),b=f;e>b;b++)d[b].subNodeRoot===a&&(g.x=(d[f].segments[0].point.x+d[f].segments[1].point.x)/2,g.y=(d[f].segments[0].point.y+d[f].segments[1].point.y)/2,h.x=(d[b].segments[2].point.x+d[b].segments[3].point.x)/2,h.y=(d[b].segments[2].point.y+d[b].segments[3].point.y)/2,g.y!==h.y?(i.x=(h.x+g.x)/2,i.y=h.y,c=new Path({segments:[i,[i.x,g.y],g],strokeWidth:2,strokeColor:"#000000"})):c=new Path({segments:[g,h],strokeWidth:2,strokeColor:"#000000"}))},_getTextWidth:function(a,b){b&&$("body").append(a);var c,d=a.html(),e="<span>"+d+"</span>";return a.html(e),c=a.find("span:first").width(),a.html(d),b&&a.detach(),c},_showConsole:function(a,b,c){return}}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.TreeProcedures=Backbone.Model.extend({},{_mathFunctions:a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.MathFunctions,_productions:a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Productions,OPERATOR_TEXT:{ADD:" plus ",SUBTRACT:" minus ",MULTIPLY:" multiplied by ",NEGATIVE:" negative ",DIVIDE:" divided by ",SIN:"sine of ",COS:"cos of ",TAN:"tan of ",CSC:"cosec of ",FACTORIAL:" factorial",NATURAL_LOG:"Natural log of ","\\pi":"Pi",e:" Euler’s constant ",RECIPROCAL:"Reciprocal of ",ABS:"Absolute value of ",SIN_INV:"Inverse sine of ",COS_INV:"Inverse cos of ",TAN_INV:"Inverse tan of ",CSC_INV:"Inverse cosec of ",INV:"Inverse ",SQUARE:" squared",CUBE:" cube",POWER:" raised to ",SQUARE_ROOT:"Square root of ",CUBE_ROOT:"Cube root of ",ROOT:"root of ",OPEN_BRACKET:"open bracket ",CLOSE_BRACKET:" close bracket ",PERCENT:" Percentage",TH:"th ",RD:"rd ",ST:"st ",ND:"nd "},_toLatex:function(b){var c,d,e,f,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(b.isTerminal!==!1)return"+"===b.sign?b.value:b.value<0?-1*b.value:b.sign+b.value;for(c=[],e=0;e<b.params.length;e++)c.push(g.TreeProcedures._toLatex(b.params[e])),g.Parser._showConsole(g.Parser._debugFlag.common,c,[]);switch(d="","-"===b.sign&&(d="-"),b.name){case"do":return d+=c[0];case"^":return d+=b.params[0].isTerminal===!0?c[0]:g.ParsingProcedures.getOperatorPrecedenceIndex(b.name)>g.ParsingProcedures.getOperatorPrecedenceIndex(b.params[0].name)?"\\left("+c[0]+"\\right)":c[0],d+=b.params[1].isTerminal===!0?"^"+c[1]:g.ParsingProcedures.getOperatorPrecedenceIndex(b.name)>g.ParsingProcedures.getOperatorPrecedenceIndex(b.params[1].name)?"^\\left("+c[1]+"\\right)":"^"+c[1];case"+":for(d+=c[0],f=1;f<c.length;f++)d+="+"+c[f];return d;case"\\cdot":for(d+=b.params[0].isTerminal===!1&&g.ParsingProcedures.getOperatorPrecedenceIndex(b.name)>g.ParsingProcedures.getOperatorPrecedenceIndex(b.params[0].name)?"\\left("+c[0]+"\\right)":c[0],f=1;f<c.length;f++)d+=b.params[f].isTerminal===!0?"\\cdot "+c[f]:g.ParsingProcedures.getOperatorPrecedenceIndex(b.name)>g.ParsingProcedures.getOperatorPrecedenceIndex(b.params[f].name)?"\\cdot \\left("+c[f]+"\\right)":"\\cdot "+c[f];return d;case"\\frac":return d+="\\frac {"+c[0]+"}{"+c[1]+"}";case"\\sqrt":return d="",d+=b.params[0].isTerminal===!1?"\\sqrt [\\left("+c[0]+"\\right)]":"\\sqrt ["+c[0]+"]",d=b.params[1].isTerminal===!1?d+" {\\left("+c[1]+"\\right)}":d+" {"+c[1]+"}";case"\\log_":return d="",d+=b.params[0].isTerminal===!1?"\\log_{\\left("+c[0]+"\\right)}":"\\log_{"+c[0]+"}",d=d+" \\left("+c[1]+"\\right)";case"\\log":case"\\ln":case"\\sin":case"\\cos":case"\\tan":case"\\csc":case"\\sec":case"\\cot":case"\\arcsin":case"\\arccos":case"\\arctan":case"\\arccsc":case"\\arcsec":case"\\arccot":case"\\sinh":case"\\cosh":case"\\tanh":case"\\csch":case"\\sech":case"\\coth":return d+=b.params[0].isTerminal===!1?b.name+" \\left("+c[0]+"\\right)":b.name+" "+c[0];case"\\ceil":case"\\floor":case"\\round":case"\\abs":case"\\exp":return d+=b.name+" \\left("+c[0]+"\\right)";case"!":return d="",d=b.params[0].isTerminal===!1?"\\left("+c[0]+"\\right)!":c[0]+"!";case"\\lcm":case"\\gcd":case"\\mod":case"\\min":case"\\max":case"\\nCr":case"\\nPr":return d+=b.params[0].isTerminal===!1?b.name+" \\left( \\left( "+c[0]+"\\right) , ":b.name+" \\left( "+c[0]+" , ",d+=b.params[1].isTerminal===!1?" \\left( "+c[1]+"\\right) \\right)":c[1]+"\\right)";case"\\prod":case"\\sum":return d+=b.params[0].isTerminal===!1?b.name+"{n=\\left("+c[0]+"\\right)}^":b.name+"{n="+c[0]+"}^",d+=b.params[1].isTerminal===!1?"{ \\left("+c[1]+"\\right)}":"{"+c[1]+"}",d+=b.params[2].isTerminal===!1?" \\left("+c[2]+"\\right)":c[2];case"\\%":return d+=b.params[0].isTerminal?b.params[0].value+b.name:c[0]+b.name}},getNumberPostFix:function(b){
var c,d,e,f=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,g=f.TreeProcedures.OPERATOR_TEXT;if(isNaN(b)===!0)return"";if(c=b.toString(),d=c.length,-1!==c.indexOf(".")||"1"===c.charAt(d-2))return g.TH;switch(e=c.charAt(c.length-1)){case"1":return g.ST;case"2":return g.ND;case"3":return g.RD;default:return g.TH}},_toAccessible:function(b){var c,d,e,f=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,g={negativeCaseType:null,expression:""},h=f.TreeProcedures.OPERATOR_TEXT;if(g.negativeCaseType=void 0===b.negativeCaseType?0:b.negativeCaseType,b.isTerminal!==!1)return"+"===b.sign?("digit"===b.type?void 0!==b.constantSubstituted?g.expression=h[b.constantSubstituted]:g.expression=f.TreeProcedures._getAccessibleStringForNumber(b.value):g.expression=b.value,g):("digit"===b.type?void 0!==b.constantSubstituted?b.negativeCaseType!==f.Parser._NEGATIVE_CASE_TYPES.SINGLE&&b.negativeCaseType!==f.Parser._NEGATIVE_CASE_TYPES.NONE?g.expression=h.NEGATIVE+h[b.constantSubstituted]:g.expression=h[b.constantSubstituted]:b.negativeCaseType!==f.Parser._NEGATIVE_CASE_TYPES.SINGLE&&b.negativeCaseType!==f.Parser._NEGATIVE_CASE_TYPES.NONE?g.expression=h.NEGATIVE+f.TreeProcedures._getAccessibleStringForNumber(b.value):g.expression=f.TreeProcedures._getAccessibleStringForNumber(b.value):g.expression=h.NEGATIVE+b.value,g);for(c=[],d=0;d<b.params.length;d++)c.push(f.TreeProcedures._toAccessible(b.params[d])),f.Parser._showConsole(f.Parser._debugFlag.common,c,[]);switch(g.expression="",g.negativeCaseType===f.Parser._NEGATIVE_CASE_TYPES.NEGATIVE&&(g.expression=h.NEGATIVE),b.name){case"do":return"{"==b.value||"}"==b.value?g.expression="":b.params[0].isTerminal===!1&&"do"!==b.params[0].name?g.expression+=h.OPEN_BRACKET+c[0].expression+h.CLOSE_BRACKET:g.expression+=c[0].expression,g;case"^":return b.params[0].isTerminal===!0?g.expression+=c[0].expression:f.ParsingProcedures.getOperatorPrecedenceIndex(b.name)>f.ParsingProcedures.getOperatorPrecedenceIndex(b.params[0].name)?g.expression+=c[0].expression:g.expression+=c[0].expression,b.params[1].isTerminal===!0?2===Number(b.params[1].value)?g.expression+=h.SQUARE:3===Number(b.params[1].value)?g.expression+=h.CUBE:g.expression+=h.POWER+c[1].expression:f.ParsingProcedures.getOperatorPrecedenceIndex(b.name)>f.ParsingProcedures.getOperatorPrecedenceIndex(b.params[1].name)?g.expression+=h.POWER+c[1].expression:g.expression+=h.POWER+c[1].expression,g;case"+":for(g.expression+=c[0].expression,e=1;e<c.length;e++)switch(c[e].negativeCaseType){case f.Parser._NEGATIVE_CASE_TYPES.NONE:case f.Parser._NEGATIVE_CASE_TYPES.NEGATIVE:g.expression+=h.ADD+c[e].expression;break;case f.Parser._NEGATIVE_CASE_TYPES.SINGLE:g.expression=g.expression+h.SUBTRACT+c[e].expression.replace("-","");break;case f.Parser._NEGATIVE_CASE_TYPES.DOUBLE:g.expression+=h.SUBTRACT+h.NEGATIVE+c[e].expression;break;case f.Parser._NEGATIVE_CASE_TYPES.PLUS_SINGLE:g.expression+=h.ADD+c[e].expression.replace("-","")}return g;case"\\cdot":for(b.params[0].isTerminal===!1&&f.ParsingProcedures.getOperatorPrecedenceIndex(b.name)>f.ParsingProcedures.getOperatorPrecedenceIndex(b.params[0].name)?g.expression+="("+c[0].expression+")":g.expression+=c[0].expression,e=1;e<c.length;e++)b.params[e].isTerminal===!0?g.expression+=h.MULTIPLY+c[e].expression:f.ParsingProcedures.getOperatorPrecedenceIndex(b.name)>f.ParsingProcedures.getOperatorPrecedenceIndex(b.params[e].name)?g.expression+=h.MULTIPLY+c[e].expression:g.expression+=h.MULTIPLY+c[e].expression;return g;case"\\frac":return b.params[0].isTerminal===!1?g.expression+=h.OPEN_BRACKET+c[0].expression+h.CLOSE_BRACKET:g.expression+=c[0].expression,g.expression+=h.DIVIDE,b.params[1].isTerminal===!1?g.expression+=h.OPEN_BRACKET+c[1].expression+h.CLOSE_BRACKET:g.expression+=c[1].expression,g;case"\\sqrt":return g.expression="",b.params[0].isTerminal===!0?2===Number(b.params[0].value)?g.expression+=h.SQUARE_ROOT:3===Number(b.params[0].value)?g.expression+=h.CUBE_ROOT:g.expression+=c[0].expression+f.TreeProcedures.getNumberPostFix(c[0].expression)+h.ROOT:g.expression+=c[0].expression+f.TreeProcedures.getNumberPostFix(c[0].expression)+h.ROOT,b.params[1].isTerminal===!1?g.expression+=h.OPEN_BRACKET+c[1].expression+h.CLOSE_BRACKET:g.expression+=c[1].expression,g;case"\\log_":return g.expression="",g.expression+="Log of ",g.expression+=c[1].expression,g.expression+=" to the base "+c[0].expression,g;case"\\log":return g.expression+="Log of "+c[0].expression+" to the base 10",g;case"\\ln":return g.expression+=h.NATURAL_LOG+c[0].expression,g;case"\\sin":return b.params[0].isTerminal?g.expression+=h.SIN+c[0].expression:g.expression+=h.SIN+h.OPEN_BRACKET+c[0].expression+h.CLOSE_BRACKET,g;case"\\csc":return b.params[0].isTerminal?g.expression+=h.CSC+c[0].expression:g.expression+=h.CSC+h.OPEN_BRACKET+c[0].expression+h.CLOSE_BRACKET,g;case"\\cos":case"\\tan":case"\\sec":case"\\cot":case"\\sinh":case"\\cosh":case"\\tanh":case"\\csch":case"\\sech":case"\\coth":case"\\ceil":case"\\floor":case"\\round":case"\\exp":return b.params[0].isTerminal?g.expression+=b.name.substring(1)+" of "+c[0].expression:g.expression+=b.name.substring(1)+" of "+h.OPEN_BRACKET+c[0].expression+h.CLOSE_BRACKET,g;case"\\abs":return b.params[0].isTerminal?g.expression+=h.ABS+c[0].expression:g.expression+=h.ABS+h.OPEN_BRACKET+c[0].expression+h.CLOSE_BRACKET,g;case"\\arcsin":return g.expression+=h.SIN_INV+c[0].expression,g;case"\\arccsc":return g.expression+=h.CSC_INV+c[0].expression,g;case"\\arccos":case"\\arctan":case"\\arcsec":case"\\arccot":return g.expression+=h.INV+b.name.replace("\\arc","")+" of "+c[0].expression,g;case"!":return g.expression+=c[0].expression+h.FACTORIAL,g;case"\\lcm":case"\\gcd":case"\\mod":case"\\min":case"\\max":case"\\nCr":case"\\nPr":return g.expression+=f.TreeProcedures._getAccessibleName(b.name)+" of "+c[0].expression+" and "+c[1].expression,g;case"\\prod":case"\\sum":return g.expression+=b.name.replace("\\","")+" from "+c[0].expression+" equal to ",b.params[1].isTerminal===!1?g.expression+=h.OPEN_BRACKET+c[1].expression+h.CLOSE_BRACKET:g.expression+=c[1].expression,g.expression+=" to ",b.params[2].isTerminal===!1?g.expression+=h.OPEN_BRACKET+c[2].expression+h.CLOSE_BRACKET:g.expression+=c[2].expression,g.expression+=" of ",g.expression+=c[3].expression,g;case"\\%":return g.expression+=c[0].expression+h.PERCENT,g}},_DECIMAL_POINT:".",_getAccessibleStringForNumber:function(b){var c,d,e,f,g,h="",i=!1,j=0,k=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(isNaN(b)===!0)return b;if(c=b.toString(),-1!==c.indexOf(k.TreeProcedures._DECIMAL_POINT)&&(g=c.split(k.TreeProcedures._DECIMAL_POINT),i=!0,c=g[0]),e=c.length,4>e)return b;for(f=e-1;f>=0;f--)(3===d||d>3&&(d-(3+j))%3===0)&&(h=","+h,j++),h=c.charAt(f)+h,d=h.length;return i&&(h+=k.TreeProcedures._DECIMAL_POINT+g[1]),h},_getAccessibleName:function(a){var b={"\\lcm":"least common multiplier","\\gcd":"greatest common divisor","\\mod":"modulas","\\min":"minimum","\\max":"maximum","\\nCr":"combinations","\\nPr":"permutations","\\ceil":"ceil value","\\floor":"floor value","\\round":"rounded value","\\abs":"absolute value","\\exp":"exponential value"};return void 0===b[a]?"":b[a]},_clone:function(b){var c,d,e,f=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(b.isTerminal===!0)c=f.TreeProcedures._getParseTreeTerminalObject(void 0,b.type,b.sign,b.units),c.isEmpty=b.isEmpty,c.value=b.value;else{for(c=f.TreeProcedures._getParseTreeNodeObject(void 0,b.name,b.sign,void 0),d=[],e=0;e<b.params.length;e++)c._addParam(f.TreeProcedures._clone(b.params[e]));c.allTermsDigits=b.allTermsDigits,c.isEmpty=b.isEmpty}return c},convertToSolvableForm:function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;for(c=b.getLeftRoot(),d=b.getFunctionVariable(),e=b.getParamVariable(),c.expand(d,b),y.Parser._showConsole(y.Parser._debugFlag.common,"%c[STAGE6 - Complete]Expansion Complete",[y.Parser._YSTYLE]),y.Parser._deploy||y.Parser._printLatex(c,6,!0),y.Parser._deploy||y.Parser._showConsole(y.Parser._debugFlag.common,"%c[CHECKPOINT] after expansion... "+y.TreeProcedures._toLatex(c),[y.Parser._BLUE_STYLE]),c.isTerminal===!1&&"+"===c.name?k=y.TreeProcedures._extractAllParams(c):(k=[],k.push(y.TreeProcedures._clone(c)),y.TreeProcedures._removeAllParams(c)),l=[],m=[],n=[];k.length>0;){if(f=y.TreeProcedures._getFunctionVariableSegregationIndex(k[0],d),void 0===f)return void y.Parser._showConsole(y.Parser._debugFlag.common,"%c[FAIL - STAGE7]CANT CONVERT THIS EQUATION TO SOLVABLE FORM>>> SOMETHING IS WRONG",[y.Parser._NSTYLE]);switch(y.Parser._showConsole(y.Parser._debugFlag.convert2q,"Segregation index is "+f,[]),f){case 2:g=k.shift(),y.TreeProcedures._commonOutFunctionVariable(g,d),l.push(g);break;case 1:g=k.shift(),y.TreeProcedures._commonOutFunctionVariable(g,d),m.push(g);break;case 0:n.push(k.shift());break;default:return void y.Parser._showConsole(y.Parser._debugFlag.common,"%c[FAIL - STAGE7]CANT CONVERT THIS EQUATION TO SOLVABLE FORM>>> SOMETHING IS WRONG",[y.Parser._NSTYLE])}}if(l.length>0){if(r=y.TreeProcedures._getParseTreeNodeObject(void 0,"\\cdot","+",void 0),o=y.TreeProcedures._getParseTreeNodeObject(r,"^","+",void 0),p=y.TreeProcedures._getParseTreeTerminalObject(o,"var","+"),p.value=d,q=y.TreeProcedures._getParseTreeTerminalObject(o,"digit","+"),q.value=2,l.length>1)for(h=y.TreeProcedures._getParseTreeNodeObject(r,"+","+",void 0);l.length>0;)h._addParam(l.shift());else h=l.shift(),r._addParam(h);h.isTerminal===!1&&h.simplify(b)}if(m.length>0){if(s=y.TreeProcedures._getParseTreeNodeObject(void 0,"\\cdot","+",void 0),p=y.TreeProcedures._getParseTreeTerminalObject(s,"var","+"),p.value=d,m.length>1)for(i=y.TreeProcedures._getParseTreeNodeObject(s,"+","+",void 0);m.length>0;)i._addParam(m.shift());else i=m.shift(),s._addParam(i);i.isTerminal===!1&&i.simplify(b)}if(n.length>0){if(n.length>1)for(j=y.TreeProcedures._getParseTreeNodeObject(void 0,"+","+",void 0);n.length>0;)j._addParam(n.shift());else j=n.shift();j.isTerminal===!1&&j.simplify(b)}for(u=[r,s,j],v=0,t=0;t<u.length;t++)void 0!==u[t]&&(v++,w=u[t]);if(v>0)for(y.TreeProcedures._convertTreeNodeTo(c,"+"),t=0;t<u.length;t++)void 0!==u[t]&&c._addParam(u[t]);else y.TreeProcedures._convertTreeNodeTo(c,w);b.setA(h),b.setB(i),b.setC(j),b.setFunctionCode(y.TreeProcedures._getMobileFunction(b)),b.setParamVariableOrder(void 0!==b.getA()?2:1),void 0!==h?y.Parser._deploy||y.Parser._showConsole(y.Parser._debugFlag.common,"A:"+y.TreeProcedures._toLatex(h),[]):y.Parser._showConsole(y.Parser._debugFlag.common,"A:undefined",[]),void 0!==i?y.Parser._deploy||y.Parser._showConsole(y.Parser._debugFlag.common,"B:"+y.TreeProcedures._toLatex(i),[]):y.Parser._showConsole(y.Parser._debugFlag.common,"B:undefined",[]),void 0!==j?y.Parser._deploy||y.Parser._showConsole(y.Parser._debugFlag.common,"C:"+y.TreeProcedures._toLatex(j),[]):y.Parser._showConsole(y.Parser._debugFlag.common,"C:undefined",[]),y.Parser._deploy||y.Parser._showConsole(y.Parser._debugFlag.common,"%c[STAGE7 - SUCCESS]Converted to quadratic form "+y.TreeProcedures._toLatex(c),[y.Parser._YSTYLE]),y.Parser._showConsole(y.Parser._debugFlag.common,b,[]),y.Parser._deploy||y.Parser._printLatex(c,7,!1),("linear"===b.getSpecie()||"quadratic"===b.getSpecie())&&(x=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.TreeProcedures.solveEquation(b),y.Parser._showConsole(y.Parser._debugFlag.info,"%c INFO%c: finding solutions for eqution "+x,[y.Parser._BLUE_STYLE,void 0]))},_getMobileFunction:function(b){var c,d,e,f,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return c=void 0!==b.getA()?g.TreeProcedures._toMobileFunction(b.getA(),b):0,d=void 0!==b.getB()?g.TreeProcedures._toMobileFunction(b.getB(),b):0,void 0!==b.getC()&&(e=g.TreeProcedures._toMobileFunction(b.getC(),b)),f="var solution,a = ("+c+"),b=("+d+"), c=("+e+");solution = []; a !== 0 ? (solution[0] = (-b + Math.sqrt(b*b - 4*a*c))/(2*a),solution[1] = (-b - Math.sqrt(b*b - 4*a*c))/(2*a)) :(solution[0] = -c/b,solution[1] = solution[0]); return solution;",f.search("findFactorial")>-1&&(f=g.MathFunctions.findFactorialString+f),f.search("gammaFunction")>-1&&(f=g.MathFunctions._gammaFunctionString+f),f.search("sum")>-1&&(f=g.MathFunctions.getSumString()+f),f.search("prod")>-1&&(f=g.MathFunctions.getProdString()+f),f},_toMobileFunction:function b(c,d,e){var f,g,h,i,j,k,l,m,n=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(void 0!==c){if(f="",c.isTerminal)if("var"===c.type){if(c.value===d.getParamVariable())return"-"===c.sign?"(param*-1)":"param"}else if("const"===c.type)switch(c.value){case"\\pi":f="Math.PI";break;case"e":f="Math.E";break;case"\\theta":f='constants["\\\\theta"]';break;default:f=e&&e===c.value?c.value:"constants['"+c.value+"']"}else f=c.value;else{for(g=[],h=e,("\\sum"===c.name||"\\prod"===c.name)&&(h=c.params[0].value),l=0;l<c.params.length;l++)g[l]=b(c.params[l],d,h);switch("rad"===d.getUnits().angle?(j="angle="+g[0]+",",k=""):(j="angle="+g[0]+",angle = angle*Math.PI /180,",k=",angle = angle*Math.PI /180"),m="",c.name){case"+":for(i="+",f=g[0],l=1;l<g.length;l++)f+=i+g[l];break;case"\\cdot":for(i="*",f=g[0],l=1;l<g.length;l++)f+=i+g[l];break;case"^":case"pow":f="raised=0,absBase=0,sign=0,num="+g[0]+",pow="+g[1]+",num===0&&pow===0?NaN:pow%1!==0?(raised=1/pow,absBase=Math.abs(num),sign=num>=0?1:-1,raised%2===0 && sign ===-1?Math.pow(num,pow):sign*Math.pow(absBase,pow)):Math.pow(num,pow)";break;case"\\frac":f=g[0]+"/"+g[1];break;case"\\sqrt":f="num=("+g[1]+"),pow = "+g[0]+",result=(isFinite(num)&&isFinite(pow)&&pow%2===0&&num<0)?NaN:pow<0?(1/Math.pow(Math.abs(num),(1/-pow))):Math.pow(Math.abs(num),1/pow),num<0?result*-1:result";break;case"\\ln":f="Math.log("+g[0]+")";break;case"\\log":f="Math.log("+g[0]+")/Math.LN10";break;case"\\log_":f="Math.log("+g[1]+")/Math.log("+g[0]+")";break;case"\\sin":case"\\cos":f=j+n.TreeProcedures.getMathFunction(c.name)+"(angle)";break;case"\\tan":f=j+"Math.sin(angle)/Math.cos(angle)";break;case"\\sec":f=j+"1/Math.cos(angle)";break;case"\\csc":f=j+"1/Math.sin(angle)";break;case"\\cot":f=j+"Math.cos(angle)/Math.sin(angle)";break;case"\\sinh":f=j+"(Math.pow(Math.E, angle) - Math.pow(Math.E, -angle)) / 2";break;case"\\cosh":f=j+"(Math.pow(Math.E, angle) + Math.pow(Math.E, -angle)) / 2";break;case"\\tanh":f=j+"Math.pow(Math.E, 2 * angle) - 1) / (Math.pow(Math.E, 2 * angle) + 1";break;case"\\csch":f=j+"2 / (Math.pow(Math.E, angle) - Math.pow(Math.E, -angle))";break;case"\\sech":f=j+"2 / (Math.pow(Math.E, angle) + Math.pow(Math.E, -angle))";break;case"\\coth":f=j+"Math.pow(Math.E, 2 * angle) + 1) / (Math.pow(Math.E, 2 * angle) - 1";break;case"\\arcsin":f="angle = "+g[0]+",Math.asin(angle)"+k;break;case"\\arccos":f="angle = "+g[0]+",Math.acos(angle)"+k;break;case"\\arctan":f="angle = "+g[0]+",Math.atan(angle)"+k;break;case"\\arccsc":f="angle = "+g[0]+",Math.asin(1/angle)"+k;break;case"\\arcsec":f="angle = "+g[0]+",Math.acos(1/angle)"+k;break;case"\\arccot":f="angle = "+g[0]+",Math.PI/2 - Math.atan(angle)"+k;break;case"\\arsinh":f="num = "+g[0]+",Math.log(num + Math.pow(num*num + 1 ,1/2))";break;case"\\arcosh":f="num = "+g[0]+",Math.log(Math.pow(num*num - 1 ,1/2))";break;case"\\artanh":f="num = "+g[0]+",Math.pow(num*num - 1 ,1/2)";break;case"\\arcsch":f="num = "+g[0]+",1/num + Math.sqrt(1/(num*num + 1))";break;case"\\arsech":f="num = "+g[0]+",1/num + Math.sqrt(1/(num*num - 1))";break;case"\\arcoth":f="num = "+g[0]+",0.5* Math.log((num+1)/(num-1))";break;case"!":f="num = "+g[0]+",num>170||!isFinite(num)?Infinity:num === 0?1:num%1===0 && num > 0?(findFactorial(num)):num*gammaFunction(num)";break;case"\\gcd":case"\\lcm":f=g[0];break;case"\\ceil":f="Math.ceil("+g[0]+")";break;case"\\floor":f="Math.floor("+g[0]+")";break;case"\\round":f="Math.round("+g[0]+")";break;case"\\abs":f="Math.abs("+g[0]+")";break;case"\\min":f="Math.min("+g[0]+","+g[1]+")";break;case"\\max":f="Math.max("+g[0]+","+g[1]+")";break;case"\\mod":f="num0="+g[0]+",num1="+g[1]+",num1===0?NaN:num0>0 === num1>0?num0%num1:num1+num0%num1";break;case"\\nCr":f="num0="+g[0]+",num1="+g[1]+",num0<0||num1<0?0:(num0 = Math.floor(Math.abs(num0)),num1 = Math.floor(Math.abs(num1)),num0<num1?0:findFactorial(num0)/(findFactorial(num1) - findFactorial(num0 - num1)))";break;case"\\nPr":f="num0="+g[0]+",num1="+g[1]+",num0<0||num1<0?0:(num0 = Math.floor(Math.abs(num0)),num1 = Math.floor(Math.abs(num1)),num0<num1?0:findFactorial(num0)/findFactorial(num0 - num1))";break;case"\\exp":f="Math.exp("+g[0]+")";break;case"\\sum":f='sum("'+c.params[0].value+'","'+g[1]+'","'+g[2]+'","'+g[3]+'",param,constants)';break;case"\\prod":f='prod("'+c.params[0].value+'","'+g[1]+'","'+g[2]+'","'+g[3]+'",param,constants)';break;default:f=0}}return f="-"===c.sign?"-("+f+")":"("+f+")"}},getMathFunction:function(a){switch(a){case"\\sin":return"Math.sin";case"\\cos":return"Math.cos";case"\\tan":return"Math.tan"}},solveEquation:function(b,c){var d=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return d.TreeProcedures._solveCartesian(b,c)},_solvePolar:function(){},_solveCartesian:function(b,c){var d,e,f,g,h,i,j=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,k=b.getA(),l=b.getB(),m=b.getC(),n=b.getConstants(),o=b.getParamVariable();if(j.Parser._debugFlag.solve&&j.Parser._showConsole(j.Parser._debugFlag.common,"For paramValue = "+c,[]),void 0!==k&&(d=j.TreeProcedures._substituteParamVariableAndGetValue(k,n,o,c)),j.Parser._showConsole(j.Parser._debugFlag.solve,"A="+d,[]),void 0!==l&&(e=j.TreeProcedures._substituteParamVariableAndGetValue(l,n,o,c)),j.Parser._showConsole(j.Parser._debugFlag.solve,"B="+e,[]),void 0!==m&&(j.Parser._deploy||j.Parser._showConsole(j.Parser._debugFlag.convert2q,"C is "+j.TreeProcedures._toLatex(m),[]),f=j.TreeProcedures._substituteParamVariableAndGetValue(m,n,o,c)),j.Parser._showConsole(j.Parser._debugFlag.solve,"C="+f,[]),void 0===d){if(j.Parser._showConsole(j.Parser._debugFlag.convert2q,"cant use quadratic formula since a = 0",[]),void 0===e)return void j.Parser._showConsole(j.Parser._debugFlag.common,"%c[FAIL - STAGE7]Cant process this equation",[j.Parser._NSTYLE]);g=h=void 0===f?void 0:-f/e}else j.Parser._showConsole(j.Parser._debugFlag.convert2q,"Using quadratic formula since a != 0",[]),void 0===e&&(e=0),void 0===f&&(f=0),i=e*e-4*d*f,0>i?(g=h="undefined",j.Parser._showConsole(j.Parser._debugFlag.convert2q,"Solution is complex",[])):(g=(-e+Math.sqrt(i))/(2*d),h=0===i?g:(-e-Math.sqrt(i))/(2*d));return g=Number(g),h=Number(h),[g,h]},_substituteParamVariableAndGetValue:function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(o.Parser._showConsole(o.Parser._debugFlag.convert2q,"Substituting param "+d+" with value "+e,[]),b.isTerminal===!0)return"digit"===b.type?"-"===b.sign?-1*Number(b.value):Number(b.value):"var"===b.type?b.value===d?"-"===b.sign?-1*Number(e):Number(e):void o.Parser._showConsole(o.Parser._debugFlag.common,"%c[FAIL-STAGE8]Unknown freevar occured "+b.value,[o.Parser._NSTYLE]):void 0!==o.Parser._constants[b.value]?"-"===b.sign?-1*o.Parser._constants[b.value]:o.Parser._constants[b.value]:void 0!==c[b.value]?"-"===b.sign?-1*c[b.value]:c[b.value]:void o.Parser._showConsole(o.Parser._debugFlag.common,"%c[FAIL-STAGE8]unsubstituted constant occured "+b.value,[o.Parser._NSTYLE]);switch(f=[],h="-"===b.sign?-1:1,b.name){case"\\sum":case"\\prod":if(k=c[b.params[0].value],l=o.TreeProcedures._substituteParamVariableAndGetValue(b.params[1],c,d,e),m=o.TreeProcedures._substituteParamVariableAndGetValue(b.params[2],c,d,e),isNaN(l)||isNaN(m)||void 0===l||void 0===m||!isFinite(m)||!isFinite(l))return void 0;for(n=l;m>=n;n++){if(c[b.params[0].value]=n,g=o.TreeProcedures._substituteParamVariableAndGetValue(b.params[3],c,d,e),void 0===g)return void o.Parser._showConsole(o.Parser._debugFlag.common,"%c[FAIL-STAGE8]Cant Calculate value of "+b.name,[o.Parser._NSTYLE]);f.push(g)}j="\\sum"===b.name?o.TreeProcedures._mathFunctions.performMathematicalCalculations("+",f,o.TreeProcedures._getUnits(b)):o.TreeProcedures._mathFunctions.performMathematicalCalculations("\\cdot",f,o.TreeProcedures._getUnits(b));break;default:for(i=0;i<b.params.length;i++){if(g=o.TreeProcedures._substituteParamVariableAndGetValue(b.params[i],c,d,e),void 0===g)return void o.Parser._showConsole(o.Parser._debugFlag.common,"%c[FAIL-STAGE8]Cant Calculate value of "+b.name,[o.Parser._NSTYLE]);f.push(g)}j=o.TreeProcedures._mathFunctions.performMathematicalCalculations(b.name,f,o.TreeProcedures._getUnits(b))}return null===j?void 0:h*j},_commonOutFunctionVariable:function(b,c){var d,e,f=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,g=!1;if(b.isTerminal){if(b.value===c)return b.value=1,b.type="digit",1}else switch(b.name){case"+":for(d=0;d<b.params.length;d++)e=f.TreeProcedures._commonOutFunctionVariable(b.params[d],c);break;case"\\cdot":for(d=0;d<b.params.length;d++)e=f.TreeProcedures._commonOutFunctionVariable(b.params[d],c),1===e&&(g=!0);if(g===!0)return 1;break;case"\\frac":return f.TreeProcedures._commonOutFunctionVariable(b.params[0],c);case"^":return f.TreeProcedures._commonOutFunctionVariable(b.params[0],c)}},_add:function(b,c){var d,e,f,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;for(b.isTerminal===!1&&"+"===b.name?(d=b,c.isTerminal===!1&&"+"===c.name?(e=g.TreeProcedures._extractAllParams(c),c.incinerate()):e=[c]):c.isTerminal===!1&&"+"===c.name?(d=c,b.isTerminal===!1&&"+"===b.name?(e=g.TreeProcedures._extractAllParams(b),b.incinerate()):e=[b]):(d=g.TreeProcedures._getParseTreeNodeObject(void 0,"+","+",void 0),e=[b,c]),f=0;f<e.length;f++)d._addParam(e[f]);return d},multiply:function(b,c){var d,e,f=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(b.isTerminal===!1&&"\\cdot"===b.name)if(d=b,c.isTerminal===!0)d._addParam(c);else{for(e=0;e<c.params.length;e++)d._addParam(c.params[e]);c.incinerate()}else if(c.isTerminal===!1&&"\\cdot"===c.name)if(d=c,b.isTerminal===!0)d._addParam(b);else{for(e=0;e<b.params.length;e++)d._addParam(b.params[e]);b.incinerate()}else d=f.TreeProcedures._getParseTreeNodeObject(void 0,"\\cdot","+",void 0),d._addParam(b),d._addParam(c);return d},updateFreeVars:function(){},combineLeftRightTree:function(b){var c,d,e,f,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,h=b.getRightExpression(),i=b.getLeftExpression(),j=b.getRightRoot(),k=b.getLeftRoot();if(void 0!==j&&null!==j){if(g.Parser._showConsole(g.Parser._debugFlag.common,"Right tree is "+b.rightRoot,[]),g.TreeProcedures.negateTree(j),j.isTerminal===!0&&0===g.TreeProcedures._getValueFromParam(j)&&k.isTerminal===!1)return;b.setLeftRoot(g.TreeProcedures._add(k,j)),b.setRightRoot(g.TreeProcedures._getParseTreeTerminalObject(void 0,"digit","+",b.getUnits())),b.getRightRoot().value="0"}for(c in h.freevars)d=i.freevars[c],e=h.freevars[c],f=d?"c"===d?d:"c"===e?e:d>e?d:e:e,i.freevars[c]=f,delete h.freevars[c]},negateTree:function(b){var c,d=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,e=b.isTerminal===!1&&"+"===b.name;if(e===!0)for(c=0;c<b.params.length;c++)d.TreeProcedures.negateTree(b.params[c]);else"+"===b.sign?b.sign="-":b.sign="+"},generateTree:function(b,c,d){function e(a){if(void 0!==a.parentNode){var b=a.parentNode.params.indexOf(a),c=a.parentNode.params[b+1];return void 0===c?a.parentNode:c}}if(void 0!==b){for(var f,g,h,i,j=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,k=[];c<b.length;){if(h=b[c],j.Parser._showConsole(j.Parser._debugFlag.tree,"...Processing object "+h,[]),j.Parser._showConsole(j.Parser._debugFlag.tree,"...Current Parent is "+g,[]),"number"==typeof h){if(i=j.ParsingProcedures.getStackCode(k),g=j.TreeProcedures._getNodeForRule(g,h,i,d),void 0===f)for(f=g;void 0!==f.parentNode;)f=f.parentNode;j.Parser._showConsole(j.Parser._debugFlag.tree,"rule returned "+g,[])}else if("func"===h.type)j.Parser._showConsole(j.Parser._debugFlag.tree,"ignoring func token "+h,[]),h.value===g.name?(j.Parser._showConsole(j.Parser._debugFlag.tree,"%cCHECK...function name matches with currentNode "+h+"<>"+g,[j.Parser._YSTYLE]),g.sign=h.sign,g.negativeCaseType=h.negativeCaseType):j.Parser._showConsole(j.Parser._debugFlag.tree,"%cFAIL...function name does not match with currentNode "+h+"<>"+g,[j.Parser._NSTYLE]);else if("delim"===h.type){if(j.Parser._showConsole(j.Parser._debugFlag.tree,"skipping delimiter "+h,[]),","===h.value&&!j.Parser._isCommaFunction(g.name))for(;!j.Parser._isCommaFunction(g.name);)g=e(g);for(j.ParsingProcedures.recordBracket(k,h.value),"do"===g.name&&(g.sign=h.sign,g.negativeCaseType=h.negativeCaseType);g.liberationCode>j.ParsingProcedures.getStackCode(k)&&(j.Parser._showConsole(j.Parser._debugFlag.common,"Current node type "+g.type,[]),j.Parser._showConsole(j.Parser._debugFlag.tree,"shifting up parent because "+g+" is Delimiter found... parent shift from "+g+" to "+g.parentNode,[]),g=e(g),void 0!==g););}else if("opr"===h.type){if(j.Parser._showConsole(j.Parser._debugFlag.tree,"skipping operator "+h,[]),j.Parser._showConsole(j.Parser._debugFlag.tree,"Operator found...shifting parent from "+g+" to "+g.parentNode+h,[]),h.value!==g.name){do j.Parser._showConsole(j.Parser._debugFlag.tree,h.value+"<> "+g.name,[]),j.Parser._showConsole(j.Parser._debugFlag.tree,"!!!!!!!!!!!!!!!!!!! current operator does not match the current node !!!!!!!!!!!!! SHOULD SHIFT parent up to!!"+g.parentNode,[]),g=e(g);while(void 0!==g&&h.value!==g.name)}else j.Parser._showConsole(j.Parser._debugFlag.tree,"Operator "+g.value+" confirms with the parent >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",[]);void 0!==g&&h.value===g.name?(j.Parser._showConsole(j.Parser._debugFlag.tree,"%cCHECK...OPERATOR name matches with currentNode "+h+"<>"+g,[j.Parser._YSTYLE]),g.sign=h.sign,g.negativeCaseType=h.negativeCaseType):j.Parser._showConsole(j.Parser._debugFlag.common,"%cFAIL...OPERATOR name does not match with currentNode "+h+"<>"+g,[j.Parser._NSTYLE])}else if("digit"===h.type||"const"===h.type||"var"===h.type){if(g.isTerminal===!1)return void j.Parser._showConsole(j.Parser._debugFlag.tree,"!!!!!!!!!!!!!!!! ERROR terminal expected found NODE------------",[]);j.Parser._showConsole(j.Parser._debugFlag.tree,"+++ found terminal "+h+" will be filled into shell "+g,[]),g.sign=h.sign,g.negativeCaseType=h.negativeCaseType,g.value=h.value,g.type=h.type,g.isEmpty=!1,void 0!==h.constantSubstituted&&(g.constantSubstituted=h.constantSubstituted)}else j.Parser._showConsole(j.Parser._debugFlag.tree,"!!!!!!!!!!!!!!!!!!!!!!!!!!! DONT KNOW WHAT TO DO WITH "+h,[]);if(void 0!==g)for(j.Parser._showConsole(j.Parser._debugFlag.tree,"Checking stackcode "+g+" "+g.liberationCode+" <> "+j.ParsingProcedures.getStackCode(k),[]);g.isEmpty===!1&&j.TreeProcedures.isOperator(g.name)===!1&&(j.Parser._showConsole(j.Parser._debugFlag.tree,"Current node type "+g.type,[]),j.Parser._showConsole(j.Parser._debugFlag.tree,"shifting up parent because "+g+" is NOT EMPTY parent shift from "+g+" to "+e(g),[]),g=e(g),void 0!==g););if(c++,void 0===g)break}return f}},isOperator:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return-1!==c.TreeProcedures._productions._operatorsInPrecedenceOrder.indexOf(b)},_getNodeForRule:function(b,c,d,e){var f,g,h,i,j=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,k=j.TreeProcedures._productions.treeGenerationRules[c],l=k.split(" "),m=b;if(l.length>0&&("node.\\sum"===l[0]||"node.\\prod"===l[0])){for(i=0;i<l.length;i++)f=l[i].split("."),"node"===f[0]?m=j.TreeProcedures._getParseTreeNodeObject(m,f[1],"+",d):void 0===h?h=j.TreeProcedures._getParseTreeTerminalObject(m,f[1],"+",e):j.TreeProcedures._getParseTreeTerminalObject(m,f[1],"+",e),void 0===g&&(g=m);m=h}else for(i=0;i<l.length;i++)f=l[i].split("."),m="node"===f[0]?j.TreeProcedures._getParseTreeNodeObject(m,f[1],"+",d):j.TreeProcedures._getParseTreeTerminalObject(m,f[1],"+",e),void 0===g&&(g=m);return j.Parser._showConsole(j.Parser._debugFlag.common,"------ Rule "+c+" Processing complete---------------",[]),j.Parser._showConsole(j.Parser._debugFlag.common,"returning "+m,[]),m},_getParseTreeTerminalObject:function(b,c,d,e){var f,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return g.Parser._showConsole(g.Parser._debugFlag.common,"Generating Node with parent "+b+" and type "+c,[]),void 0===d&&(d="+"),f={toString:function(){return"["+this.sign+this.value+" "+this.type+"]"},isTerminal:!0,type:c,sign:d,value:void 0,units:e,isEmpty:!0,incinerate:function(){this.value="incinerated (X)",delete this.isTerminal,delete this.type,delete this.isEmpty,delete this.units,delete this.parentNode},parentNode:b},void 0!==b&&b.isEmpty===!0&&b._addParam(f),f},getFunctionVariablePowerInTerm:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(b.isTerminal)return 0;switch(b.name){case"+":case"-":c.Parser._showConsole(c.Parser._debugFlag.common,"%c[FAIL ]This term should have occured when looking  for power of function variable",[c.Parser._NSTYLE]);break;case"\\cdot":}},_getFunctionVariableSegregationIndex:function(b,c){var d,e,f=0,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(void 0===c)return void g.Parser._showConsole(g.Parser._debugFlag.common,"Cant segregate with unknown fVar",[]);if(b.isTerminal===!0)return c===b.value?1:0;switch(b.name){case"+":for(d=0;d<b.params.length;d++)if(e=g.TreeProcedures._getFunctionVariableSegregationIndex(b.params[d],c),0===d)f=e;else if(e!==f)return;return f;case"\\cdot":for(d=0;d<b.params.length;d++){if(e=g.TreeProcedures._getFunctionVariableSegregationIndex(b.params[d],c),void 0===e)return;e>0&&(f+=e)}return f;case"\\frac":return e=g.TreeProcedures._getFunctionVariableSegregationIndex(b.params[0],c),g.Parser._showConsole(g.Parser._debugFlag.convert2q,"fraction with numerator fvar power "+e,[]),e;case"^":return b.params[1].isTerminal===!1||"digit"!==b.params[1].type?(g.Parser._showConsole(g.Parser._debugFlag.convert2q,"No point in checking when power is complicated for "+b+" power is "+b.params[1],[]),0):(e=g.TreeProcedures._getFunctionVariableSegregationIndex(b.params[0],c),g.Parser._showConsole(g.Parser._debugFlag.convert2q,"power: fVar "+e+" my power "+b.params[1],[]),void 0===e?void 0:e>0?e*g.TreeProcedures._getValueFromParam(b.params[1]):0);default:return 0}},_findSameOperatorAndMerge:function(b){var c,d,e,f,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if("+"!==b.name&&"\\cdot"!==b.name&&"-"!==b.name)return void g.Parser._showConsole(g.Parser._debugFlag.common,"Cant merge function "+b,[]);for(g.Parser._showConsole(g.Parser._debugFlag.common,"Merging operator "+b,[]),d=[],e=0,f=null,e=0;e<b.params.length;e++)if(f=b.params[e],f.name===b.name)for(c=g.TreeProcedures._extractAllParams(f),b._removeParam(f),e--;c.length>0;)d.push(c.shift());if(d.length>0)for(;d.length>0;)b._addParam(d.shift())},_getParseTreeNodeObject:function(b,c,d,e){var f,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return g.Parser._showConsole(g.Parser._debugFlag.common,"Generating function "+c+" with parent "+b,[]),void 0===d&&(d="+"),f={toString:function(){return"+"===this.sign?this.name+"()":this.sign+this.name+"()"},params:[],isTerminal:!1,name:c,isEmpty:!0,sign:d,allTermsDigits:void 0,liberationCode:e,maxParams:g.TreeProcedures._productions.getMaximumParameters(c),_addParam:function(a){return this.params.length>=this.maxParams?void g.Parser._showConsole(g.Parser._debugFlag.common,"!!!!!!!! ERROR I CANT ACCEPT THIS CHILD",[]):(a.parentNode=this,this.params.push(a),g.Parser._showConsole(g.Parser._debugFlag.common,"Adding param "+a.name+" to "+this.name+" at index "+(this.params.length-1),[]),void(this.params.length===this.maxParams&&(g.Parser._showConsole(g.Parser._debugFlag.common,"---Function "+this.name+" is full---",[]),this.isEmpty=!1)))},_removeParam:function(a,b){var c,d,e;return c="number"==typeof a?a:this.params.indexOf(a),-1===c||c>=this.params.length?void g.Parser._showConsole(g.Parser._debugFlag.common,"Cant remove object at index "+c,[]):(d=this.params.splice(c,1),
e=d[0],void 0===b&&(b=!0),b!==!0?e:void e.incinerate())},convertToTerminal:function(a){this.isTerminal=!0,this.value=a.value,this.isEmpty=a.isEmpty,this.type=a.type,this.units=a.units,this.sign=a.sign,this.toString=function(){return"["+this.sign+this.value+" "+this.type+"]"},void 0!==a.parentNode&&a.parentNode._removeParam(a),delete this.params,delete this.name,delete this.liberationCode,delete this.maxParams,delete this._removeParam,delete this.toEquation,delete this._addParam,delete this.simplify},incinerate:function(){this.name="incinerated (+)",delete this.params,delete this.isTerminal,delete this.isEmpty,delete this.liberationCode,delete this.parentNode,delete this.maxParams},toEquation:function(){},expand:function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;switch(this.name){case"+":for(k=0;k<this.params.length;k++)this.params[k].isTerminal===!1&&this.params[k].expand(b,c);y.TreeProcedures._findSameOperatorAndMerge(this),l=!0;break;case"\\cdot":if(y.TreeProcedures._getAdditionGroupCount(this.params)>0){for(m=[],n=0;n<this.params.length;)"+"===this.params[n].name?m.push(this._removeParam(this.params[n],!1)):n++;if(m.length>1)for(;m.length>1;)o=y.TreeProcedures._expandMultiplication(m.shift(),m.shift(),this.sign),m.unshift(o);else o=m[0];y.Parser._showConsole(y.Parser._debugFlag.expand,"Remaining non plus params count is "+this.params.length,[]),this.params.length>0&&(this.params.length>1?(w=y.TreeProcedures._getParseTreeNodeObject(void 0,"\\cdot","+",void 0),y.TreeProcedures._adoptAllParams(this,w),o=y.TreeProcedures._expandMultiplication(w,o,this.sign)):(o=y.TreeProcedures._expandMultiplication(this.params[0],o,this.sign),y.TreeProcedures._removeAllParams(this))),y.Parser._showConsole(y.Parser._debugFlag.expand,"Addition group is "+o,[]),y.TreeProcedures._convertTreeNodeTo(this,"+"),y.TreeProcedures._adoptAllParams(o,this)}else y.Parser._showConsole(y.Parser._debugFlag.expand,"Nothing to expand",[]);y.TreeProcedures._findSameOperatorAndMerge(this);break;case"^":if(i=this.params[0],i.isTerminal===!1&&i.expand(c),j=this.params[1],y.Parser._showConsole(y.Parser._debugFlag.expand,"Expanding ^ with params "+this.params,[]),"+"===i.name&&j.isTerminal===!0){if(y.Parser._showConsole(y.Parser._debugFlag.expand,"Possible expansion of "+i+" at degree "+j,[]),"2"===j.value){if(y.TreeProcedures._hasFreeVariable(this,b)===!1)return void y.Parser._showConsole(y.Parser._debugFlag.expand,"No function variable found in my params....Expansion is futile",[]);if(p=y.TreeProcedures._extractAllParams(i),y.TreeProcedures._convertTreeNodeTo(this,"+"),y.TreeProcedures._removeAllParams(this),r=y.TreeProcedures._seperateTermsWithFreeVariable(p,b),y.Parser._showConsole(y.Parser._debugFlag.expand,"Terms with free Variable "+b+" are "+r,[]),y.Parser._showConsole(y.Parser._debugFlag.expand,"Terms WITHOUT free Variable "+b+" are "+p,[]),0===r.length)y.Parser._showConsole(y.Parser._debugFlag.expand,"##############ERROR THIS SHOULDNT HAPPEN...@#@#######",[]);else{if(t=y.TreeProcedures._getParseTreeTerminalObject(void 0,"digit","+"),t.value=2,r.length>0)for(i=y.TreeProcedures._getParseTreeNodeObject(void 0,"+",void 0,void 0),k=0;k<r.length;k++)y.Parser._showConsole(y.Parser._debugFlag.expand,"Adding param "+r[k],[]),i._addParam(r[k]);else i=r[0];if(p.length>0)for(j=y.TreeProcedures._getParseTreeNodeObject(void 0,"+",void 0,void 0),k=0;k<p.length;k++)j._addParam(p[k]);else j=p[0];s=y.TreeProcedures._getParseTreeNodeObject(void 0,"^",void 0,void 0),s._addParam(y.TreeProcedures._clone(i)),s._addParam(y.TreeProcedures._clone(t)),y.Parser._showConsole(y.Parser._debugFlag.expand,"expansion term 1 generated "+s,[]),s.sign=y.TreeProcedures._multiplySigns(s.sign,this.sign),this._addParam(s),s=y.TreeProcedures._getParseTreeNodeObject(void 0,"^",void 0,void 0),s._addParam(y.TreeProcedures._clone(j)),s._addParam(y.TreeProcedures._clone(t)),y.Parser._showConsole(y.Parser._debugFlag.expand,"expansion term 2 generated "+s,[]),s.sign=y.TreeProcedures._multiplySigns(s.sign,this.sign),this._addParam(s),s=y.TreeProcedures.multiply(i,j),s=y.TreeProcedures.multiply(s,t),s.sign=y.TreeProcedures._multiplySigns(s.sign,this.sign),this._addParam(s),l=!0}}}else if("\\cdot"===i.name&&j.isTerminal&&"digit"===j.type){for(q=this._removeParam(j,!1),y.TreeProcedures._convertTreeNodeTo(this,"\\cdot"),p=y.TreeProcedures._extractAllParams(i),y.TreeProcedures._removeAllParams(this),i.incinerate();p.length>0;)v=y.TreeProcedures._getParseTreeNodeObject(void 0,"^","+",void 0),v._addParam(p.shift()),v._addParam(y.TreeProcedures._clone(q)),this._addParam(v);q.incinerate(),l=!0}break;case"\\frac":if(d=this.params[0],d.isTerminal===!1&&d.expand(b),"+"===d.name){for(l=!0,this.name="+",this.maxParams=y.TreeProcedures._productions.getMaximumParameters(this.name),f=this.params[1],this._removeParam(d,!1),this._removeParam(f,!1),e=d.params.length;d.params.length>0;)x=this.sign,g=d.params[0],d._removeParam(g,!1),h=0===d.params.length?f:y.TreeProcedures._clone(f),u=y.TreeProcedures._getParseTreeNodeObject(this,"\\frac"),u._addParam(g),u._addParam(h),u.sign=x,u.simplify(c),this._addParam(u);d.incinerate()}}l===!0&&this.simplify(c)},simplify:function(b){var c,d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,f=!0;if(e.Parser._showConsole(e.Parser._debugFlag.simplify,"Simplifying "+this,[]),"\\sum"===this.name||"\\prod"===this.name)return void e.TreeProcedures.simplifySumProd(this,b);for(d=this.params.length,c=d-1;c>=0;c--)e.Parser._showConsole(e.Parser._debugFlag.common,"...processing "+this.params[c],[]),this.params[c].isTerminal!==!0?(this.params[c].simplify(b),(this.params[c].isTerminal===!1||"digit"!==this.params[c].type)&&(e.Parser._showConsole(e.Parser._debugFlag.simplify,this.params[c]+" is not digit",[]),f=!1)):"digit"!==this.params[c].type&&(e.Parser._showConsole(e.Parser._debugFlag.simplify,this.params[c]+" is not digit",[]),f=!1);this.allTermsDigits=f,e.Parser._showConsole(e.Parser._debugFlag.simplify,"all terms digit flag is "+this.allTermsDigits+" for function "+this,[]),e.TreeProcedures._performNumericalOptimizations(this,b),e.TreeProcedures._performStructuralOptimizations(this,b)},parentNode:b},void 0!==b&&b.isEmpty===!0&&b._addParam(f),f},_isInversibleFunction:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return-1!==c.Parser._INVERSIBLE_FUNCTIONS.indexOf(b)},_isNodeSimple:function c(a){var b,d=!0;if(a.isTerminal)d=d&&"var"!==a.type;else for(b=0;b<a.params.length;b++)if(d=d&&c(a.params[b]),!d)return d;return d},simplifySumProd:function(b,c){var d,e,f,g,h,i,j,k,l=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;!b||!b.params||b.params.length<4||(d=b.params[1],e=b.params[2],f=b.params[3],d.isTerminal||d.simplify(),e.isTerminal||e.simplify(),f.isTerminal||f.simplify(),l.TreeProcedures._isNodeSimple(d)&&l.TreeProcedures._isNodeSimple(e)&&l.TreeProcedures._isNodeSimple(f)&&d.isTerminal&&"digit"===d.type&&e.isTerminal&&"digit"===e.type&&(g=l.TreeProcedures._toMobileFunction(f,c,b.params[0].value),g.search("param")>-1||(h="return "+l.TreeProcedures._toMobileFunction(b,c)+";",h.search("findFactorial")>-1&&(h=l.MathFunctions.findFactorialString+h),h.search("gammaFunction")>-1&&(h=l.MathFunctions._gammaFunctionString+h),h.search("sum")>-1&&(h=l.MathFunctions.getSumString()+h),h.search("prod")>-1&&(h=l.MathFunctions.getProdString()+h),i=new Function("param,constants",h),j=i(0,c.getConstants()),k=l.TreeProcedures._getParseTreeTerminalObject(void 0,"digit","+",b.params[0].units),k.value=j,b.convertToTerminal(k))))},_getLeftChild:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return b.isTerminal?null:"do"===b.params[0].name?c.TreeProcedures._getLeftChild(b.params[0]):b.params[0]},_getRightChild:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return b.isTerminal?null:"do"===b.params[1].name?c.TreeProcedures._getLeftChild(b.params[1]):b.params[1]},_getInversibleFunctionReplacement:function(b){var c,d=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return c=d.Parser._INVERSIBLE_FUNCTIONS.indexOf(b),-1!==c?d.Parser._INVERT_FUNCTIONS_IN_ORDER[c]:null},_preNumericalStructuralOptimizations:function(b){var c,d,e,f,g,h,i=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;switch(b.name){case"^":if(c=i.TreeProcedures._getLeftChild(b),null!==c&&i.TreeProcedures._isInversibleFunction(c.name)&&(d=i.TreeProcedures._getRightChild(b),null!==d&&-1===i.TreeProcedures._getValueFromParam(d)&&(f=i.TreeProcedures._getInversibleFunctionReplacement(c.name),null!==f)))for(e=i.TreeProcedures._extractAllParams(c),i.TreeProcedures._convertTreeNodeTo(b,f),b.sign=i.TreeProcedures._multiplySigns(b.sign,c.sign),i.TreeProcedures._removeAllParams(b),g=0,h=e.length,g;h>g;g++)b._addParam(e[g])}},_performStructuralOptimizations:function(b,c){var d,e,f,g,h,i,j,k,l,m,n=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,o=!1;switch(b.name){case"^":"^"===b.params[0].name?(h=b._removeParam(1,!1),e=b.params[0]._removeParam(0,!1),f=b.params[0]._removeParam(0,!1),b._removeParam(0),h=n.TreeProcedures.multiply(h,f),b._addParam(e),b._addParam(h),o=!0):"\\%"===b.params[0].name&&(j=n.TreeProcedures._getNumberOfPercentChilds(b),i=b.params[1],k=n.TreeProcedures._getPercentChild(b.params[0]),d=k.sign,l=Math.pow(.01,j),l=Math.pow(l,i.value),l*=k.value,m=n.TreeProcedures._getParseTreeTerminalObject(void 0,"digit",d,void 0),m.value=l,n.TreeProcedures._removeAllParams(b),b.convertToTerminal(m));break;case"do":n.Parser._showConsole(n.Parser._debugFlag.simplify,"optimizing "+b+" with params "+b.params,[]),g=n.TreeProcedures._extractAllParams(b),d=b.sign,n.TreeProcedures._convertTreeNodeTo(b,g[0]),d=n.TreeProcedures._multiplySigns(d,g[0].sign),"+"===g[0].name&&"-"===d?n.TreeProcedures.negateTree(b):b.sign=d;break;case"!":"\\%"===b.params[0].name&&(j=n.TreeProcedures._getNumberOfPercentChilds(b),k=n.TreeProcedures._getPercentChild(b.params[0]),d=k.sign,l=Math.pow(.01,j),l=n.TreeProcedures._mathFunctions.performMathematicalCalculations("!",[l],n.TreeProcedures._getUnits(b)),l*=k.value,m=n.TreeProcedures._getParseTreeTerminalObject(void 0,"digit",d,void 0),m.value=l,n.TreeProcedures._removeAllParams(b),b.convertToTerminal(m))}o&&n.TreeProcedures._performNumericalOptimizations(b,c)},_getNumberOfPercentChilds:function(b){var c,d,e,f=0,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(b.isTerminal===!1)for(c=0,d=b.params.length,c;d>c;c++)e=b.params[c],"\\%"===e.name&&(f++,f+=g.TreeProcedures._getNumberOfPercentChilds(e));return f},_getPercentChild:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return"\\%"===b.params[0].name?c.TreeProcedures._getPercentChild(b.params[0]):b.params[0]},_expandMultiplication:function(b,c,d){var e,f,g,h,i,j,k,l,m=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(m.Parser._showConsole(m.Parser._debugFlag.common,"multiplying "+b+" to "+c,[]),"+"!==b.name&&"+"!==c.name)return m.Parser._showConsole(m.Parser._debugFlag.expand,"Both terms are not + series...just multiplying",[]),m.TreeProcedures.multiply(b,c);if(g=!1,h=!1,"+"===b.name?(e=m.TreeProcedures._extractAllParams(b),f=b,g=!0):(e=[b],g=!1),"+"===c.name?(i=m.TreeProcedures._extractAllParams(c),h=!0,void 0===f?f=c:c.incinerate()):(i=[c],h=!1),m.Parser._showConsole(m.Parser._debugFlag.expand,"term1 params "+e,[]),m.Parser._showConsole(m.Parser._debugFlag.expand,"term2 params "+e,[]),void 0===f)return void m.Parser._showConsole(m.Parser._debugFlag.expand,"Parent node not found...skip expand multiplication",[]);for(j=0;j<e.length;j++)for(k=0;k<i.length;k++)l=m.TreeProcedures.multiply(m.TreeProcedures._clone(e[j]),m.TreeProcedures._clone(i[k])),l.sign=m.TreeProcedures._multiplySigns(d,l.sign),m.Parser._showConsole(m.Parser._debugFlag.expand,">>>"+l,[]),f._addParam(l);if(g)for(;e.length>0;)e[0].incinerate(),e.shift();if(h)for(;i.length>0;)i[0].incinerate(),i.shift();return f},_extractAllParams:function(a){for(var b=[];a.params.length>0;)b.push(a._removeParam(a.params[0],!1));return b},_removeAllParams:function(a,b){for(void 0===b&&(b=!0);a.params.length>0;)a._removeParam(a.params[0],b)},_getAdditionGroupCount:function(a){var b=0,c=0;for(c=0;c<a.length;c++)"+"===a[c].name&&b++;return b},_adoptAllParams:function(b,c){var d=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(b===c)return void d.Parser._showConsole(d.Parser._debugFlag.common,"Skipping adopting your own params -_-",[]);for(;b.params.length>0;)c._addParam(b._removeParam(0,!1))},_seperateTermsWithFreeVariable:function(b,c){var d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,f=[];for(d=0;d<b.length;d++)e.TreeProcedures._hasFreeVariable(b[d],c)===!0?(e.Parser._showConsole(e.Parser._debugFlag.common,"term "+b[d]+" have freevar "+c,[]),f.push(b[d]),b.splice(d,1),d--):e.Parser._showConsole(e.Parser._debugFlag.common,"term "+b[d]+"  doesnt have freevar "+c,[]);return f},_hasFreeVariable:function d(a,b){if(a.isTerminal===!0)return"var"===a.type&&a.value===b;var c,e;for(e=0;e<a.params.length;e++)if(c=d(a.params[e],b),c===!0)return!0;return!1},_convertTreeNodeTo:function(b,c){var d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(b.isTerminal===!0)return void e.Parser._showConsole(e.Parser._debugFlag.common,"Cant convert terminal to a NODE",[]);if(e.Parser._showConsole(e.Parser._debugFlag.common,"Converting the tree node "+b+" from "+b.name+" to "+c,[]),"string"==typeof c)b.name=c,b.maxParams=e.TreeProcedures._productions.getMaximumParameters(c);else if(c.isTerminal===!1)for(b.name=c.name,b.sign=c.sign,b.maxParams=e.TreeProcedures._productions.getMaximumParameters(b.name),d=e.TreeProcedures._extractAllParams(c),e.TreeProcedures._removeAllParams(b);d.length>0;)b._addParam(d.shift());else b.convertToTerminal(c);b.maxParams===1/0&&(b.isEmpty=!0)},_getUnits:function(b){var c=b.params[0],d=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return c.isTerminal===!0?c.units:d.TreeProcedures._getUnits(c)},_getAllParamsValues:function(b){var c,d=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,e=[],f=0,g=b.params.length;for(f;g>f;f++)c=b.params[f],c.isTerminal?e.push(d.TreeProcedures._getValueFromParam(c)):d.Parser._showConsole(d.Parser._debugFlag.common,"%c[FAIL ]The Node provided is not terminal",[d.Parser._NSTYLE]);return e},_getValueFromParam:function(b){var c,d=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return b.isTerminal?(c=Number(b.value),isNaN(c)?b.value:"-"===b.sign&&0!==c?-1*c:c):(d.Parser._showConsole(d.Parser._debugFlag.common,"Value for a non terminal node was asked"+b.name,[]),null)},_multiplySigns:function(a,b){return"+"===a&&"+"===b?"+":"+"===a||"+"===b?"-":"+"},_getAdditionValue:function(b){var c,d=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,e=null,f=b.params.length,g=0;for(g;f>g;g++)c=b.params[g],c.isTerminal&&"digit"===c.type&&(null===e&&(e=0),e+=d.TreeProcedures._getValueFromParam(c));return e},_performPercentOptimizations:function(b){var c,d,e,f=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,g=b.parentNode;return void 0===g?f.TreeProcedures._mathFunctions.performMathematicalCalculations(b.name,[f.TreeProcedures._getValueFromParam(b.params[0])],f.TreeProcedures._getUnits(b)):"+"!==g.name?"^"===g.name||"!"===g.name?void 0:f.TreeProcedures._mathFunctions.performMathematicalCalculations(b.name,[f.TreeProcedures._getValueFromParam(b.params[0])],f.TreeProcedures._getUnits(b)):(e=f.TreeProcedures._getAdditionValue(g),void 0===g.onlyPercent&&(null===e?g.onlyPercent=!0:g.onlyPercent=!1),c=g.onlyPercent===!0?f.TreeProcedures._mathFunctions.performMathematicalCalculations(b.name,[f.TreeProcedures._getValueFromParam(b.params[0])],f.TreeProcedures._getUnits(b)):f.TreeProcedures._mathFunctions.performMathematicalCalculations(b.name,[e,f.TreeProcedures._getValueFromParam(b.params[0])],f.TreeProcedures._getUnits(b)),"-"===b.sign&&(c*=-1),d=f.TreeProcedures._extractAllParams(b,!1),b.convertToTerminal(d[0]),b.sign=d[0].sign,b.value=c,d[0].incinerate(),void 0)},_performNumericalOptimizations:function(b,c){if(b.isTerminal!==!0){var d,e,f,g,h,i,j,k,l,m,n,o=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(o.Parser._showConsole(o.Parser._debugFlag.simplify,"solving---------------"+b+" with maxparams "+b.maxParams,[]),g=1,"-"===b.sign&&(g=-1),b.maxParams===1/0){for(h=0,h=0;h<b.params.length;h++)if(i=b.params[h],i.isTerminal===!0&&"digit"===i.type)if(o.Parser._showConsole(o.Parser._debugFlag.simplify,"processing digit "+i,[]),void 0===d)d=o.TreeProcedures._getValueFromParam(b.params[h]),o.Parser._showConsole(o.Parser._debugFlag.simplify,"for operator "+b.name+" Result init to "+d,[]),f=b.params[h];else{switch(b.name){case"+":d+=o.TreeProcedures._getValueFromParam(b.params[h]);break;case"-":d-=o.TreeProcedures._getValueFromParam(b.params[h]);break;case"\\cdot":d*=o.TreeProcedures._getValueFromParam(b.params[h])}b._removeParam(i),h--}else o.Parser._showConsole(o.Parser._debugFlag.simplify,"param "+i+" is not terminal",[]),g=1;"\\cdot"===b.name,void 0!==d&&(d*=g),1===b.params.length&&(e=!0),void 0!==f&&(o.Parser._showConsole(o.Parser._debugFlag.simplify,"Reduced to result "+d,[]),f.value=d,f.sign="+")}else if(o.Parser._showConsole(o.Parser._debugFlag.common,b+" all terms digits flag is "+b.allTermsDigits,[]),b.allTermsDigits===!0){switch(o.Parser._showConsole(o.Parser._debugFlag.simplify,"!!!Processing function "+b.name+" with params "+b.params,[]),b.name){case"\\%":d=o.TreeProcedures._performPercentOptimizations(b);break;case"do":e=!1;break;default:d=o.TreeProcedures._mathFunctions.performMathematicalCalculations(b.name,o.TreeProcedures._getAllParamsValues(b),o.TreeProcedures._getUnits(b)),null===d&&o.Parser._showConsole(o.Parser._debugFlag.simplify,"Dont know how to process function "+b,[])}if(void 0!==d){for(d*=g,b.params[0].value=d,b.params[0].type="digit",b.params[0].sign="+";b.params.length>1;)b._removeParam(b.params[1]);e=!0}}else switch(o.Parser._showConsole(o.Parser._debugFlag.simplify,"Not all terms are digits in function "+b+" params are "+b.params,[]),b.name){case"\\frac":b.params[0].isTerminal===!1&&"\\frac"===b.params[0].name?(o.Parser._showConsole(o.Parser._debugFlag.common,"SImplifying fraction in numerator",[]),j=b.params[0],k=b.params[1],b._removeParam(j,!1),b._removeParam(k,!1),b._addParam(j.params[0]),l=o.TreeProcedures.multiply(k,j.params[1]),b._addParam(l),l.simplify(c)):o.Parser._showConsole(o.Parser._debugFlag.simplify,"Cant simplify frac any further",[])}e===!0&&(m=b.params[0],o.Parser._showConsole(o.Parser._debugFlag.simplify,"node "+b+" has only param left "+m,[]),n=m.isTerminal===!0||"+"===b.name||"\\cdot"===b.name,n===!0&&(o.Parser._showConsole(o.Parser._debugFlag.simplify,"CONVERTING last node from "+b+" to "+m,[]),o.Parser._showConsole(o.Parser._debugFlag.simplify,"before conversion it was "+b,[]),m.isTerminal?b.convertToTerminal(m):(o.TreeProcedures._convertTreeNodeTo(b,m),m.incinerate()),o.Parser._showConsole(o.Parser._debugFlag.simplify,"after conversion it is  "+b,[]))),o.Parser._showConsole(o.Parser._debugFlag.simplify,"Finished solving---------------"+b,[])}}}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.ParsingProcedures=Backbone.Model.extend({},{_validOpeningBrackets:["(","{","["],_validClosingBrackets:[")","}","]"],_recursiveTokenRegEx:/^\((.+)\)\+$/i,_productions:a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Productions,peekInPredictionStack:function(b,c){if(!(c>b.length)){var d=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return d.ParsingProcedures._getPeekValue(b[c])}},_getPeekValue:function(b){var c,d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(void 0!==b)return e.ParsingProcedures._recursiveTokenRegEx.test(b)?(e.Parser._showConsole(e.Parser._debugFlag.common,"peek term is recursive..."+b,[]),c=b.match(e.ParsingProcedures._recursiveTokenRegEx),e.Parser._showConsole(e.Parser._debugFlag.common,"matches "+c,[]),d=c[1].split(","),e.Parser._showConsole(e.Parser._debugFlag.common,"tokens are "+d,[]),d[0]):b},expandRecursiveStack:function(b,c){var d,e,f,g,h=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;for(h.Parser._showConsole(h.Parser._debugFlag.common,"Expanding prediction stack "+b+" at index "+c,[]),d=b[c],e=d.match(h.ParsingProcedures._recursiveTokenRegEx),f=e[1].split(","),h.Parser._showConsole(h.Parser._debugFlag.common,"Expanded terms are "+f,[]),g=f.length-1;g>=0;g--)b.splice(c,0,f[g]);h.Parser._showConsole(h.Parser._debugFlag.common,"now prediction stack is "+b,[])},isStackInfinite:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return c.ParsingProcedures.isTermInfinite(b[b.length-1])},isTermInfinite:function(b){if(void 0===b)return!1;var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return c.Parser._showConsole(c.Parser._debugFlag.common,"checking for recursive term "+b+" result is "+this._recursiveTokenRegEx.test(b),[]),c.ParsingProcedures._recursiveTokenRegEx.test(b)},verifyStackWithLookahead:function(b,c){var d,e,f=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(f.Parser._showConsole(f.Parser._debugFlag.common,"*******************verifying stack "+b+" with lookahead "+c,[]),void 0===c||0===c.length)return!0;for(e=c.length-1;e>0;e--){if(d=c[e],f.Parser._showConsole(f.Parser._debugFlag.common,d+" <> "+b[b.length-1],[]),f.ParsingProcedures._isClosingBracket(d))return!0;if(b[b.length-1]===d)return!1;if(f.ParsingProcedures.getOperatorPrecedenceIndex(f.ParsingProcedures._getPeekValue(b[b.length-1]))<f.ParsingProcedures.getOperatorPrecedenceIndex(f.ParsingProcedures._getPeekValue(d)))return f.Parser._showConsole(f.Parser._debugFlag.common,">>>>>>>>>>>!!!!!!>>>>>>>> REJECTING THE STACK because "+b[b.length-1]+" should not be precededed by "+d,[]),!1}return!0},getOperatorPrecedenceIndex:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,d=c.Productions._operatorsInPrecedenceOrder.indexOf(b);return c.Parser._showConsole(c.Parser._debugFlag.common,"checking operator precedence index for operator "+b+" index is "+d,[]),d},isTokenSame:function(a,b){return a.value===b||a.type===b?!0:!1},cloneStringStack:function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c]},pushAllLookAheads:function(a,b,c){var d,e=0;for(d=b.length-1;d>=c;d--)e++,a.push(b[d]);return e},checkWithLookAhead:function(b,c){var d,e,f,g=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(g.Parser._showConsole(g.Parser._debugFlag.rules,"------------------------------------------------------------------------------",[]),g.Parser._showConsole(g.Parser._debugFlag.rules,"checking token "+b+" from Lookahead stack "+c,[]),void 0===c)return!1;for(f=c.length-1;f>=0&&(d=g.ParsingProcedures._getPeekValue(c[f]),e=g.ParsingProcedures.isTermInfinite(c[f]),void 0!==d);f--)if(g.ParsingProcedures._isClosingBracket(b.value)){if(e===!1)return g.ParsingProcedures.isTokenSame(b,d)}else{if(g.ParsingProcedures._isClosingBracket(d))return g.ParsingProcedures.isTokenSame(b,d);if(!e)return g.Parser._showConsole(g.Parser._debugFlag.common,c[f]+" is not recursive...checking normally now",[]),g.ParsingProcedures.isTokenSame(b,d);if(g.Parser._showConsole(g.Parser._debugFlag.common,"checkign with recursive "+g.ParsingProcedures._getPeekValue(c[f]),[]),g.ParsingProcedures.isTokenSame(b,d))return!0}return!1},isNonTerminal:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return c.Parser._showConsole(c.Parser._debugFlag.common,"checking "+b,[]),"E"===b},_isSpecialTerminal:function(a){return"var"===a||"const"===a||"digit"===a?!0:!1},getPredictionStacksForToken:function(b,c,d){var e,f,g,h=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return g=h.ParsingProcedures._isSpecialTerminal(b.type)?b.type:b.value,h.Parser._showConsole(h.Parser._debugFlag.common,"token value is "+g,[]),e=d?h.RangeProductionRules.rangeRulesTable[c]:h.ParsingProcedures._productions.productionTable[c],h.Parser._showConsole(h.Parser._debugFlag.common,"node objects "+e,[]),f=e[g],h.Parser._showConsole(h.Parser._debugFlag.common,"valid rules "+f,[]),f},recordBracket:function(b,c){var d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;if(e.ParsingProcedures._isValidBracket(c)){if(0===b.length)return b.push(c),void e.Parser._showConsole(e.Parser._debugFlag.common,"Updating bracket stack "+b,[]);d=b[b.length-1],e.ParsingProcedures._isOppositeBracket(d,c)?(e.Parser._showConsole(e.Parser._debugFlag.common,"Opposites found "+d+"<>"+c,[]),b.pop()):(e.Parser._showConsole(e.Parser._debugFlag.common,"pushing in stack "+c,[]),b.push(c)),e.Parser._showConsole(e.Parser._debugFlag.common,"Updating bracket stack "+b,[])}},_isValidBracket:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return-1!==c.ParsingProcedures._validOpeningBrackets.indexOf(b)||-1!==c.ParsingProcedures._validClosingBrackets.indexOf(b)},_isOpeningBracket:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return-1!==c.ParsingProcedures._validOpeningBrackets.indexOf(b)},_isClosingBracket:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return-1!==c.ParsingProcedures._validClosingBrackets.indexOf(b)},_isOppositeBracket:function(b,c){var d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;return e.ParsingProcedures._isValidBracket(b)===!1||e.ParsingProcedures._isValidBracket(c)===!1?void e.Parser._showConsole(e.Parser._debugFlag.common,"Wrong bracket Pair "+b+" <> "+c,[]):e.ParsingProcedures._isOpeningBracket(b)?(d=e.ParsingProcedures._validOpeningBrackets.indexOf(b),e.ParsingProcedures._validClosingBrackets[d]===c):(d=e.ParsingProcedures._validClosingBrackets.indexOf(b),e.ParsingProcedures._validOpeningBrackets[d]===c)},getStackCode:function(a){return a.length}}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.RangeProductionRules=Backbone.Model.extend({},{rangeRules:null,rangeRulesTable:null,solution:null,generateRules:function(){var b,c,d,e=["var","digit"],f=["\\le","\\ge","<",">"],g={"\\le":"<","\\ge":">"},h=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,i=f.length,j=null;for(h.RangeProductionRules.rangeRulesTable={E:{"var":[],digit:[]}},h.RangeProductionRules.rangeRules=[],h.RangeProductionRules.solution=[],b=0;i>b;b++)c=f[b],j=[],j.push(e[0]),j.push(c),j.push(e[1]),h.RangeProductionRules._createAndPushRule(j),h.RangeProductionRules.solution.push(h.RangeProductionRules._setSequenceRules(c,1,!0)),j=[],j.push(e[1]),j.push(c),j.push(e[0]),h.RangeProductionRules._createAndPushRule(j),h.RangeProductionRules.solution.push(h.RangeProductionRules._setSequenceRules(c,1)),h.RangeProductionRules._getRulesForSeperatorCombination(c),void 0!==g[c]&&(d=g[c],h.RangeProductionRules._getRulesForSeperatorCombination(c,d),h.RangeProductionRules._getRulesForSeperatorCombination(d,c));h.Parser._showConsole(h.Parser._debugFlag.common,"rules :: "),h.Parser._showConsole(h.Parser._debugFlag.common,h.RangeProductionRules.rangeRules),h.Parser._showConsole(h.Parser._debugFlag.common,"rules table :: "),h.Parser._showConsole(h.Parser._debugFlag.common,h.RangeProductionRules.rangeRulesTable)},_setSequenceRules:function(a,b,c){var d;switch(a){case"\\le":d=1===b?c?"var."+(b-1)+" max.equal."+(b+1):"min.equal.0 var."+(b+1):"max.equal."+(b+1);break;case"\\ge":d=1===b?c?"var."+(b-1)+" min.equal."+(b+1):"max.equal.0 var."+(b+1):"min.equal."+(b+1);break;case"<":d=1===b?c?"var."+(b-1)+" max."+(b+1):"min.0 var."+(b+1):"max."+(b+1);break;case">":d=1===b?c?"var."+(b-1)+" min."+(b+1):"max.0 var."+(b+1):"min."+(b+1)}return d},_getRulesForSeperatorCombination:function(b,c){var d,e=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine,f=["digit","var","digit"];void 0===c&&(c=b),f.splice(1,0,b),f.splice(3,0,c),e.RangeProductionRules._createAndPushRule(f),d=e.RangeProductionRules._setSequenceRules(b,1),d+=" "+e.RangeProductionRules._setSequenceRules(c,3),e.RangeProductionRules.solution.push(d)},_createAndPushRule:function(b){var c=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine;c.RangeProductionRules.rangeRules.push(b),c.RangeProductionRules.rangeRulesTable.E[b[0]].push(c.RangeProductionRules.rangeRules.length-1)}}),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.EquationEnums=Backbone.Model.extend({},{ERROR_TOO_MANY_FREE_VARIABLES:"Too many free variables.",ERROR_CONSTANTS_NOT_DEFINED:"Constants are not defined",ERROR_COMPLICATED:"Its complicated",ERROR_SYNTAX_ERROR:"Equation has syntax error",ERROR_VARIABLE_HAS_TO_BE_QUADRATIC:"Atleast one variable has to be quadratic"})}(window.MathInteractives);var geomFunctions={isDebugMode:!1,distance:function(a,b){return Math.sqrt((b.y-a.y)*(b.y-a.y)+(b.x-a.x)*(b.x-a.x))},distance2:function(a,b,c,d){return Math.sqrt((d-b)*(d-b)+(c-a)*(c-a))},hypotenuse:function(a,b){return 0===a&&0===b?0:Math.abs(a)>Math.abs(b)?Math.abs(a)*Math.sqrt(b/a*(b/a)+1):Math.abs(b)*Math.sqrt(a/b*(a/b)+1)},areaOfEllipse:function(a,b){var c;return c=Math.PI*a*b},areaOfArcSegament:function(a){var b,c,d,e;return c=geomFunctions.areaOfArcSector(a),e=[[a.x1,a.y1],[a.a,a.b],[a.x3,a.y3],[a.x1,a.y1]],d=geomFunctions.areaOfIrregularPolygon(e),b=d+c},areaOfArcSector:function(a){var b,c;return b=geomFunctions.getArcAngle(a),c=b/360*(Math.PI*a.r*a.r)},intersectionOfLines:function(a,b,c,d,e,f,g,h){var i=(a-c)*(f-h)-(b-d)*(e-g);if(0!==i){var j=((a*d-b*c)*(e-g)-(a-c)*(e*h-f*g))/i,k=((a*d-b*c)*(f-h)-(b-d)*(e*h-f*g))/i;return[j,k]}},intersectionOfCircles:function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n={},o={},p=[],g=geomFunctions.distance2(a,b,c,d);return g>e+f?p:g<Math.abs(e-f)?p:(h=(e*e-f*f+g*g)/(2*g),i=(f*f-e*e+g*g)/(2*g),m=Math.sqrt(e*e-h*h),o.a=b-d,o.b=-(a-c),o.c=-o.b*b-o.a*a,k=geomFunctions.getPointAtADistance(o.a,o.b,o.c,a,b,h),l=geomFunctions.getPointAtADistance(o.a,o.b,o.c,c,d,i),j=k[0][0].toFixed(3)===l[0][0].toFixed(3)&&k[0][1].toFixed(3)===l[0][1].toFixed(3)||k[0][0].toFixed(3)===l[1][0].toFixed(3)&&k[0][1].toFixed(3)===l[1][1].toFixed(3)?k[0]:k[1],n.a=-o.b,n.b=o.a,n.c=-o.a*j[0]+o.b*j[1],p=geomFunctions.getPointAtADistance(n.a,n.b,n.c,j[0],j[1],m))},onSegment:function(a,b,c){return b.x<=Math.max(a.x,c.x)&&b.x>=Math.min(a.x,c.x)&&b.y<=Math.max(a.y,c.y)&&b.y>=Math.min(a.y,c.y)},orientation:function(a,b,c){var d=(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y);return 0==d?0:d>0?1:2},doSegmentIntersect:function(a,b,c,d){var e=geomFunctions.orientation(a,b,c),f=geomFunctions.orientation(a,b,d),g=geomFunctions.orientation(c,d,a),h=geomFunctions.orientation(c,d,b);return e!=f&&g!=h?!0:0==e&&geomFunctions.onSegment(a,c,b)?!0:0==f&&geomFunctions.onSegment(a,d,b)?!0:0==g&&geomFunctions.onSegment(c,a,d)?!0:0==h&&geomFunctions.onSegment(c,b,d)?!0:!1},calculateLineOutCode:function(a,b,c,d,e,f,g){var h=0,i=1,j=2,k=4,l=8;return("undefined"==typeof g||null===g)&&(g=0),c+g>=a?h|=i:a>=d-g&&(h|=j),e+g>=b?h|=k:b>=f-g&&(h|=l),h},doesLineIntersectRectangle:function(a,b,c,d,e,f,g,h){var i;return(i=geomFunctions.doSegmentIntersect({x:a,y:b},{x:c,y:d},{x:e,y:g},{x:f,y:g}))?!0:(i=geomFunctions.doSegmentIntersect({x:a,y:b},{x:c,y:d},{x:f,y:g},{x:f,y:h}))?!0:(i=geomFunctions.doSegmentIntersect({x:a,y:b},{x:c,y:d},{x:f,y:h},{x:e,y:h}))?!0:(i=geomFunctions.doSegmentIntersect({x:a,y:b},{x:c,y:d},{x:e,y:h},{x:e,y:g}),i?!0:!1)},lineClipWithRectangle:function(a,b,c,d,e,f,g,h){for(var i,j,k,l=geomFunctions.calculateLineOutCode(a,b),m=geomFunctions.calculateLineOutCode(c,d),n=!1,o=1,p=2,q=4,r=8;;){if(!(l|m)){n=!0;break}if(l&m)break;k=l?l:m,k&r?(i=a+(c-a)*(h-b)/(d-b),j=h):k&q?(i=a+(c-a)*(g-b)/(d-b),j=g):k&p?(j=b+(d-b)*(f-a)/(c-a),i=f):k&o&&(j=b+(d-b)*(e-a)/(c-a),i=e),k==l?(a=i,b=j,l=ComputeOutCode(a,b)):(c=i,d=j,m=ComputeOutCode(c,d))}return n?{x0:a,y0:b,x1:c,y1:d}:void 0},intersectionOfLineAndCircle:function(a,b,c,d,e,f){
var g,h,i,j;return g=geomFunctions.getProjectionOfPointOnLine(a,b,d,e,f),i=geomFunctions.distance2(a,b,g[0],g[1]),i>c?void 0:(h=Math.sqrt(c*c-i*i),j=geomFunctions.getPointAtADistance(d,e,f,g[0],g[1],h))},getPointAtADistance:function(a,b,c,d,e,f){var g,h,i,j=[[],[]];return g=-b,h=a,i=Math.sqrt(g*g+h*h),g/=i,h/=i,j[0][0]=d+g*f,j[0][1]=e+h*f,j[1][0]=d-g*f,j[1][1]=e-h*f,j},mean:function(a,b){return a>0==b>0?a+(b-a)/2:(a+b)/2},getProjectionOfPointOnLine:function(a,b,c,d,e){var f=-c*b+d*a,g=c*c+d*d,h=[(-e*c+d*f)/g,(-c*f-d*e)/g];return h},reflectPointAroundLine:function(a,b,c,d,e){var f=this.getProjectionOfPointOnLine(a,b,c,d,e),g=f[0]-a,h=f[1]-b;return f[0]+=g,f[1]+=h,f},areaOfIrregularPolygon:function(a){var b,c=0,d=0,e=0;for(b=0;b<a.length-1;b++)c+=a[b][0]*a[b+1][1];for(b=0;b<a.length-1;b++)d+=a[b][1]*a[b+1][0];return e=Math.abs(c-d)/2},getArcAngle:function(a){var b,c,d=this.getPositiveAngle(a.from),e=this.getPositiveAngle(a.via),f=this.getPositiveAngle(a.to);return a.x1===a.x3&&a.y3===a.y3?360:(d>f?(b=f,c=d):(b=d,c=f),e>b&&c>e?180*(c-b)/Math.PI:180*(2*Math.PI-(c-b))/Math.PI)},getPointOnArcFromOffset:function(a,b,c){var d,e=geomFunctions.getArcAngle(a),f=e/360*2*Math.PI*a.r;return b*=f,d=360*b/(2*Math.PI*a.r),1===c?geomFunctions.rotatePoint(a.x1,a.y1,a.a,a.b,d,!0):3===c?geomFunctions.rotatePoint(a.x3,a.y3,a.a,a.b,d,!0):void 0},isPointProjectionOnArc:function(a,b){var c,d,e=Math.atan2(b[1]-a.b,b[0]-a.a),f=geomFunctions.getPositiveAngle(a.from),g=geomFunctions.getPositiveAngle(a.via),h=geomFunctions.getPositiveAngle(a.to),e=geomFunctions.getPositiveAngle(e);if(f>h?(c=h,d=f):(c=f,d=h),g>c&&d>g){if(!(e>c&&d>e))return!1}else if(e>c&&d>e)return!1;return!0},getPositiveAngle:function(a){return 0>a&&(a+=2*Math.PI),a},reflectLineAroundLine:function(a,b,c,d,e,f){return[a*(Math.pow(e,2)-Math.pow(d,2))-2*b*d*e,b*(Math.pow(d,2)-Math.pow(e,2))-2*a*d*e,c*(Math.pow(d,2)+Math.pow(e,2))-2*f*(d*a+e*b)]},dilateLine:function(a,b,c,d,e,f){var g=-a*e+b*d,h=a*a+b*b,i=[(-c*a+b*g)/h,(-a*g-b*c)/h];return this.dilatePoint(i[0],i[1],d,e,f)},getRotatedImageMatrix:function(a,b,c){var d,e,f,g,h,i;return e=[[1,0,0],[0,1,0],[-b[0],-b[1],1]],h=-c.angle*Math.PI/180,f=[[Math.cos(h),Math.sin(h),0],[-Math.sin(h),Math.cos(h),0],[0,0,1]],g=[[1,0,0],[0,1,0],[b[0],b[1],1]],i=[[a._a,a._c,0],[a._b,a._d,0],[a._tx,a._ty,1]],i=this.matrixMultiplication(i,e),i=this.matrixMultiplication(i,f),i=this.matrixMultiplication(i,g),d=a.set(i[0][0],i[0][1],i[1][0],i[1][1],i[2][0],i[2][1])},getTranslatedImageMatrix:function(a,b){var c,d,e,f;return e=b.dx,f=b.dy,d=[[1,0,0],[0,1,0],[e,f,1]],rasterImageMatrix=[[a._a,a._c,0],[a._b,a._d,0],[a._tx,a._ty,1]],rasterImageMatrix=this.matrixMultiplication(rasterImageMatrix,d),c=a.set(rasterImageMatrix[0][0],rasterImageMatrix[0][1],rasterImageMatrix[1][0],rasterImageMatrix[1][1],rasterImageMatrix[2][0],rasterImageMatrix[2][1])},getDilatedImageMatrix:function(a,b,c,d){var e,f,g,h,i;return e=this.dilatePoint(b[0],b[1],c[0],c[1],d),f=[[1,0,0],[0,1,0],[-b[0],-b[1],1]],h=[[d.ratio,0,0],[0,d.ratio,0],[0,0,1]],g=[[1,0,0],[0,1,0],[b[0],b[1],1]],i=[[a._a,a._c,0],[a._b,a._d,0],[a._tx,a._ty,1]],i=this.matrixMultiplication(i,f),i=this.matrixMultiplication(i,h),i=this.matrixMultiplication(i,g),f=[[1,0,0],[0,1,0],[e[0]-b[0],e[1]-b[1],1]],i=this.matrixMultiplication(i,f),a.set(i[0][0],i[0][1],i[1][0],i[1][1],i[2][0],i[2][1]),a},getReflectedImageMatrix:function(a,b,c){var d,e,f,g,h,i,j,k;return d=[[1,0,0],[0,1,0],[-c[0],-c[1],1]],i=-b.a/b.b,j=Math.atan(i),e=[[Math.cos(j),Math.sin(j),0],[-Math.sin(j),Math.cos(j),0],[0,0,1]],f=[[1,0,0],[0,-1,0],[0,0,1]],g=[[Math.cos(j),-Math.sin(j),0],[Math.sin(j),Math.cos(j),0],[0,0,1]],h=[[1,0,0],[0,1,0],[c[0],c[1],1]],k=[[a._a,a._c,0],[a._b,a._d,0],[a._tx,a._ty,1]],k=this.matrixMultiplication(k,d),k=this.matrixMultiplication(k,e),k=this.matrixMultiplication(k,f),k=this.matrixMultiplication(k,g),k=this.matrixMultiplication(k,h),a.set(k[0][0],k[0][1],k[1][0],k[1][1],k[2][0],k[2][1]),a},matrixMultiplication:function(a,b){var c,d,e,f=[[0,0,0],[0,0,0],[0,0,0]];for(c=0;3>c;c++)for(d=0;3>d;d++)for(e=0;3>e;e++)f[c][d]+=a[c][e]*b[e][d];return f},getPolarCoordinate:function(a,b,c){var d=Math.sqrt(a*a+b*b),e=Math.atan2(b,a);return c&&(e=180*e/Math.PI),[d,e]},dotProduct:function(a,b,c,d){return a*c+b*d},getSegmentParam:function(a,b,c,d,e,f){var g=this.hypotenuse(e-c,f-d);if(0===g)return 0;var h=this.dotProduct((a-c)/g,(b-d)/g,(e-c)/g,(f-d)/g);return h},midPoint:function(a,b){return[(b[0]+a[0])/2,(b[1]+a[1])/2]},midPoint2:function(a,b,c,d){return[(a+c)/2,(b+d)/2]},closestPointOnSegment:function(a,b,c,d,e,f){var g=this.getSegmentParam(a,b,c,d,e,f);return 0>=g?[c,d]:g>=1?[e,f]:[c+g*(e-c),d+g*(f-d)]},getPointOffset:function(a,b,c,d,e,f){var g,h,i,j;return g=geomFunctions.distance2(a,b,c,d),h=geomFunctions.distance2(a,b,e,f),i=geomFunctions.distance2(c,d,e,f),j=i>g&&i>h?-h/g:h/g},getPointPositionFromOffset:function(a,b,c,d,e){var f,g,h,i,j=[];return f=geomFunctions.distance2(a,b,c,d),0>e?(g=-e*f,h=f+g):(g=e*f,h=e>1?g-f:f-g),h>g?(i=h/f,j[0]=(1-i)*c+i*a,j[1]=(1-i)*d+i*b):(i=g/f,j[0]=(1-i)*a+i*c,j[1]=(1-i)*b+i*d),j},pointAtADistanceFromMidPoint:function(a,b,c,d,e){var f=geomFunctions.midPoint2(a,b,c,d),g=Math.atan2(a-c,d-b),h=[f[0]+e*Math.cos(g),f[1]+e*Math.sin(g)];return h},pointAtADistanceFromMidPointWithBetterName:function(a,b,c,d,e,f,g,h,i){var j=geomFunctions.midPoint2(a,b,c,d),k=geomFunctions.midPoint2(e,f,g,h),l=Math.atan2(j[1]-k[1],j[0]-k[0]),m=[j[0]+i*Math.cos(l),j[1]+i*Math.sin(l)];return m},distanceToSegment:function(a,b,c,d,e,f){var g=this.closestPointOnSegment(a,b,c,d,e,f);return this.hypotenuse(a-g[0],b-g[1])},getParameterOfParabola:function(a,b,c,d,e,f){var g,h,i;return g=Math.sqrt(Math.pow(a-c,2)+Math.pow(b-d,2)),h=Math.atan((b-d)/(a-c)),i=(Math.cos(h)*(f-d)-Math.sin(h)*(e-c))/(2*g)},getParameterOfHyperbola:function(a,b,c,d,e,f,g,h,i,j){var k=Math.sqrt(Math.pow(e-g,2)+Math.pow(f-h,2)),l=Math.sqrt(Math.pow(e-i,2)+Math.pow(f-j,2)),m=Math.atan((Math.cos(d)*(f-b)-Math.sin(d)*(e-a))/c);return l>k?m:-Math.PI+m},getParameterOfEllipse:function(a,b,c,d,e,f,g,h,i,j,k){var l,m=Math.sqrt(Math.pow(f-h,2)+Math.pow(g-i,2)),n=Math.sqrt(Math.pow(f-j,2)+Math.pow(g-k,2));return l=Math.atan(a*(Math.cos(e)/(f-b)-Math.sin(e)/(g-c))/(d*(Math.cos(e)/(g-c)+Math.sin(e)/(f-b)))),n>m?l:0>l?(geomFunctions.traceConsole(3.14+l),3.14+l):-3.14+l},angleBetweenPoints:function(a,b,c,d,e,f,g){var h=Math.atan2(f-d,e-c)-Math.atan2(b-d,a-c);return g?180*h/Math.PI:h},smallerAngleBetweenPoints:function(a,b,c,d,e,f,g){var h;return h=this.angleBetweenPoints(a,b,c,d,e,f,!1),Math.abs(h)>Math.PI&&(h=h>0?2*Math.PI-h:2*Math.PI+h),g?180*h/Math.PI:h},rotatePoint:function(a,b,c,d,e,f,g){f&&(e=e*Math.PI/180),g&&(e*=-1);var h=Math.cos(e),i=Math.sin(e);return[c+(a-c)*h-(b-d)*i,d+(a-c)*i+(b-d)*h]},rotateLine:function(a,b,c,d,e,f,g){var c;return g&&(f=f*Math.PI/180),cos=Math.cos(f),sin=Math.sin(f),[a*cos-b*sin,a*sin+b*cos,a*d+b*e+c-(a*d+b*e)*cos-(a*e-b*d)*sin]},getPolarCoordinates:function(a,b,c,d,e){var f,g,h;return f=a-c,g=b-d,theta=Math.atan2(g,f),theta<0&&(theta+=2*Math.PI),e===!0&&(theta=180*theta/Math.PI),h=this.distance2(a,b,c,d),[h,theta]},getCartesianCoordinates:function(a,b,c,d,e){var f=[];return e===!0&&(d=d*Math.PI/180),f[0]=a+c*Math.cos(d),f[1]=b+c*Math.sin(d),f},translatePoint:function(a,b,c,d){var e=d?-1:1;return"polar"===c.coordinateSystem?this.rotatePoint(a+c.r,b,a,b,c.angle,!0,d):[a+c.dx*e,b+c.dy*e]},getTriangleCircumCentre:function(a,b,c,d,e,f){var g=2*(a*(d-f)+c*(f-b)+e*(b-d)),h=((a*a+b*b)*(d-f)+(c*c+d*d)*(f-b)+(e*e+f*f)*(b-d))/g,i=((a*a+b*b)*(e-c)+(c*c+d*d)*(a-e)+(e*e+f*f)*(c-a))/g;return[h,i]},getTriangleIncentre:function(a,b,c,d,e,f){var g=this.distance2(a,b,c,d),h=this.distance2(a,b,e,f),i=this.distance2(e,f,c,d),j=g+h+i;return[(g*e+h*c+i*a)/j,(g*f+h*d+i*b)/j]},dilatePoint:function(a,b,c,d,e){var f,g;return f=c-(c-a)*e.ratio,g=d-(d-b)*e.ratio,[f,g]},getXYInterceptsOfLine:function(a,b,c){var d,e;return d=0===a?null:-c/a,e=0===b?null:-c/b,{xIntercept:d,yIntercept:e}},getCanvasCoordinates:function(a){var b=a.event.target,c=$(b),d=(c.offset(),[a.point.x,a.point.y]);return d},traceConsole:function(a){this.isDebugMode===!0},calculatePerimeter:function(a){var b,c,d,e,f,g,h=0,i=[],j="x",k="y";for(b=Object.keys(a[0]).length,c=.5*b,e=0;c>e;e++)j+=e,k+=e,f=a[0][j],g=a[0][k],i.push([f,g]),j="x",k="y";for(i.push(i[0]),e=0;c>e;e++)d=geomFunctions.distance2(i[e][0],i[e][1],i[e+1][0],i[e+1][1]),h+=d;return h}},CurveDerivativeTracker=Backbone.Model.extend({_points:void 0,_arrOrderNo:void 0,currentDerivatives:void 0,flipState:void 0,initialize:function(){this._points=[],this._arrOrderNo=[],this.currentDerivatives=[],this.flipState=[],this.curveAffinity=[]},trackPoint:function(a){var b,c,d,e,f,g;for(orderCounter=0;orderCounter<4&&(breakAfter=void 0===this._arrOrderNo[orderCounter],0===orderCounter?(b="",breakAfter&&(this._arrOrderNo[orderCounter]=[]),this._arrOrderNo[orderCounter].push(a)):(breakAfter&&(this._arrOrderNo[orderCounter]=[]),c=this._arrOrderNo[orderCounter-1],e=this._getPointDiff(c),1===orderCounter&&(f=180*Math.atan2(e[1],e[0])/Math.PI,Math.abs(f)>85&&(g=f>0?+(1/0):-(1/0),this.curveAffinity[this.curveAffinity.length-1]!==g&&(geomFunctions.traceConsole("Curve now leads to "+g),this.curveAffinity.push(g)))),this._arrOrderNo[orderCounter].push(e),this.flipState[orderCounter]=this._getFlipState(this._arrOrderNo[orderCounter]),b+=this.printPoint(c[c.length-1])+">>"),d=this._arrOrderNo[orderCounter],this.currentDerivatives[orderCounter]=d[d.length-1],!breakAfter);orderCounter++);geomFunctions.traceConsole("Order Derivatives "+this.printPoint(this.currentDerivatives[0])+" >> "+this.printPoint(this.currentDerivatives[1])+" >> "+this.printPoint(this.currentDerivatives[2])+" >> "+this.printPoint(this.currentDerivatives[3])),void 0!==this.currentDerivatives[1]},_getFlipState:function(a){var b=a[a.length-1],c=a[a.length-2];if(void 0!==c){var d=b[0]>=0?1:-1,e=c[0]>=0?1:-1,f=[];return f[0]=0>d*e&&Math.abs(b[0])>1&&Math.abs(c[0])>1,d=b[1]>=0?1:-1,e=c[1]>=0?1:-1,f[1]=0>d*e&&Math.abs(b[1])>1&&Math.abs(c[1])>1,f}},printPoint:function(a){return void 0!==a?a[0].toFixed(2)+","+a[1].toFixed(2):void 0},_radToDeg:function(a){return 180*a/Math.PI},_getPointDiff:function(a){var b=a[a.length-1],c=a[a.length-2];return[b[0]-c[0],b[1]-c[1]]},clear:function(){for(;this._points.length>0;)this._points.pop();for(;this._arrOrderNo.length>0;)this._arrOrderNo.pop();for(;this.currentDerivatives.length>0;)this.currentDerivatives.pop();for(;this.flipState.length>0;)this.flipState.pop()}}),getCanvasCoordinates=function(a){var b=a.event.target,c=$(b),d=(c.offset(),[a.point.x,a.point.y]);return d};!function(a){"use strict";a.Common.Components.Models.MathUtilitiesGraphNew.plotterModel=Backbone.Model.extend({_equations:null,_equationsMap:null,_annotationPaths:null,incompleteAnnotations:null,_firstPoint:null,pathThickness:null,initialize:function(){this._equations=[],this._equationsMap={},this.incompleteAnnotations=[]}},{BASEPATH:null})}(window.MathInteractives),function(a){"use strict";a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile=Backbone.Model.extend({},{profiler:{},getStartTime:function(a){var b=(new Date).getTime();this.profiler[a]={id:"",start:0,end:0,processingTime:0},this.profiler[a].start=b},getProcessingTime:function(a){var b=(new Date).getTime();return this.profiler[a].end=b,this.profiler[a].processingTime=b-this.profiler[a].start,this.profiler[a].processingTime}})}(window.MathInteractives),function(a){"use strict";a.Common.Components.Views.MathUtilitiesGraphNew.GridGraph=Backbone.View.extend({ID:null,_shapePan:null,_projectLayers:null,_paperScope:null,_canvasSize:null,markerBounds:null,_polarLineAngleMarker:null,_zoomFactors:[1,2,5],TEXT_ALIGN:{HORIZONTAL:{LEFT:"left",RIGHT:"right",CENTER:"center"},VERTICAL:{TOP:"top",BOTTOM:"bottom",MIDDLE:"middle"}},PI:"π",_ADJECENT_LINES_MIN_DISTANCE:14,MINIMUM_THRESHOLD_LINE_DISTANCE:15,_ZOOM_DISTANCE:3,_ZOOM_STEPS:6,_ZOOM_STEPS_FOR_FIVE_MULTIPLIER:8,GRID_LINES:{DEFAULT:4,FIVE_MULTIPLIER:5},MARKER_FONT_SIZE:{ON_GRAPH_AREA:12,ON_GRAPH_AREA_PROJECTOR_MODE:16},MARKER_FONT_COLOR:{ON_GRAPH_AREA:"#000000",AT_END_OF_GRAPH_AREA:"grey"},_gridGraphModelObject:null,_isGraphDefaultZoomBehaviourAllowed:null,_isGraphDefaultPanBehaviourAllowed:null,snapToGridFlag:void 0,isDragInProgress:void 0,_X10_STRING:"×10",_gridMode:null,_selectionRect:null,_touchDoubleTapCounter:null,_DOUBLE_TAP_THRESHOLD:600,_pinchCounter:null,_MINIMUM_ZOOM_LEVEL_FACTOR:.65,_MAXIMUM_ZOOM_LEVEL_FACTOR:1.5,_ZOOM_LEVEL_INCREMENT_STEPS:.1,_GRAPH_SHIFT_DISTANCE:50,graphShiftDistance:null,graphShiftDistanceAfterDrag:null,isSnap:!1,isDrawingsDraggable:null,isTooltipForPoint:null,paddingTop:0,paddingLeft:0,settingsOption:{XLowerTextBox:"x-lower-text-box",XUpperTextBox:"x-upper-text-box",YLowerTextBox:"y-lower-text-box",YUpperTextBox:"y-upper-text-box",graphTypeButton:"change-graph-type",zoomInButton:"zoom-graph",zoomOutButton:"zoom-out-graph",restoreDefaultZooming:"restore-default-zoom",gridLineDisplayButton:"toggle-grid-line-display",labelLineDisplayButton:"toggle-label-display",axesLinesDisplayButton:"toggle-axes-display",equalizeAxisScaleButton:"equalize-axis",projectorModeButton:"toggle-projector-mode",xAxisLabelInRadian:"change-x-axis-label-to-radian",xAxisLabelInDegree:"change-x-axis-label-to-degree",yAxisLabelInRadian:"change-y-axis-label-to-radian",yAxisLabelInDegree:"change-y-axis-label-to-degree",polarAngleInDegree:"change-polar-angle-label-to-degree",polarAngleInRadian:"change-polar-angle-label-to-radian",polarAngleLinesButton:"toggle-polar-angle-label-style",xAxisLableStyleButton:"toggle-x-axis-label-style",yAxisLabelStyleButton:"toggle-y-axis-label-style"},events:{click:"_functionAttacher",keyup:"_functionAttacher",mousewheel:"_functionAttacher"},_isGestureProgress:!0,resetGridMode:function(){this._gridMode="Graph"},getGridMode:function(){return this._gridMode},setGridMode:function(a){this._gridMode=a},isSnapToGridEnabled:function(){return this.snapToGridFlag},setSnapSnapToGridFlag:function(a){this.snapToGridFlag=a},_isGridRefreshPaused:void 0,pauseGridRefresh:function(){this._isGridRefreshPaused=!0},resumeGridRefresh:function(){this._isGridRefreshPaused=!1},_functionAttacher:function(b,c){var d,e,f=this.ID,g=this.settingsOption,h=$(b.target).attr("data-setting-option");switch(b.type){case"click":switch(h){case g.graphTypeButton:this._graphTypeChange();break;case g.gridLineDisplayButton:this._gridLineDisplayChange();break;case g.labelLineDisplayButton:this._labelDisplayChange();break;case g.axesLinesDisplayButton:this._axisDisplayChange();break;case g.projectorModeButton:this._projectorModeChange();break;case g.equalizeAxisScaleButton:this._equalizeAxisScales();break;case g.xAxisLabelInRadian:this._xAxisMarkerLineStyle(!0);break;case g.xAxisLabelInDegree:this._xAxisMarkerLineStyle(!1);break;case g.yAxisLabelInRadian:this._yAxisMarkerLineStyle(!0);break;case g.yAxisLabelInDegree:this._yAxisMarkerLineStyle(!1);break;case g.polarAngleInDegree:this._polarAngleLineMarkerStyle(!1);break;case g.polarAngleInRadian:this._polarAngleLineMarkerStyle(!0);break;case g.polarAngleLinesButton:this._polarAngleLineMarkerStyleToggle();break;case g.xAxisLableStyleButton:this._xAxisMarkerStyleToggle();break;case g.yAxisLabelStyleButton:this._yAxisMarkerStyleToggle();break;case g.zoomInButton:this._zoomInButtonClicked();break;case g.restoreDefaultZooming:this._restoreDefaultZoomingClicked();break;case g.zoomOutButton:this._zoomOutButtonClicked();break;case g.XLowerTextBox:case g.XUpperTextBox:case g.YLowerTextBox:case g.YUpperTextBox:break;default:this._setTextBoxValues()}break;case"keyup":switch(d=b.keyCode,e=[37,38,39,40,13,9,20,27,33,34,35,36,45],h){case g.XLowerTextBox:case g.XUpperTextBox:-1===e.indexOf(d)&&this._graphAxisLimitChangedByUserInput(!0,e);break;case g.YLowerTextBox:case g.YUpperTextBox:-1===e.indexOf(d)&&this._graphAxisLimitChangedByUserInput(!1,e)}break;case"mousewheel":switch(b.target.id){case f.canvasId:a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Profile.getStartTime("graph"),this._isGraphDefaultZoomBehaviourAllowed===!0&&"Graph"===this._gridMode&&(this.setDefaultPanBehaviour(!1),this._zoomGraph(c,!0),this.setDefaultPanBehaviour(!0),b.preventDefault())}break;case"dblclick":switch(b.target.id){case f.canvasId:}}},_triggerEqualizeEvent:function(a){a===!0?this.trigger("graph:un-equalize"):this.trigger("graph:equalize")},_customZoomInMultiplier:null,_customZoomOutMultiplier:null,_backgroundColor:"white",initialize:function(){this.ID={canvasId:null,XLowerTextBox:null,XUpperTextBox:null,YLowerTextBox:null,YUpperTextBox:null,graphTypeButton:null,zoomInButton:null,zoomOutButton:null,restoreDefaultZooming:null,gridLineDisplayButton:null,labelLineDisplayButton:null,axesLinesDisplayButton:null,equalizeAxisScaleButton:null,projectorModeButton:null,xAxisLabelInRadian:null,xAxisLabelInDegree:null,yAxisLabelInRadian:null,yAxisLabelInDegree:null,polarAngleInDegree:null,polarAngleInRadian:null,polarAngleLinesButton:null,xAxisLableStyleButton:null,yAxisLabelStyleButton:null},this._projectLayers={gridLayer:null,shapeLayer:null,pointLayer:null,imageLayer:null,serviceLayer:null},this._canvasSize={height:null,width:null},this.markerBounds={max:{x:null,y:null,"\\theta":null},min:{x:null,y:null,"\\theta":null}},this._polarLineAngleMarker={degree:[],radian:[]};var b,c,d,e;b=this.options.option,this.disableLineTooltip=this.options.option.disableLineTooltip,this._gridGraphModelObject=new a.Common.Components.Models.MathUtilitiesGraphNew.GridGraphModel,this.adjustGraphToPoints=this.options.option.adjustGraphToPoints,this._gridGraphModelObject.set("_points",[]),this._gridGraphModelObject.set("_plots",[]),this._gridGraphModelObject.set("_images",[]),this._defaultClassVariblesValue(),this._updateClassVariablesValue(b),"undefined"!=typeof this.options.option.paddingTop&&(this.paddingTop=this.options.option.paddingTop),"undefined"!=typeof this.options.option.paddingLeft&&(this.paddingLeft=this.options.option.paddingLeft),this.isDragInProgress=!1,this.snapToGridFlag=!1,this._gridMode="Graph",this._polarAngleLinesMarkerArrayGenerator(),this._canvasSetUp(),b.backgroundColor&&(this._backgroundColor=new this._paperScope.Color(b.backgroundColor[0],b.backgroundColor[1],b.backgroundColor[2],b.backgroundColor[3])),this._canvasTool(),this.render(),e=this,this._onShapeRollOver=function(a){e.isDragInProgress||"Graph"!==e._gridMode||(c=a.target,$(a.event.target).is("canvas")&&(d=c.equation,d.isDraggable()&&d.trigger("roll-over",d)))},this._onShapeRollOut=function(a){e.isDragInProgress||"Graph"!==e._gridMode||$(a.event.target).is("canvas")&&(c=a.target,d=c.equation,d.isDraggable()&&d.trigger("roll-out",d))}},render:function(){this._cartesionSymbolGenerator(),this._restoreDefaultZoom()},_defaultClassVariblesValue:function(){var a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),c=this._canvasSize,d=(b._graphOrigin,b._graphsAxisLimits),e=b._graphParameters;this._paperScope;c.height=800,c.width=1244,d.defaultLimits.xLower=d.currentLimits.xLower=-10,d.defaultLimits.xUpper=d.currentLimits.xUpper=10,d.defaultLimits.yLower=d.currentLimits.yLower=-10,d.defaultLimits.yUpper=d.currentLimits.yUpper=10,e.graphGridLine=4,e.xGridLine=4,e.yGridLine=4,this._shapePan=!1,this._isGraphDefaultZoomBehaviourAllowed=!0,this._isGraphDefaultPanBehaviourAllowed=!0,this.graphShiftDistance=this._GRAPH_SHIFT_DISTANCE,this.graphShiftDistanceAfterDrag=this.graphShiftDistance,this.isDrawingsDraggable=!1,this.isTooltipForPoint=!0},_updateClassVariablesValue:function(a){var b=this._gridGraphModelObject,c=b.get("_graphDisplayValues"),d=this._canvasSize,e=c._graphLimitTextBoxDomElement,f=this.ID,g=c._graphsAxisLimits;f.canvasId=a.canvasId,f.XLowerTextBox=a.XLowerTextBox,f.XUpperTextBox=a.XUpperTextBox,f.YLowerTextBox=a.YLowerTextBox,f.YUpperTextBox=a.YUpperTextBox,f.graphTypeButton=a.graphTypeButton,f.zoomInButton=a.zoomInButton,f.zoomOutButton=a.zoomOutButton,f.restoreDefaultZooming=a.restoreDefaultZooming,f.gridLineDisplayButton=a.gridLineDisplayButton,f.labelLineDisplayButton=a.labelLineDisplayButton,f.axesLinesDisplayButton=a.axesLinesDisplayButton,f.equalizeAxisScaleButton=a.equalizeAxisScaleButton,f.projectorModeButton=a.projectorModeButton,f.xAxisLabelInRadian=a.xAxisLabelInRadian,f.xAxisLabelInDegree=a.xAxisLabelInDegree,f.yAxisLabelInRadian=a.yAxisLabelInRadian,f.yAxisLabelInDegree=a.yAxisLabelInDegree,f.polarAngleInRadian=a.polarAngleInRadian,f.polarAngleInDegree=a.polarAngleInDegree,f.yAxisLabelStyleButton=a.yAxisLabelStyleButton,f.xAxisLableStyleButton=a.xAxisLableStyleButton,f.polarAngleLinesButton=a.polarAngleLinesButton,e.xLower=document.getElementById(f.XLowerTextBox),e.xUpper=document.getElementById(f.XUpperTextBox),e.yLower=document.getElementById(f.YLowerTextBox),e.yUpper=document.getElementById(f.YUpperTextBox),"number"==typeof a.canvasHeight&&"number"==typeof a.canvasWidth&&(d.height=a.canvasHeight,d.width=a.canvasWidth),"number"==typeof a.xAxisMinValue&&"number"==typeof a.xAxisMaxValue&&(g.defaultLimits.xLower=g.currentLimits.xLower=a.xAxisMinValue,g.defaultLimits.xUpper=g.currentLimits.xUpper=a.xAxisMaxValue),void 0!==a._isGraphDefaultZoomBehaviourAllowed&&(this._isGraphDefaultZoomBehaviourAllowed=a.isGraphDefaultZoomBehaviourAllowed),void 0!==a._isGraphDefaultPanBehaviourAllowed&&(this._isGraphDefaultPanBehaviourAllowed=a.isGraphDefaultPanBehaviourAllowed),a.isDrawingsDraggable&&(this.isDrawingsDraggable=!0),(a.isTooltipForPoint||a.isTooltipForPoint===!1)&&(this.isTooltipForPoint=a.isTooltipForPoint),a.stopDoubleClickZoom&&(c._zoomingFactor.doubleClickZoomAllow=!a.stopDoubleClickZoom)},_canvasSetUp:function(){var a,b,c=this._gridGraphModelObject.get("_graphDisplayValues"),d=document.getElementById(this.ID.canvasId),e=this._canvasSize.height,f=this._canvasSize.width,g=$(d);300===g.width()&&150===g.height()?g.width(f).height(e):(this._canvasSize.width=g.width(),this._canvasSize.height=g.height()),this._paperScope=new paper.PaperScope,this._paperScope.install($("#"+this.ID.canvasId)),this._paperScope.setup(d),b=this,a=this._paperScope,c._graphOrigin.defaultOrigin=new this._paperScope.Point(d.width/2,d.height/2),this._gridGraphModelObject.get("_graphDisplayValues")._graphOrigin.defaultOrigin=new a.Point(this._canvasSize.width/2,this._canvasSize.height/2),this._projectLayers.gridLayer=a.project.activeLayer,this._projectLayers.imageLayer=new a.Layer,this._projectLayers.shapeLayer=new a.Layer,this._projectLayers.pointLayer=new a.Layer,this._projectLayers.labelLayer=new a.Layer,this._projectLayers.bannerLayer=new a.Layer,this._projectLayers.annotationLayer=new a.Layer,this._projectLayers.serviceLayer=new a.Layer,this._projectLayers.gridLayer.activate(),b=this,this._pinchCounter=1,d.addEventListener("gesturechange",function(a){b._isGraphDefaultZoomBehaviourAllowed===!0&&b._pinchZoom(a)}),d.addEventListener("gesturestart",function(a){b._gestureStartEvent=a,b._isGestureProgress=!1}),d.addEventListener("gestureend",function(){b._gestureStartEvent=null,b._isGestureProgress=!0}),d.addEventListener("touchstart",function(a){null===b._touchDoubleTapCounter?b._touchDoubleTapCounter=(new Date).getTime():(new Date).getTime()-b._touchDoubleTapCounter>b._DOUBLE_TAP_THRESHOLD?b._touchDoubleTapCounter=null:(b._touchDoubleTapCounter=null,b._graphDoubleClick(a))})},_gestureStartEvent:null,_pinchZoom:function(a){var b=this,c=$("#"+b.ID.canvasId).offset(),d={x:b._gestureStartEvent.pageX-c.left,y:b._gestureStartEvent.pageY-c.top};b.activateScope();var e,f,g,h,i,j,k,l,m,n,o;j=b._gridGraphModelObject,k=j.get("_graphDisplayValues"),f=k._graphOrigin,e=d,g=f.currentOrigin,i=f.defaultOrigin,h=k._zoomingFactor,l=b._canvasSize.height,m=b._canvasSize.width,f.isOriginPositionChanged=!0,n=b._getGraphPointCoordinates([e.x,e.y]),o=b._originShiftFactorForDoubleClick(n),b.graphShiftDistance=o.distance,h.previousZoomAngle=o.angle,a.scale>1?(5===this._pinchCounter&&(this._zoomGraph(1,!1,!0),this._pinchCounter=0),this._pinchCounter++):(5===this._pinchCounter&&(this._zoomGraph(-1,!1,!0),this._pinchCounter=0),this._pinchCounter++)},_canvasTool:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=this._gridGraphModelObject,p=o.get("_graphDisplayValues"),q=this._canvasSize.width,r=this._canvasSize.height,s=p._zoomingFactor,t=p._graphOrigin,u=this,v=!1,w=this._paperScope;this._projectLayers.shapeLayer.onMouseDown=function(b){u.activateScope(),u.trigger("grid-mousedown",b),u._isGraphDefaultPanBehaviourAllowed===!0&&"Graph"===u._gridMode&&u._isGestureProgress&&(u._projectLayers.shapeLayer.activate(),a=w.project.activeLayer.hitTest(b.point,{stroke:!0,type:w.Group}),void 0!==a?("stroke"===a.type&&(v=!0),v=null===a?!1:null!==a.item&&"group"===a.item._parent.type?!0:!1):v=!1,u._shapePan=v,v===!0&&this.disableLineTooltip===!0?(u._projectLayers.shapeLayer.activate(),u._traceMouseDownHandle.apply(u,[b,a.item._parent]),u._projectLayers.gridLayer.activate()):u.off("grid-graph-mousedrag",j).on("grid-graph-mousedrag",j).off("grid-graph-mouseup",i).on("grid-graph-mouseup",i))},this._paperScope.tool.minDistance=1,this._projectLayers.shapeLayer.onMouseDrag=function(b){u.activateScope(),u._isGraphDefaultPanBehaviourAllowed===!0&&"Graph"===u._gridMode&&u._isGestureProgress&&u._shapePan===!0&&this.disableLineTooltip===!0&&(u._projectLayers.shapeLayer.activate(),u._traceMouseDragHandle.apply(u,[b,a.item._parent]),u._projectLayers.gridLayer.activate())},b=function(a){var b,c;if(u.activateScope(),u._isGraphDefaultPanBehaviourAllowed===!0&&"Graph"===u._gridMode)u._shapePan===!0||(t.currentOrigin.x+=a.delta.x,t.currentOrigin.y+=a.delta.y,u._graphTypeSelector(),t.isOriginPositionChanged=!0,u._graphLimitChangesDuringDragging(),u._deltaAngle(),u._previousMaxValue=u._getGraphPointCoordinates([q,r/2])[0],b=o.get("_plots").length,c=o.get("_images").length,(0!==b||0!==c)&&(0!==b.length&&(u._layerDrag(u._projectLayers.shapeLayer,a.delta),u._layerDrag(u._projectLayers.labelLayer,a.delta),u._layerDrag(u._projectLayers.annotationLayer,a.delta)),0!==c&&u._layerDrag(u._projectLayers.imageLayer,a.delta),clearTimeout($.data(u,"timer")),$.data(u,"timer",setTimeout(function(){u.trigger("graph:zoom-pan"),u.refreshView()},150))),0!==o.get("_points").length&&u._repositionPoints());else if("SelectionRect"===u._gridMode){var d=u._selectionRect._startPoint,e=u._getMinXMinYFromPoints(a.point,d),f=Math.abs(a.point.x-u._selectionRect._startPoint.x),g=Math.abs(a.point.y-u._selectionRect._startPoint.y);u._selectionRect.remove(),u._selectionRect=null,u._selectionRect=new u._paperScope.Path.Rectangle(e,{width:f,height:g}),u._selectionRect.style={strokeColor:"black",strokeWidth:2},u._selectionRect._startPoint=d}},c=this._projectLayers.gridLayer,c.name="grid",d=this._projectLayers.shapeLayer,d.name="shape",e=this,f=this._projectLayers.pointLayer,f.name="point",g=this._projectLayers.bannerLayer,g.name="banner",h=this._projectLayers.imageLayer,h.name="image",l=this._projectLayers.annotationLayer,l.name="annotation",m=this._projectLayers.labelLayer,m.name="label",this._addLayerClickDoubleClickEvents(f),this._addLayerClickDoubleClickEvents(this._projectLayers.shapeLayer),this._addLayerClickDoubleClickEvents(g),this._addLayerClickDoubleClickEvents(this._projectLayers.gridLayer),this._addLayerClickDoubleClickEvents(h),this._addLayerClickDoubleClickEvents(l),this._addLayerClickDoubleClickEvents(m),this._paperScope.tool.onMouseDrag=function(a){"undefined"==typeof u.$el.attr("ogCursor")&&u._isGraphDefaultPanBehaviourAllowed===!0&&(u.$el.attr("ogCursor",u.$el.find("canvas").css("cursor")),u.$el.find("canvas").trigger("interactivegraphpanningstart"),u.$el.find("canvas").css("cursor","move")),u.trigger("grid-graph-mousedrag",a),u.trigger("draw-annotation",a)},this._paperScope.tool.onMouseDown=function(a){u.trigger("grid-graph-mousedown",a),u.trigger("annotation-start",a)},this._paperScope.tool.onMouseUp=function(a){u.$el.attr("ogCursor")&&(u.$el.find("canvas").css("cursor",u.$el.attr("ogCursor")),u.$el.find("canvas").trigger("interactivegraphpanningstop"),u.$el.removeAttr("ogCursor")),u.activateScope(),3!==a.event.which&&(e.isDragInProgress=!1,s.previousZoomAngle=u._angleBetweenTwoPoints(t.currentOrigin,t.defaultOrigin),n=u._distanceBetweenPoints(t.currentOrigin,t.defaultOrigin),s.zoomCounter=n/u._GRAPH_SHIFT_DISTANCE,null!==u._gridGraphModelObject.get("circleDrag")&&(u._gridGraphModelObject.get("circleDrag").visible=!1,u.$(".drag-tooltip").remove(),u._shapePan=!1),u.trigger("grid-graph-mouseup",a),u.trigger("annotation-end",a))},!("ontouchstart"in window),i=function(){if("SelectionRect"===this._gridMode&&this._selectionRect){var a=this._selectionRect.bounds;this._selectionRect.remove(),this._selectionRect=null,this.trigger("selection-rect-complete",a)}this.off("grid-graph-mousedrag",j)},j=function(a){b(a)},this.on("grid-layer-mousedown",function(a){"SelectionRect"===u._gridMode&&(u._selectionRect=new this._paperScope.Path.Rectangle(a.point,{width:1,height:1}),u._selectionRect.strokeColor="black",u._selectionRect.strokeWidth=2,u._selectionRect._startPoint=a.point),this.on("grid-graph-mousedrag",j),this.on("grid-graph-mouseup",i)}),k=function(a){u._isGraphDefaultPanBehaviourAllowed===!0&&"Graph"===u._gridMode&&u._isGestureProgress&&(u.trigger("graph:zoom-pan"),u.refreshView(),u._shapePan=!1),t.doubleClickedPoint=a.point},this.on("grid-layer-mouseup",k),this.on("grid-layer-doubleclick",$.proxy(this._graphDoubleClick,this))},_getMinXMinYFromPoints:function(a,b){var c={x:null,y:null};return c.x=a.x<=b.x?a.x:b.x,c.y=a.y<=b.y?a.y:b.y,c},refreshView:function(){this._isGridRefreshPaused||this._paperScope.view.draw()},_addLayerClickDoubleClickEvents:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=200;e=this,h=function(c){if(3!==c.event.which&&("Graph"===e._gridMode||"SelectionRect"===e._gridMode)){"image"!==a.name&&"service"!==a.name;var h,j,k,l;b&&clearInterval(b),h=function(){b&&(d=void 0,clearInterval(b)),e.isDragInProgress=!1,e.off("grid-graph-mouseup",h)},j=c.target,k=j.parent,l=void 0===j.equation?k.equation:j.equation,l&&(l.getLabelData().labelObject!==j?l.trigger("drag-begin",e._getGraphPointCoordinates(getCanvasCoordinates(c)),l):l.trigger("label-drag-begin",getCanvasCoordinates(c),l)),(!l||l.isDraggable())&&(f=getCanvasCoordinates(c),"label"!==a.name&&(g=[f[0]-k.position.x,f[1]-k.position.y]),e.on("grid-graph-mouseup",h),e.isDragInProgress=!0,b=setInterval(function(){i(c)},n/2))}},i=function(h){var i,j,n,o,p,q;clearInterval(b),b=void 0,i=h.target,e.trigger(a.name+"-layer-mousedown",h),"grid"!==a.name&&(j=i.parent,n=getCanvasCoordinates(h),p=function(b){d=i;var h,j,n,p,q;c&&(clearInterval(c),c=void 0),void 0!==b.event&&(o||(o=f,m=f),k=getCanvasCoordinates(b)[0]-m[0],l=getCanvasCoordinates(b)[1]-m[1],j=i.parent,n=getCanvasCoordinates(b),p=n[0]-o[0],q=n[1]-o[1],h=void 0===i.equation?j.equation:i.equation,void 0!==g&&(n[0]-=g[0],n[1]-=g[1]),e.snapToGridFlag&&"point"===a.name&&(n=e.getClosestCanvasPoint(n)),h&&(h.getLabelData().labelObject!==i?h.trigger("pre-drag",e._getGraphPointCoordinates(n),h,n):h.trigger("label-pre-drag",n,h)),"label"!==a.name?(j.position.x=n[0],j.position.y=n[1]):(i.position.x=n[0],i.position.y=n[1]),o=n,this._paperScope.view.draw(),h&&h.getLabelData().labelObject!==i&&h.trigger("post-drag",h,!0,k,l),m=getCanvasCoordinates(b))},q=function(b){if(3!==b.event.which){var c,d,f,h,j,k;e.off("grid-graph-mousedrag",p),e.off("grid-graph-mouseup",q),h=getCanvasCoordinates(b),d=h[0]-n[0],f=h[1]-n[1],j=.1,Math.abs(d)<j&&Math.abs(f)<j||(c=void 0===i.equation?i.parent.equation:i.equation,void 0!==g&&(h[0]-=g[0],h[1]-=g[1]),e.snapToGridFlag&&"point"===a.name&&(h=e.getClosestCanvasPoint(h)),"label"!==a.name&&c.trigger("pre-relocate",e._getGraphPointCoordinates(h),c,h),e.isDragInProgress=!1,k=e._getGraphPointCoordinates(h),"label"!==a.name&&("point"===c.getSpecie()&&(c.setPoints([k]),c.trigger("change-equation")),c&&c.trigger("post-relocate",c,k)))}},e.on("grid-graph-mousedrag",p),e.on("grid-graph-mouseup",q))},("grid"===a.name||e.isDrawingsDraggable===!0)&&(a.onMouseDown=h),a.onDoubleClick=function(d){
if(3!==d.event.which&&"Graph"===e._gridMode){var f;b&&(clearInterval(b),b=void 0),c&&(clearInterval(c),c=void 0),e.isDragInProgress=!1,f=d.target,e.trigger(a.name+"-layer-doubleclick",d)}},j=function(b){c&&(clearInterval(c),c=void 0),e.isDragInProgress=!1,d!==b.target&&(e.trigger(a.name+"-layer-mouseup",b),e.trigger(a.name+"-layer-click",b),e._paperScope.view.draw())},a.onClick=function(b){3!==b.event.which&&("Graph"===e._gridMode||"point"===a.name||"tabletDrawing"===e._gridMode)&&(c&&(clearInterval(c),c=void 0),c=setInterval(function(){j(b)},n))}},_onShapeRollOver:void 0,_onShapeRollOut:void 0,_setPathRollOverListeners:function(a){a.onMouseEnter=this._onShapeRollOver,a.onMouseLeave=this._onShapeRollOut},_removePathRollOverListeners:function(a){a.onMouseEnter=void 0,a.onMouseLeave=void 0},_labelDisplayChange:function(){var a,b;a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b._graphDisplay.isLabelShown=!b._graphDisplay.isLabelShown,this._graphTypeSelector()},_axisDisplayChange:function(){var a,b;a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b._graphDisplay.isAxisLinesShown=!b._graphDisplay.isAxisLinesShown,this._graphTypeSelector()},_gridLineDisplayChange:function(){var a,b;a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b._graphDisplay.isGridLineShown=!b._graphDisplay.isGridLineShown,this._graphTypeSelector()},_projectorModeChange:function(){var a,b;a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b._graphDisplay.isProjectorModeOn=!b._graphDisplay.isProjectorModeOn,this._cartesionSymbolGenerator(),this._graphTypeSelector()},graphZoomIn:function(){this.isDragInProgress||this._zoomInButtonClicked()},_zoomInButtonClicked:function(){if(!this.isDragInProgress){var a,b,c=0,d=this,e=this._ZOOM_STEPS;this._customZoomInMultiplier&&(e=this._customZoomInMultiplier),a=function(){d._zoomGraph(1,!0)},b=setInterval(function(){a(),c++,c>e&&clearInterval(b)},.1)}},graphZoomOut:function(){this.isDragInProgress||this._zoomOutButtonClicked()},_zoomOutButtonClicked:function(){if(!this.isDragInProgress){var a,b,c=0,d=this,e=this._ZOOM_STEPS;this._customZoomOutMultiplier&&(e=this._customZoomOutMultiplier),a=function(){d._zoomGraph(-1,!0)},b=setInterval(function(){a(),c++,c>e&&clearInterval(b)},.1)}},_graphDoubleClick:function(a){this.activateScope();var b,c,d,e,f,g,h=this._gridGraphModelObject,i=h.get("_graphDisplayValues"),g=i._zoomingFactor.doubleClickZoomAllow,j=1,k=this,l=i._graphOrigin,m=a.point,n=(l.currentOrigin,l.defaultOrigin,i._zoomingFactor),o=(this._canvasSize.height,this._canvasSize.width,this.graphShiftDistance),b=this._ZOOM_STEPS;this._shapePan||g===!1||(l.isOriginPositionChanged=!0,e=this._getGraphPointCoordinates([m.x,m.y]),c=function(){k._zoomGraph(1,!1)},d=setInterval(function(){f=k._originShiftFactorForDoubleClick(e),k.graphShiftDistance=f.distance,n.previousZoomAngle=f.angle,c(),j++,j>b&&(clearInterval(d),k.graphShiftDistance=o)},.1))},_xAxisMarkerStyleToggle:function(){var a,b;a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b._graphDisplay.isXmarkerInRadians=!b._graphDisplay.isXmarkerInRadians,this._graphTypeSelector()},_xAxisMarkerLineStyle:function(a){var b,c;b=this._gridGraphModelObject,c=b.get("_graphDisplayValues"),c._graphDisplay.isXmarkerInRadians=a,this._graphTypeSelector()},_yAxisMarkerStyleToggle:function(){var a,b;a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b._graphDisplay.isYmarkerInRadians=!b._graphDisplay.isYmarkerInRadians,this._graphTypeSelector()},_yAxisMarkerLineStyle:function(a){var b,c;b=this._gridGraphModelObject,c=b.get("_graphDisplayValues"),c._graphDisplay.isYmarkerInRadians=a,this._graphTypeSelector()},_graphTypeChange:function(){var a,b;a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b._graphDisplay.isCartesionCurrentGraphType=!b._graphDisplay.isCartesionCurrentGraphType,this._graphTypeSelector()},_polarAngleLineMarkerStyleToggle:function(){var a,b;a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b._graphDisplay.isPolarAngleInRadian=!b._graphDisplay.isPolarAngleInRadian,this._graphTypeSelector()},_polarAngleLineMarkerStyle:function(a){var b,c;b=this._gridGraphModelObject,c=b.get("_graphDisplayValues"),c._graphDisplay.isPolarAngleInRadian=a,this._graphTypeSelector()},defaultGraphZoom:function(){this._restoreDefaultZoomingClicked()},_restoreDefaultZoomingClicked:function(){this._restoreDefaultZoom(),this._deltaAngle(),this._triggerEqualizeEvent(!1)},_restoreDefaultZoom:function(){this.activateScope();var a,b,c,d,e=this._gridGraphModelObject,f=e.get("_graphDisplayValues"),g=this._canvasSize,h=(g.width,g.height,f._graphsAxisLimits),i=h.defaultLimits,j=f._zoomingFactor,k=f._graphParameters,l=this._zoomFactors,m=f._graphOrigin;f._graphDisplay,this.markerBounds;a=i.xLower,c=i.xUpper,b=i.yLower,d=i.yUpper,j.xCurrentFactor=j.yCurrentFactor=l[1],j.xZoomMultiplier=j.yZoomMultiplier=1,j.xTotalMultiplier=j.yTotalMultiplier=l[1],k.yGridLine=4,k.xGridLine=4,j.zoomLevel=1,m.isOriginPositionChanged=!1,h.isXLastChangedLimit=!0,j.zoomCounter=0,this._setGraphLimits(a,c,b,d),this._equalizeAxisScales()},_zoomGraph:function(a,b,c){this.activateScope();var d,e,f,g=this,h=this._gridGraphModelObject,i=h.get("_graphDisplayValues"),j=i._graphParameters,k=i._graphOrigin,l=this._canvasSize.height,m=this._canvasSize.width,n=(j.distanceBetweenTwoHorizontalLines,j.distanceBetweenTwoVerticalLines,j.xGridLine),o=j.yGridLine,p=k.currentOrigin,q=k.defaultOrigin,r=i._zoomingFactor,s=(this._zoomFactors,this.graphShiftDistance),t=this._zoomLevelLimits();this._distanceBetweenPoints(p,q)/10;(!this.isDragInProgress||c)&&("annotation-mode"!==this._gridMode||c)&&"Graph"===this._gridMode&&(b=void 0,s=this.graphShiftDistance,0!==a&&(a>0?(r.zoomCounter++,k.isOriginPositionChanged===!0&&r.zoomCounter>0?(d=r.previousZoomAngle-Math.PI,f=new this._paperScope.Point(p.x+Math.cos(d)*s,p.y-Math.sin(d)*s),this._delta=new this._paperScope.Point(k.currentOrigin.x-f.x,k.currentOrigin.y-f.y),k.currentOrigin=f,this._previousMaxValue=this._getGraphPointCoordinates([m,l/2])[0]):this._delta=new this._paperScope.Point(0,0),r.currentXZoomLevel+=this._ZOOM_LEVEL_INCREMENT_STEPS,r.currentXZoomLevel=parseFloat(r.currentXZoomLevel.toFixed(4)),r.currentXZoomLevel>t.xMaxZoomLevel&&(this._xAxisZoomFactorModifier(!1),t=this._zoomLevelLimits(),r.currentXZoomLevel=t.xMinZoomLevel),r.currentYZoomLevel+=this._ZOOM_LEVEL_INCREMENT_STEPS,r.currentYZoomLevel=parseFloat(r.currentYZoomLevel.toFixed(4)),r.currentYZoomLevel>t.yMaxZoomLevel&&(this._yAxisZoomFactorModifier(!1),t=this._zoomLevelLimits(),r.currentYZoomLevel=t.yMinZoomLevel),n=j.xGridLine,o=j.yGridLine,j.currentDistanceBetweenTwoVerticalLines=r.currentXZoomLevel*j.distanceBetweenTwoVerticalLines,j.totalVerticalLines=m/j.currentDistanceBetweenTwoVerticalLines,j.currentDistanceBetweenTwoHorizontalLines=r.currentYZoomLevel*j.distanceBetweenTwoHorizontalLines,j.totalHorizontalLines=l/j.currentDistanceBetweenTwoHorizontalLines):(r.zoomCounter--,p.x!==q.x||p.y!==q.y?(e=Math.sqrt(Math.pow(p.x-q.x,2)+Math.pow(p.y-q.y,2)),25>=e?(f=new this._paperScope.Point([q.x,q.y]),this._delta=new this._paperScope.Point(k.currentOrigin.x-f.x,k.currentOrigin.y-f.y),k.currentOrigin=f,this._previousMaxValue=this._getGraphPointCoordinates([m,l/2])[0]):(d=r.previousZoomAngle,f=new this._paperScope.Point(p.x+Math.cos(d)*s,p.y-Math.sin(d)*s),this._delta=new this._paperScope.Point(k.currentOrigin.x-f.x,k.currentOrigin.y-f.y),k.currentOrigin=f,this._previousMaxValue=this._getGraphPointCoordinates([m,l/2])[0])):this._delta=new this._paperScope.Point(0,0),r.currentXZoomLevel-=this._ZOOM_LEVEL_INCREMENT_STEPS,r.currentXZoomLevel=parseFloat(r.currentXZoomLevel.toFixed(4)),r.currentXZoomLevel<t.xMinZoomLevel&&(this._xAxisZoomFactorModifier(!0),t=this._zoomLevelLimits(),r.currentXZoomLevel=t.xMaxZoomLevel),r.currentYZoomLevel-=this._ZOOM_LEVEL_INCREMENT_STEPS,r.currentYZoomLevel=parseFloat(r.currentYZoomLevel.toFixed(4)),r.currentYZoomLevel<t.yMinZoomLevel&&(this._yAxisZoomFactorModifier(!0),t=this._zoomLevelLimits(),r.currentYZoomLevel=t.yMaxZoomLevel),n=j.xGridLine,o=j.yGridLine,j.currentDistanceBetweenTwoVerticalLines=r.currentXZoomLevel*j.distanceBetweenTwoVerticalLines,j.totalVerticalLines=m/j.currentDistanceBetweenTwoVerticalLines,j.currentDistanceBetweenTwoHorizontalLines=r.currentYZoomLevel*j.distanceBetweenTwoHorizontalLines,j.totalHorizontalLines=l/j.currentDistanceBetweenTwoHorizontalLines),this._graphTypeSelector(),this._graphLimitChangesDuringDragging(),this._deltaAngle(),0!==h.get("_plots").length&&this._shapeZoom(),0!==h.get("_points").length&&this._repositionPoints(),g=this,clearTimeout($.data(this,"timer")),$.data(this,"timer",setTimeout(function(){(0!==h.get("_plots").length||0!==h.get("_images").length)&&(g._shapeRedraw(),g.refreshView()),g.$el.find("canvas").trigger("interactivegraphzoomcomplete")},100)),this.refreshView()))},_xAxisZoomFactorModifier:function(a){var b,c,d,e;if(d=this._gridGraphModelObject,e=d.get("_graphDisplayValues"),b=e._zoomingFactor,c=this._zoomFactors,a===!0)switch(b.xCurrentFactor){case c[0]:b.xCurrentFactor=c[1],b.xTotalMultiplier=b.xCurrentFactor*b.xZoomMultiplier,e._graphParameters.xGridLine=4;break;case c[1]:b.xCurrentFactor=c[2],b.xTotalMultiplier=b.xCurrentFactor*b.xZoomMultiplier,e._graphParameters.xGridLine=5;break;case c[2]:b.xCurrentFactor=c[0],b.xZoomMultiplier=10*b.xZoomMultiplier,b.xTotalMultiplier=b.xCurrentFactor*b.xZoomMultiplier,e._graphParameters.xGridLine=4}else switch(b.xCurrentFactor){case c[0]:b.xCurrentFactor=c[2],b.xZoomMultiplier=b.xZoomMultiplier/10,b.xTotalMultiplier=b.xCurrentFactor*b.xZoomMultiplier,e._graphParameters.xGridLine=5;break;case c[1]:b.xCurrentFactor=c[0],b.xTotalMultiplier=b.xCurrentFactor*b.xZoomMultiplier,e._graphParameters.xGridLine=4;break;case c[2]:b.xCurrentFactor=c[1],b.xTotalMultiplier=b.xCurrentFactor*b.xZoomMultiplier,e._graphParameters.xGridLine=4}},_yAxisZoomFactorModifier:function(a){var b,c,d,e;if(d=this._gridGraphModelObject,e=d.get("_graphDisplayValues"),b=e._zoomingFactor,c=this._zoomFactors,a===!0)switch(b.yCurrentFactor){case c[0]:b.yCurrentFactor=c[1],b.yTotalMultiplier=b.yCurrentFactor*b.yZoomMultiplier,e._graphParameters.yGridLine=4;break;case c[1]:b.yCurrentFactor=c[2],b.yTotalMultiplier=b.yCurrentFactor*b.yZoomMultiplier,e._graphParameters.yGridLine=5;break;case c[2]:b.yCurrentFactor=c[0],b.yZoomMultiplier=10*b.yZoomMultiplier,b.yTotalMultiplier=b.yCurrentFactor*b.yZoomMultiplier,e._graphParameters.yGridLine=4}else switch(b.yCurrentFactor){case c[0]:b.yCurrentFactor=c[2],b.yZoomMultiplier=b.yZoomMultiplier/10,b.yTotalMultiplier=b.yCurrentFactor*b.yZoomMultiplier,e._graphParameters.yGridLine=5;break;case c[1]:b.yCurrentFactor=c[0],b.yTotalMultiplier=b.yCurrentFactor*b.yZoomMultiplier,e._graphParameters.yGridLine=4;break;case c[2]:b.yCurrentFactor=c[1],b.yTotalMultiplier=b.yCurrentFactor*b.yZoomMultiplier,e._graphParameters.yGridLine=4}},_angleBetweenTwoPoints:function(a,b){var c,d,e;return c=Math.abs(a.y-b.y),d=Math.abs(a.x-b.x),e=Math.atan(d/c),e=a.y<b.y?a.x<b.x?3*Math.PI/2+e:a.x>b.x?3*Math.PI/2-e:3*Math.PI/2:a.y>b.y?a.x<b.x?Math.PI/2-e:a.x>b.x?Math.PI/2+e:Math.PI/2:a.x<b.x?0:a.x>b.x?Math.PI:0},_graphLimitChangesDuringDragging:function(){var a,b,c=this._gridGraphModelObject,d=c.get("_graphDisplayValues"),e=(c.get("markerBounds"),d._graphParameters),f=(e.xGridLine,e.yGridLine,e.distanceBetweenTwoVerticalLines,e.distanceBetweenTwoHorizontalLines,d._graphOrigin.currentOrigin),g=(d._zoomingFactor,d._graphsAxisLimits.currentLimits),h=this._canvasSize.height,i=this._canvasSize.width;f.y<0?(a=-1,b=-1):f.y>h?(a=1,b=1):(a=-1,b=1),g.yLower=this._getGraphPointCoordinates([f.x,h])[1],g.yUpper=this._getGraphPointCoordinates([f.x,0])[1],f.x<0?(a=1,b=1):f.x>i?(a=-1,b=-1):(a=-1,b=1),g.xUpper=this._getGraphPointCoordinates([i,f.y])[0],g.xLower=this._getGraphPointCoordinates([0,f.y])[0],this._setBounds(),this._setTextBoxValues()},_setTextBoxValues:function(){var a,b,c,d;c=this._gridGraphModelObject,d=c.get("_graphDisplayValues"),a=d._graphLimitTextBoxDomElement,b=d._graphsAxisLimits.currentLimits,null!==a.xLower&&null!==a.xUpper&&null!==a.yLower&&null!==a.yUpper&&(a.xLower.value=b.xLower,a.xUpper.value=b.xUpper,a.yLower.value=b.yLower,a.yUpper.value=b.yUpper)},_graphAxisLimitChangedByUserInput:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=[];b=void 0,p=this._gridGraphModelObject,q=p.get("_graphDisplayValues"),c=q._graphLimitTextBoxDomElement,n=this._canvasSize,o=q._graphOrigin,r=q._graphsAxisLimits,s=r.currentLimits,d=c.xLower.value,e=c.xUpper.value,f=c.yLower.value,g=c.yUpper.value,h=this._checkForNumericValue(d),i=this._checkForNumericValue(e),j=this._checkForNumericValue(f),k=this._checkForNumericValue(g),h===!0&&i===!0&&j===!0&&k===!0?(s.xLower!==parseFloat(d)||s.xUpper!==parseFloat(e)||s.yLower!==parseFloat(f)||s.yUpper!==parseFloat(g))&&(q._graphsAxisLimits.isXLastChangedLimit=a,this._setGraphLimits(d,e,f,g),m=o.defaultOrigin,l=o.currentOrigin,q._zoomingFactor.previousZoomAngle=this._angleBetweenTwoPoints(l,m),this._graphTypeSelector(),0!==p.get("_plots").length&&this._shapeRedraw(),0!==p.get("_points").length&&this._repositionPoints(),this._deltaAngle(),m.x===l.x&&m.y===l.y?o.isOriginPositionChanged=!1:o.isOriginPositionChanged=!0,Math.abs(q._graphParameters.distanceBetweenTwoVerticalLines-q._graphParameters.distanceBetweenTwoHorizontalLines)>.1?this._triggerEqualizeEvent(!0):this._triggerEqualizeEvent(!1)):(t=["","-"],-1===t.indexOf(d)&&-1===t.indexOf(e)&&-1===t.indexOf(f)&&-1===t.indexOf(g)&&this._setTextBoxValues())},_axisMarkerMultiplierAdjuster:function(a,b,c,d,e){this.setLimits(a,b,c,d),this._gridGraphModelObject.get("_graphDisplayValues")._graphOrigin.isOriginPositionChanged=!1},_convertNumberTillRequiredDecimalPoint:function(a){return Math.abs(a)>1?a.toFixed(3):a.toFixed(10)},_checkForNumericValue:function(a){var b,c,d,e,f,g;if(b=a.toString(),b.length>0){for(d=!0,e=0,f=0,g=0;g<b.length;g++){if(c=b[g].charCodeAt(),!(c>=48&&57>=c||45===c||46===c)){d=!1;break}if(45===c?e+=1:46===c&&(f+=1),f>1||e>1){d=!1;break}}return 1===b.length&&45===c&&(d=!1),d}},_graphTypeSelector:function(){this._projectLayers.gridLayer.activate();var a,b;a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b._graphDisplay.isCartesionCurrentGraphType===!0?this._cartesianGraph():this._polarGraph(),this._drawAxisLines(),this._axisMarker(),this.refreshView()},getMarkerBounds:function(){return this.markerBounds},_equalizeAxisScales:function(){var a,b,c,d,e=this._gridGraphModelObject,f=e.get("_graphDisplayValues"),g=(e.get("markerBounds"),this.markerBounds,this._canvasSize),h=f._graphsAxisLimits,i=f._graphParameters,j=g.height,k=g.width,l=f._graphOrigin.currentOrigin,m=f._zoomingFactor,n=h.currentLimits;h.isXLastChangedLimit===!0?(l.y<0?(c=-1,d=-1):l.y>j?(c=1,d=1):(c=-1,d=1),i.distanceBetweenTwoHorizontalLines=i.distanceBetweenTwoVerticalLines,i.currentDistanceBetweenTwoHorizontalLines=i.currentDistanceBetweenTwoVerticalLines,i.totalHorizontalLines=j/i.currentDistanceBetweenTwoHorizontalLines,m.yCurrentFactor=m.xCurrentFactor,m.yZoomMultiplier=m.xZoomMultiplier,m.yTotalMultiplier=m.xTotalMultiplier,i.yGridLine=i.xGridLine,m.currentYZoomLevel=m.currentXZoomLevel,n.yLower=c*(Math.abs(l.y-j)/i.currentDistanceBetweenTwoHorizontalLines)/i.yGridLine*m.yTotalMultiplier,n.yUpper=d*(Math.abs(l.y-0)/i.currentDistanceBetweenTwoHorizontalLines)/i.yGridLine*m.yTotalMultiplier):(l.x<0?(a=1,b=1):l.x>k?(a=-1,b=-1):(a=-1,b=1),m.xCurrentFactor=m.yCurrentFactor,m.xZoomMultiplier=m.yZoomMultiplier,m.xTotalMultiplier=m.yTotalMultiplier,i.xGridLine=i.yGridLine,m.currentXZoomLevel=m.currentYZoomLevel,i.distanceBetweenTwoVerticalLines=i.distanceBetweenTwoHorizontalLines,i.currentDistanceBetweenTwoVerticalLines=i.currentDistanceBetweenTwoHorizontalLines,i.totalVerticalLines=k/i.currentDistanceBetweenTwoVerticalLines,n.xUpper=b*(Math.abs(l.x-k)/i.currentDistanceBetweenTwoVerticalLines/i.xGridLine)*m.xTotalMultiplier,n.xLower=a*(Math.abs(l.x-0)/i.currentDistanceBetweenTwoHorizontalLines)/i.xGridLine*m.xTotalMultiplier),this._triggerEqualizeEvent(!1),this._setBounds(),this._originPositionOnGraph(),this._graphTypeSelector(),0!==e.get("_plots").length&&this._shapeRedraw(),0!==e.get("_points").length&&this._repositionPoints(),this._setTextBoxValues()},_cartesionSymbolGenerator:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this._gridGraphModelObject,q=p.get("_graphDisplayValues"),r=this._canvasSize.height,s=this._canvasSize.width,t=q._symbols;q._graphDisplay.isProjectorModeOn===!0?(a=2,b=new this._paperScope.Color(.8,.8,.8),c=new this._paperScope.Color(.4,.4,.4)):(a=1,b=new this._paperScope.Color(.9,.9,.9),c=new this._paperScope.Color(.7,.7,.7)),d=new this._paperScope.Path.Line({from:[0,0],to:[0,r],strokeColor:b,strokeWidth:1}),e=new this._paperScope.Path.Line({from:[0,0],to:[0,r],strokeColor:c,strokeWidth:1}),f=new this._paperScope.Symbol(d),g=new this._paperScope.Symbol(e),d.remove(),e.remove(),t.xInnerGridLines=f,t.xMarkerLines=g,h=new this._paperScope.Path.Line({from:[0,0],to:[s,0],strokeColor:b,strokeWidth:1}),i=new this._paperScope.Path.Line({from:[0,0],to:[s,0],strokeColor:c,strokeWidth:1}),j=new this._paperScope.Symbol(h),k=new this._paperScope.Symbol(i),h.remove(),i.remove(),t.yInnerGridLines=j,t.yMarkerLines=k,m=new this._paperScope.Path.Line({from:[0,0],to:[0,r],strokeColor:0,strokeWidth:a}),l=new this._paperScope.Path.Line({from:[0,0],to:[s,0],strokeColor:0,strokeWidth:a}),n=new this._paperScope.Symbol(l),o=new this._paperScope.Symbol(m),l.remove(),m.remove(),t.xAxis=n,t.yAxis=o},_distanceBetweenLinesCalculator:function(){var a,b=this._gridGraphModelObject.get("_graphDisplayValues"),c=b._graphsAxisLimits.currentLimits,d=b._graphParameters;a=this._calculateDistanceBetweenAdjecentLines(c.xLower,c.xUpper,c.yLower,c.yUpper),d.totalVerticalLines=a.totalVerticalLines,d.distanceBetweenTwoVerticalLines=d.currentDistanceBetweenTwoVerticalLines=a.distanceBetweenVerticalLines,d.totalHorizontalLines=a.totalHorizontalLines,d.distanceBetweenTwoHorizontalLines=d.currentDistanceBetweenTwoHorizontalLines=a.distanceBetweenHorizontalLines},_calculateDistanceBetweenAdjecentLines:function(a,b,c,d){var e,f,g,h,i=this._canvasSize.height,j=this._canvasSize.width,k=this._gridGraphModelObject,l=k.get("_graphDisplayValues"),m=(l._graphsAxisLimits.currentLimits,l._zoomingFactor,l._graphParameters),n=m.xGridLine,o=m.yGridLine;return e=(b-a)/l._zoomingFactor.xTotalMultiplier*n,f=j/e,g=(d-c)/l._zoomingFactor.yTotalMultiplier*o,h=i/g,{distanceBetweenVerticalLines:f,totalVerticalLines:e,distanceBetweenHorizontalLines:h,totalHorizontalLines:g}},_originPositionOnGraph:function(){var a,b,c=this._gridGraphModelObject,d=c.get("_graphDisplayValues"),e=this._canvasSize.height,f=this._canvasSize.width,g=d._graphsAxisLimits.currentLimits,h=d._graphParameters,i=g.xLower,j=g.yUpper,k=h.xGridLine,l=h.yGridLine,m=this._paperScope;a=i>=0?0-i:Math.abs(i),b=0>=j?0-Math.abs(j):Math.abs(j),d._graphOrigin.currentOrigin=new m.Point(a/d._zoomingFactor.xTotalMultiplier*k*h.currentDistanceBetweenTwoVerticalLines,b/d._zoomingFactor.yTotalMultiplier*l*h.currentDistanceBetweenTwoHorizontalLines),this._previousMaxValue=this._getGraphPointCoordinates([f,e/2])[0]},_cartesianGraph:function(){this._paperScope.project.activeLayer.removeChildren();var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=this._gridGraphModelObject,G=F.get("_graphDisplayValues"),r=(F.get("markerBounds"),this._canvasSize),H=G._graphParameters,I=(G._zoomingFactor,G._symbols),J=G._graphDisplay.isGridLineShown,K=r.height,L=r.width,M=H.xGridLine,N=H.yGridLine,O=G._graphOrigin.currentOrigin;if(C=new this._paperScope.Point(0,0),D=new this._paperScope.Size(this._canvasSize.width,this._canvasSize.height),E=new this._paperScope.Shape.Rectangle(C,D),E.fillColor=this._backgroundColor,J===!0){for(G._graphDisplay.isXmarkerInRadians===!1?(a=H.currentDistanceBetweenTwoVerticalLines,b=H.totalVerticalLines):(x=this._zoomLevelLimits().xMinZoomLevel*H.distanceBetweenTwoVerticalLines,B=this._getRadianMarkers(x,!0),s=B.marker,A=s/Math.PI,M=this._numberOfMarkerLines(A),t=this._getCanvasPointCoordinates([s,0]),u=Math.abs(O.x-t[0]),v=u/M,w=L/v,x>v&&(s=B.maxMarker,A=s/Math.PI,M=this._numberOfMarkerLines(A),t=this._getCanvasPointCoordinates([s,0]),u=Math.abs(O.x-t[0]),v=u/M,w=L/v),a=v,b=w),O.x>=0?(c=O.x,d=parseInt(c/a,10),e=c-d*a,f=0,g=M-d%M):(h=Math.abs(O.x),i=parseInt(h/a,10),e=a-(h-i*a),f=0,g=i,0!==e&&g++),G._graphDisplay.isYmarkerInRadians===!1?(j=H.currentDistanceBetweenTwoHorizontalLines,k=H.totalHorizontalLines):(x=this._zoomLevelLimits().yMinDistance,B=this._getRadianMarkers(x,!1),s=B.marker,A=s/Math.PI,N=this._numberOfMarkerLines(A),t=this._getCanvasPointCoordinates([0,s]),u=Math.abs(O.y-t[1]),y=u/N,z=K/y,x>y&&(s=B.maxMarker,A=s/Math.PI,N=this._numberOfMarkerLines(A),t=this._getCanvasPointCoordinates([0,s]),u=Math.abs(O.y-t[1]),y=u/N,z=K/y),j=y,k=z),O.y>=0?(l=O.y,m=parseInt(l/j,10),n=l-m*j,o=N-m%N):(p=Math.abs(O.y),q=parseInt(p/j,10),n=j-(p-q*j),o=q,0!==n&&o++),f=0;b>f;f++,g++)g%M===0?I.xMarkerLines.place(new this._paperScope.Point(e+f*a,K/2)):I.xInnerGridLines.place(new this._paperScope.Point(e+f*a,K/2));for(f=0;k>f;f++,o++)o%N===0?I.yMarkerLines.place(new this._paperScope.Point(L/2,n+f*j)):I.yInnerGridLines.place(new this._paperScope.Point(L/2,n+f*j))}},_numberOfMarkerLines:function(a){var b=this.GRID_LINES,c=/5/g;return c.test(a)?b.FIVE_MULTIPLIER:b.DEFAULT},_getRadianMarkers:function(a,b){var c,d,e,f,g,h,i,j,k,l=this._gridGraphModelObject,m=l.get("_graphDisplayValues");return b===!0?(i=m._zoomingFactor.xTotalMultiplier,j=m._zoomingFactor.xCurrentFactor,k=m._zoomingFactor.xZoomMultiplier):(i=m._zoomingFactor.yTotalMultiplier,j=m._zoomingFactor.yCurrentFactor,k=m._zoomingFactor.yZoomMultiplier),5===i?(d=Math.ceil(i/Math.PI)*Math.PI,e=Math.floor(i/Math.PI)*Math.PI):5===j&&(1>k?(c=Math.log(1/k)/Math.LN10,d=Math.PI/(6*Math.pow(8,c-1)),e=Math.PI/(12*Math.pow(8,c-1))):(d=2*k*Math.PI,e=k*Math.PI)),2===i?(d=Math.PI,e=Math.PI/2):2===j&&(1>k?(c=Math.log(1/k)/Math.LN10,d=Math.PI/(12*Math.pow(8,c-1)),e=Math.PI/(3*Math.pow(8,c))):(d=k*Math.PI,e=5*(k/10)*Math.PI)),1===i?(d=Math.PI/3,e=Math.PI/3):1===j&&(1>k?(c=Math.log(1/k)/Math.LN10,d=Math.PI/(3*Math.pow(8,c)),e=Math.PI/(6*Math.pow(8,c))):(d=5*(k/10)*Math.PI,e=2*(k/10)*Math.PI)),f=this._getCanvasPointCoordinates([0,0]),g=b?this._getCanvasPointCoordinates([d,0]):this._getCanvasPointCoordinates([0,d]),h=Math.sqrt(Math.abs(Math.pow(f[0]-g[0],2)+Math.pow(f[1]-g[1],2))),h/2>=a?{marker:e,minMarker:e,maxMarker:d}:{marker:d,minMarker:e,maxMarker:d}},_graphStartingGridLines:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;return z=this._gridGraphModelObject,A=z.get("_graphDisplayValues"),v=this._canvasSize,w=A._graphParameters,y=A._zoomingFactor,x=A._symbols,a=0,b=v.height,c=v.width,E=w.xGridLine,F=w.yGridLine,d=A._graphOrigin.currentOrigin,e=w.distanceBetweenTwoVerticalLines,f=w.totalVerticalLines,d.x>=0?(g=d.x,h=parseInt(g/e,10),i=g-h*e,j=0,k=E-h%E,B=parseInt(h/E,10)):(l=Math.abs(d.x),m=parseInt(l/e,10),i=e-(l-m*e),j=0,k=m,B=parseInt(m/E,10),0!==i&&k++),n=w.distanceBetweenTwoHorizontalLines,o=w.totalHorizontalLines,d.y>=0?(p=d.y,q=parseInt(p/n,10),r=p-q*n,s=F-q%F,C=parseInt(q/F,10)):(t=Math.abs(d.y),u=parseInt(t/e,10),r=e-(t-u*e),s=u,C=parseInt(u/F,10),0!==r&&s++),D=[i,k,B,r,s,C]},_polarGraph:function(){this._paperScope.project.activeLayer.removeChildren();var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R=this._gridGraphModelObject,S=R.get("_graphDisplayValues"),T=S._graphParameters,U=(S._zoomingFactor,this._canvasSize),V=S._graphDisplay.isLabelShown,W=S._graphDisplay.isGridLineShown,X=T.currentDistanceBetweenTwoVerticalLines,Y=T.currentDistanceBetweenTwoHorizontalLines,Z=(T.totalVerticalLines,U.width),$=U.height,_=T.xGridLine,aa=(T.yGridLine,S._graphOrigin.currentOrigin),ba=0;if(O=new this._paperScope.Point(0,0),P=new this._paperScope.Size(this._canvasSize.width,this._canvasSize.height),Q=new this._paperScope.Shape.Rectangle(O,P),Q.fillColor="white",d=Math.sqrt(Math.pow(aa.x-0,2)+Math.pow(aa.y-0,2)),e=Math.sqrt(Math.pow(aa.x-Z,2)+Math.pow(aa.y-0,2)),f=Math.sqrt(Math.pow(aa.x-Z,2)+Math.pow(aa.y-$,2)),g=Math.sqrt(Math.pow(aa.x-0,2)+Math.pow(aa.y-$,2)),ba=(c=(c=d>e?d:e)>f?c:f)>g?c:g,h=Y>X?X:Y,aa.y<0?aa.x<0?(p=Math.abs(aa.y),q=Math.sqrt(Math.pow(aa.x-0,2)+Math.pow(aa.y-0,2)),o=2*Math.PI-Math.acos(p/q),m=Math.abs(aa.x),n=Math.abs(aa.y),b=q):aa.x>Z?(p=Math.abs(aa.y),q=Math.sqrt(Math.pow(aa.x-Z,2)+Math.pow(aa.y-0,2)),o=1.5*Math.PI-Math.acos(p/q),m=Math.abs(aa.x)-Z,n=Math.abs(aa.y),b=q):(o=Math.PI/2,n=Math.abs(aa.y),m=X/Y*n,b=Math.abs(aa.y)):aa.y>$?aa.x<0?(p=Math.abs(aa.x),q=Math.sqrt(Math.pow(aa.x-0,2)+Math.pow(aa.y-$,2)),o=Math.acos(p/q),m=Math.abs(aa.x),n=Math.abs(aa.y)-$,b=q):aa.x>Z?(p=Math.abs(aa.x)-Z,q=Math.sqrt(Math.pow(aa.x-Z,2)+Math.pow(aa.y-$,2)),o=Math.PI-Math.acos(p/q),m=Math.abs(aa.x)-Z,n=Math.abs(aa.y)-$,b=q):(o=Math.PI/2,n=Math.abs(aa.y)-$,m=X/Y*n,b=Math.abs(aa.y)-$):aa.x<0?(o=0,m=Math.abs(aa.x),n=m*Y/X,b=Math.abs(aa.x)):aa.x>Z?(o=0,m=Math.abs(aa.x)-Z,n=m*Y/X,b=Math.abs(aa.x)-Z):(b=0,i=0,o=0,m=0,n=0),j=new this._paperScope.Point(aa.x+m*Math.cos(o),aa.y+n*Math.sin(o)),k=new this._paperScope.Point(aa.x+(m+X)*Math.cos(o),aa.y+(n+Y)*Math.sin(o)),l=Math.sqrt(Math.pow(j.x-k.x,2)+Math.pow(j.y-k.y,2)),i=parseInt(b/l,10),b=i*l,m=X*i,n=Y*i,r=b,s=m,t=n,S.isProjectorModeOn===!0?(u=new this._paperScope.Color(.8,.8,.8),v=new this._paperScope.Color(.4,.4,.4)):(u=new this._paperScope.Color(.9,.9,.9),v=new this._paperScope.Color(.7,.7,.7)),W===!0)for(;ba>=b;b+=h,m+=X,n+=Y)a=i%_===0?new this._paperScope.Path.Ellipse({point:[aa.x-m,aa.y-n],size:[2*m,2*n],strokeColor:v}):new this._paperScope.Path.Ellipse({point:[aa.x-m,aa.y-n],size:[2*m,2*n],strokeColor:u}),i++;for(S._graphDisplay.isProjectorModeOn===!0?(w=new this._paperScope.Color(.8,.8,.8),x=this.MARKER_FONT_SIZE.ON_GRAPH_AREA,y=new this._paperScope.Color(.6,.6,.6)):(w=new this._paperScope.Color(.9,.9,.9),x=14,y=new this._paperScope.Color(.7,.7,.7)),N=this._polarLineAngleMarker,z=S._graphDisplay.isPolarAngleInRadian===!0?N.radian:N.degree,A=0,aa.x<Z&&aa.x>0&&aa.y<$&&aa.y>0?(B=3,C=3,D=2,E=6,aa.x<=Y*_*2||Z-aa.x<=Y*_*2?(F=t+X*_*5-X,G=s+Y*_*5-Y):(F=t+X*_*3-X,G=s+Y*_*3-Y)):(B=4,C=1,D=1,E=3,F=t+X*_*6,G=s+Y*_*6),M=0;360>M;M+=5)H=aa.x+ba*Math.cos(M*Math.PI/180),I=aa.y+ba*Math.sin(M*Math.PI/180),M%C===0&&(W===!0&&(a=new this._paperScope.Path.Line({from:aa,to:[H,I],strokeColor:w})),V===!0&&M%E===0&&(o=M*Math.PI/180,J=aa.x+F*Math.cos(o),K=aa.y+G*Math.sin(o),L=new this._paperScope.PointText({point:[J,K],content:z[A],fontSize:x,fillColor:y}),A+=D))},_polarAngleLinesMarkerArrayGenerator:function(){var a,b,c,d,e,f,g,h,i,j;for(a=[0,345,330,315,300,285,270,255,240,225,210,195,180,165,150,135,120,105,90,75,60,45,30,15],this._polarLineAngleMarker.degree=a,d=this.PI,e=[0],b=1,c=23;c>0;c--){for(f=12>c?c:12,h=12,i=c,g=1,j=f;j>=2;j--)for(;h%j===0&&i%j===0;)h/=j,i/=j;1===i&&1===h?e[b]=d:1===i?e[b]=d+"/"+h:1===h?e[b]=i+d:e[b]=i+d+"/"+h,b++}this._polarLineAngleMarker.radian=e},_drawAxisLines:function(){var a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),c=b._graphOrigin.currentOrigin,d=b._graphDisplay.isAxisLinesShown,e=b._symbols,f=this._canvasSize,e=(b._graphParameters,b._symbols),g=f.height,h=f.width;d===!0&&(e.xAxis.place(new this._paperScope.Point(h/2,c.y)),e.yAxis.place(new this._paperScope.Point(c.x,g/2)))},_axisMarker:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M=this._gridGraphModelObject,N=M.get("_graphDisplayValues"),O=this._canvasSize,P=N._graphParameters,Q=(N._symbols,O.height),R=O.width,S=N._graphOrigin.currentOrigin,T=N._zoomingFactor,U=T.xZoomMultiplier,V=T.yZoomMultiplier,W=T.xTotalMultiplier,X=T.yTotalMultiplier,Y=P.xGridLine,Z=P.yGridLine,$=N._graphDisplay.isCartesionCurrentGraphType,_=N._graphDisplay.isProjectorModeOn,aa=N._graphDisplay.isLabelShown,ba=this.MARKER_FONT_COLOR.ON_GRAPH_AREA,ca=this.MARKER_FONT_COLOR.AT_END_OF_GRAPH_AREA,da=ba,a=_?this.MARKER_FONT_SIZE.ON_GRAPH_AREA_PROJECTOR_MODE:this.MARKER_FONT_SIZE.ON_GRAPH_AREA,ea=this.TEXT_ALIGN.HORIZONTAL,fa=this.TEXT_ALIGN.VERTICAL,ga={},ha=N._graphDisplay.isXmarkerInRadians,ia=N._graphDisplay.isYmarkerInRadians,ja=8,ka=8,la=5,ma=5,na="arial";if(aa!==!1){for(ha===!1||$===!1?(c=P.currentDistanceBetweenTwoVerticalLines,d=P.totalVerticalLines,S.x>=0?(g=S.x,h=parseInt(g/c,10),i=g-h*c,j=Y-h%Y,k=parseInt(h/Y,10)):(o=Math.abs(S.x),p=parseInt(o/c,10),i=c-(o-p*c),j=p,k=parseInt(p/Y,10),0!==i&&(j++,k++)),q=W,S.x>=0&&N._graphDisplay.isCartesionCurrentGraphType===!0&&(q=-W),K=1):(C=this._zoomLevelLimits().xMinDistance,G=this._getRadianMarkers(C,!0),x=G.marker,F=x/Math.PI,Y=this._numberOfMarkerLines(F),y=this._getCanvasPointCoordinates([x,0]),z=Math.abs(S.x-y[0]),A=z/Y,B=R/A,C>A&&(x=G.maxMarker,F=x/Math.PI,Y=this._numberOfMarkerLines(F),y=this._getCanvasPointCoordinates([x,0]),z=Math.abs(S.x-y[0]),A=z/Y,B=R/A),c=A,d=B,S.x>=0?(g=S.x,h=parseInt(g/c,10),i=g-h*c,b=0,j=Y-h%Y,k=x/Math.PI*parseInt(h/Y,10)):(o=Math.abs(S.x),p=parseInt(o/c,10),i=c-(o-p*c),b=0,j=p,k=x/Math.PI*parseInt(p/Y,10),0!==i&&(j++,k+=x/Math.PI)),q=1,S.x>=0&&N._graphDisplay.isCartesionCurrentGraphType===!0&&(q=-1),K=x/Math.PI),b=0;d>=b;b++)H=ea.CENTER,I=fa.BOTTOM,j%Y===0&&(m=i+b*c,n=S.y,l=ha===!1||$===!1?this._getPowerOfNumber(k*q,U,q):this._getProperFormedRadianMarkerText(k*q,U,q),v=l[0],w=l[1],0===w&&(n+=ja),$===!1&&0>v&&(v=-v),J=this._displayToPower10(v,w,new this._paperScope.Point(m,n),{fontSize:a,fontColor:da,justification:H,verticalAlign:I},!1),0!==k?J.base.x<=0?(m=ma,H=ea.left):J.base.x+J.base.width+J.power.width>=R&&J.base.x+J.base.width/2<=R?(m=R-ma,H=ea.RIGHT):J.base.x+J.base.width+J.power.width>=R&&J.base.x+J.base.width/2>R&&(H=ea.LEFT):(m-=8,H=ea.RIGHT),$===!0&&(J.base.y<0||J.power.y<0?(n=0+ma,da=ca,I=fa.BOTTOM):J.base.y+J.base.height>Q&&(n=Q-ma,da=ca,I=fa.TOP)),(S.y>0&&S.y<Q&&0===v||0!==k)&&(ga={fontSize:a,fontColor:da,justification:H,verticalAlign:I,fontFamily:na},_&&(ga.strokeWidth=.3,ga.strokeColor=da),this._displayToPower10(v,w,new this._paperScope.Point(m,n),ga)),S.x<0?k+=K:k-=K),j++;for(ia===!1||$===!1?(e=P.currentDistanceBetweenTwoHorizontalLines,f=P.totalHorizontalLines,S.y>=0?(r=S.y,s=parseInt(r/e,10),i=r-s*e,j=Z-s%Z,k=parseInt(s/Z,10)):(t=Math.abs(S.y),u=parseInt(t/e,10),i=e-(t-u*e),j=u,k=parseInt(u/Z,10),0!==i&&(j++,k++)),S.y<0&&N._graphDisplay.isCartesionCurrentGraphType===!0&&(X=-X),L=1):(C=this._zoomLevelLimits().yMinDistance,G=this._getRadianMarkers(C,!1),x=G.marker,F=x/Math.PI,Z=this._numberOfMarkerLines(F),y=this._getCanvasPointCoordinates([0,x]),z=Math.abs(S.y-y[1]),D=z/Z,E=Q/D,C>D&&(x=G.maxMarker,F=x/Math.PI,Z=this._numberOfMarkerLines(F),y=this._getCanvasPointCoordinates([0,x]),z=Math.abs(S.y-y[1]),D=z/Z,E=Q/D),e=D,f=E,S.y>=0?(r=S.y,s=parseInt(r/e,10),i=r-s*e,j=Z-s%Z,k=x/Math.PI*parseInt(s/Z,10)):(t=Math.abs(S.y),u=parseInt(t/e,10),i=e-(t-u*e),j=u,k=x/Math.PI*parseInt(u/Z,10),0!==i&&(j++,k+=x/Math.PI)),X=1,S.y<0&&N._graphDisplay.isCartesionCurrentGraphType===!0&&(X=-1),L=x/Math.PI),da=ba,b=0;f>=b;b++)j%Z===0&&(I=fa.MIDDLE,H=ea.RIGHT,l=ia===!1||$===!1?this._getPowerOfNumber(k*X,V,X):this._getProperFormedRadianMarkerText(k*X,V,X),v=l[0],w=l[1],n=i+b*e,m=S.x-ka,$===!1&&0>v&&(v=-v),J=this._displayToPower10(v,w,new this._paperScope.Point(m,n),{fontSize:a,fontColor:da,justification:H,verticalAlign:I},!1),J.base.y+J.base.height/4<=0||J.power.y<=0?(n=2,I=fa.BOTTOM):J.base.y+J.base.height>Q&&(n=Q,I=fa.TOP),$===!0&&(J.base.x<0?(m=la,H=ea.LEFT,da=ca):S.x>R&&(m=R-la,H=ea.RIGHT,da=ca)),0!==v&&(ga={fontSize:a,fontColor:da,justification:H,verticalAlign:I,fontFamily:na},_&&(ga.strokeWidth=.3,ga.strokeColor=da),this._displayToPower10(v,w,new this._paperScope.Point(m,n),ga)),S.y<0?k+=L:k-=L),j++}},_getProperFormedRadianMarkerText:function(a,b,c){var d,e=Math.PI,f=this.PI;return b>1e4?(a*=e,d=this._getPowerOfNumber(a,b,c)):Math.abs(a)*e<e/25?(a*=e,d=this._getPowerOfNumber(a,b,c)):(d=this._convertToFractional(a),a=1===Math.abs(d[0])&&1===d[1]?1===d[0]?f:"-"+f:1===Math.abs(d[0])?1===d[0]?f+"/"+d[1]:"-"+f+"/"+d[1]:1===d[1]?d[0]+f:d[0]+f+"/"+d[1],
[a,0])},_convertToFractional:function(a){var b,c,d,e,f;if(a=parseFloat(a.toFixed(2)),-1===a.toString().indexOf("."))return[a,1];for(b=a,c=.01,d=1,e=1,f=d/e;Math.abs(f-b)>c;)b>f?d++:(e++,d=parseInt(Math.round(b*e),10)),f=d/e;return[d,e]},_getPowerOfNumber:function(a,b,c){a=parseFloat(a);for(var d,e,f,g=0,h=1,c=Math.abs(c);1>c;)h++,c=10*c;if(0>a){if(d=Math.abs(a),1e-4>b)for(;1>d;)d=10*d,g-=1;else if(b>1e4)for(;d/10>=1;)d/=10,g+=1;a=-d}else if(1e-4>b&&0!==a)for(;1>a;)a=10*a,g-=1;else if(b>1e4)for(;a/10>=1;)a/=10,g+=1;return e=a,e=h>4?parseFloat(a.toFixed(h)):parseFloat(a.toFixed(4)),f=[],f.push(e),f.push(g),f},_displayToPower10:function(a,b,c,d,e){var f,g,a,h,i,j,k,l,m,n=d.strokeColor,o=d.fontSize,p=d.justification,q=d.verticalAlign,r=d.fontColor,s=d.strokeWidth,t=this.TEXT_ALIGN.HORIZONTAL,u=d.fontFamily,v=this.TEXT_ALIGN.VERTICAL;return f=new this._paperScope.PointText({point:c,justification:"left",fontSize:o,fillColor:r,strokeColor:n,strokeWidth:s,content:a,fontFamily:u}),g=new this._paperScope.PointText({point:[c.x+f.bounds.width,c.y],justification:"left",fontSize:3*o/4,fillColor:r,strokeColor:n,strokeWidth:s,fontFamily:u}),0!==b&&(f.content=f.content+this._X10_STRING,g.content=b,g.bounds.x=f.bounds.x+f.bounds.width,g.bounds.y=f.bounds.y-g.bounds.height/4),h=f.bounds.height,i=f.bounds.width,j=g.bounds.height,k=g.bounds.width,q===v.MIDDLE?(f.bounds.y+=h/4,g.bounds.y+=h/4):q===v.BOTTOM&&(f.bounds.y+=h/2+j/2,g.bounds.y+=h/2+j/2),p===t.RIGHT?(f.bounds.x-=k+i,g.bounds.x-=k+i):p===t.CENTER&&(f.bounds.x-=k/2+i/2,g.bounds.x-=k/2+i/2),l={x:f.bounds.x,y:f.bounds.y,width:f.bounds.width,height:f.bounds.height},m={x:g.bounds.x,y:g.bounds.y,width:g.bounds.width,height:g.bounds.height},e===!1&&(f.remove(),g.remove()),{base:l,power:m}},_getCanvasPointCoordinates:function(a){var b,c,d=this._gridGraphModelObject,e=d.get("_graphDisplayValues"),f=e._graphOrigin.currentOrigin,g=e._graphParameters.currentDistanceBetweenTwoVerticalLines,h=e._graphParameters.currentDistanceBetweenTwoHorizontalLines,i=e._graphParameters.xGridLine,j=e._graphParameters.yGridLine,k=e._zoomingFactor,l=k.xTotalMultiplier,m=k.yTotalMultiplier,n=[];return b=f.x+a[0]*i*g/l,n.push(b),c=f.y-a[1]*j*h/m,n.push(c),n},_getGraphPointCoordinates:function(a){var b,c,d=this._gridGraphModelObject,e=d.get("_graphDisplayValues"),f=e._graphOrigin.currentOrigin,g=e._graphParameters.currentDistanceBetweenTwoVerticalLines,h=e._graphParameters.currentDistanceBetweenTwoHorizontalLines,i=e._graphParameters.xGridLine,j=e._graphParameters.yGridLine,k=e._zoomingFactor,l=k.xTotalMultiplier,m=k.yTotalMultiplier,n=[];return b=-((f.x-a[0])/g/i)*l,c=(f.y-a[1])/h/j*m,n.push(b),n.push(c),n},_deltaAngle:function(){var a,b,c,d,e=this._gridGraphModelObject,f=e.get("_graphDisplayValues"),g=e.get("markerBounds"),h=f._graphOrigin.currentOrigin,i=this._canvasSize.height,j=this._canvasSize.width;h.y<0?h.x<0?(a=new this._paperScope.Point(0,i),c=this._angleBetweenTwoPoints(h,a),b=new this._paperScope.Point(j,0),d=this._angleBetweenTwoPoints(h,b)):h.x>j?(a=new this._paperScope.Point(0,0),c=this._angleBetweenTwoPoints(h,a),b=new this._paperScope.Point(j,i),d=this._angleBetweenTwoPoints(h,b)):(a=new this._paperScope.Point(0,0),c=this._angleBetweenTwoPoints(h,a),b=new this._paperScope.Point(j,0),d=this._angleBetweenTwoPoints(h,b)):h.y>i?h.x<0?(a=new this._paperScope.Point(j,i),c=this._angleBetweenTwoPoints(h,a),b=new this._paperScope.Point(0,0),d=this._angleBetweenTwoPoints(h,b)):h.x>j?(a=new this._paperScope.Point(j,0),c=this._angleBetweenTwoPoints(h,a),b=new this._paperScope.Point(0,i),d=this._angleBetweenTwoPoints(h,b)):(a=new this._paperScope.Point(j,i),c=this._angleBetweenTwoPoints(h,a),b=new this._paperScope.Point(0,i),d=this._angleBetweenTwoPoints(h,b)):h.x<0?(a=new this._paperScope.Point(j,0),c=this._angleBetweenTwoPoints(h,a),b=new this._paperScope.Point(j,i),d=this._angleBetweenTwoPoints(h,b)):h.x>j?(a=new this._paperScope.Point(j,0),c=this._angleBetweenTwoPoints(h,a),b=new this._paperScope.Point(j,i),d=this._angleBetweenTwoPoints(h,b)):(a=new this._paperScope.Point(j,0),c=this._angleBetweenTwoPoints(h,a),b=new this._paperScope.Point(j,i),d=this._angleBetweenTwoPoints(h,b)),this.markerBounds.max["\\theta"]=g.max["\\theta"]=d,this.markerBounds.min["\\theta"]=g.min["\\theta"]=c},repositionImage:function(a){var b=this._getCanvasPointCoordinates(a.getPoints());a.getRaster().position={x:b[0],y:b[1]},this._paperScope.view.draw()},_shapeRedraw:function(){this._projectLayers.shapeLayer.activate(),null!==this._paperScope.project.activeLayer.children&&this._paperScope.project.activeLayer.removeChildren(),this.trigger("graph:zoom-pan"),this._projectLayers.gridLayer.activate()},_delta:null,_previousMaxValue:null,_shapeZoom:function(){this.activateScope(),this._projectLayers.shapeLayer.activate();var a,b,c,d,e=this._gridGraphModelObject,f=e.get("_graphDisplayValues"),g=f._graphOrigin.currentOrigin,h=this._canvasSize.height,i=this._canvasSize.width,a=this._getGraphPointCoordinates([i,h/2])[0],j=this._previousMaxValue/a;for(c=this._paperScope.project.activeLayer.children,d=c.length,b=0;d>b;b++)c[b].bounds.x-=this._delta.x,c[b].bounds.y-=this._delta.y,c[b].scale(j,g);this._previousMaxValue=a,this.refreshView()},_layerDrag:function(a,b){a.activate();var c=this._paperScope.project.activeLayer.children,d=c.length;0!==d&&(a.bounds.x+=b.x,a.bounds.y+=b.y)},drawPoint:function(a){this._projectLayers.pointLayer.activate();var b,c,d,e,f,g,h=this._gridGraphModelObject;c=a.getColor(),d=3*a.getThickness(),e=a.getOpacity(),f=a.getDashArray(),g=a.getPointVisibility(),b=new this._paperScope.Group,-1===h.get("_points").indexOf(a)&&h.get("_points").push(a),this._drawPoints(a),this.refreshView(),this._projectLayers.gridLayer.activate()},resetGraph:function(a){var b;b=this._gridGraphModelObject;var c,d=function(a,b,c,d){this._axisMarkerMultiplierAdjuster(c,d,a,b,!0),this._graphTypeSelector(),this._repositionPoints(),this._shapeRedraw()},e=b.get("_points"),f=[];if("undefined"!=typeof a)f=a;else for(var g=0;g<e.length;g++){c=e[g].getPoints();for(var h=0;h<c.length;h++)f.push(c[h])}for(var i=this.getMarkerBounds(),j=i.min.x,k=i.min.y,l=i.max.x,m=i.max.y,n=f,o=null,p=null,q=0;q<n.length;q++)null===o?(o=[],p=[],o.push(Math.abs(n[q][0])),o.push(Math.abs(n[q][1])),p.push(n[q][0]),p.push(n[q][1]),o.push(0)):(Math.abs(n[q][0])>o[0]&&(o[0]=Math.abs(n[q][0]),p[0]=n[q][0],o[2]=q),Math.abs(n[q][1])>o[1]&&(o[1]=Math.abs(n[q][1]),p[1]=n[q][1],o[2]=q));var r,s,t,u,v=Math.abs(this._getCurrentBandPadding(i.max.y-i.min.y,this._canvasSize.height,this.paddingTop)),w=Math.abs(this._getCurrentBandPadding(i.max.x-i.min.x,this._canvasSize.width,this.paddingLeft));l/Math.abs(l)===-1?t=l+w:l/Math.abs(l)===1&&(t=l-w),m/Math.abs(m)===-1?u=m-v:m/Math.abs(m)===1&&(u=m-v),j/Math.abs(j)===-1?r=j+w:j/Math.abs(j)===1&&(r=j+w),k/Math.abs(k)===-1?s=k+v:k/Math.abs(k)===1&&(s=k-v);var x=p;if(x[0]>=t||x[1]>=u||x[0]<=r||x[1]<=s||"undefined"==typeof a){var y=this._getNewBoundsWithPadding(o[0],this._canvasSize.width,this.paddingLeft),z=this._getNewBoundsWithPadding(o[1],this._canvasSize.height,this.paddingTop);$.proxy(d,this)(-z,z,-y,y)}},_getCurrentBandPadding:function(a,b,c){return Math.ceil(c/b*a)},_getNewBoundsWithPadding:function(a,b,c){var d,e;return e=a/(b/2-c),d=e*(b/2),d+=d/10},_togglePointsColor:function(a,b){var c=a.getColor();return b&&a.changeColor(b),c},_showHoverOnPoint:function(a){var b;if("point"===a.getSpecie())return b=this._togglePointsColor(a,a.hoverColor)},_removeHoverOnPoint:function(a,b){var b;if("point"===a.getSpecie())return b=this._togglePointsColor(a,b)},_drawPoints:function(a){this.activateScope();var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;for(d=a.getColor(),e=3*a.getThickness(),f=a.getOpacity(),g=a.getDashArray(),h=a.getPointVisibility(),c=new this._paperScope.Group,k=this,o=function(){var b,c=[this.tooltipPoint[0],this.tooltipPoint[1]];c[0]=k._getNumberForToolTip(c[0]),c[1]=k._getNumberForToolTip(c[1]),b=$('.coordinate-tooltip[data-point="'+c[0]+"-"+c[1]+'"]').css("opacity",.4),k.$el.find("canvas").css("cursor","default"),m=k._showHoverOnPoint(a),0===b.length?k.showToolTipForPoint(this.bounds.center,[c[0],0],[c[1],0],!1,a):b.remove()},p=function(){var b,c=[this.tooltipPoint[0],this.tooltipPoint[1]];c[0]=k._getNumberForToolTip(c[0]),c[1]=k._getNumberForToolTip(c[1]),k.$el.find("canvas").css("cursor","pointer"),k._removeHoverOnPoint(a,m),b=$('.coordinate-tooltip[data-point="'+c[0]+"-"+c[1]+'"]'),b.remove()},l=a.getPoints(),n=l.length,i=0;n>i;i++)b=this._getCanvasPointCoordinates(l[i]),a.isDraggable()&&(j=this._getPointShapePath(a.pointShape,b,a.getDragHitThickness()/2,a.getDragHitColor()),j.hit=!0,j.fillColor.alpha=a.getDragHitAlpha(),j.equation=a,j.data.point=l[i],c.addChild(j)),j=this._getPointShapePath(a.pointShape,b,e/2),j.data.point=l[i],j.equation=a,this.isTooltipForPoint&&(j.tooltipPoint=l[i],j.onMouseEnter=o,j.onMouseLeave=p),c.addChild(j),0===a.getDashArray().length?j.fillColor=d:(j.fillColor="#ffffff",j.strokeColor=d),j.visible=h,k=this,this.repositionPointsToolTip(b);null!==a.getPointsGroup()&&(this._removePathRollOverListeners(a.getPointsGroup()),a.getPointsGroup().remove(),a.setPointsGroup(null)),a.setPointsGroup(c),this._setPathRollOverListeners(c),this.refreshView()},_getPointShapePath:function(a,b,c,d){var e;switch(d||(d="#000000"),a){case"triangle":e=new this._paperScope.Path.RegularPolygon(b,3,c);break;case"square":e=new this._paperScope.Path.RegularPolygon(b,4,c);break;default:e=new this._paperScope.Path.Circle({center:b,radius:c})}return e.fillColor=d,e},_repositionPoints:function(){this._projectLayers.pointLayer.activate();var a,b,c,d,e,f,g,h,i,j=this._gridGraphModelObject.get("_points"),k=j.length;for(a=0;k>a;a++){for(f=j[a],e=f.getPoints(),c=e.length,h=f.getPointsGroup(),b=0,i=0;c>b;b++,i++)d=this._getCanvasPointCoordinates(e[b]),g=h.children[i],g&&(g.position=new this._paperScope.Point(d),g.hit===!0&&(i++,g=h.children[i],g.position=new this._paperScope.Point(d)),this.repositionPointsToolTip(this._getGraphPointCoordinates(d)));null!==f.getLabelData()&&null!==f.getLabelData().labelObject&&this._updateLabelPosition(f)}this.refreshView()},_getNumberForToolTip:function(a){if(void 0!==a&&null!==a){var b,c,d,e,f=a.toString(),g=3;return-1===f.indexOf(".")?f:(f=Number(f).toFixed(g),b=f.split("."),d=/([0-9]*[1-9])([0]+)/g,b[1]=b[1].replace(d,function(a,b,c){return c=void 0,b}),e=Number(b[1]),0===e?Number(b[0]):(c=b[1].length,3>c&&(g=c),Number(f).toFixed(g)))}},removePoint:function(a){if(void 0!==a&&null!==a){this._projectLayers.pointLayer.activate();var b,c=this._gridGraphModelObject.get("_points").indexOf(a);-1!==c&&this._gridGraphModelObject.get("_points").splice(c,1),this._repositionPoints(),b=a.getPointsGroup(),b&&(this._removePathRollOverListeners(b),b.remove(),a.setPointsGroup(null)),this.$(".coordinate-tooltip[data-equation-cid="+a.cid+"]").remove(),this.refreshView(),this._projectLayers.gridLayer.activate()}},removeRaster:function(a){if("undefined"!=typeof a){this._projectLayers.imageLayer.activate();var b=a.getRaster();b&&(b.remove(),a.setRaster(null)),this.refreshView()}},_redrawPoints:function(){this._projectLayers.pointLayer.activate(),null!==this._paperScope.project.activeLayer.children&&this._paperScope.project.activeLayer.removeChildren();var a,b,c,d,e=this._gridGraphModelObject.get("_points"),f=this;for(c=function(){var a,c=f._getGraphPointCoordinates([this.bounds.center.x,this.bounds.center.y]);c[0]=f._getNumberForToolTip(c[0]),c[1]=f._getNumberForToolTip(c[1]),a=$('.coordinate-tooltip[data-point="'+c[0]+"-"+c[1]+'"]'),0===a.length?f.showToolTipForPoint(this.bounds.center,[c[0],0],[c[1],0],!1,b):a.remove()},d=function(){var a,b=f._getGraphPointCoordinates([this.bounds.center.x,this.bounds.center.y]);b[0]=f._getNumberForToolTip(b[0]),a=$('.coordinate-tooltip[data-point="'+b[0]+"-"+b[1]+'"]'),a.remove()},a=0;a<e.length;a++)this._drawPoints(e[a]);this.refreshView(),this._projectLayers.gridLayer.activate()},repositionPointsToolTip:function(a){var b,c,d,e,f,g,h,i,j,k=this.$("#"+this.ID.canvasId);a[0]=this._getNumberForToolTip(a[0]),a[1]=this._getNumberForToolTip(a[1]),b=$($('.coordinate-tooltip[data-point="'+a[0]+"-"+a[1]+'"]')[0]),0!==b.length&&(c=this._getCanvasPointCoordinates(a),h=k.height(),i=k.width(),j=k.position(),f=b.height(),g=b.width(),d=j.left+c[0],e=j.top+c[1]-2*f,c[1]-f<0||c[1]-f>h||c[0]<0||c[0]+2*g>=i?b.hide():b.show(),$(b[0]).css({top:e+"px",left:d+"px"}))},_changePlotColor:function(){var a=this.pathGroup;a.strokeColor=this.changed.color,this.refreshView()},setLabelStyle:function(a){var b;b=a.labelObject,b.fillColor="red",b.fontWeight="bold",b.fontSize=20,b.fontFamily="Montserrat",b.content=a.text},addLabel:function(a){var b=!1,c=this,d=a.getLabelData(),e=a.getPathGroup();switch(this._projectLayers.labelLayer.activate(),a.getSpecie()){case"point":d.labelObject?(this._updateLabelPosition(a,!0),b=!0):(d.labelObject=new this._paperScope.PointText,d.labelObject.equation=a,this.setLabelStyle(d),this._updateLabelPosition(a,!0),b=!0),d.isSaveRestoreData===!0&&(this._updateLabelPosition(a,!0),b=!0);break;case"polygon":d.labelObject?(this._updateLabelPosition(a,!0),b=!0):(d.labelObject=new this._paperScope.PointText,d.labelObject.equation=a,this.setLabelStyle(d),e&&void 0!==e.children[0]&&(this._updateLabelPosition(a,!0),b=!0)),d.isSaveRestoreData===!0&&(this._updateLabelPosition(a,!0),b=!0);break;case"plot":d.labelObject?e&&void 0!==e.children[0]&&(this._updateLabelPosition(a,!0),b=!0):(d.labelObject=new this._paperScope.PointText,d.labelObject.equation=a,this.setLabelStyle(d),e&&void 0!==e.children[0]&&(this._updateLabelPosition(a,!0),b=!0));break;case"drawAnnotation":return void(b=!1)}this.refreshView(),a.on("post-drag",function(a,b,d,e){c._updateLabelPosition(a,!0,d,e)}),a.on("post-relocate",function(a){c._updateLabelPosition(a)}),a.on("teleported",function(a){c._updateLabelPosition(a)}),a.on("drag-label",$.proxy(c._updateLabelPosition,c))},_updateLabelPosition:function(a,b,c,d){var e,f=a.getLabelData();(b!==!0||f.isSaveRestoreData===!0)&&this.trigger("change-label-position",void 0,a),e=[f.position.x,f.position.y],void 0!==c&&void 0!==d?(f.labelObject.position.x+=c,f.labelObject.position.y+=d):(f.labelObject.position.x=e[0],f.labelObject.position.y=e[1])},setBannerPosition:function(a,b){var b,c,d,e,f,g=a.model.equation.getBannerData().bannerObject;this._projectLayers.bannerLayer.activate(),this._paperScope.project.activeLayer.addChild(g),null!==b?(c=b.equation.getBannerData().bannerObject.children[2],d=c.bounds.y,e=c.bounds.x,f=c.bounds.height):(d=50,e=10,f=0),g.children[2].bounds.y=d+f+10,g.children[2].bounds.x=e,this._projectLayers.pointLayer.activate()},showToolTipForPoint:function(b,c,d,e,f){var g,h,i,j,k,l=this.$("#"+this.ID.canvasId),m=l.position(),n="";f&&(h=f.getCid(),i=f.getColor()),g=$("<div></div>").css({position:"absolute",top:m.top+b.y+"px",left:m.left+b.x+"px","z-index":1e3,"border-color":i}).attr("class","coordinate-tooltip"),j=a.Common.Utilities.Models.Utils.convertIntoScientificNotaion({number:c[0],numberOfDigits:5}).number,k=a.Common.Utilities.Models.Utils.convertIntoScientificNotaion({number:d[0],numberOfDigits:5}).number,f.titleLabel&&(n+=f.titleLabel+"<br/>"),f.xToolTipLabel&&f.yToolTipLabel?(n+=f.xToolTipLabel+":&nbsp",n+=j,0!==c[1]&&(n+=" × "+c[1]),n+="<br>",n+=f.yToolTipLabel+":&nbsp;",n+=k,0!==d[1]&&(n+=" × "+d[1])):(n=j,0!==c[1]&&(n+=" × "+c[1]),n+=",&nbsp;"+k,0!==d[1]&&(n+=" × "+d[1])),g.html(n),e?(this.$(".drag-tooltip").remove(),g.addClass("drag-tooltip")):(g.attr("data-point",c[0]+"-"+d[0]),g.attr("data-equation-cid",h));var o,p,q=g.css("top"),r=g.css("left");this.$el.parents(".de-mathematics-interactive .player").append(g),g.css({top:0,left:0}),o=g.width()+20+2,p=g.height()+6+2,g.css({top:q,left:r}),this.$el.find(".coordinate-tooltip").remove(),this.$el.append(g),g.css("top",g.position().top-(p+15)),g.position().left+o>this.$el.width()&&g.css("left",g.position().left-o),g.position().top<m.top&&g.css("top",g.position().top+(p+15+15))},addPoints:function(a){this._projectLayers.shapeLayer.activate();var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;for(E=a.getPathGroup(),null!==E&&(E.remove(),this._removePathRollOverListeners(E)),-1===this._gridGraphModelObject.get("_plots").indexOf(a)&&this._gridGraphModelObject.get("_plots").push(a),Backbone.listenTo(a,"change:color",$.proxy(this._changePlotColor,a)),u=a.getPoints(),v=a.getColor(),w=a.getThickness(),b=null,c=null,d=null,f=null,x=new this._paperScope.Group,g=new this._paperScope.Path,g.equation=a,g.strokeColor=v,g.strokeWidth=w,x.addChild(g),i=new this._paperScope.Point(0,0),j=new this._paperScope.Point(0,0),k=[],m=!1,s=[],t=[],y=1,z="color: #000",A="background: #0c0; color: #fff",C=0;C<u.length;C++)if(e=u[C],null===f||f[0]!==e[0]||f[1]!==e[1]){for(q=!1,l=0;4>l&&(m=void 0===k[l],0===l?(n="",m&&(k[l]=[]),k[l].push(e)):(m&&(k[l]=[]),p=k[l-1],k[l].push(this._getPointDiff(p))),o=k[l],n+="%c "+o[o.length-1][0].toFixed(5)+","+o[o.length-1][1].toFixed(5)+"%c>>",t[l]=l>=2&&(Math.abs(o[o.length-1][0])>y||Math.abs(o[o.length-1][1])>y)?A:z,2===l&&(r=o[o.length-1],(Math.abs(r[0])>y||Math.abs(r[1])>y)&&(B=this._getCanvasPointCoordinates(e))),!m);l++);q&&(h=new this._paperScope.Path,h.strokeColor=v,h.equation=a,h.strokeWidth=w,g=h,x.addChild(g)),e=this._getCanvasPointCoordinates(e),g.add(e),this._plottingPoints(x,c,b,e),c=b,b=e,f=e}x.strokeColor=v,this.refreshView(),a.setPathGroup(x),D=this,a.set({color:"black"})},_traceMouseDownHandle:function(a,b){if(this.isTooltipForPoint&&this.disableLineTooltip!==!0){b.bringToFront();var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(q=15,e=this._gridGraphModelObject,g=[],h=this._canvasSize.height,i=this._canvasSize.width,d=this._getGraphPointCoordinates([a.point.x,a.point.y]),k=this._getPowerOfNumber(d[0],this._gridGraphModelObject.get("_graphDisplayValues")._zoomingFactor.xTotalMultiplier),k[0]=parseFloat(k[0].toFixed(4)),0!==k[1]?(m=k[0].toString().length+k[1].toString().length+this._X10_STRING.length,n=2):(m=k[0].toString().length,n=1),l=this._getPowerOfNumber(d[1],this._gridGraphModelObject.get("_graphDisplayValues")._zoomingFactor.yTotalMultiplier),l[0]=parseFloat(l[0].toFixed(4)),0!==l[1]?(o=l[0].toString().length+l[1].toString().length+this._X10_STRING.length,p=2):(o=l[0].toString().length,p=1),f=new this._paperScope.Path([a.point.x,0],[a.point.x,h]),b.children)for(j=0;j<b.children.length;j++)g=g.concat(f.getIntersections(b.children[j]));else g=b.getIntersections(e.get("path"));if(g.length<1){if(f=new this._paperScope.Path([0,a.point.y],[i,a.point.y]),b.children)for(j=0;j<b.children.length;j++)g=g.concat(f.getIntersections(b.children[j]));else g=b.getIntersections(e.get("path"));g.length<1&&(f=new this._paperScope.Path)}b.children[0].equation.trigger("focus-equation"),c=new this._paperScope.Path.Circle(g[0].point,3),c.fillColor=b.children[0].equation.getColor(),this.disableLineTooltip!==!0&&this.showToolTipForPoint(g[0].point,k,l,!0,b.children[0].equation),e.set("circleDrag",c),e.set("path",f),this.refreshView()}},_traceMouseDragHandle:function(a,b){if(this.isTooltipForPoint&&this.disableLineTooltip!==!0){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=[],q=this._gridGraphModelObject;if(this.$el.find(".hover-tooltip").attr("event-id"))return q.get("circleDrag").visible=!1,void(this.isSnap=!0);if(this.isSnap=!1,q.get("circleDrag").visible=!0,0===q.get("path").firstSegment.point.y?q.get("path").position.x=a.point.x:q.get("path").position.y=a.point.y,b.children)for(e=0;e<b.children.length;e++)p=p.concat(b.children[e].getIntersections(q.get("path")));else p=b.getIntersections(q.get("path"));if(p.length<1)return q.get("circleDrag").visible=!1,void this.$(".drag-tooltip").remove();for(c=new Array(p.length),c[0]=p[0].point.getDistance(a.point),d=c[0],e=1;e<p.length;e++)c[e]=p[e].point.getDistance(a.point),c[e]<d&&(d=c[e]);f=c.indexOf(d),q.get("circleDrag").position=p[f].point,g=this._getGraphPointCoordinates([q.get("circleDrag").position.x,q.get("circleDrag").position.y]),h=this._getPowerOfNumber(g[0],this._gridGraphModelObject.get("_graphDisplayValues")._zoomingFactor.xTotalMultiplier),h[0]=parseFloat(h[0].toFixed(4)),0!==h[1]?(o=h[0].toString().length+this._X10_STRING.length,j=o+h[1].toString().length,k=2):(o=0,j=h[0].toString().length,k=1),i=this._getPowerOfNumber(g[1],this._gridGraphModelObject.get("_graphDisplayValues")._zoomingFactor.yTotalMultiplier),i[0]=parseFloat(i[0].toFixed(4)),0!==i[1]?(n=i[0].toString().length+this._X10_STRING.length,l=n+i[1].toString().length,m=2):(n=0,l=i[0].toString().length,m=1),this.disableLineTooltip!==!0&&this.showToolTipForPoint(p[f].point,h,i,!0,b.children[0].equation),this.refreshView()}},drawInequalitites:function(a){var b,c,d,e,f=a.getInEqualityPlots();if(null!==f){for(e=new this._paperScope.Group,e.fillColor=a.getColor(),e.strokeColor=a.getColor(),e.fillColor.alpha=.5,e.strokeColor.alpha=0,b=f.length,c=0;b>c;c++)d=new this._paperScope.Path({segments:f[c]}),d.fillColor=a.getColor(),d.strokeColor=a.getColor(),d.fillColor.alpha=.5,d.strokeColor.alpha=0,e.addChild(d);a.setInEqualititesPathGroup(e)}},removeInEqualityPlots:function(a){var b=a.getInEqualititesPathGroup();null!==b&&(b.remove(),a.setInEqualititesPathGroup(null))},_addSegments:function(a){this.activateScope();var b,c,d,e,f,g,h,i,j,k,l,m;for(b=a.getLeftArray(),c=a.getRightArray(),this._projectLayers.shapeLayer.activate(),null!==a.getPathGroup()&&(this._removePathRollOverListeners(a.getPathGroup()),a.getPathGroup().remove()),j=void 0===a.getColor()?"#000000":a.getColor(),k=void 0===a.getThickness()?1:a.getThickness(),void 0!==a.getDashArray()&&(l=a.getDashArray()),m=void 0===a.getCurveVisibility()?!0:"object"==typeof a.getCurveVisibility()?a.getCurveVisibility().curve:a.getCurveVisibility(),e=new this._paperScope.Group,h=null,i=null,g=0;g<b.length;g++)a.isDraggable()&&(d=new this._paperScope.Path({segments:b[g]}),d.strokeColor=a.getDragHitColor(),d.strokeColor.alpha=a.getDragHitAlpha(),d.equation=a,d.hit=!0,d.equationID=a.getId(),d.strokeWidth=a.getDragHitThickness(),e.addChild(d)),d=new this._paperScope.Path({segments:b[g]}),d.strokeColor=j,d.strokeWidth=k,d.equation=a,d.equationID=a.getId(),e.addChild(d);if(null!==c)for(h=null,g=0;g<c.length;g++)a.isDraggable()&&(d=new this._paperScope.Path({segments:c[g]}),d.strokeColor=a.getDragHitColor(),d.equation=a,d.hit=!0,d.strokeColor.alpha=a.getDragHitAlpha(),d.equationID=a.getId(),d.strokeWidth=a.getDragHitThickness(),e.addChild(d)),d=new this._paperScope.Path({segments:c[g]}),d.strokeColor=j,d.equation=a,d.equationID=a.getId(),d.strokeWidth=k,e.addChild(d);e.dashArray=a.getDashArray(),e.visible=m,this._setPathRollOverListeners(e),a.setPathGroup(e),f=a.getLabelData(),null!==f&&null!==f.labelObject&&this._updateLabelPosition(a),this._projectLayers.gridLayer.activate(),this.refreshView(),-1===this._gridGraphModelObject.get("_plots").indexOf(a)&&this._gridGraphModelObject.get("_plots").push(a)},_getOppositeAxis:function(a){switch(a){case"y":return"x";case"x":return"y"}},_getAxisIndex:function(a){switch(a){case"y":return 1;case"x":return 0}},_extendPathForConnection:function(a,b){var c,d,e;c=a[0],d=b[0],void 0!==c&&void 0!==d&&(e=geomFunctions.distance(new this._paperScope.Point(c[0],c[1]),new this._paperScope.Point(d[0],d[1])),10>e&&a.unshift(d),c=a[a.length-1],d=b[b.length-1],e=geomFunctions.distance(new this._paperScope.Point(c[0],c[1]),new this._paperScope.Point(d[0],d[1])),50>e&&a.push(d),this.refreshView())},_generatePoint:function(a,b,c){var d=[];return"y"!==b?(d.push(a[0+c]),d.push(a[0])):(d.push(a[0]),d.push(a[0+c])),d},_plottingPoints:function(a,b,c,d){var e;if(null!==b&&null!==c)return c[1]<b[1]&&c[1]<d[1]||c[1]>b[1]&&c[1]>d[1]?(e=new this._paperScope.Path.Circle({center:[c[0],c[1]],radius:2,fillColor:"#666666",strokeColor:"#666666"}),void a.addChild(e)):c[0]<b[0]&&c[0]<d[0]||c[0]>b[0]&&c[0]>d[0]?(e=new this._paperScope.Path.Circle({center:[c[0],c[1]],radius:2,fillColor:"#666666",strokeColor:"#666666"}),void a.addChild(e)):void 0},_getPointDiff:function(a){var b,c;return b=a[a.length-1],c=a[a.length-2],[b[0]-c[0],b[1]-c[1]]},_printorder:function(a,b){b=void 0,a=void 0},getAttribute:function(){var a,b,c;return c=function(a){var b,d;if(null===a||"object"!=typeof a)return a;b=a.constructor();for(d in a)b[d]=c(a[d]);return b},a={markerBounds:{},graphDisplay:{},currentLimits:{},graphOrigin:{currentOrigin:{x:{},y:{}},defaultOrigin:{x:{},y:{}},isOriginPositionChanged:null},graphParameters:{},zoomingFactor:{}},b=this._gridGraphModelObject.get("_graphDisplayValues"),a.markerBounds=this._gridGraphModelObject.get("markerBounds"),a.graphDisplay=b._graphDisplay,a.currentLimits=b._graphsAxisLimits.currentLimits,a.graphOrigin.currentOrigin.x=b._graphOrigin.currentOrigin.x,a.graphOrigin.currentOrigin.y=b._graphOrigin.currentOrigin.y,a.graphOrigin.defaultOrigin.x=b._graphOrigin.defaultOrigin.x,a.graphOrigin.defaultOrigin.y=b._graphOrigin.defaultOrigin.y,a.graphOrigin.isOriginPositionChanged=b._graphOrigin.isOriginPositionChanged,a.graphParameters=b._graphParameters,a.zoomingFactor=b._zoomingFactor,c(a)},saveState:function(){return this.getAttribute()},retrieveState:function(a){this.setAttribute(a)},setAttribute:function(a){this._gridGraphModelObject.setModelAttribute(a),this._retrieveGraph()},_retrieveGraph:function(){this._setBounds(),this._graphTypeSelector()},activateScope:function(){this._paperScope.activate()},drawPolygon:function(b){this.activateScope();var c=b.getPathGroup();"annotation"===b.getSpecie()?this._projectLayers.annotationLayer.activate():(this._projectLayers.shapeLayer.activate(),null!==c&&this._removePathRollOverListeners(c)),null!==c&&c.remove();var d,e,f,g,h,i,j,k,l,m=new this._paperScope.Path,n=new this._paperScope.Group,o=0,p=b.getPoints();if(b.isDraggable()&&(e=new this._paperScope.Path,e.strokeColor=b.getDragHitColor(),e.equation=b,e.strokeColor.alpha=b.getDragHitAlpha(),e.equationID=b.getId(),e.strokeWidth=b.getDragHitThickness(),e.hit=!0),null!==p){if(l=p.length,d=this._gridGraphModelObject,f=d.get("_plots"),-1===f.indexOf(b)&&f.push(b),l=p.length,m.strokeColor=n.strokeColor=b.getColor(),m.strokeWidth=n.strokeWidth=b.getThickness(),m.opacity=n.opacity=b.getOpacity(),m.equation=b,m.visible=b.getCurveVisibility(),i=m.style,h=[],"annotation"!==b.getSpecie()&&b.getRayPolygon()){for(g=[],k=1;l>k;k++)g.push(p[k-1][0]),g.push(p[k-1][1]),g.push(p[k][0]),g.push(p[k][1]);g=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.fitPointsInsideDomain({domain:{minX:this.markerBounds.min.x,maxX:this.markerBounds.max.x,minY:this.markerBounds.min.y,maxY:this.markerBounds.max.y}},g)}else g=p;for(k=0;l>k;k++)"annotation"===b.getSpecie()?void 0===p[k]||null===p[k]?(n.addChild(m),m=new this._paperScope.Path,m.style=i,o=0):(m.add(this._getCanvasPointCoordinates(p[k])),e&&e.add(this._getCanvasPointCoordinates(p[k]))):b.getRayPolygon()?(j=[g[0][2*k],g[0][2*k+1]],m.add(this._getCanvasPointCoordinates(j)),e&&e.add(this._getCanvasPointCoordinates(j))):(m.add(this._getCanvasPointCoordinates(g[k])),e&&e.add(this._getCanvasPointCoordinates(g[k])));b.isClosedPolygon()===!0&&(e&&(e.closed=!0),m.closed=!0),b.isSmoothPolygon()===!0&&m.smooth(),e&&n.addChild(e),n.addChild(m),"annotation"!==b.getSpecie()&&this._setPathRollOverListeners(n),b.setPathGroup(n),null!==b.getLabelData().labelObject&&this._updateLabelPosition(b),this.refreshView()}},removePlottedGraph:function(a){var b=a.getPathGroup();b&&(this._removePathRollOverListeners(b),b.remove(),a.setPathGroup(null)),this.refreshView()},canvasResize:function(){this._paperScope.activate();var a,b,c=document.getElementById(this.ID.canvasId),d=this._gridGraphModelObject,e=d.get("_graphDisplayValues"),f=e._graphParameters.xGridLine,g=e._graphParameters.yGridLine,h=e._graphsAxisLimits.currentLimits,i=e._graphParameters,j=$(c).height(),k=$(c).width(),l=e._graphParameters.currentDistanceBetweenTwoHorizontalLines,m=e._graphParameters.currentDistanceBetweenTwoVerticalLines,n=this._canvasSize.height,o=this._canvasSize.width,p=j-n,q=k-o,r=0,s=0;k>0&&j>0&&(0!==p||0!==q)&&(0!==p&&(this._canvasSize.height=j,s=p/(l*g)*e._zoomingFactor.yTotalMultiplier,h.yLower=h.yLower-s/2,h.yUpper=h.yUpper+s/2),0!==q&&(this._canvasSize.width=k,r=q/(m*f)*e._zoomingFactor.xTotalMultiplier,h.xLower=h.xLower-r/2,h.xUpper=h.xUpper+r/2),this._setBounds(),this._setTextBoxValues(),i=e._graphParameters,i.totalVerticalLines+=q/m,i.totalHorizontalLines+=p/l,a=h.xLower>=0?0-h.xLower:Math.abs(h.xLower),b=h.yUpper<=0?0-Math.abs(h.yUpper):Math.abs(h.yUpper),e._graphOrigin.currentOrigin=new this._paperScope.Point(a/e._zoomingFactor.xTotalMultiplier*f*m,b/e._zoomingFactor.yTotalMultiplier*g*l),e._graphOrigin.defaultOrigin=new this._paperScope.Point(this._canvasSize.width/2,this._canvasSize.height/2),this._cartesionSymbolGenerator(),this._deltaAngle(),this._graphTypeSelector(),0!==d.get("_plots").length&&this._shapeRedraw(),0!==d.get("_points").length&&this._repositionPoints(),this._paperScope.view.viewSize=[k,j],this.refreshView())},_originShiftFactorForDoubleClick:function(a){var b,c,d,e,f,g,h,i,j,k=this._getNextMultipliers(),l=this._gridGraphModelObject,m=l.get("_graphDisplayValues"),n=m._zoomingFactor,o=m._graphParameters,p=m._graphOrigin.currentOrigin,q=n.currentXZoomLevel+this._ZOOM_LEVEL_INCREMENT_STEPS,r=n.currentYZoomLevel+this._ZOOM_LEVEL_INCREMENT_STEPS,s=this._zoomLevelLimits(n.xTotalMultiplier,n.yTotalMultiplier),t=this._zoomLevelLimits(k.xFactor.xTotalMultiplier,k.yFactor.yTotalMultiplier),u={};return q>=s.xMaxZoomLevel?(q=t.xMinZoomLevel,d=k.xFactor.xGridLine,f=k.xFactor.xTotalMultiplier):(d=o.xGridLine,f=n.xTotalMultiplier),r>=s.yMaxZoomLevel?(r=t.yMinZoomLevel,e=k.yFactor.yGridLine,g=k.yFactor.yTotalMultiplier):(e=o.yGridLine,g=n.yTotalMultiplier),b=q*o.distanceBetweenTwoVerticalLines,c=r*o.distanceBetweenTwoHorizontalLines,h=this._getCanvasPointCoordinates(a),u.x=h[0]-a[0]*d*b/f,u.y=h[1]+a[1]*e*c/g,i=Math.sqrt(Math.pow(u.x-p.x,2)+Math.pow(u.y-p.y,2)),j=this._angleBetweenTwoPoints(p,u)+Math.PI,{distance:i,angle:j}},_getNextMultipliers:function(){var a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),c=b._zoomingFactor,d=this._zoomFactors,e={},f={};switch(c.yCurrentFactor){case d[0]:f.yCurrentFactor=d[2],f.yZoomMultiplier=c.yZoomMultiplier/10,f.yTotalMultiplier=f.yCurrentFactor*f.yZoomMultiplier,f.yGridLine=5;break;case d[1]:f.yCurrentFactor=d[0],f.yZoomMultiplier=c.yZoomMultiplier,f.yTotalMultiplier=f.yCurrentFactor*c.yZoomMultiplier,f.yGridLine=4;break;case d[2]:f.yCurrentFactor=d[1],f.yZoomMultiplier=c.yZoomMultiplier,f.yTotalMultiplier=f.yCurrentFactor*c.yZoomMultiplier,f.yGridLine=4}switch(c.xCurrentFactor){case d[0]:e.xCurrentFactor=d[2],e.xZoomMultiplier=c.xZoomMultiplier/10,e.xTotalMultiplier=e.xCurrentFactor*e.xZoomMultiplier,e.xGridLine=5;break;case d[1]:e.xCurrentFactor=d[0],e.xZoomMultiplier=c.xZoomMultiplier,e.xTotalMultiplier=e.xCurrentFactor*c.xZoomMultiplier,e.xGridLine=4;break;case d[2]:e.xCurrentFactor=d[1],e.xZoomMultiplier=c.xZoomMultiplier,e.xTotalMultiplier=e.xCurrentFactor*c.xZoomMultiplier,e.xGridLine=4}return{xFactor:e,yFactor:f}},getDefaultZoomBehaviour:function(){return this._isGraphDefaultZoomBehaviourAllowed},setDefaultZoomBehaviour:function(a){"boolean"==typeof a&&(this._isGraphDefaultZoomBehaviourAllowed=a)},getDefaultPanBehaviour:function(){return this._isGraphDefaultPanBehaviourAllowed},setDefaultPanBehaviour:function(a){"boolean"==typeof a&&(a===!0?(this.$el.attr("disabledCursor",this.$el.find("canvas").css("cursor")),this.$el.find("canvas").css("cursor","pointer")):a===!1&&(this.$el.find("canvas").css("cursor","default"),this.$el.removeAttr("disabledCursor")),this._isGraphDefaultPanBehaviourAllowed=a)},getClosestGridPoint:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=[],I=1,J=1;for(g=a[0],h=a[1],c=this._gridGraphModelObject,d=c.get("_graphDisplayValues"),i=d._graphParameters.xGridLine,j=d._graphParameters.yGridLine,k=d._zoomingFactor.xTotalMultiplier,l=d._zoomingFactor.yTotalMultiplier,void 0===b&&(b=d._graphDisplay.isCartesionCurrentGraphType?"cartesian-graph":"polar-graph"),
0!==Math.abs(g)&&(I=g/Math.abs(g)),0!==Math.abs(h)&&(J=h/Math.abs(h)),"cartesian-graph"===b?(e=I*k/i,f=J*l/j,m=g%e,n=e-m,o=h%f,p=f-o,H=[[g-m,h-o],[g+n,h-o],[g-m,h+p],[g+n,h+p]]):"polar-graph"===b&&(u=this._polarAngleIncrement(),v=this.angleBetweenPoints(a,[0,0],!1),0>v&&(v=2*Math.PI+v),w=v-v%u,x=v+(u-v%u),A=k/i,B=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)),y=B-B%A,z=B+(A-B%A),C=[y*Math.cos(x),y*Math.sin(x)],D=[y*Math.cos(w),y*Math.sin(w)],E=[z*Math.cos(x),z*Math.sin(x)],F=[z*Math.cos(w),z*Math.sin(w)],H=[C,D,E,F]),G=.4*geomFunctions.distance2(H[0][0],H[0][1],H[2][0],H[2][1]),r=0;r<H.length;r++)s=Math.sqrt(Math.pow(g-H[r][0],2)+Math.pow(h-H[r][1],2)),void 0===q?(q=s,t=H[r]):q>s&&(q=s,t=H[r]);return q>G?a:t},getClosestCanvasPoint:function(a,b){var c,d,e;return d=this._getGraphPointCoordinates(a),e=this.getClosestGridPoint(d,b),c=this._getCanvasPointCoordinates(e)},changeOriginPosition:function(a){var b,c,d;b=this._gridGraphModelObject,c=b.get("_graphDisplayValues"),d=c._graphOrigin.currentOrigin,(d.x!==a[0]||d.y!==a[1])&&(c._graphOrigin.currentOrigin=new this._paperScope.Point(a),this._graphLimitChangesDuringDragging(),this._graphTypeSelector(),this._deltaAngle(),0!==b.get("_plots").length&&this._shapeRedraw(),0!==b.get("_points").length&&this._repositionPoints(),this.refreshView())},angleBetweenPoints:function(a,b,c){var d,e,f,g,h;return d=a[0],e=a[1],f=b[0],g=b[1],h=Math.atan2(e-g,d-f),c?180*h/Math.PI:h},_polarAngleIncrement:function(){var a,b=this._gridGraphModelObject,c=b.get("_graphDisplayValues"),d=c._graphOrigin.currentOrigin,e=this._canvasSize.width,f=this._canvasSize.height;return a=d.x<e&&d.x>0&&d.y<f&&d.y>0?15*Math.PI/180:5*Math.PI/180},setGraphType:function(a){var b,c;switch(b=this._gridGraphModelObject,c=b.get("_graphDisplayValues"),a){case"no-grid":c._graphDisplay.isLabelShown=!1,c._graphDisplay.isGridLineShown=!1,c._graphDisplay.isAxisLinesShown=!1,this._graphTypeSelector();break;case"cartesian-graph":c._graphDisplay.isCartesionCurrentGraphType=!0,c.isLabelShown||c.isGridLineShown||c.isAxisLinesShown||(c._graphDisplay.isLabelShown=!0,c._graphDisplay.isGridLineShown=!0,c._graphDisplay.isAxisLinesShown=!0),this._graphTypeSelector();break;case"polar-graph":c._graphDisplay.isCartesionCurrentGraphType=!1,c.isLabelShown||c.isGridLineShown||c.isAxisLinesShown||(c._graphDisplay.isLabelShown=!0,c._graphDisplay.isGridLineShown=!0,c._graphDisplay.isAxisLinesShown=!0,this._graphTypeSelector())}},getGraphType:function(){var a,b;return a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b.isLabelShown||b.isGridLineShown||b.isAxisLinesShown?"no-grid":b.isCartesionCurrentGraphType?"cartesian-graph":"polar-graph"},getMinimumMarkerValues:function(){var a,b,c,d,e,f,g;return a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),e=b._zoomingFactor,f=b._graphParameters.xGridLine,g=b._graphParameters.yGridLine,c=e.xTotalMultiplier/f,d=e.yTotalMultiplier/g,{xMinMarker:c,yMinMarker:d}},getMinimumSteps:function(){var a=this.getMinimumMarkerValues(),b=a.xMinMarker*a.xGridLines,c=a.yMinMarker*a.yGridLines;return{xMarker:b,yMarker:c}},criticalPointsShowOnHover:function(a,b){if(null!==a){var c,d,e,f,g,h,i,j=this;if(d=j.$('.coordinate-tooltip[data-equation-cid="'+b.getCid()+'"]'),g=d.length,0!==g)for(f=a.children.length,e=0;f>e;e++)i=a.children[e],i.hit!==!0&&(h=[j._getNumberForToolTip(i.data.point[0]),j._getNumberForToolTip(i.data.point[1])],0!=j.$(".coordinate-tooltip[data-point='"+h[0]+"-"+h[1]+"']").length&&(i.fillColor="black",i.opacity=1,i.data.selected=!0));j.$(".hover-tooltip").remove(),j.$el.removeClass("tool-tip-hover-cursor"),a.onMouseEnter=function(a){i=a.target,c=i.data.point,i.hit?(i=j._getPointPath(i.parent.children,i.data.point),i.opacity=1):i.opacity=1,j.showToolTipOnMouseEnter(c,a.target.id,b.getCid()),j.$el.addClass("tool-tip-hover-cursor")},a.onMouseLeave=function(a){i=a.target,i.hit?(i=j._getPointPath(i.parent.children,i.data.point),i.data.selected!==!0&&(i.opacity=.5,i.fillColor="#8D8D8D")):i.data.selected!==!0&&(i.opacity=.5,i.fillColor="#8D8D8D"),parseInt(j.$el.find(".hover-tooltip").attr("event-id"))===a.target.id&&j.$(".hover-tooltip").remove(),j.$el.removeClass("tool-tip-hover-cursor")},a.onMouseUp=function(a){if(i=a.target,c=i.data.point,i.hit){if(i=j._getPointPath(i.parent.children,i.data.point),j.isSnap===!1)return;i.fillColor="black",i.data.selected=!0}else{if(j.isSnap===!1)return;i.fillColor="black",i.data.selected=!0}h=[j._getNumberForToolTip(i.data.point[0]),j._getNumberForToolTip(i.data.point[1])],j.showToolTipForPoint(i.bounds.center,[h[0],0],[h[1],0],!1,i.equation.getCid()),j.isSnap=!1}}},_getPointPath:function(a,b){var c,d=a.length;for(c=0;d>c;c++)if(a[c].hit!==!0&&a[c].data.point[0]===b[0]&&a[c].data.point[1]===b[1])return a[c]},showToolTipOnMouseEnter:function(a,b,c){a=this._getCanvasPointCoordinates(a);var d,e,f,g,h=this.$("#"+this.ID.canvasId),i=h.position(),j=$("<div></div>").css({position:"absolute",top:i.top+a[1]+"px",left:i.left+a[0]+"px"}).attr("class","hover-tooltip"),k=this;j.attr("data-equation-cid",c),0!==k.$(".drag-tooltip").length&&k.$(".drag-tooltip").hide(),e=k._getGraphPointCoordinates(a),f=k._getNumberForToolTip(e[0]),g=k._getNumberForToolTip(e[1]),d=f,d+=",&nbsp;"+g,j.html(d),j.attr("event-id",b),0==this.$(".coordinate-tooltip[data-point='"+f+"-"+g+"']").length&&(this.$el.append(j),j.css("top",j.position().top-2*j.height()),j.position().top<i.top&&j.remove())},startDoubleClickZoom:function(){this._gridGraphModelObject.get("_graphDisplayValues")._zoomingFactor.doubleClickZoomAllow=!0},stopDoubleClickZoom:function(){this._gridGraphModelObject.get("_graphDisplayValues")._zoomingFactor.doubleClickZoomAllow=!1},_setGraphLimits:function(a,b,c,d){var e,f,g=this._gridGraphModelObject,h=g.get("_graphDisplayValues"),i=h._graphsAxisLimits.currentLimits,j=h._graphOrigin;a=parseFloat(a),c=parseFloat(c),b=parseFloat(b),d=parseFloat(d),a>=b||c>=d||(i.xLower=a,i.xUpper=b,i.yLower=c,i.yUpper=d,this._setDistanceBetweenLines(),this._originPositionOnGraph(),e=j.defaultOrigin,f=j.currentOrigin,e.x===f.x&&e.y===f.y?j.isOriginPositionChanged=!1:j.isOriginPositionChanged=!0,this._setBounds())},_setDistanceBetweenLines:function(){var a,b,c,d,e,f,g=this._gridGraphModelObject,h=g.get("_graphDisplayValues"),i=h._zoomingFactor,j=h._graphParameters,k=(h._graphsAxisLimits.currentLimits,1),l=1,m=[],n=[],o=(this._MINIMUM_ZOOM_LEVEL_FACTOR,this._ZOOM_LEVEL_INCREMENT_STEPS),p=function(a,g,h,i,j){for(b=parseFloat(h.toFixed(4));i>=b;)c=h/b*j,d=i/b*j,c>=a&&g>=d&&(e=b,f=!0),b+=o,b=parseFloat(b.toFixed(4))};for(f=!1;!f;)this._distanceBetweenLinesCalculator(),a=this._zoomLevelLimits(),j.distanceBetweenTwoVerticalLines<a.xMinDistance?(this._xAxisZoomFactorModifier(!0),k++):(p(a.xMinDistance,a.xMaxDistance,a.xMinZoomLevel,a.xMaxZoomLevel,j.distanceBetweenTwoVerticalLines),f||(this._xAxisZoomFactorModifier(!1),k--)),-1!==m.indexOf(k)&&p(a.xExtraMinDistance,a.xExtraMaxDistance,a.xMinZoomLevel,a.xMaxZoomLevel,j.distanceBetweenTwoVerticalLines),m.push(k);for(i.currentXZoomLevel=e,f=!1;!f;)this._distanceBetweenLinesCalculator(),a=this._zoomLevelLimits(),j.distanceBetweenTwoHorizontalLines<a.yMinDistance?(this._yAxisZoomFactorModifier(!0),l++):(p(a.yMinDistance,a.yMaxDistance,a.yMinZoomLevel,a.yMaxZoomLevel,j.distanceBetweenTwoHorizontalLines),f||(this._yAxisZoomFactorModifier(!1),l--)),f||-1===n.indexOf(l)||p(a.yExtraMinDistance,a.yExtraMaxDistance,a.yMinZoomLevel,a.yMaxZoomLevel,j.distanceBetweenTwoHorizontalLines),n.push(l);i.currentYZoomLevel=e,j.distanceBetweenTwoVerticalLines=j.distanceBetweenTwoVerticalLines/i.currentXZoomLevel,j.distanceBetweenTwoHorizontalLines=j.distanceBetweenTwoHorizontalLines/i.currentYZoomLevel},drawGraph:function(){this._graphTypeSelector()},_zoomLevelLimits:function(a,b){var c,d,e,f,g,h=this._gridGraphModelObject,i=h.get("_graphDisplayValues"),j=i._zoomingFactor,k=j.xTotalMultiplier,l=j.yTotalMultiplier,m=this.GRID_LINES,n=this._ZOOM_STEPS_FOR_FIVE_MULTIPLIER,o=this._ZOOM_STEPS,p=this._MINIMUM_ZOOM_LEVEL_FACTOR,q=this._ZOOM_LEVEL_INCREMENT_STEPS,r=this._ADJECENT_LINES_MIN_DISTANCE,s=this._ZOOM_DISTANCE;return k=a?a:k,l=b?b:l,e=this._numberOfMarkerLines(k),f=this._numberOfMarkerLines(l),g=function(a){var b,c,d,e,f,g;return a===m.FIVE_MULTIPLIER?(b=r,c=b+s*n,d=p,e=d+q*n,f=c+s,g=b-s):(b=r+s,c=b+s*o,d=p+q,e=d+q*o,f=c+s,g=b-s),{minDistance:b,maxDistance:c,minZoomLevel:d,maxZoomLevel:e,extraMaxDistance:f,extraMinDistance:g}},c=g(e),d=g(f),{xMinDistance:c.minDistance,xMaxDistance:c.maxDistance,xMinZoomLevel:c.minZoomLevel,xMaxZoomLevel:c.maxZoomLevel,xExtraMaxDistance:c.extraMaxDistance,xExtraMinDistance:c.extraMinDistance,yMinDistance:d.minDistance,yMaxDistance:d.maxDistance,yMinZoomLevel:d.minZoomLevel,yMaxZoomLevel:d.maxZoomLevel,yExtraMaxDistance:d.extraMaxDistance,yExtraMinDistance:d.extraMinDistance}},_setBounds:function(){var a=this._gridGraphModelObject.get("markerBounds"),b=this.markerBounds,c=this._gridGraphModelObject.get("_graphDisplayValues")._graphsAxisLimits.currentLimits;a.max.x=b.max.x=c.xUpper,a.min.x=b.min.x=c.xLower,a.max.y=b.max.y=c.yUpper,a.min.y=b.min.y=c.yLower,this._deltaAngle()},getLimits:function(){var a=this._gridGraphModelObject.get("markerBounds");return{xLower:a.min.x,xUpper:a.max.x,yLower:a.min.y,yUpper:a.max.y}},setLimits:function(a,b,c,d){isNaN(parseFloat(b))||isNaN(parseFloat(a))||isNaN(parseFloat(c))||isNaN(parseFloat(d))||this._setGraphLimits(a,b,c,d)},_distanceBetweenPoints:function(a,b){return Math.sqrt((b.y-a.y)*(b.y-a.y)+(b.x-a.x)*(b.x-a.x))},convertToCanvasCoordinate:function(a){return this._getCanvasPointCoordinates(a)},convertToGraphCoordinate:function(a){return this._getGraphPointCoordinates(a)},hideGridLines:function(){var a,b;a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b._graphDisplay.isGridLineShown=!1,this._graphTypeSelector()},hideLabels:function(){var a,b;a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b._graphDisplay.isLabelShown=!1,this._graphTypeSelector()},hideAxis:function(){var a,b;a=this._gridGraphModelObject,b=a.get("_graphDisplayValues"),b._graphDisplay.isAxisLinesShown=!1,this._graphTypeSelector()}},{AXIS_LABEL_RIGHT_PADDING:5,AXIS_LABEL_BOTTOM_PADDING:3})}(window.MathInteractives),function(a){"use strict";a.Common.Components.Views.MathUtilitiesGraphNew.plotterView=Backbone.View.extend({model:null,_graphView:null,_plottingFuntions:null,_worker:null,initialize:function(){this.model=new a.Common.Components.Models.MathUtilitiesGraphNew.plotterModel,this.graphView=this.options.graphView,this.graphView.on("graph:zoom-pan",$.proxy(function(){var a,b,c,d=this.model._equations,e=d.length;for(a=0;e>a;a++)if(b=d[a].getSpecie(),c=d[a].getCriticalPoints(),null!==c&&null!==c.getPointsGroup()&&(c.getPointsGroup().visible=!1),void 0!==b&&null!==b&&"error"!==b&&"expression"!==b&&"number"!==b&&"quadratic"!==b)if("polygon"===b)this.graphView.drawPolygon(d[a]);else{if("point"===b)continue;"annotation"===b?this.graphView.drawPolygon(d[a]):"image"===b?this.graphView.repositionImage(d[a]):this._plot(d[a])}},this)),a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Productions.init()},addEquation:function(a){var b=this.model._equations,c=this.model._equationsMap;if(-1===b.indexOf(a))return b.push(a),c[a.getId()]=a,a.on("change-visibility",$.proxy(function(){this.changePlotVisibility(a)},this)),"image"===a.getSpecie()?void this.graphView._paperScope.view.draw():(a.on("change-equation",$.proxy(function(){this._showConsole(!0,"Updating plot for equation "+a),this.addPlot(a)},this)),a.on("plot-equation",$.proxy(function(){this._showConsole(!0,"Plotting equation "+a),this._plot(a)},this)),a.on("change-color",$.proxy(function(){this.changePlotColor(a)},this)),a.on("change-points-color",$.proxy(function(){this.changePointsColor(a)},this)),a.on("change-constants",$.proxy(function(){var b=a.getAllConstants().length;0!==b&&"point"!==a.getSpecie()&&("error"===a.getSpecie()||"expression"===a.getSpecie()||b>0?this.addPlot(a):this._plot(a))},this)),a.on("change-thickness",$.proxy(function(){"point"===a.getSpecie()?null!==a.getPointsGroup()&&this.graphView._redrawPoints():null!==a.getPathGroup()&&(a.getPathGroup().strokeWidth=a.getThickness())},this)),"polygon"===a.getSpecie()||"annotation"===a.getSpecie()?("annotation"===a.getSpecie()&&null!==this.model._annotationPaths&&(this.model._annotationPaths.remove(),this.graphView._paperScope.view.draw()),void this.graphView.drawPolygon(a)):void this.addPlot(a))},removeEquation:function(a){var b,c=this.model._equations,d=this.model._equationsMap;b=c.indexOf(a),-1!==b&&(null!==a.getPathGroup()&&this.graphView.removePlottedGraph(a),null!==a.getPointsGroup()&&this.graphView.removePoint(a),null!==a.getRaster()&&this.graphView.removeRaster(a),this.graphView.removeInEqualityPlots(a),c.splice(b,1)),delete d[a.getId()]},createAnnotationStart:function(a,b){this.graphView._projectLayers.annotationLayer.activate(),this.graphView.setGridMode("annotation-mode");var c=this;this.graphView.on("annotation-start",$.proxy(c._createAnnotationMouseDown,c)),this.graphView.on("draw-annotation",$.proxy(c._createAnnotationMove,c)),this.graphView.on("annotation-end",$.proxy(c._createAnnotationMouseUp,c)),this.model._annotationPaths=new this.graphView._paperScope.Group,this.model._annotationPaths.strokeColor=a,this.model._annotationPaths.strokeWidth=b},_createAnnotationMouseDown:function(a){this.graphView.setGridMode("annotation-mode");var b,c=this.model;b=new this.graphView._paperScope.Path,b.strokeWidth=c._annotationPaths.strokeWidth,this.graphView._paperScope.tool.minDistance=1,b.strokeColor=this.model._annotationPaths.strokeColor,b.strokeWidth=this.model._annotationPaths.strokeWidth,c.incompleteAnnotations.push(this.graphView._getGraphPointCoordinates(getCanvasCoordinates(a))),c._firstPoint=a.point,c._annotationPaths.addChild(b),b.strokeCap="round"},_createAnnotationMove:function(a){var b=this.model._annotationPaths._children,c=this.model;this.graphView._paperScope.tool.minDistance=1,null!==c._firstPoint&&(b[b.length-1].add(c._firstPoint),c._firstPoint=null),b[b.length-1].add(a.point),c.incompleteAnnotations.push(this.graphView._getGraphPointCoordinates(getCanvasCoordinates(a)))},_createAnnotationMouseUp:function(a){a=void 0;var b=this.model,c=this.model._annotationPaths._children;null!==b._firstPoint&&(c[c.length-1].add([b._firstPoint.x,b._firstPoint.y]),c[c.length-1].add([b._firstPoint.x+1,b._firstPoint.y+1]),this.model.incompleteAnnotations.push(this.graphView._getGraphPointCoordinates([b._firstPoint.x+2,b._firstPoint.y+4])),b._firstPoint=null),this.model.incompleteAnnotations.push(void 0),this.graphView.refreshView()},createAnnotationEnd:function(a){a=void 0;var b;return this.model.incompleteAnnotations.pop(),b=this.model.incompleteAnnotations,this.model.incompleteAnnotations=[],this.graphView.off("annotation-start"),this.graphView.off("draw-annotation"),this.graphView.off("annotation-end"),this.graphView.resetGridMode(),b},changePlotVisibility:function(a){var b,c,d,e,f;if("point"===a.getSpecie())for(f=a.getPointsGroup(),b=0;b<f.children.length;b++)f.children[b].hit||(f.children[b].visible=a.getVisible().point);else c=a.getPathGroup(),e=a.getVisible().curve,c&&e===!1?(c.visible=e,a.removePathGroup()):c||(d=a.getSpecie(),"plot"===a.getSpecie()?this._plot(a):("annotation"===d||"polygon"===d)&&this.graphView.drawPolygon(a)),a.getRaster()&&(a.getRaster().visible=a.getVisible().curve);this.graphView.refreshView()},changePlotColor:function(a){var b,c=a.getPathGroup();if("point"===a.getSpecie())0===a.getDashArray().length?this.changePointsColor(a):this.changePointsColor(a);else if(c)for(b=0;b<c.children.length;b++)c.children[b].hit||(c.children[b].strokeColor=a.getColor());this.graphView.refreshView()},changePointsColor:function(a){var b=a.getPointsGroup();if(null!==b){var c;if(0===a.getDashArray().length)for(c=0;c<b.children.length;c++)b.children[c].hit||(b.children[c].fillColor=a.getColor());else for(c=0;c<b.children.length;c++)b.children[c].hit||(b.children[c].strokeColor=a.getColor());this.graphView._paperScope.view.draw()}},_showConsole:function(a,b,c){a=void 0,b=void 0,c=void 0},addPlot:function(b){var c,d,e,f,g,h;if(!b.getBlind()){if(a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Parser.parseEquationToGetTokens(b),b.isCanBeSolved()===!1)return;if("number"!==b.getSpecie()&&"point"!==b.getSpecie()){if(a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Parser.processTokensWithRules(b),b.isCanBeSolved()===!1)return;a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.Parser.generateTreeFromRules(b)}}if("point"===b.getSpecie()){if(!b.getBlind())for(h=b.getSolution(),d=h.length,b.setPoints([]),c=0;d>c;c++)e=[],e.push(Number(h[c][0])),e.push(Number(h[c][1])),b.getPoints().push(e);this.graphView.drawPoint(b)}else b.getBlind()===!1&&b.isCanBeSolved()===!0&&"expression"!==b.getSpecie()&&"number"!==b.getSpecie()?(a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.TreeProcedures.convertToSolvableForm(b),"quadratic"===b.getSpecie()&&(h=a.Common.Components.Models.MathUtilitiesGraphNew.EquationEngine.TreeProcedures.solveEquation(b,1),b.setSolution(h)),"plot"===b.getSpecie()&&(f=b.getParamVariableOrder(),g=2>f?b.getB():b.getA(),"equal"!==b.getInEqualityType()&&("-"===g.sign||g.value<0)&&b.reverseInequality(),this._plot(b))):b.getBlind()===!0?this._plot(b):this._showConsole(!0,"Cant plot this equation")},_plot:function(b){b.setLeftArray([]),b.setRightArray([]);var c,d,e,f,g,h,i,j,k,l=(this.model._equationsMap,this.graphView.markerBounds),m=b.getParamVariable(),n=Number(l.min[m]),o=Number(l.max[m]),p=(navigator.userAgent.toLowerCase(),[]),q=[],r=b.getRange(),s=this.graphView,t=8*((Math.abs(n)+Math.abs(o))/1e4);if(s._paperScope.activate(),r=b.getRange(),null!==r&&void 0!==r&&(null!==r.min&&(n=r.min.value,r.min.include===!1&&(n+=t)),null!==r.max&&(o=r.max.value,r.max.include===!1&&(o-=t))),c=this.graphView.getMinimumMarkerValues(),f={minX:n,maxX:o,minY:Number(l.min[b.getFunctionVariable()]),maxY:Number(l.max[b.getFunctionVariable()]),step:t,tolerance:c.xMinMarker/100,paramVariable:m},e=(t.toString().split(".")[1]||[]).length,d=b.getParamVariableOrder(),b.getVisible().curve!==!1){if(f.gridGraph=s,b.getAutonomous()){for(i=new Function("constants,plot",b.getFunctionCode()),p=i(b.getConstants(),f),g=[],h=0;h<p.length;h++)g.push(a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.translateSegment(f,p[h],s));p=g}else i=new Function("param,constants",b.getFunctionCode()),j=function(a){var c=i(a,b.getConstants());return c[0]},k=function(a){var c=i(a,b.getConstants());return c[1]},p=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.generatePlot(j,f),2===d&&(q=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.generatePlot(k,f),b.setRightArray(q));b.setLeftArray(p),this.graphView._addSegments(b),b.setPoints(p),void 0===b.getThickness()&&b.setThickness(3)}},_createCriticalPointEquationData:function(a){a.setCriticalPoints(new MathUtilities.Components.EquationEngine.Models.EquationData);var b=a.getCriticalPoints();return b.setColor("#8D8D8D",!0),b.hasParent=a,b.setDraggable(!0),b.getStyle().setDragHitThickness(20),b.setThickness(2.5*b.getThickness()),b},getLinearContinuousInequalityPlots:function(a,b,c,d,e,f,g){if(!(a.length<2)){var h,i,j=a.length,k=[],l=!1,m=a[0],n=a[j-1];if(h=this._getPointIntersectionWithBounds(m,b,c,d,e),i=this._getPointIntersectionWithBounds(n,b,c,d,e),null===h||null===i)return k=this.getDiscontinuousInequalityPlots(a,b,c,d,e,f,g);switch(("lesser"===g||"ltequal"===g)&&(l=!0),h){case"xMax":switch(i){case"xMin":"y"===f?l?(k.push([m[0],e]),k=k.concat(a),k.push([n[0],e])):(k.push([m[0],c]),k=k.concat(a),k.push([n[0],c])):l?(k.push([m[0],c]),k=k.concat(a),k.push([n[0],c])):(k.push([m[0],e]),k=k.concat(a),k.push([n[0],e]));break;case"xMax":l?(k.push([b,e]),k.push([m[0],e]),k=k.concat(a),k.push([n[0],c]),k.push([b,c])):k=k.concat(a);break;case"yMin":l?(k.push([m[0],e]),k=k.concat(a),k.push([b,n[1]]),k.push([b,e])):(k.push([m[0],n[1]]),k=k.concat(a))}break;case"xMin":switch(i){case"xMax":l?(k.push([m[0],e]),k=k.concat(a),k.push([n[0],e])):(k.push([m[0],c]),k=k.concat(a),k.push([n[0],c]));break;case"yMax":l?(k.push([m[0],n[1]]),k=k.concat(a)):(k.push([m[0],c]),k=k.concat(a),k.push([d,n[1]]),k.push([d,c]));break;case"yMin":"y"===f?l?(k.push([m[0],e]),k=k.concat(a),k.push([d,n[1]]),k.push([d,e])):(k.push([m[0],n[1]]),k=k.concat(a)):l?(k.push([m[0],n[1]]),k=k.concat(a)):(k.push([m[0],e]),k=k.concat(a),k.push([d,n[1]]),k.push([d,e]));break;case"xMin":l?k=k.concat(a):(k.push([d,e]),k.push([m[0],e]),k=k.concat(a),k.push([n[0],c]),k.push([d,c]))}break;case"yMax":switch(i){case"yMin":"y"===f?l?(k.push([d,m[1]]),k=k.concat(a),k.push([d,n[1]])):(k.push([b,m[1]]),k=k.concat(a),k.push([b,n[1]])):l?(k.push([b,m[1]]),k=k.concat(a),k.push([b,n[1]])):(k.push([d,m[1]]),k=k.concat(a),k.push([d,n[1]]));break;case"xMax":"y"===f?l?(k.push([d,m[1]]),k=k.concat(a)):(k.push([b,m[1]]),k=k.concat(a),k.push([n[0],c]),k.push([b,c])):l?(k.push([b,m[1]]),k=k.concat(a),k.push([n[0],c]),k.push([b,c])):(k.push([d,m[1]]),k=k.concat(a));break;case"yMax":l?k=k.concat(a):(k.push([b,c]),k.push([b,m[1]]),k=k.concat(a),k.push([d,n[1]]),k.push([d,c]));break;case"xMin":l?(k.push([n[0],m[1]]),k=k.concat(a)):(k.push([d,m[1]]),k=k.concat(a),k.push([n[0],c]),k.push([d,c]))}break;case"yMin":switch(i){case"xMax":l?(k.push([b,m[1]]),k=k.concat(a),k.push([n[0],e]),k.push([b,e])):(k.push([n[0],m[1]]),k=k.concat(a));break;case"yMin":l?(k.push([b,e]),k.push([b,m[1]]),k=k.concat(a),k.push([d,n[1]]),k.push([d,e])):k=k.concat(a);break;case"yMax":l?(k.push([b,m[1]]),k=k.concat(a),k.push([b,n[1]])):(k.push([d,m[1]]),k=k.concat(a),k.push([d,n[1]]))}}return k}},_getPointIntersectionWithBounds:function(a,b,c,d,e){var f=null;return a[0].toFixed(11)<=b?f="xMin":Math.ceil(a[0])>=d?f="xMax":a[1].toFixed(11)<=c?f="yMin":Math.ceil(a[1])>=e&&(f="yMax"),f},_getBoundsForDiscontinuousFucntion:function(a){var b=a[0],c=a.length,d=a[c-1],e={min:{x:0,y:0},max:{x:0,y:0}};return b[0]<=d[0]?(e.min.x=b[0],e.max.x=d[0]):(e.max.x=b[0],e.min.x=d[0]),b[1]<=d[1]?(e.min.y=b[1],e.max.y=d[1]):(e.max.y=b[1],e.min.y=d[1]),e},getInEqualityPlots:function(a,b){var c,d,e,f,g,h=a.getParamVariableOrder(),i=a.getLeftArray(),j=a.getInEqualityType(),k=i.length,l=0,m=this.graphView._getCanvasPointCoordinates([Number(b.max.x),0])[0],n=0,o=this.graphView._getCanvasPointCoordinates([0,Number(b.min.y)])[1],p=[],q=a.getFunctionVariable();if(m=Math.floor(m),o=Math.floor(o),2>h)if(1===k)p.push(this.getLinearContinuousInequalityPlots(i[0],l,n,m,o,q,j));else for(g=0;k>g;g++)d=i[g],p.push(this.getDiscontinuousInequalityPlots(d,l,n,m,o,q,j));else for(g=0;k>g;g++)for(d=i[g],c=this.getQuadraticDiscontinuousInequalityPlots(a.getLeftArray()[g],a.getRightArray()[g],l,n,m,o,q,j,k),e=c.length,f=0;e>f;f++)p.push(c[f]);a.setInEqualityPlots(p)},getQuadraticDiscontinuousInequalityPlots:function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o=[],p=[],q=b[0],r=a[0],s=b[b.length-1],t=a[a.length-1];return void 0===b&&(j=!0),k=this._getPointIntersectionWithBounds(r,c,d,e,f),l=this._getPointIntersectionWithBounds(t,c,d,e,f),m=this._getPointIntersectionWithBounds(q,c,d,e,f),n=this._getPointIntersectionWithBounds(s,c,d,e,f),"lesser"===h||"ltequal"===h?(p.push(q),1===i&&"yMin"===k&&"yMin"===l&&"yMax"===m&&"yMax"===n&&(p.push([c,q[1]]),p.push([c,r[1]])),p.push(r),p=p.concat(a),p.push(t),1===i&&"yMin"===k&&"yMin"===l&&"yMax"===m&&"yMax"===n&&(p.push([e,t[1]]),p.push([e,s[1]])),p.push(s),p=p.concat(b.reverse()),o.push(p)):"y"===g?(p=[],p.push([r[0],d]),p=p.concat(a),"xMin"===k&&"xMin"===l?p.push([t[0],f]):p.push([t[0],d]),o.push(p),p=[],"xMax"===m&&"xMax"===n?p.push([q[0],d]):p.push([q[0],f]),p=p.concat(b),p.push([s[0],f]),o.push(p)):(p=[],p.push([e,r[1]]),p=p.concat(a),"yMax"===k&&"yMax"===l?p.push([c,t[1]]):p.push([e,t[1]]),o.push(p),p=[],"yMin"===m&&"yMin"===n?p.push([e,q[1]]):p.push([c,q[1]]),p=p.concat(b),p.push([c,s[1]]),o.push(p)),o},getDiscontinuousInequalityPlots:function(a,b,c,d,e,f,g){var h=[],i=a.length,j=a[0],k=a[i-1];return"y"===f?"lesser"===g||"ltequal"===g?(h.push([j[0],e]),h=h.concat(a),h.push([k[0],e])):(h.push([j[0],c]),h=h.concat(a),h.push([k[0],c])):"lesser"===g||"ltequal"===g?(h.push([b,j[1]]),h=h.concat(a),h.push([b,k[1]])):(h.push([d,j[1]]),h=h.concat(a),h.push([d,k[1]])),h},regressExtremaEdges:function(a,b,c,d,e){for(var f,g,h,i,j=a[0],k=a[1],l=b[0],m=b[1],n=c[0],o=c[1];;)if("y"===e){if(f=this.getCenterOfCoordinates(j,l),g=d(f),h=this.getCenterOfCoordinates(l,n),i=d(h),!isFinite(g)||!isFinite(i))return null;if(f===j||f===l||h===l||h===n)return g>m==m>k?[f,g]:i>m==m>k?[h,i]:[l,m];if(g===m||i===m)return this.getCenterOfFlatRegion(j,k,l,m,n,o,d,e);g>k==m>k&&g>k==g>m?(n=l,o=m,l=f,m=g):i>o==m>o&&i>m==i>o?(j=l,k=m,l=h,m=i):(j=f,k=g,n=h,o=i)}else{if(g=this.getCenterOfCoordinates(k,m),f=d(g),i=this.getCenterOfCoordinates(m,o),h=d(i),!isFinite(f)||!isFinite(h))return null;if(g===k||g===m||i===m||i===o)return f>l==l>j?[f,g]:h>l==l>j?[h,i]:[l,m];if(f===l||h===l)return this.getCenterOfFlatRegion(j,k,l,m,n,o,d,e);f>j==l>j&&f>j==f>l?(n=l,o=m,l=f,m=g):h>n==l>n&&h>l==h>n?(j=l,k=m,l=h,m=i):(j=f,k=g,n=h,o=i)}},_MAX_FLOAT:.01,getCenterOfCoordinates:function(a,b){var c,d,e,f,g,h;return a>b&&(c=a,a=b,b=c),d=a>0,e=b>0,f=Math.abs(a)>this._MAX_FLOAT,g=Math.abs(b)>this._MAX_FLOAT,f||g?this.getMean(a,b):0===a?b*Math.abs(b):0===b?a*Math.abs(a):d!==e?0:(h=d?Math.sqrt(a*b):-Math.sqrt(a*b),h>=a&&b>=h?h:this.getMean(a,b))},getMean:function(a,b){return a>0==b>0?a+.5*(b-a):.5*(a+b)},getCenterOfFlatRegion:function(a,b,c,d,e,f,g,h){var i,j,k,l;if("y"===h){if(!isFinite(d))return;return isFinite(b)||(i=this.getBisectedFiniteValues(a,b,c,d,g),a=i[0],b=i[1]),isFinite(f)||(i=this.getBisectedFiniteValues(c,d,e,f,g),e=i[0],f=i[1]),k=b===d?[a,b]:this.divideCoordinateForConstantValue(a,b,c,d,g,d),l=f===d?[e,f]:this.divideCoordinateForConstantValue(c,d,e,f,g,d),j=this.getCenterOfCoordinates(k[0],l[0]),[j,g(j)]}if(isFinite(c)){if(isFinite(a)||(i=this.getBisectedFiniteValues(b,a,d,c,g),a=i[1],b=i[0]),isFinite(e)||(i=this.getBisectedFiniteValues(d,c,f,e,g),e=i[1],f=i[0]),a===c)k=[a,b];else{k=this.divideCoordinateForConstantValue(b,a,d,c,g,c);var m=k[0];k[0]=k[1],k[1]=m}if(e===c)l=[e,f];else{l=this.divideCoordinateForConstantValue(d,c,f,e,g,c);var m=l[0];l[0]=l[1],l[1]=m}return j=this.getCenterOfCoordinates(k[1],l[1]),[g(j),j]}},getBisectedFiniteValues:function(a,b,c,d,e){if(isFinite(b)!==isFinite(d))for(var f,g;;){if(f=this.getCenterOfCoordinates(a,c),g=e(f),f===a||f===c)return isFinite(b)?[a,b]:[c,d];isFinite(g)!==isFinite(b)?(c=f,d=g):(a=f,b=g)}},divideCoordinateForConstantValue:function(a,b,c,d,e,f){if(b===f!=(d===f))for(var g,h;;){if(g=this.getCenterOfCoordinates(a,c),h=e(g),g===a||g===c)return b===f?[a,b]:[c,d];h===f!=(b===f)?(c=g,d=h):(a=g,b=h)}},findCriticalPoints:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=0,B=0,C=0,D=[],E=[],F=[];for(f=new Array,p=.01,s=1e-4,e=!0,MathUtilities.Components.EquationEngine.Models.Profile.getStartTime("criticalPoints"),A=0;A<a.length;A++){if(B=0,i=a[A].length,!(i>1))return f;for(t=0,B=B;i-2>B;B+=2){if(e===!0&&("y"===b?(j=a[A][B-2],k=a[A][B-1],l=a[A][B],m=a[A][B+1],n=a[A][B+2],o=a[A][B+3],x=a[A][B+4],y=a[A][B+5]):(k=a[A][B-2],j=a[A][B-1],m=a[A][B],l=a[A][B+1],o=a[A][B+2],n=a[A][B+3],y=a[A][B+4],x=a[A][B+5]),g=(m-k)/(l-j),h=(o-m)/(n-l),u=(y-o)/(x-n),q=h-g,r=!1,h>g&&h>u||g>h&&u>h))for(;r===!1&&("y"===b?(l=(j+n)/2,m=c(l)):(m=(k+o)/2,l=c(m)),g=(m-k)/(l-j),h=(o-m)/(n-l),u=(y-o)/(x-n),v=g-t,q=h-g,w=u-h,!(Math.abs(n-l)<s||Math.abs(l-j)<s||Math.abs(x-n)<s));)0>v&&w>0||v>0&&0>w?(F[C]=[l,m],C++,r=!0):q>0?h>0?(h=u,n=l,o=m):(j=l,k=m):0>q&&(0>g?(g=h,j=l,k=m):(n=l,o=m));"y"===b?(j=a[A][B-2],k=a[A][B-1],l=a[A][B],m=a[A][B+1],n=a[A][B+2],o=a[A][B+3],x=a[A][B+4],y=a[A][B+5],j>l&&(z=j,j=l,l=z),l>n&&(z=l,l=n,n=z)):(k=a[A][B-2],j=a[A][B-1],m=a[A][B],l=a[A][B+1],o=a[A][B+2],n=a[A][B+3],y=a[A][B+4],x=a[A][B+5],k>m&&(z=k,k=m,m=z),m>o&&(z=m,m=o,o=z)),g=(m-k)/(l-j),h=(o-m)/(n-l),u=(y-o)/(x-n),q=h-g,r=!1,(g>0&&0>h||h>0&&0>g)&&D.push(this.regressExtremaEdges([j,k],[l,m],[n,o],c,b))}}return f=e===!0?f.concat(D,E,F):f.concat(D,E)},refinePoint:function(a,b,c,d){var e,f=d/20;if(c){for(;;){if(e=b(a[0]+f),!(e>a[1]))break;a=[a[0]+f,e]}for(;;){if(e=b(a[0]-f),!(e>a[1]))break;a=[a[0]+f,e]}}else{for(;;){if(e=b(a[0]+f),!(e<a[1]))break;a=[a[0]+f,e]}for(;;){if(e=b(a[0]-f),!(e<a[1]))break;a=[a[0]+f,e]}}return a},addImage:function(a,b,c){var d,e,f;return this.graphView._paperScope.activate(),this.graphView._projectLayers.imageLayer.activate(),d="string"==typeof a?new this.graphView._paperScope.Raster({source:a}):new this.graphView._paperScope.Raster(a),void 0===c?(e=d.width/2,f=d.height/2):(e=c[0]+c[2]/2,f=c[1]+c[3]/2),d.position=new this.graphView._paperScope.Point(e,f),b.position=this.graphView._getGraphPointCoordinates([e,f]),b.setPoints([]),b.getPoints().push(this.graphView._getGraphPointCoordinates([e,f])),this.addEquation(b),this.graphView._gridGraphModelObject.get("_images").push(b),d}},{}),a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions=Backbone.Model.extend({},{_graphView:null,generateSimplePlot:function(b,c){var d=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.getPlotObject(c);return a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.addPoint(d,c.minX,b(c.minX)),a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.addPoint(d,c.maxX,b(c.maxX)),a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.finishSegment(d),d.lines},convertPolarToCartesian:function(a){var b,c,d,e,f;for(b=[],c=[],e=0;e<a.length;e++){for(c=a[e],d=[],f=0;f<c.length-1;f+=2)isFinite(c[f])&&isFinite(c[f+1])&&(d.push(c[f+1]*Math.cos(c[f])),d.push(c[f+1]*Math.sin(c[f])));b.push(d)}return b},addPoint:function(a,b,c){var d,e=[b,c],f=a.basePoint;return a.temporaryLines?f?(d=[a.temporaryLines[a.temporaryLines.length-2],a.temporaryLines[a.temporaryLines.length-1]],this.changePivot(d,f,e,a.tolerance)||(this.removeUnsettledPoints(a),a.basePoint=e),void(a.unsettledPoint=e)):(a.basePoint=e,void(a.unsettledPoint=e)):void(a.temporaryLines=[e[0],e[1]])},removeUnsettledPoints:function(a){a.unsettledPoint&&(a.temporaryLines.push(a.unsettledPoint[0],a.unsettledPoint[1]),a.basePoint=null,a.unsettledPoint=null)},finishSegment:function(b){a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.removeUnsettledPoints(b);var c,d,e;if(b.temporaryLines){for(c=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.fitPointsInsideDomain(b,b.temporaryLines),e=0;e<c.length;e++)c[e].length<2||(d=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.translateSegment(b,c[e],this._graphView),b.lines.push(d));b.temporaryLines=null}},translateSegment:function(a,b,c){var d,e,f=[];for(e=0;e<b.length-1;e+=2)d="x"===a.paramVariable?[b[e],b[e+1]]:[b[e+1],b[e]],d=c?c._getCanvasPointCoordinates(d):a.gridGraph._getCanvasPointCoordinates(d),f.push(d);return f},projectPointOnDomain:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s;return isFinite(e)||(e=e>0?1e10:-1e10),isFinite(c)||(c=c>0?1e10:-1e10),j=!0,k=!0,isFinite(e)||(e=e>0?1e10:-1e10),isFinite(c)||(c=c>0?1e10:-1e10),d<a.domain.minX?(h=a.domain.minX,i=a.domain.minY,n=a.domain.minX,o=a.domain.maxY):d>a.domain.maxX?(h=a.domain.maxX,i=a.domain.minY,n=a.domain.maxX,o=a.domain.maxY):j=!1,e<a.domain.minY?(f=a.domain.minX,g=a.domain.minY,l=a.domain.maxX,m=a.domain.minY):e>a.domain.maxY?(f=a.domain.minX,g=a.domain.maxY,l=a.domain.maxX,m=a.domain.maxY):k=!1,k&&(p=geomFunctions.intersectionOfLines(f,g,l,m,b,c,d,e),void 0!==p&&(r=geomFunctions.distance2(b,c,p[0],p[1]))),j&&(q=geomFunctions.intersectionOfLines(h,i,n,o,b,c,d,e),void 0!==q&&(s=geomFunctions.distance2(b,c,q[0],q[1]))),r||s?r&&s?r>s?p:q:r?p:s?q:void 0:void 0},fitPointsInsideDomain:function(a,b){if(void 0!==b&&!(b.length<2)){var c,d,e,f,g,h,i=[],j=[i],k=[];for(c=0;c<b.length-1;c+=2)if(b[c]!==d||b[c+1]!==e)if(h=this.getDomainForPoint(a,b[c],b[c+1]),void 0!==d){if(h!==g){if(0===h&&k.indexOf(0)>-1){
for(;k.length>0;)k.pop();i=[],j.push(i)}k.push(h)}if(0===h){if(0!==g){if(f=this.projectPointOnDomain(a,b[c],b[c+1],d,e),void 0===f)continue;i.push(f[0]),i.push(f[1])}i.push(b[c]),i.push(b[c+1])}else if(0===g){if(f=this.projectPointOnDomain(a,d,e,b[c],b[c+1]),void 0===f)continue;i.push(f[0]),i.push(f[1])}else if(h!==g){if(f=this.projectPointOnDomain(a,b[c],b[c+1],d,e),void 0===f)continue;if(i.push(f[0]),i.push(f[1]),f=this.projectPointOnDomain(a,d,e,b[c],b[c+1]),void 0===f)continue;i.push(f[0]),i.push(f[1])}g=h,d=b[c],e=b[c+1]}else d=b[c],e=b[c+1],0===h&&(i.push(b[c]),i.push(b[c+1])),g=h,k.push(h);return j}},changePivot:function(a,b,c,d){var e,f=geomFunctions.getSegmentParam(c[0],c[1],a[0],a[1],b[0],b[1]);return 1>f?!1:(e=[a[0]+f*(b[0]-a[0]),a[1]+f*(b[1]-a[1])],Math.abs(c[0]-e[0])<=d&&Math.abs(c[1]-e[1])<=d)},isPointOutSideDomain:function(a,b,c){return 0===this.getDomainForPoint(a,b,c)},getDomainForPoint:function(a,b,c){var d=0,e=0;return b<a.domain.minX-10?d=1:b>a.domain.maxX+10&&(d=2),c<a.domain.minY?e=1:c>a.domain.maxY&&(e=2),10*e+d},getPlotObject:function(a){return{lines:[],segment:null,gridGraph:a.gridGraph,tolerance:a.tolerance,domain:a,basePoint:null,unsettledPoint:null,paramVariable:a.paramVariable}},refine:function(b,c,d,e){var f,g;g=geomFunctions.mean(b[0],c[0]),f=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.detectJump(d,e.domain.tolerance,b[0],b[1],g,d(g),c[0],c[1]),f&&(a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.addPoint(e,f[0][0],f[0][1]),a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.finishSegment(e),a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.addPoint(e,f[1][0],f[1][1]))},generatePlot:function(b,c){var d,e=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.getPlotObject(c),f=c.minX,g=b(f),h=[f,g];for(isFinite(g)&&a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.addPoint(e,f,g),f+=c.step;f<=c.maxX;)g=b(f),isFinite(g)&&isFinite(h[1])?(a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.refine(h,[f,g],b,e),a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.addPoint(e,f,g)):isFinite(g)&&!isFinite(h[1])?(d=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.limitedRefine(h[0],h[1],f,g,b),d[0]!==f&&a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.addPoint(e,d[0],d[1]),a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.refine(d,[f,g],b,e),a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.addPoint(e,f,g)):!isFinite(g)&&isFinite(h[1])&&(d=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.limitedRefine(h[0],h[1],f,g,b),a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.refine(h,d,b,e),d[0]!==h[0]&&a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.addPoint(e,d[0],d[1]),a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.finishSegment(e)),h=[f,g],f+=c.step;return a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.finishSegment(e),e.lines},detectJump:function(b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q;if(isFinite(e)&&isFinite(g)&&isFinite(i)&&!(d>f||f>h))for(;;){if(j=this.getInterpolationParam(d,f),l=b(j),n=Math.abs(l-geomFunctions.mean(e,g)),k=this.getInterpolationParam(f,h),m=b(k),o=Math.abs(m-geomFunctions.mean(g,i)),c>=n&&c>=o)return null;if(!isFinite(l))return p=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.limitedRefine(d,e,j,l,b),q=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.limitedRefine(j,l,h,i,b),[p,q];if(!isFinite(m))return p=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.limitedRefine(d,e,k,m,b),q=a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.limitedRefine(k,m,h,i,b),[p,q];if(!(j!==d&&j!==f||k!==f&&k!==h))return Math.abs(g-e)>Math.abs(i-g)?(p=[d,e],q=[f,g]):(p=[f,g],q=[h,i]),[p,q];if(j===d||j===f)return a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.selectJumpPoint(d,e,f,g,k,m,h,i);if(k===f||k===h)return a.Common.Components.Models.MathUtilitiesGraphNew.plottingFunctions.selectJumpPoint(d,e,j,l,f,g,h,i);n>o?(h=f,i=g,f=j,g=l):(d=f,e=g,f=k,g=m)}},selectJumpPoint:function(a,b,c,d,e,f,g,h){var i=Math.abs(d-b),j=Math.abs(f-d),k=Math.abs(h-f);return i>j&&i>k?[[a,b],[c,d]]:k>j&&k>i?[[e,f],[g,h]]:[[c,d],[e,f]]},getInterpolationParam:function(a,b){return a>b&&(a=a+b-(b=a)),Math.abs(a)>.01||Math.abs(b)>.01?geomFunctions.mean(a,b):0===a?b*Math.abs(b):0===b?a*Math.abs(a):a>0!=b>0?0:geomFunctions.mean(a,b)},setGraphView:function(a){this._graphView=a},limitedRefine:function(a,b,c,d,e){var f,g;if(isFinite(b)!==isFinite(d))for(;;){if(f=this.getInterpolationParam(a,c),g=e(f),f===a||f===c)return isFinite(b)?[a,b]:[c,d];isFinite(g)!==isFinite(b)?(c=f,d=g):(a=f,b=g)}}})}(window.MathInteractives);