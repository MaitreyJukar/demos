!function(){"use strict";MathInteractives.Common.Components.Theme2.Views.CustomSpinnerExtended=MathInteractives.Common.Components.Theme2.Views.CustomSpinner.extend({isClicked:!1,timer:null,firstTimeout:null,initialize:function(){this.constructor.__super__.initialize.apply(this,arguments),this._attachEvents()},_setAlignments:function(){this._generateButtons(),this.setSpinBoxValue(this.spinValue)},_attachEvents:function(){var a=this,b=MathInteractives.Common.Utilities.Models.Utils,c=this.$el.find(".spin-up-arrow"),d=this.$el.find(".spin-down-arrow");d.off(".downButton").on("mousedown.downButton",function(b){a.downBtn.getButtonState()!=MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED&&(a.handleArrowClick(!1,b),a._bindDocumentUpEvent(!1))}),c.off(".upButton").on("mousedown.upButton",function(b){a.upBtn.getButtonState()!=MathInteractives.global.Theme2.Button.BUTTON_STATE_DISABLED&&(a.handleArrowClick(!0,b),a._bindDocumentUpEvent(!0))}),b.EnableTouch(d),b.EnableTouch(c)},_bindDocumentUpEvent:function(a){var b=this;$(document).off(".spinnerDocumentClick").on("mouseup.spinnerDocumentClick touchend.spinnerDocumentClick touchcancel.spinnerDocumentClick",function(a){b.isClicked=!1,window.clearInterval(b.timer),window.clearTimeout(b.firstTimeout),$(document).off(".spinnerDocumentClick")})},setSpinBoxValue:function(a){var b=this,c=this.minValue,d=this.maxValue,e=(this.spinSign,this.spinBoxId,this.model.get("defaultText"));this.disableSpin||(null===a||a===e?(this.isEditable?(this.$(".spinner-input-box").val(e),this.setAccMessage(this.model.getTextAccId(),this.model.getEmptySpinnerAccText(),this.emptySpinnerPlaceHolderValues)):(this.$(".spin-value").text(this._replaceMinusSign(e)),this.setAccMessage(this.model.getTextAccId(),this.model.getEmptySpinnerAccText(),this.emptySpinnerPlaceHolderValues)),this.model.set("value",null),this.currentValue=null,this._disableBtn(this.downBtn)):(this.currentValue=this.spinSign?b.getSpinBoxSignValue(a):a,this.model.set("value",a),this.isEditable?this.$(".spinner-input-box").val(this.currentValue):this.$(".spin-value").text(this._replaceMinusSign(this.currentValue))),c==a?(this.upBtn.getButtonState()!==MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE&&this._enableBtn(this.upBtn,this.model.getUpArrowAccId()),this._disableBtn(this.downBtn,this.model.getDownArrowAccId())):d==a?(this._disableBtn(this.upBtn,this.model.getUpArrowAccId()),this.downBtn.getButtonState()!==MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE&&this._enableBtn(this.downBtn,this.model.getDownArrowAccId())):(this.upBtn.getButtonState()!==MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE&&this._enableBtn(this.upBtn,this.model.getUpArrowAccId()),this.downBtn.getButtonState()!==MathInteractives.global.Theme2.Button.BUTTON_STATE_ACTIVE&&null!=this.currentValue&&this._enableBtn(this.downBtn,this.model.getDownArrowAccId())))},handleArrowClick:function(a,b){var c=this,d=null,e=null,f=500/3;this.isClicked=!0,c.timer&&window.clearInterval(c.timer),c.firstTimeout&&window.clearTimeout(c.firstTimeout),d=function(){c.isClicked?a?c.spinUpArrowClick(b):c.spinDownArrowClick(b):window.clearInterval(e)},a?c.spinUpArrowClick(b):c.spinDownArrowClick(b),e&&window.clearInterval(e),this.firstTimeout=window.setTimeout(function(){c.timer=e=window.setInterval(d,f)},2*f)},spinUpArrowClick:function(a){if("disabled"!==this.upBtn.getButtonState()&&(void 0===a||"undefined"==typeof a.which||1===a.which)){var b,c=this.maxValue,d=this.stepValue,e=Number(this.currentValue),f=this.spinSign;if(MathInteractives.global.SpeechStream.stopReading(),this.isEditable&&(this.validateInputValue(this.$(".spinner-input-box").val()),e=Number(this.currentValue)),e>c&&(e=c-1),this._enableBtn(this.downBtn,this.model.getDownArrowAccId()),c>e){if(this.model.get("isStepper")!==!0){var g=Number(e)+Number(d);null!==this.inputPrecision&&(g=g.toFixed(this.inputPrecision),b=String(g).split("."),0===Number(b[1])&&(g=parseInt(g)))}else{var g,h=this.model.get("stepperValues"),i=this.model.get("currentStepperIndex");h[i+1]&&(g=h[i+1],this.model.set("currentStepperIndex",i+1))}this.previousValue=this.currentValue,this.currentValue=f?this.getSpinBoxSignValue(g):g,this.validateInputValue(this.currentValue),this.isEditable&&this.$(".spinner-input-box").val(this.currentValue)}this._setPlaceHolderValue(this.model.getDefaultPlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.PREV_VAL,this.defaultAllPlaceHolderValues,Number(this.previousValue)),this._setPlaceHolderValue(this.model.getDefaultPlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.CURR_VAL,this.defaultAllPlaceHolderValues,Number(this.currentValue)),this._setPlaceHolderValue(this.model.getOnIncreasePlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.PREV_VAL,this.onIncreaseAllPlaceHolderValues,Number(this.previousValue)),this._setPlaceHolderValue(this.model.getOnIncreasePlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.CURR_VAL,this.onIncreaseAllPlaceHolderValues,Number(this.currentValue)),this.setAccMessage(this.model.getTextAccId(),this.model.getOnIncreaseAccText(),this.onIncreaseAllPlaceHolderValues),e==c-d&&(this._disableBtn(this.upBtn,this.model.getUpArrowAccId()),this.setAccMessage(this.model.getTextAccId(),this.model.getMaxLimitAccText(),this.maxLimitAllPlaceHolderValues)),this.trigger(MathInteractives.global.Theme2.CustomSpinner.VALUE_CHANGED,{actionPerformed:MathInteractives.global.Theme2.CustomSpinner.BUTTON_CLICK,buttonType:"spinner-up"}),this.model.setButtonState("active"),this.setFocusOnSpinner()}},spinDownArrowClick:function(a){if("disabled"!==this.downBtn.getButtonState()&&(void 0===a||"undefined"==typeof a.which||1===a.which)){var b,c=this.minValue,d=this.stepValue,e=Number(this.currentValue),f=this.spinSign;if(MathInteractives.global.SpeechStream.stopReading(),this.isEditable&&(this.validateInputValue(this.$(".spinner-input-box").val()),e=Number(this.currentValue)),c>e&&(e=c+1),this._enableBtn(this.upBtn,this.model.getUpArrowAccId()),e>c){if(this.previousValue=this.currentValue,this.model.get("isStepper")!==!0)this.currentValue=f?this.getSpinBoxSignValue(e-d):e-d;else{var g=this.model.get("stepperValues"),h=this.model.get("currentStepperIndex");g[h-1]&&(this.currentValue=g[h-1],this.model.set("currentStepperIndex",h-1))}null!==this.inputPrecision&&(this.currentValue=this.currentValue.toFixed(this.inputPrecision),b=String(this.currentValue).split("."),0===parseInt(b[1])&&(this.currentValue=parseInt(this.currentValue))),this.validateInputValue(this.currentValue),this.isEditable?this.$(".spinner-input-box").val(this.currentValue):this.$(".spin-value").text(this._replaceMinusSign(this.currentValue))}this._setPlaceHolderValue(this.model.getDefaultPlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.PREV_VAL,this.defaultAllPlaceHolderValues,Number(this.previousValue)),this._setPlaceHolderValue(this.model.getDefaultPlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.CURR_VAL,this.defaultAllPlaceHolderValues,Number(this.currentValue)),this._setPlaceHolderValue(this.model.getOnDecreasePlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.PREV_VAL,this.onDecreaseAllPlaceHolderValues,Number(this.previousValue)),this._setPlaceHolderValue(this.model.getOnDecreasePlaceHolders(),MathInteractives.global.Theme2.CustomSpinner.CURR_VAL,this.onDecreaseAllPlaceHolderValues,Number(this.currentValue)),this.setAccMessage(this.model.getTextAccId(),this.model.getOnDecreaseAccText(),this.onDecreaseAllPlaceHolderValues),e===c+d&&(this._disableBtn(this.downBtn,this.model.getDownArrowAccId()),this.setAccMessage(this.model.getTextAccId(),this.model.getMinLimitAccText(),this.minLimitAllPlaceHolderValues)),this.trigger(MathInteractives.global.Theme2.CustomSpinner.VALUE_CHANGED,{actionPerformed:MathInteractives.global.Theme2.CustomSpinner.BUTTON_CLICK,buttonType:"spinner-down"}),this.model.setButtonState("active"),this.setFocusOnSpinner()}},_spinBoxInputKeyPress:function(a){var b=a.which||a.keyCode,c=this.$("#"+a.currentTarget.id),d=c.val();d<=this.minValue?(this._enableBtn(this.upBtn,this.model.getUpArrowAccId()),this._disableBtn(this.downBtn,this.model.getDownArrowAccId())):d>=this.maxValue?(this._disableBtn(this.upBtn,this.model.getUpArrowAccId()),this._enableBtn(this.downBtn,this.model.getDownArrowAccId())):(this._enableBtn(this.upBtn,this.model.getUpArrowAccId()),this._enableBtn(this.downBtn,this.model.getDownArrowAccId())),this.isFocusedPress&&(this.isFocusedPress=!1,b===$.ui.keyCode.ENTER)||(this.currentValue=this.spinSign?self.getSpinBoxSignValue(d):d,this.trigger(MathInteractives.global.Theme2.CustomSpinner.VALUE_CHANGED,{actionPerformed:MathInteractives.global.Theme2.CustomSpinner.KEY_PRESS,keyCode:b}))},_replaceMinusSign:function(a){var b=String.fromCharCode(8722);return a.toString().replace(/-/g,b)}},{generateCustomSpinner:function(a){if(a){var b=new MathInteractives.Common.Components.Theme2.Models.CustomSpinner(a),c=new MathInteractives.Common.Components.Theme2.Views.CustomSpinnerExtended({model:b,el:"#"+a.spinId});return c}}}),MathInteractives.global.Theme2.CustomSpinnerExtended=MathInteractives.Common.Components.Theme2.Views.CustomSpinnerExtended}();