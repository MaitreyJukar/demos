!function(){"use strict";var a=null,b=null,c=null;MathInteractives.Common.Components.Theme2.Models.ToolsGraph=MathInteractives.Common.Player.Models.BaseInteractive.extend({defaults:function(){return{gridGraphView:null,plotterView:null,gridGraphTool:null,gridGraphData:null,focusRect:null}},initialize:function(){return this},initializeGridGraphView:function(a){var b=this,c=null,d=null,e=null;return e=new MathUtilities.Components.Graph.Views.GridGraph({option:a.gridGraphOptions,el:a.gridGraphEl}),c=e.getPaperScope(),d=new c.Tool,b.set("gridGraphView",e),b.set("gridGraphTool",d),b.set("gridGraphData",a),a.isPlotterRequired?b._initializePlotterView():b},_initializePlotterView:function(){var a=this,b=a.get("gridGraphView");if(b){var c=new MathUtilities.Components.Graph.Views.plotterView({graphView:a.get("gridGraphView")});return a.set("plotterView",c),a}return!1},getGridGraphScope:function(){return this.get("gridGraphView").getPaperScope()},getAccessibilityText:function(b){var c=/[xy]/,d=b.match(c);if(d)return a.GET_ACC_TEXT(b);var e=b.split("="),f=[],g="x = x",h=a.GET_ACC_TEXT(g);return h=h.replace(/x/g,""),f[0]=a.GET_ACC_TEXT(e[0]),void 0!==e[1]?(f[1]=a.GET_ACC_TEXT(e[1]),f[0]+h+f[1]):f[0]},getCustomPaperTool:function(){return this.get("gridGraphTool")},_bindPostDragHandler:function(a){var b=this;return b.stopListening(a,"post-drag",b._triggerPostDrag),b.listenTo(a,"post-drag",b._triggerPostDrag),b},_triggerPostDrag:function(a){var b=this;return b.trigger(c.EQUATION_EVENTS.POST_DRAG,a),b},forceRefreshGridGraph:function(){var a=this,b=a.get("gridGraphView"),c=b.getPaperScope();return c.view.draw(),a},refreshGridGraph:function(){var a=this,b=a.get("gridGraphView");return b.refreshView(),a},drawGridGraph:function(a){var b=this,c=b.get("gridGraphView");return c.drawGraph(a),b},changeOriginOfGridGraph:function(a){var b=this,c=b.get("gridGraphView");return a&&c.changeOriginPosition(a),b},setGridBackground:function(a,b){var c=this,d=c.get("gridGraphView");return d.setBackgroundColor(a,b),c},setGridGraphStyle:function(a){var b=this,c=("undefined"==typeof a.shouldRefresh?!1:a.shouldRefresh,b.get("gridGraphView"));return c.setGridStyle(a.gridStyle),a.shouldRefresh&&c.drawGridLayer(),b},setAxisLineVisibility:function(a){var b=this,c=("undefined"==typeof a.shouldRefresh?!1:a.shouldRefresh,b.get("gridGraphView"));return c.setAxisLineVisibility(a.isVisible),a.shouldRefresh&&c.drawGridLayer(),b},setGridLineVisibility:function(a){var b=this,c=("undefined"==typeof a.shouldRefresh?!1:a.shouldRefresh,b.get("gridGraphView"));return c.setGridLineVisibility(a.isVisible),a.shouldRefresh&&c.drawGridLayer(),b},setGridGraphLabelVisibility:function(a){var b=this,c=("undefined"==typeof a.shouldRefresh?!1:a.shouldRefresh,b.get("gridGraphView"));return c.setLabelVisibility(a.isVisible),a.shouldRefresh&&c.drawGridLayer(),b},setGridGraphMarkerStyle:function(a){var b=this,c=("undefined"==typeof a.shouldRefresh?!1:a.shouldRefresh,b.get("gridGraphView"));return c.setMarkerTextStyle(a.markerStyle),a.shouldRefresh&&c.drawGridLayer(),b},getDragHitThicknessForEquation:function(a){return a.getDragHitThickness()},setDragHitThicknessForEquation:function(a,b){return $.isArray(a)?$.each(a,function(a,c){c.setDragHitThickness(b.thickness)}):a.setDragHitThickness(b.thickness),this},getGridLimits:function(){return this.get("gridGraphView").getLimits()},setGridLimits:function(a){var b=this,c=b.get("gridGraphView");return c.setLimits(a.xLower,a.xUpper,a.yLower,a.yUpper),c.drawGridLayer(),b},createEquationObject:function(a){var b=this,c=(b.get("gridGraphView"),b.get("plotterView"),new MathUtilities.Components.EquationEngine.Models.EquationData),d=null;return"undefined"!=typeof a&&(d=$.extend({},a),d.shouldRefresh=!0,"undefined"!=typeof d.latex&&b.setLatex(c,d)),c},createPointsEquationObject:function(a){var b=this,c=(b.get("gridGraphView"),b.get("plotterView"),b.createEquationObject()),d=null;return b.setBlindForEquation(c,!0).setSpecieForEquation(c,"point"),"undefined"!=typeof a&&(d=$.extend({},a),d.shouldRefresh=!0,"undefined"!=typeof d.points&&b.setPoints(c,d)),c},createPolygonEquationObject:function(a){var b=this,c=(b.get("gridGraphView"),b.get("plotterView"),b.createEquationObject()),d=null;return b.setBlindForEquation(c,!0).setSpecieForEquation(c,"polygon"),"undefined"!=typeof a&&(d=$.extend({},a),a.shouldRefresh=!0,"undefined"!=typeof d.isClosedPolygon&&c.setClosedPolygon(d.isClosedPolygon),"undefined"!=typeof d.points&&b.setPoints(c,d)),c},getPointsForEquation:function(a){return a.getPoints()},getPointsGroupForEquation:function(a){return a.getPointsGroup()},getPathGroupForEquation:function(a){return a.getPathGroup()},getGridDistanceForPoint:function(a){return this.get("gridGraphView")._getGridDistance(a)},getMinimumMarkerValuesForGrid:function(){return this.get("gridGraphView").getMinimumMarkerValues()},setBlindForEquation:function(a,b){return a.setBlind(b),this},setSpecieForEquation:function(a,b){return a.setSpecie(b),this},setAutonomousForEquation:function(a,b){return a.setAutonomous(b),this},setFunctionCodeForEquation:function(a,b){return a.setFunctionCode(b),this},setFunctionVariableForEquation:function(a,b){return a.setFunctionVariable(b),this},setParamVariableForEquation:function(a,b){return a.setParamVariable(b),this},setParamVariableOrderForEquation:function(a,b){return a.setParamVariableOrder(b),this},setConstantsForEquation:function(a,b){return a.setConstants(b),this},setLatex:function(a,b){var c=this,d=(c.get("plotterView"),"undefined"==typeof b.shouldRefresh?!1:b.shouldRefresh);return a.setLatex(b.latex),d&&c.updateEquationObject(a),c},getLatex:function(a){return a.getLatex()},setPoints:function(a,b){var c=this,d=(c.get("plotterView"),"undefined"==typeof b.shouldRefresh?!1:b.shouldRefresh);return a.setPoints(b.points),d&&c.updateEquationObject(a),c},setDraggable:function(a,b){var c=this,d=$.isArray(a),e="undefined"==typeof b.shouldRefresh?!1:b.shouldRefresh;return d?$.each(a,function(a,d){d.setDraggable(b.draggable),c._bindPostDragHandler(d)}):(a.setDraggable(b.draggable),c._bindPostDragHandler(a)),e&&c.updateEquationObject(a),c},setRange:function(a,b){var c=this,d=$.isArray(a);return d?$.each(a,function(a,c){c.setRange(b.range),c.trigger("plot-equation")}):(a.setRange(b.range),a.trigger("plot-equation")),c},getEquationArr:function(a){return a.getArr()},triggerChange:function(a){return a.trigger("change-equation"),this},updateEquationObject:function(a){var b=this,c=b.get("plotterView");return $.isArray(a)?$.each(a,function(a,b){c.addEquation(b),c.addPlot(b)}):(c.addEquation(a),c.addPlot(a)),b},changeEqnObjOpacity:function(a,b){var c=this,d=$.isArray(a),e=(c.get("plotterView"),"undefined"==typeof b.shouldRefresh?!1:b.shouldRefresh);return d?$.each(a,function(a,c){c.setOpacity(b.opacity)}):a.setOpacity(b.opacity),e&&c.updateEquationObject(a),c},changeEqnObjThickness:function(a,b){var c=this,d=$.isArray(a),e=(c.get("plotterView"),"undefined"==typeof b.shouldRefresh?!1:b.shouldRefresh);return d?$.each(a,function(a,c){c.changeThickness(b.thickness)}):a.changeThickness(b.thickness),e&&c.updateEquationObject(a),c},changeEqnObjColor:function(a,b){var c=this,d=$.isArray(a),e="undefined"==typeof b.shouldRefresh?!1:b.shouldRefresh;return d?$.each(a,function(a,c){c.changeColor(b.color)}):a.changeColor(b.color),e&&c.updateEquationObject(a),c},setInEqualityOpacity:function(a,b){var c=this,d=$.isArray(a),e="undefined"==typeof b.shouldRefresh?!1:b.shouldRefresh;return d?$.each(a,function(a,c){c.setInEqualityOpacity(b.opacity)}):a.setInEqualityOpacity(b.opacity),e&&c.updateEquationObject(a),c},setEquationOpacity:function(a,b){var c=this,d=$.isArray(a),e="undefined"==typeof b.shouldRefresh?!1:b.shouldRefresh;return d?$.each(a,function(a,c){c.setOpacity(b.opacity)}):a.setOpacity(b.opacity),e&&c.updateEquationObject(a),c},convertToDashedGraph:function(a){var b=this,c=$.isArray(a);return c?$.each(a,function(a,b){b.dashedGraph()}):a.dashedGraph(),b},convertToNormalGraph:function(a){var b=this,c=$.isArray(a);return c?$.each(a,function(a,b){b.normalGraph()}):a.normalGraph(),b},convertToCanvasCoordinate:function(a){var b=this,c=b.get("gridGraphView");return c.convertToCanvasCoordinate(a)},convertToGraphCoordinate:function(a){var b=this,c=b.get("gridGraphView");return c.convertToGraphCoordinate(a)},removeEquationFromGraph:function(a){var b=this,c=$.isArray(a),d=b.get("plotterView");return c?$.each(a,function(a,b){d.removeEquation(b)}):d.removeEquation(a),b},showEquation:function(a){var b=$.isArray(a);return b?$.each(a,function(a,b){b.showGraph()}):a.showGraph(),this},hideEquation:function(a){var b=$.isArray(a);return b?$.each(a,function(a,b){b.hideGraph()}):a.hideGraph(),this},triggerCustomEventsForGridEvent:function(a){var b=this,c=b.get("gridGraphView");return b.listenTo(c,a,function(){b.trigger(a,arguments)}),b},stopTriggeringCustomEventsForGridEvent:function(a){var b=this,c=b.get("gridGraphView");return b.stopListening(c,a),b},triggerCustomMouseMoveEventForGrid:function(a){var b=this,c=b.get("gridGraphData"),a=a?a:0;return $("#"+c.gridGraphOptions.canvasId).on("mousemove.graphWrapper",function(c){b._mouseMoveEventForGrid(c,a)}),b},stopTriggeringCustomMouseMoveEventForGrid:function(){var a=this,b=a.get("gridGraphData");return $("#"+b.gridGraphOptions.canvasId).off("mousemove.graphWrapper",a._mouseMoveEventForGrid),a},_mouseMoveEventForGrid:function(a,b){var c=this,d=a;c.bMouseMoveTimer||(c.bMouseMoveTimer=!0,window.setTimeout(function(){c.bMouseMoveTimer=!1,c.trigger(MathInteractives.Common.Components.Theme2.Models.ToolsGraph.EVENTS.GRID_EVENTS.GRID_LAYER_MOUSEMOVE,d)},b))},triggerCustomEventsForEquation:function(a,b,c){var d=this,c=c?c:"",e=b+c;return d.listenTo(a,b,function(){d.trigger(e,arguments)}),d},stopTriggeringCustomEventsForEquation:function(a,b){var c=this;return c.stopListening(a,b),c},setDefaultZoomBehaviour:function(a){var b=this,c=b.get("gridGraphView");return c.setDefaultZoomBehaviour(a),b},stopDoubleClickZoom:function(){var a=this,b=a.get("gridGraphView");return b.stopDoubleClickZoom(),a},setDefaultPanBehaviour:function(a){var b=this,c=b.get("gridGraphView");return c.setDefaultPanBehaviour(a),b},drawPoint:function(a,b){var c=this,d=c.get("gridGraphView");return d.drawPoint(a,b),c},setFillColor:function(a,b){var c=this;c.get("gridGraphView");return a.setIsFilled(!0),a.setFillColor(b),c},removeFillColor:function(a){var b=this;b.get("gridGraphView");return a.setIsFilled(!1),b},activateNewGridLayer:function(a){var b=this,c=b.get("gridGraphView");return c.activateNewLayer(a),b},activatePreviousGridLayer:function(){var a=this,b=a.get("gridGraphView");return b.activateEarlierLayer(),a},initGridGraphAcc:function(){var a=this,c=a.getGridGraphScope(),d=(a.get("gridGraphView"),null),e=a._getFocusRectStyle();return a.activateNewGridLayer(b.SERVICE_LAYER),d=new c.Path.Rectangle([0,0,1,1]),a.set("focusRect",d),d.style=e,a.hideFocusRect(),a.activatePreviousGridLayer(),a},setFocus:function(b){var c=this,d=a.FOCUS_OFFSET,e=c._getPaperGroup(b),f=e.bounds,g=f.topLeft,h=f.bottomRight,g=[g.x-d,g.y-d],h=[h.x+d,h.y+d],i={topLeft:g,bottomRight:h};return c._redrawFocus(i)},_getPaperGroup:function(a){var b=this,c=a.getSpecie(),d=null;switch(c){case"point":d=b.getPointsGroupForEquation(a);break;case"polygon":case"plot":default:d=b.getPathGroupForEquation(a)}return d},showFocusRect:function(){var a=this;return a.get("focusRect").opacity=1,a.refreshGridGraph(),a},hideFocusRect:function(){var a=this;return a.get("focusRect").opacity=0,a.refreshGridGraph(),a},_redrawFocus:function(a){var b=this,c=b.getGridGraphScope(),d=b._getFocusRectStyle(),e=null;return b.get("focusRect").remove(),e=new c.Path.Rectangle(a),e.style=d,b.set("focusRect",e),b.showFocusRect()},_getFocusRectStyle:function(){var a="#aaa",b=2,c=[2,2],d={strokeColor:a,dashArray:c,strokeWidth:b};return d}},{GET_ACC_TEXT:function(a){return MathUtilities.Components.EquationEngine.Models.ParserAssist.getEquationAccessibility(a)},EVENTS:{EQUATION_EVENTS:{POST_DRAG:"post-drag",DRAG_BEGIN:"drag-begin",DRAG_END:"post-relocate",PLOT_COMPLETE:"plotComplete"},GRID_EVENTS:{GRID_LAYER_MOUSEDOWN_SENSED:"grid-layer-mousedown-sensed",GRID_LAYER_CLICK:"grid-layer-click",GRID_LAYER_DOUBLE_CLICK:"grid-layer-doubleclick",GRID_LAYER_MOUSEDRAG:"grid-layer-mousedrag",GRID_LAYER_MOUSEUP:"grid-layer-mouseup",GRID_LAYER_DRAGBEGIN:"grid-layer-dragBegin",GRAPH_ZOOM_PAN:"graph:zoom-pan",POINT_LAYER_MOUSEUP:"point-layer-mouseup",POINT_LAYER_MOUSEDOWN_SENSED:"point-layer-mousedown-sensed",POINT_LAYER_CLICK:"point-layer-click"}},LAYER_NAMES:{GRID_LAYER:"grid",SHAPE_LAYER:"shape",CUSTOM_SHAPE_LAYER:"customShape",POINT_LAYER:"point",BANNER_LAYER:"banner",IMAGE_LAYER:"image",ANNOTATION_LAYER:"annotation",SERVICE_LAYER:"service"},FOCUS_OFFSET:2}),a=MathInteractives.Common.Components.Theme2.Models.ToolsGraph,c=a.EVENTS,b=a.LAYER_NAMES}(window.MathInteractives);